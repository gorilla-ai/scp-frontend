//
//     KeyLines v4.6.0-9745 professional sdk
//     Licensed to Gorilla Technology Inc. for CDR Link Analysis expires on Sun Sep 06 2020
//
//     Copyright © 2011-2018 Cambridge Intelligence Limited.
//     All rights reserved.
//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.KeyLines=t()}(this,function(){"use strict";var e,t=function(e,t){if(e&&"object"==typeof e)if(Array.isArray(e))e.forEach(t);else for(var n=Object.keys(e),r=n.length,i=0;i<r;i++){var a=n[i];t(e[a],a)}};function n(){if("undefined"!=typeof window)return window.devicePixelRatio||1}function r(e){return"rtl"===window.getComputedStyle(e).direction}function i(e){if(null===e)return null;switch(typeof e){case"object":if(Array.isArray(e))return e.slice();if(c(e))return l(e);if(e instanceof Date)return new Date(e.getTime());var n={};t(e,function(e,t){n[t]=e});return n;case"boolean":case"string":case"number":return e;default:return}}function a(e){return e*(Math.PI/180)}function o(e,n,r){var i,a=n,u=r;if(2===arguments.length&&"string"==typeof a){u=a;a=!0}if(null===e)return null;function s(e,t){a&&"_"===t.charAt(0)||(i[t]=o(e,a&&t!==u))}switch(typeof e){case"object":if(Array.isArray(e)){for(var f=[],d=0;d<e.length;d++)f.push(o(e[d],a,u));return f}if(c(e))return l(e,!0);if(e instanceof Date)return new Date(e.getTime());i={};t(e,s);return i;case"boolean":case"string":case"number":return e;default:return}}function l(e,t){var n,r=Object.getPrototypeOf(e).constructor;if(t){n=new r;o(Array.from(e)).forEach(function(e){n.add?n.add(e):n.set(e[0],e[1])})}else n=new r(e);return n}function u(){return Object.isPrototypeOf&&Array.from&&"undefined"!=typeof Set&&"undefined"!=typeof Map}function c(t){null==e&&u&&(e=u());return!!e&&(Object.prototype.isPrototypeOf.call(Map.prototype,t)||Object.prototype.isPrototypeOf.call(Set.prototype,t))}function s(e,t){if(m(e))return setTimeout(e,t)}function f(e,t){if(m(e))return setInterval(e,t)}function d(){if(!KeyLines._loggerDisabled&&"undefined"!=typeof console){var e=[].slice.call(arguments).join(" ");console.log(e)}}var g=Number.isNaN||function(e){return e!=e},h=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)};function v(e){return e>>>0===parseFloat(e)}function m(e){return"function"==typeof e}function b(e,t){var n=t||"";return n.slice(Math.max(n.length-5,0))==="."+e}function I(e){return"data:image/"===(e||"").slice(0,11)}function y(e){return!("object"!=typeof e||e instanceof Date||Array.isArray(e)||W(e))}function p(e){return"[object Date]"===Object.prototype.toString.call(e)&&!g(e.getTime())}function C(e,t){e&&m(e)&&e(t)}var x=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function G(e,t){try{t(null,e())}catch(e){t(e)}}function w(e){return e&&!Array.isArray(e)&&e.items?e.items:e}function Z(e){return Array.isArray(e)?e:[e]}var A=Map||function(){var e={},t=[];return{get size(){return t.length},get:function(n){var r=e[n];return void 0!==r?t[r][1]:null},set:function(n,r){var i=e[n];if(void 0!==i)t[i]=[n,r];else{t.push([n,r]);e[n]=t.length-1}},forEach:function(e){function n(t){e(t[1],t[0])}t.forEach(n)},delete:function(n){var r=e[n];if(void 0!==r){t.splice(r,1);e[n]=void 0}},clear:function(){e={};t=[]}}};function B(e,n){var r=o(e)||{};if("string"==typeof e)return e;t(n,function(e,t){M(r,t)&&!W(r[t])||(r[t]=e)});return r}function R(e){return void 0!==e}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function W(e){return null==e}function V(){return"✄"}function S(e){return e.lastIndexOf(V())}function X(e){if(W(e))return null;var t=e+"",n=S(t);-1!==n&&(t=t.substring(0,n));return t}function k(e){if(W(e))return null;var t=e+"",n=S(t);return-1!==n?t.substring(n+1):null}function E(e,t){return e.indexOf(t)>-1}var Y=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})};function F(e){return Object.keys(e).length>0}function H(e){return Z(e).reduce(function(e,t){e[X(t)]=1;return e},{})}function T(e){return Z(e).reduce(function(e,t){e.set(X(t),1);return e},new A)}function N(e){var t={};e.forEach(function(e){t[e.id]=e});return t}function z(e){var t={};e.forEach(function(e){t[e]=e});return t}function U(e){return e.map(function(e){return e.id})}function D(e,n){if(e){t(n,function(t,n){e[n]=t});return e}return n}var _=Object.assign||function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n};function K(e,t){return Math.max(1e-4,Math.sqrt(e*e+t*t))}function O(e,t){var n=e,r=t,i=K(n,r);return[n/=i,r/=i]}function J(e,t,n,r){var i=O(e,t),a=O(n,r);return i[0]*a[0]+i[1]*a[1]}function P(){}function j(e,t,n){var r=!e();function i(){r||(r=t())||(r=!e());return r?n():s(i,0)}i()}function Q(e,t){var n,r,i,a;return function(){var o=Date.now();i=this;a=arguments;function l(){r=Date.now();e.apply(i,a)}if(!n)if(!r||o-r>=t)l();else{n=s(function(){n=null;l()},t-(o-r))}}}function q(e){var t=e,n=48271,r=2147483647,i=r/n,a=r%n,o=1/r;return{setSeed:function(e){t=e},next:function(){if(t){var e=n*(t%i)-a*(t/i);return(t=e>0?e:e+r)*o}return Math.random()}}}function $(e,n){t(e,function(e){if(e&&e.im&&ee(e.im)){e.im=n;e.missing=!0}})}function ee(e){var t=void 0!==e.naturalWidth&&0===e.naturalWidth;if(!I(e.src)&&b("svg",e.src)){var n=28===e.width&&30===e.height;return t&&(0===e.width||n)}return t}var te={};function ne(e){if(!te[e]){var t=e;e.match(/'/)&&(t=e.replace(/'/g,"\\'"));t.match(/\s/)&&(t="'"+t+"'");te[e]=t}return te[e]}function re(e){return ie(e,e.target.id)}function ie(e,t){var n=oe(t);return{x:Math.floor(e.pageX-n.left),y:Math.floor(e.pageY-n.top)}}function oe(e){var t=document.getElementById(e),n={top:0,left:0};t&&(n=t.getBoundingClientRect());return{top:n.top+window.pageYOffset-document.documentElement.clientTop,left:n.left+window.pageXOffset-document.documentElement.clientLeft}}function le(e){for(var t=0,n=e.length;t<n;t++){var r=e.charCodeAt(t);if(r>=1536&&(r<=1791||r>=64336&&r<=65023||r>=65136&&r<=65279||r>=1872&&r<=1919||r>=2208&&r<=2303))return!0}return!1}function ue(e){return Math.floor(e*(11/14))}function ce(e){var t=e.charCodeAt(0);return t<=55295||t>=57344?t:1024*(t-55296)+(e.charCodeAt(1)-56320)+65536}function se(e){return[[169,169],[174,174],[8252,8252],[8265,8265],[8419,8419],[8482,8482],[8505,8505],[8596,8601],[8617,8618],[8986,8987],[9e3,9e3],[9096,9096],[9167,9167],[9193,9203],[9208,9210],[9410,9410],[9642,9643],[9654,9654],[9664,9664],[9723,9726],[9728,9733],[9735,9746],[9748,9861],[9872,9989],[9992,10002],[10004,10004],[10006,10006],[10013,10013],[10017,10017],[10024,10024],[10035,10036],[10052,10052],[10055,10055],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10083,10087],[10133,10135],[10145,10145],[10160,10160],[10175,10175],[10548,10549],[11013,11015],[11035,11036],[11088,11088],[11093,11093],[12336,12336],[12349,12349],[12951,12951],[12953,12953],[65039,65039],[126976,127231],[127245,127247],[127279,127279],[127340,127345],[127358,127359],[127374,127374],[127377,127386],[127405,127487],[127489,127503],[127514,127514],[127535,127535],[127538,127546],[127548,127551],[127561,128317],[128326,128591],[128640,128767],[128884,128895],[128981,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129279],[129292,129338],[129340,129349],[129351,131069],[917536,917631]].some(function(t){return e>=t[0]&&e<=t[1]})}function fe(e){return de(e).some(function(e){return se(ce(e))})}function de(e){for(var t,n=0,r=e.length,i=[];n<r;++n){t=!1;var a=e.charCodeAt(n);if(a>=55296&&a<=56319&&n+1<r&&(a=e.charCodeAt(n+1))>=56320&&a<=57343){i.push(e.slice(n,n+2));++n;t=!0}t||i.push(e.charAt(n))}return i}function ge(e){var t,n,r,i=[],a=e.length;for(t=0;t<a;t++){r=ce(n=e[t]);if(0===t)i.push(n);else if(u(r))i[i.length-1]+=n;else if(65038===r||65039===r)i[i.length-1]+=n;else if(o(r))i[i.length-1]+=n;else if(l(r)&&2===i[i.length-1].length&&l(ce(i[i.length-1])))i[i.length-1]+=n;else if(8205===r&&fe(i[i.length-1])&&t<a-1&&se(ce(e[t+1]))){i[i.length-1]+=n;i[i.length-1]+=e[++t]}else r>=917536&&r<=917631?i[i.length-1]+=n:i.push(n)}function o(e){return e>=127995&&e<=127999}function l(e){return e>=127462&&e<=127487}function u(e){return e>=768&&e<=879||e>=8400&&e<=8447}return i}var he={},ve=0,me=1,be=2,Ie=3,ye=4,pe=5,Ce=6,xe=7,Ge=8,we=9,Ze=10,Ae=11,Be=12,Re=13,Me=14,We=15,Ve=16,Se=17,Xe=18,ke=2,Ee=5,Ye=[9,Xe,10,Ce,11,pe,12,Ce,13,Ge,14,pe,28,Xe,31,pe,32,Ce,33,Ge,35,ye,38,Ae,43,ye,44,Ze,45,we,46,Ze,48,we,58,be,59,we,65,ye,91,ve,97,ye,123,ve,127,ye,133,Xe,134,pe,160,Xe,161,we,162,ye,166,Ae,170,ye,171,ve,173,ye,174,Xe,176,ye,178,Ae,180,be,181,ye,182,ve,185,ye,186,be,187,ve,192,ye,215,ve,216,ye,247,ve,248,ye,697,ve,699,ye,706,ve,720,ye,722,ve,736,ye,741,ve,750,ye,751,ve,768,ye,880,Be,884,ve,886,ye,894,ve,895,ye,900,ve,902,ye,903,ve,904,ye,1014,ve,1015,ye,1155,ve,1162,Be,1418,ve,1423,ye,1425,Ae,1470,Be,1471,me,1472,Be,1473,me,1475,Be,1476,me,1478,Be,1479,me,1488,Be,1536,me,1542,Ie,1544,ye,1545,xe,1547,Ae,1548,xe,1549,we,1550,xe,1552,ye,1563,Be,1611,xe,1632,Be,1642,Ie,1643,Ae,1645,Ie,1648,xe,1649,Be,1750,xe,1757,Be,1758,Ie,1759,ye,1765,Be,1767,xe,1769,Be,1770,ye,1774,Be,1776,xe,1786,be,1809,xe,1810,Be,1840,xe,1869,Be,1958,xe,1969,Be,1984,xe,2027,me,2036,Be,2038,me,2042,ye,2070,me,2074,Be,2075,me,2084,Be,2085,me,2088,Be,2089,me,2096,Be,2137,me,2142,Be,2208,me,2260,xe,2274,Be,2275,Ie,2307,Be,2362,ve,2363,Be,2364,ve,2365,Be,2369,ve,2377,Be,2381,ve,2382,Be,2385,ve,2392,Be,2402,ve,2404,Be,2433,ve,2434,Be,2492,ve,2493,Be,2497,ve,2503,Be,2509,ve,2510,Be,2530,ve,2534,Be,2546,ve,2548,Ae,2555,ve,2561,Ae,2563,Be,2620,ve,2622,Be,2625,ve,2649,Be,2672,ve,2674,Be,2677,ve,2691,Be,2748,ve,2749,Be,2753,ve,2761,Be,2765,ve,2768,Be,2786,ve,2790,Be,2801,ve,2809,Ae,2817,ve,2818,Be,2876,ve,2877,Be,2879,ve,2880,Be,2881,ve,2887,Be,2893,ve,2903,Be,2914,ve,2918,Be,2946,ve,2947,Be,3008,ve,3009,Be,3021,ve,3024,Be,3059,ve,3065,ye,3066,Ae,3072,ye,3073,Be,3134,ve,3137,Be,3142,ve,3160,Be,3170,ve,3174,Be,3192,ve,3199,ye,3201,ve,3202,Be,3260,ve,3261,Be,3276,ve,3285,Be,3298,ve,3302,Be,3329,ve,3330,Be,3393,ve,3398,Be,3405,ve,3406,Be,3426,ve,3430,Be,3530,ve,3535,Be,3538,ve,3544,Be,3633,ve,3634,Be,3636,ve,3647,Be,3648,Ae,3655,ve,3663,Be,3761,ve,3762,Be,3764,ve,3773,Be,3784,ve,3792,Be,3864,ve,3866,Be,3893,ve,3894,Be,3895,ve,3896,Be,3897,ve,3898,Be,3902,ye,3953,ve,3967,Be,3968,ve,3973,Be,3974,ve,3976,Be,3981,ve,4030,Be,4038,ve,4039,Be,4141,ve,4145,Be,4146,ve,4152,Be,4153,ve,4155,Be,4157,ve,4159,Be,4184,ve,4186,Be,4190,ve,4193,Be,4209,ve,4213,Be,4226,ve,4227,Be,4229,ve,4231,Be,4237,ve,4238,Be,4253,ve,4254,Be,4957,ve,4960,Be,5008,ve,5024,ye,5120,ve,5121,ye,5760,ve,5761,Ge,5787,ve,5792,ye,5906,ve,5920,Be,5938,ve,5941,Be,5970,ve,5984,Be,6002,ve,6016,Be,6068,ve,6070,Be,6071,ve,6078,Be,6086,ve,6087,Be,6089,ve,6100,Be,6107,ve,6108,Ae,6109,ve,6112,Be,6128,ve,6155,ye,6158,Be,6160,Xe,6277,ve,6279,Be,6313,ve,6314,Be,6432,ve,6435,Be,6439,ve,6441,Be,6450,ve,6451,Be,6457,ve,6464,Be,6470,ye,6622,ve,6656,ye,6679,ve,6681,Be,6683,ve,6686,Be,6742,ve,6743,Be,6744,ve,6753,Be,6754,ve,6755,Be,6757,ve,6765,Be,6771,ve,6784,Be,6832,ve,6916,Be,6964,ve,6965,Be,6966,ve,6971,Be,6972,ve,6973,Be,6978,ve,6979,Be,7019,ve,7028,Be,7040,ve,7042,Be,7074,ve,7078,Be,7080,ve,7082,Be,7083,ve,7086,Be,7142,ve,7143,Be,7144,ve,7146,Be,7149,ve,7150,Be,7151,ve,7154,Be,7212,ve,7220,Be,7222,ve,7227,Be,7376,ve,7379,Be,7380,ve,7393,Be,7394,ve,7401,Be,7405,ve,7406,Be,7412,ve,7413,Be,7416,ve,7424,Be,7616,ve,7680,Be,8125,ve,8126,ye,8127,ve,8130,ye,8141,ve,8144,ye,8157,ve,8160,ye,8173,ve,8178,ye,8189,ve,8192,ye,8203,Ge,8206,Xe,8207,ve,8208,me,8232,ye,8233,Ge,8234,pe,8235,Re,8236,Me,8237,We,8238,Ve,8239,Se,8240,we,8245,Ae,8260,ye,8261,we,8287,ye,8288,Ge,8294,Xe,8298,null,8304,Xe,8305,be,8308,ve,8314,be,8316,Ze,8319,ye,8320,ve,8330,be,8332,Ze,8336,ye,8352,ve,8400,Ae,8448,Be,8450,ye,8451,ve,8455,ye,8456,ve,8458,ye,8468,ve,8469,ye,8470,ve,8473,ye,8478,ve,8484,ye,8485,ve,8486,ye,8487,ve,8488,ye,8489,ve,8490,ye,8494,ve,8495,Ae,8506,ve,8508,ye,8512,ve,8517,ye,8522,ve,8526,ye,8528,ve,8544,ye,8585,ve,8722,ye,8723,Ze,8724,Ae,9014,ye,9083,ve,9109,ye,9110,ve,9352,ye,9372,be,9450,ve,9900,ye,9901,ve,10240,ye,10496,ve,11264,ye,11493,ve,11499,ye,11503,ve,11506,Be,11513,ve,11520,ye,11647,ve,11648,Be,11744,ve,11776,Be,12288,ye,12289,Ge,12293,ye,12296,ve,12321,ye,12330,ve,12334,Be,12336,ve,12337,ye,12342,ve,12344,ye,12349,ve,12353,ye,12441,ve,12443,Be,12445,ye,12448,ve,12449,ye,12539,ve,12540,ye,12736,ve,12784,ye,12829,ve,12832,ye,12880,ve,12896,ye,12924,ve,12927,ye,12977,ve,12992,ye,13004,ve,13008,ye,13175,ve,13179,ye,13278,ve,13280,ye,13311,ve,13312,ye,19904,ve,19968,ye,42128,ve,42192,ye,42509,ve,42512,ye,42607,ve,42611,Be,42612,ye,42622,Be,42624,ye,42654,ve,42656,Be,42736,ve,42738,Be,42752,ve,42786,ye,42888,ve,42889,ye,43010,ve,43011,Be,43014,ve,43015,Be,43019,ve,43020,Be,43045,ve,43047,Be,43048,ve,43056,ye,43064,ve,43072,Ae,43124,ve,43136,ye,43204,ve,43214,Be,43232,ve,43250,Be,43302,ve,43310,Be,43335,ve,43346,Be,43392,ve,43395,Be,43443,ve,43444,Be,43446,ve,43450,Be,43452,ve,43453,Be,43493,ve,43494,Be,43561,ve,43567,Be,43569,ve,43571,Be,43573,ve,43584,Be,43587,ve,43588,Be,43596,ve,43597,Be,43644,ve,43645,Be,43696,ve,43697,Be,43698,ve,43701,Be,43703,ve,43705,Be,43710,ve,43712,Be,43713,ve,43714,Be,43756,ve,43758,Be,43766,ve,43777,Be,44005,ve,44006,Be,44008,ve,44009,Be,44013,ve,44016,Be,64285,ve,64286,me,64287,Be,64297,me,64298,Ze,64336,me,64830,xe,64848,ye,65021,xe,65024,ye,65040,Be,65056,ye,65072,Be,65104,ye,65105,we,65106,ye,65108,we,65109,ye,65110,we,65119,ye,65120,Ae,65122,ye,65124,Ze,65129,ye,65131,Ae,65136,ye,65279,xe,65281,Xe,65283,ye,65286,Ae,65291,ye,65292,Ze,65293,we,65294,Ze,65296,we,65306,be,65307,we,65313,ye,65339,ve,65345,ye,65371,ve,65382,ye,65504,ve,65506,Ae,65509,ye,65512,Ae,1114109,ye],Fe={1536:{t:4},1537:{t:4},1538:{t:4},1539:{t:4},1540:{t:4},1541:{t:4},1544:{t:4},1547:{t:4},1568:{t:2},1569:{t:4,isolated:65152},1570:{t:1,isolated:65153,initial:65154},1571:{t:1,isolated:65155,initial:65156},1572:{t:1,isolated:65157,initial:65158},1573:{t:1,isolated:65159,initial:65160},1574:{t:2,isolated:65161,final:65163,median:65164,initial:65162},1575:{t:1,isolated:65165,initial:65166},1576:{t:2,isolated:65167,final:65169,median:65170,initial:65168},1577:{t:1,isolated:65171,initial:65172},1578:{t:2,isolated:65173,final:65175,median:65176,initial:65174},1579:{t:2,isolated:65177,final:65179,median:65180,initial:65178},1580:{t:2,isolated:65181,final:65183,median:65184,initial:65182},1581:{t:2,isolated:65185,final:65187,median:65188,initial:65186},1582:{t:2,isolated:65189,final:65191,median:65192,initial:65190},1583:{t:1,isolated:65193,initial:65194},1584:{t:1,isolated:65195,initial:65196},1585:{t:1,isolated:65197,initial:65198},1586:{t:1,isolated:65199,initial:65200},1587:{t:2,isolated:65201,final:65203,median:65204,initial:65202},1588:{t:2,isolated:65205,final:65207,median:65208,initial:65206},1589:{t:2,isolated:65209,final:65211,median:65212,initial:65210},1590:{t:2,isolated:65213,final:65215,median:65216,initial:65214},1591:{t:2,isolated:65217,final:65219,median:65220,initial:65218},1592:{t:2,isolated:65221,final:65223,median:65224,initial:65222},1593:{t:2,isolated:65225,final:65227,median:65228,initial:65226},1594:{t:2,isolated:65229,final:65231,median:65232,initial:65230},1595:{t:2},1596:{t:2},1597:{t:2},1598:{t:2},1599:{t:2},1600:{t:3,isolated:1600,final:1600,median:1600,initial:1600},1601:{t:2,isolated:65233,final:65235,median:65236,initial:65234},1602:{t:2,isolated:65237,final:65239,median:65240,initial:65238},1603:{t:2,isolated:65241,final:65243,median:65244,initial:65242},1604:{t:2,isolated:65245,final:65247,median:65248,initial:65246},1605:{t:2,isolated:65249,final:65251,median:65252,initial:65250},1606:{t:2,isolated:65253,final:65255,median:65256,initial:65254},1607:{t:2,isolated:65257,final:65259,median:65260,initial:65258},1608:{t:1,isolated:65261,initial:65262},1609:{t:2,isolated:65263,initial:65264},1610:{t:2,isolated:65265,final:65267,median:65268,initial:65266},1646:{t:2},1647:{t:2},1649:{t:1},1650:{t:1},1651:{t:1},1652:{t:4},1653:{t:1},1654:{t:1},1655:{t:1},1656:{t:2},1657:{t:2},1658:{t:2},1659:{t:2},1660:{t:2},1661:{t:2},1662:{t:2,isolated:64342,final:64344,median:64345,initial:64343},1663:{t:2},1664:{t:2},1665:{t:2},1666:{t:2},1667:{t:2},1668:{t:2},1669:{t:2},1670:{t:2,isolated:64378,final:64380,median:64381,initial:64379},1671:{t:2},1672:{t:1},1673:{t:1},1674:{t:1},1675:{t:1},1676:{t:1},1677:{t:1},1678:{t:1},1679:{t:1},1680:{t:1},1681:{t:1},1682:{t:1},1683:{t:1},1684:{t:1},1685:{t:1},1686:{t:1},1687:{t:1},1688:{t:1,isolated:64394,initial:64395},1689:{t:1},1690:{t:2},1691:{t:2},1692:{t:2},1693:{t:2},1694:{t:2},1695:{t:2},1696:{t:2},1697:{t:2},1698:{t:2},1699:{t:2},1700:{t:2},1701:{t:2},1702:{t:2},1703:{t:2},1704:{t:2},1705:{t:2,isolated:64398,final:64400,median:64401,initial:64399},1706:{t:2},1707:{t:2},1708:{t:2},1709:{t:2},1710:{t:2},1711:{t:2,isolated:64402,final:64404,median:64405,initial:64403},1712:{t:2},1713:{t:2},1714:{t:2},1715:{t:2},1716:{t:2},1717:{t:2},1718:{t:2},1719:{t:2},1720:{t:2},1721:{t:2},1722:{t:2},1723:{t:2},1724:{t:2},1725:{t:2},1726:{t:2},1727:{t:2},1728:{t:1},1729:{t:2},1730:{t:2},1731:{t:1},1732:{t:1},1733:{t:1},1734:{t:1},1735:{t:1},1736:{t:1},1737:{t:1},1738:{t:1},1739:{t:1},1740:{t:2,isolated:64508,final:64510,median:64511,initial:64509},1741:{t:1},1742:{t:2},1743:{t:1},1744:{t:2},1745:{t:2},1746:{t:1},1747:{t:1},1749:{t:1},1757:{t:4},1774:{t:1},1775:{t:1},1786:{t:2},1787:{t:2},1788:{t:2},1791:{t:2},1808:{t:1},1810:{t:2},1811:{t:2},1812:{t:2},1813:{t:1},1814:{t:1},1815:{t:1},1816:{t:1},1817:{t:1},1818:{t:2},1819:{t:2},1820:{t:2},1821:{t:2},1822:{t:1},1823:{t:2},1824:{t:2},1825:{t:2},1826:{t:2},1827:{t:2},1828:{t:2},1829:{t:2},1830:{t:2},1831:{t:2},1832:{t:1},1833:{t:2},1834:{t:1},1835:{t:2},1836:{t:1},1837:{t:2},1838:{t:2},1839:{t:1},1869:{t:1},1870:{t:2},1871:{t:2},1872:{t:2},1873:{t:2},1874:{t:2},1875:{t:2},1876:{t:2},1877:{t:2},1878:{t:2},1879:{t:2},1880:{t:2},1881:{t:1},1882:{t:1},1883:{t:1},1884:{t:2},1885:{t:2},1886:{t:2},1887:{t:2},1888:{t:2},1889:{t:2},1890:{t:2},1891:{t:2},1892:{t:2},1893:{t:2},1894:{t:2},1895:{t:2},1896:{t:2},1897:{t:2},1898:{t:2},1899:{t:1},1900:{t:1},1901:{t:2},1902:{t:2},1903:{t:2},1904:{t:2},1905:{t:1},1906:{t:2},1907:{t:1},1908:{t:1},1909:{t:2},1910:{t:2},1911:{t:2},1912:{t:1},1913:{t:1},1914:{t:2},1915:{t:2},1916:{t:2},1917:{t:2},1918:{t:2},1919:{t:2},2208:{t:2},2209:{t:2},2210:{t:2},2211:{t:2},2212:{t:2},2213:{t:2},2214:{t:2},2215:{t:2},2216:{t:2},2217:{t:2},2218:{t:1},2219:{t:1},2220:{t:1},2221:{t:4},2222:{t:1},2223:{t:2},2224:{t:2},2225:{t:1},2226:{t:1},2227:{t:2},2228:{t:2},2230:{t:2},2231:{t:2},2232:{t:2},2233:{t:1},2234:{t:2},2235:{t:2},2236:{t:2},2237:{t:2},2274:{t:4},8204:{t:4},8205:{t:3},8239:{t:4},8294:{t:4},8295:{t:4},8296:{t:4},8297:{t:4},65269:{t:1,isolated:65269,initial:65270},65271:{t:1,isolated:65271,initial:65272},65273:{t:1,isolated:65273,initial:65274},65275:{t:1,isolated:65275,initial:65276}},He={1611:1,1612:1,1613:1,1614:1,1615:1,1616:1,1617:1,1618:1,1619:1,1620:1,1621:1,1648:1},Le={1456:1,1457:1,1458:1,1459:1,1460:1,1461:1,1462:1,1463:1,1464:1,1465:1,1466:1,1467:1,1473:1,1474:1},Te={"ل":{"ا":"ﻻ","آ":"ﻵ","أ":"ﻷ","إ":"ﻹ"},"ا":{"ل":{"ل":{"ه":"ﷲ"}}}},Ne={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{",">":"<","<":">"},ze=63;function Ue(e,t){if(he[t])return he[t];var n={characters:[],logicalOrder:e,result:[]},r=De(e),i=Je(e,r),a=i.length;i.forEach(function(e,t){Pe(e);Oe(e);if(0!==e.characters.length){_e(e);Ke(e);at(e);ot(e);st(e);ft(e);lt(e);gt(e,Le,!1);dt(e);n.result=n.result.concat(e.reorderedCharacters);t<a-1&&n.result.push({text:"\n",level:0,type:pe});n.characters=n.characters.concat(e.characters)}});n.types=r;he[t]=n;return n}function De(e){return e.map(function(e){return yt(e)||0})}function _e(e){je(e);Qe(e);qe(e);$e(e);et(e);tt(e);nt(e)}function Ke(e){rt(e);it(e)}function Oe(e){var t=0,n=1,r=2,i=e.level,a=[];a.push({level:e.level,override:t});var o=0,l=a[0],u=l.level,c=[];function s(e,t){if(e<ze){a.push({level:e,override:t});return e}}e.characters.forEach(function(e){var f=e.type;if(f===Me){u+=Ct(u)?2:1;i=s(u,t)}else if(f===Re){u+=pt(u)?2:1;i=s(u,t)}else if(f===Se){u+=Ct(u)?2:1;i=s(u,r)}else if(f===Ve){u+=pt(u)?2:1;i=s(u,n)}f===We?a.length>1&&(l=a.pop()):l=a[a.length-1];i=l.level;u=i;if(-1===[Xe,Me,Re,Se,Ve,We].indexOf(f)){l.override>t&&(e.type=l.override===r?me:ve);e.embeddingLevel=i;e.index=o++;c.push(e)}});e.characters=c}function Je(e,t){var n=0,r=[],i=[];t.forEach(function(e){if(e!==pe)i.push(e);else if(i.length>0){a(i);n++;i.length=0}});i.length>0&&a(i);function a(t){var i=n,a=t.map(function(t){return{text:e[n++],level:0,embeddingLevel:null,type:t}}),o=e.slice(i,i+t.length);r.push({symbols:o,level:0,characters:a})}return r}function Pe(e){e.level=1}function je(e){e.characters.filter(xt(Be)).forEach(function(t){t.isNSM=!0;if(t.index>0){var n=e.characters[t.index-1].type;n===xe&&(t.type=xe);me===n&&(t.type=me)}})}function Qe(e){e.characters.filter(xt(be)).forEach(function(t){for(var n=t.index-1;n>=0;n--){var r=e.characters[n].type;if(r===xe){t.type=Ie;break}if([me,ve].indexOf(r)>-1)break}})}function qe(e){e.characters.filter(xt(xe)).forEach(function(e){e.type=me;e.isAL=!0})}function $e(e){e.characters.filter(xt([Ze,we])).forEach(function(t){var n=t.index;if(n>0&&n<e.characters.length-1){var r=e.characters[n-1].type;r!==e.characters[n+1].type||r!==be&&r!==Ie||(t.type=r)}})}function et(e){e.characters.filter(xt(Ae)).forEach(function(t){var n=t.index,r=n;if(n>0){for(var i=e.characters[n-1].type;r-- >0&&i===Ae;)i=e.characters[r].type;if(i===be){t.type=be;return}}if(n<e.characters.length-1){var a=e.characters[n+1].type;r=n;for(;r++<e.characters.length-1&&a===Ae;)a=e.characters[r].type;a===be&&(t.type=be)}})}function tt(e){e.characters.filter(xt([Ae,we,Ze,Ie])).forEach(function(e){e.type=ye})}function nt(e){e.characters.filter(xt(be)).forEach(function(t){for(var n=t.index-1;n>=0;n--){var r=e.characters[n].type;if(r===me)return;if(r===ve){t.type=ve;return}}})}function rt(e){e.characters.filter(xt([pe,Ce,Ge,ye])).forEach(function(t){var n=t.index;if(e.level<t.embeddingLevel)t.type=pt(t.embeddingLevel)?ve:me;else if(0!==n&&n!==e.characters.length-1&&n>0&&n<e.characters.length-1){for(var r=e.characters[n-1].type,i=e.characters[n+1].type,a=n;a-- >0&&-1===[me,xe,be,Ie,ve].indexOf(r);)r=e.characters[a].type;a=n;for(;a++<e.characters.length-1&&-1===[me,xe,be,Ie,ve].indexOf(i);)i=e.characters[a].type;[me,xe,be,Ie].indexOf(r)>-1&&[me,xe,be,Ie].indexOf(i)>-1?t.type=me:t.type=r===ve&&i===ve?ve:pt(t.embeddingLevel)?ve:me}})}function it(e){e.characters.filter(xt([pe,Ce,Ge,ye])).forEach(function(e){e.type=pt(e.embeddingLevel)?ve:me})}function at(e){var t;e.characters.forEach(function(e){var n=e.type;t=e.embeddingLevel;n===ve?Ct(t)&&t++:n===me||n===xe?pt(t)&&t++:n!==be&&n!==Ie||(pt(t)?t+=2:t++);e.level=t})}function ot(e){e.characters.filter(function(e){return Ne[e.text]&&Ct(e.level)}).forEach(function(e){e.text=Ne[e.text]})}function lt(e){var t=e.highestLevel;e.reorderedCharacters=o(e.characters);for(;t>0;){ut(e,t);t--}}function ut(e,t){var n,r=[];e.levelRuns.forEach(function(e){if(e.level>=t)if(n)n.endIndex+=e.length;else{n={startIndex:e.idx,endIndex:e.idx+e.length};r.push(n)}else n=null});r.forEach(function(t){ct(e,t)})}function ct(e,t){var n=t.startIndex,r=t.endIndex,i=e.reorderedCharacters.slice(n,r).reverse();e.reorderedCharacters=e.reorderedCharacters.slice(0,n).concat(i).concat(e.reorderedCharacters.slice(r))}function st(e){var t=0;e.characters.forEach(function(e){e.level>t&&(t=e.level)});e.highestLevel=t}function ft(e){var t=[],n=0,r=0,i={idx:0,length:0,level:e.characters[0].level};e.characters.forEach(function(e){if(e.level!==n&&0!==r){t.push(i);i={idx:r,length:0,level:e.level}}i.length++;r++;n=e.level});t.push(i);e.levelRuns=t}function dt(e){gt(e,He,!0);vt(e);bt(e);It(e)}function gt(e,t,n){for(var r=e.reorderedCharacters.reverse(),i=[],a=0,o=r.length;a<o;a++){var l=r[a],u=ht(a,r,t);a+=u.length;n||(l.text+=u.join(""));i.push(l)}var c=0;e.reorderedCharacters=i.reverse();e.reorderedCharacters.forEach(function(e){e.index=c++})}function ht(e,t,n){for(var r=[],i=e+1;i<t.length;i++){if(!n[t[i].text.charCodeAt(0)])return r;r.push(t[i].text)}return r}function vt(e){for(var t=e.reorderedCharacters.reverse(),n=[],r=0,i=t.length;r<i;r++){var a=t[r],o=Te[a.text[0]];if(o){var l=mt(r,o,t);if(l){r+=l.length;a.text=l.text}}n.push(a)}var u=0;e.reorderedCharacters=n.reverse();e.reorderedCharacters.forEach(function(e){e.index=u++})}function mt(e,t,n){for(var r=0,i=t,a=e+1;a<n.length;a++){var o=i[n[a].text[0]];if(!o)return!1;if("string"==typeof o)return{text:o,length:++r};i=o}return!1}function bt(e){var t,n=function(){e.arabicTextRuns.push(t);t=null},r=e.reorderedCharacters;e.arabicTextRuns=[];for(var i=0,a=r.length;i<a;i++){var o=r[i].text.charCodeAt(0),l=Fe[o];if(l&&[me,ke,ve].indexOf(l.t)>-1){t||(t={startIndex:i});t.endIndex=i+1;if(i+1<a){var u=r[i+1].text.charCodeAt(0),c=Fe[u];c&&c.t===me&&n()}else n();l.t===ve&&n()}else l&&l.t===Ee||t&&n()}t&&n()}function It(e){e.arabicTextRuns.forEach(function(t){for(var n,r=t.startIndex,i=t.endIndex,a=r;a<i;a++){var o=e.reorderedCharacters[a],l=Fe[o.text.charCodeAt(0)];n=null;i-r>1?a===r?n=l.initial:a===i-1?n=l.final:a>r&&a<i-1&&(n=l.median):n=l.isolated;n&&(o.text=String.fromCharCode(n)+o.text.substring(1))}})}function yt(e){for(var t=e.charCodeAt(0),n=0;n<Ye.length;n+=2)if(t<Ye[n])return Ye[n+1];return ye}function pt(e){return e%2==0}function Ct(e){return e%2!=0}function xt(e){var t=Z(e);return function(e){return t.indexOf(e.type)>-1}}var Gt=Object.freeze({analyseText:Ue}),wt={},Zt={},At="rgb(128, 128, 128)",Bt={aqua:"rgb(0, 255, 255)",black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",fuchsia:"rgb(255, 0, 255)",green:"rgb(0, 128, 0)",grey:At,gray:At,lime:"rgb(0, 255, 0)",maroon:"rgb(128, 0, 0)",navy:"rgb(0, 0, 128)",olive:"rgb(128, 128, 0)",orange:"rgb(255,165,0)",purple:"rgb(128, 0, 128)",red:"rgb(255, 0, 0)",silver:"rgb(192, 192, 192)",teal:"rgb(0, 128, 128)",yellow:"rgb(255, 255, 0)",white:"rgb(255, 255, 255)",ci:"rgb(0, 174, 239)",cia:"rgba(0, 174, 239, 0.5)",keyline:"rgb(88, 89, 91)",midgrey:"rgb(145, 146, 149)",lightgrey:"rgb(208, 209, 211)",edit:"rgb(114, 179, 0)",attention:"rgb(220, 0, 0)",information:"rgb(0, 150, 255)",description:"rgb(255, 175, 0)",textback:"rgba(255,255,255,0.6)",transparent:"rgba(255,255,255,0.0)",touch:"rgba(255,0,0,0.6)"};function Rt(e,t,n){return"rgb("+e+","+t+","+n+")"}function Mt(e,t,n,r){return"rgba("+e+","+t+","+n+","+r+")"}var Wt=/^(?:rgb)?\(\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?\)$/i,Vt=/^(?:rgba)?\(\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]),\s?(0|1|0\.\d{0,20}|1\.0)\)$/i,St=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,Xt=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])$/i;function kt(e){return!!Et(e).length}function Et(e){var t,n=[];if("string"!=typeof e)return n;var r=Bt[e.toLowerCase()]||e,i=r.match(Wt);i||(i=r.match(Vt));if(i){for(t=1;t<4;t++)n.push(parseInt(i[t],10));void 0!==i[4]&&n.push(+i[4])}else{if(!(i=r.match(Xt))&&(i=r.match(St)))for(t=1;t<4;t++)i[t]=""+i[t]+i[t];if(i)for(t=1;t<4;t++)n.push(parseInt(i[t],16))}return n}function Yt(e){if("transparent"===e)return 0;var t=e.match(Vt);return t?parseFloat(t[4]):1}function Ft(e){var t=Et(e),n=zt(t[0],t[1],t[2]);n.push(Yt(e));return n}function Ht(e){var t=Dt(e[0],e[1],e[2]);return Mt(t[0],t[1],t[2],e[3])}function Lt(e,t){return 1===t?e:Kt(e,t)}function Tt(e){function t(){return Math.floor(240*Math.random())}var n=Rt(t(),t(),t());return e&&n in e?Tt(e):n}function Nt(e,t,n){var r;e&&(e.bg&&e.gh?r=t*n:e.bg?r=t:e.gh&&(r=n));return 0===r?1e-6:r}function zt(e,t,n){var r,i,a=e/255,o=t/255,l=n/255,u=Math.max(a,o,l),c=Math.min(a,o,l),s=(u+c)/2;if(u===c){r=0;i=0}else{var f=u-c;i=s>.5?f/(2-u-c):f/(u+c);switch(u){case a:r=(o-l)/f+(o<l?6:0);break;case o:r=(l-a)/f+2;break;case l:r=(a-o)/f+4}r/=6}return[r,i,s]}function Ut(e,t,n){var r=n;r<0&&(r+=1);r>1&&(r-=1);return r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Dt(e,t,n){var r,i,a;if(0===t){r=n;i=n;a=n}else{var o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;r=Ut(l,o,e+1/3);i=Ut(l,o,e);a=Ut(l,o,e-1/3)}return[Math.round(255*r),Math.round(255*i),Math.round(255*a)]}function _t(e,t){for(var n=["c","fc","bc"],r=0;r<n.length;r++){var i=n[r];if(e[i]){var a=Et(e[i]);e[i]=Mt(a[0],a[1],a[2],t);e["w"+i][3]=255*t}}}function Kt(e,t){var n=e+t;if(!wt[n]){var r=Et(e),i=Yt(e);wt[n]=Mt(r[0],r[1],r[2],i*t)}return wt[n]}function Ot(e){if(e){if(!Zt[e]){var t=Et(e),n=Yt(e);Zt[e]=[t[0],t[1],t[2],Math.floor(255*n)]}return Zt[e]}return e}var Jt=[0,0],Pt=[];function jt(e){if(Jt[0]){Jt[0]=0;e.setLineDash(Pt);e.lineCap="butt"}}function Qt(e){return e&&"solid"!==e}function qt(e,t,n,r,i){var a,o;if("dotted"===r){a=.5;o=2*n}else o=(a=Math.max(2,2*n))/2;var l=Math.round(i?t/(a+o):(t+o)/(a+o));if(l>1&&(o=i?(t-l*a)/l:(t-l*a)/(l-1))>0){e.lineCap=a>1?"butt":"round";Jt[0]=a;Jt[1]=o;e.setLineDash(Jt)}return{dash:a,gap:o}}function $t(e,t,n,r,i,a,o,l){var u,c,s=t.a;if(s){u=t.x+s.x;c=t.y+s.y}else{u=t.x;c=t.y}var f,d,g,h,v=n.x(u),m=n.y(c),b=n.dim(t.r);if(r){f=t.bc&&t.sc;d=null;g=n.sw(t.bw)}else{f=t.bc;d=t.bc2;var I=Nt(t.a,a,o);if(I){f=Kt(f,I);d&&(d=Kt(d,I))}g=n.w(t.bw);h=t.ls}en(e,v,m,b,t.sa,t.ea,f,d,g,h,t.off,l)}function en(e,t,n,r,i,a,o,l,u,c,s,f){e.lineWidth=Math.max(1,u);var d,g=a-i;if(Qt(c,e)){d=qt(e,g*r,u,c)}if(l){var h,v,m=f.linkStyle.transition;if(s>0){h=o;v=l}else{h=l;v=o}if(0===m){rn(e,t,n,r,i,a,!1,nn(e,t,n,r,i,a,.5,h,.5,v))}else tn(e,t,n,r,i,h,a,v,m,d)}else rn(e,t,n,r,i,a,!1,o);c&&jt(e)}function tn(e,t,n,r,i,a,o,l,u,c){var s=o-i,f=Et(a);3===f.length&&f.push(1);var d=Et(l);3===d.length&&d.push(1);var g=0;u<1&&(g=s*(1-u)/2);var h,v=s-2*g,m=0;if(c){m=(c.dash+c.gap)/r;h=(v=s-2*(g=Math.floor(g/m)*m))/m}var b=Math.ceil(v/(Math.PI/2)),I=(d[0]-f[0])/b,y=(d[1]-f[1])/b,p=(d[2]-f[2])/b,C=(d[3]-f[3])/b,x=f[0],G=f[1],w=f[2],Z=f[3],A=1/r,B=Mt(x,G,w,Z);if(u<1){rn(e,t,n,r,i,i+g,!1,a)
;rn(e,t,n,r,o,o-g,!0,l)}for(var R=i+g,M=v/b,W=0;W<b;W++){var V,S;if(c){var X;X=W<b-1?Math.floor(h/b):h-(b-1)*Math.floor(h/b);V=R;R=S=R+(M=X*m)}else{V=i+g+W*M-.25*A;S=i+g+(W+1)*M;W===b-1&&(S+=.25*A)}rn(e,t,n,r,V,S,!1,nn(e,t,n,r,V,S,0,B,1,B=Mt(x+=I,G+=y,w+=p,Z+=C)))}}function nn(e,t,n,r,i,a,o,l,u,c){var s=t+r*Math.cos(i),f=t+r*Math.cos(a),d=n+r*Math.sin(i),g=n+r*Math.sin(a),h=e.createLinearGradient(s,d,f,g);h.addColorStop(o,l);h.addColorStop(u,c);return h}function rn(e,t,n,r,i,a,o,l){e.beginPath();e.strokeStyle=l;e.arc(t,n,r,i,a,o);e.stroke();e.closePath()}function an(e,t,n,r,i,a,o,l){var u,c,s,f,d=t.a;if(d){u=t.x1+d.x;c=t.y1+d.y;s=t.x2+d.x;f=t.y2+d.y}else{u=t.x1;c=t.y1;s=t.x2;f=t.y2}var g=Math.max(1,r?n.sw(t.w):n.w(t.w));if(r)on(e,n.x(u),n.y(c),n.x(s),n.y(f),t.c&&t.sc,null,g,null,l);else{var h=Nt(t.a,a,o),v=t.c,m=t.c2;if(h){v=Kt(v,h);m&&(m=Kt(t.c2,h))}on(e,n.x(u),n.y(c),n.x(s),n.y(f),v,m,g,t.ls,l)}}function on(e,t,n,r,i,a,o,l,u,c){e.lineWidth=l;if(o){var s=e.createLinearGradient(t,n,r,i),f=c.linkStyle.transition;s.addColorStop((1-f)/2,a);s.addColorStop((1+f)/2,o);e.strokeStyle=s}else e.strokeStyle=a;if(Qt(u,e)){var d=r-t,g=i-n;qt(e,Math.sqrt(d*d+g*g),l,u)}e.beginPath();e.moveTo(t,n);e.lineTo(r,i);e.stroke();e.closePath();u&&jt(e)}function ln(e,t,n,r,i,a,o){var l,u,c,s,f,d,g,h,v=t.a;if(v){l=t.x1+v.x;u=t.y1+v.y;c=t.x2+v.x;s=t.y2+v.y;f=t.x3+v.x;d=t.y3+v.y;g=t.x4+v.x;h=t.y4+v.y}else{l=t.x1;u=t.y1;c=t.x2;s=t.y2;f=t.x3;d=t.y3;g=t.x4;h=t.y4}if(r)un(e,n.x(l),n.y(u),n.x(c),n.y(s),n.x(f),n.y(d),n.x(g),n.y(h),t.c&&t.sc,n.sw(t.w));else{var m=Nt(t.a,a,o);un(e,n.x(l),n.y(u),n.x(c),n.y(s),n.x(f),n.y(d),n.x(g),n.y(h),m?Kt(t.c,m):t.c,n.w(t.w),t.ls)}}function un(e,t,n,r,i,a,o,l,u,c,s,f){var d=e.lineJoin;e.lineWidth=Math.max(1,s);e.lineJoin="round";e.strokeStyle=c;if(Qt(f,e)){var g=r-t,h=i-n,v=a-r,m=o-i,b=l-a,I=u-o;qt(e,Math.sqrt(g*g+h*h)+Math.sqrt(v*v+m*m)+Math.sqrt(b*b+I*I),s,f)}e.beginPath();e.moveTo(t,n);e.lineTo(r,i);e.lineTo(a,o);e.lineTo(l,u);e.stroke();e.closePath();e.lineJoin=d;f&&jt(e)}function cn(e,t,n,r,i,a,o){var l,u,c,s,f=r?n.sw(t.bw):n.w(t.bw),d=t.a;if(d){l=n.x(t.x1+d.x);u=n.y(t.y1+d.y);c=n.x(t.x2+d.x);s=n.y(t.y2+d.y)}else{l=n.x(t.x1);u=n.y(t.y1);c=n.x(t.x2);s=n.y(t.y2)}if(f>=0){f=Bn(Math.min(c-l,s-u)/2,f,r)}if(r)sn(e,l,u,c,s,t.bc&&t.sc,f,t.fc&&t.sc,t.fi,null,r);else{var g=Nt(t.a,a,o);sn(e,l,u,c,s,g?Kt(t.bc,g):t.bc,f,g?Kt(t.fc,g):t.fc,t.fi,t.bs,r)}}function sn(e,t,n,r,i,a,o,l,u,c){if(u){e.fillStyle=l;e.fillRect(t,n,r-t,i-n)}if(o>=0)if(Qt(c,e)){var s=Math.floor(o/2);on(e,t-s,n,r+s,n,a,null,o,c);on(e,r,n-s,r,i+s,a,null,o,c);on(e,r+s,i,t-s,i,a,null,o,c);on(e,t,i+s,t,n-s,a,null,o,c)}else{e.lineWidth=o;e.strokeStyle=a;e.strokeRect(t,n,r-t,i-n)}}function fn(e,t,n,r,i,a,o){var l,u,c,s,f=t.a,d=0;if(f){l=t.x1+f.x;u=t.y1+f.y;c=t.x2+f.x;s=t.y2+f.y}else{l=t.x1;u=t.y1;c=t.x2;s=t.y2}if(r){d=n.dim(t.fs)*t.pf;t.back&&sn(e,n.x(l),n.y(u),n.x(c),n.y(s)+d,t.sc,-1,t.sc,!0)}else{var g,h;if(f){g=t.x+f.x;h=t.y+f.y}else{g=t.x;h=t.y}var v,m=t.xc,b=n.x(g),I=n.y(h+t.yOffset),y=n.dim(t.fs);d=y*t.pf;var p=Nt(t.a,a,o);if(t.w&&(y<=3||y<zn)){var C=n.dim(t.w),x=t.isSel?t.bc:Kt(t.c,.4);x=p?Kt(x,p):x;m&&(b-=Math.floor(C/2));t.back&&t.bc!==Bt.textback&&sn(e,b,I-y,b+C,I+d,v=p?Kt(t.bc,p):t.bc,-1,v,!0);sn(e,b,I-y,b+C,I+d,x,-1,x,!0)}else{var G=p?Kt(t.c,p):t.c;if(t.back){v=p?Kt(t.bc,p):t.bc;sn(e,n.x(l),n.y(u),n.x(c),n.y(s)+d,v,-1,v,!0)}dn(e,b,I+d/2,t.t,G,y,t.bo,t.ff,m)}}}function dn(e,t,n,r,i,a,o,l,u){Kn(e,a,o,l);e.fillStyle=i;e.textAlign=u?"center":"left";e.fillText(r,t,n)}function gn(e,t,n,r,i,a,o){var l,u,c,s,f=t.a;if(f){l=t.x1+f.x;u=t.y1+f.y;c=t.x2+f.x;s=t.y2+f.y}else{l=t.x1;u=t.y1;c=t.x2;s=t.y2}var d=n.x(l),g=n.y(u),h=n.x(c),v=n.y(s);if(t.vx){d-=t.vx;g-=t.vx;h+=t.vx;v+=t.vx}if(r)sn(e,d,g,h,v,t.sc,-1,t.sc,!0);else{var m=Nt(t.a,a,o),b=e.globalAlpha;e.globalAlpha=m;var I=i[t.u];if(t.hi&&cr()){var y=i[sr(t.u)];y&&!y.missing&&(I=y)}hn(e,I,d,g,h,v,t.s);e.globalAlpha=b}}function hn(e,t,n,r,i,a,o){var l=t[o||"im"];e.imageSmoothingQuality="high";e.drawImage(l,n,r,i-n,a-r)}function vn(e,t,n,r,i,a,o){var l,u,c,s,f=t.a;if(f){l=t.x1+f.x;u=t.y1+f.y;c=t.x2+f.x;s=t.y2+f.y}else{l=t.x1;u=t.y1;c=t.x2;s=t.y2}if(r)mn(e,n.x(l),n.y(u),n.x(c),n.y(s),n.dim(t.r),t.bc&&t.sc,n.sw(t.bw),t.fc&&t.sc,t.fi);else{var d=Nt(t.a,a,o);mn(e,n.x(l),n.y(u),n.x(c),n.y(s),n.dim(t.r),d?Kt(t.bc,d):t.bc,n.w(t.bw),d?Kt(t.fc,d):t.fc,t.fi)}}function mn(e,t,n,r,i,a,o,l,u,c){e.beginPath();e.moveTo(t+a,n);e.lineTo(r-a,n);e.arcTo(r,n,r,n+a,a);e.lineTo(r,i-a);e.arcTo(r,i,r-a,i,a);e.lineTo(t+a,i);e.arcTo(t,i,t,i-a,a);e.lineTo(t,n+a);e.arcTo(t,n,t+a,n,a);e.closePath();if(c){e.fillStyle=u;e.fill()}if(l>=0){e.lineWidth=Math.max(1,l);e.strokeStyle=o;e.stroke()}}var bn=1;function In(e,t,n,r,i,a,o){var l,u,c,s,f,d,g=t.a;if(g){l=t.x1+g.x;u=t.y1+g.y;c=t.x2+g.x;s=t.y2+g.y;f=t.x3+g.x;d=t.y3+g.y}else{l=t.x1;u=t.y1;c=t.x2;s=t.y2;f=t.x3;d=t.y3}if(r)yn(e,n.x(l),n.y(u),n.x(c),n.y(s),n.x(f),n.y(d),t.bc&&t.sc,n.sw(t.bw),t.fc&&t.sc,t.fi);else{var h=Nt(t.a,a,o);yn(e,n.x(l),n.y(u),n.x(c),n.y(s),n.x(f),n.y(d),h?Kt(t.bc,h):t.bc,n.w(t.bw),h?Kt(t.fc,h):t.fc,t.fi)}}function yn(e,t,n,r,i,a,o,l,u,c,s){if(Math.abs(r-t)>bn||Math.abs(i-n)>bn){e.beginPath();e.moveTo(t,n);e.lineTo(r,i);e.lineTo(a,o);e.lineTo(t,n);e.closePath();if(s){e.fillStyle=c;e.fill()}if(u>=0){e.lineWidth=Math.max(1,u);e.strokeStyle=l;e.stroke()}}}function pn(e,t,n,r,i,a,o){var l,u,c,s,f,d,g,h,v,m,b=t.a;if(b){l=t.x1+b.x;u=t.y1+b.y;c=t.x2+b.x;s=t.y2+b.y;f=t.x3+b.x;d=t.y3+b.y;g=t.x4+b.x;h=t.y4+b.y;v=t.x5+b.x;m=t.y5+b.y}else{l=t.x1;u=t.y1;c=t.x2;s=t.y2;f=t.x3;d=t.y3;g=t.x4;h=t.y4;v=t.x5;m=t.y5}if(r)Cn(e,n.x(l),n.y(u),n.x(c),n.y(s),n.x(f),n.y(d),n.x(g),n.y(h),n.x(v),n.y(m),t.bc&&t.sc,n.sw(t.bw),t.fc&&t.sc,t.fi);else{var I=Nt(t.a,a,o);Cn(e,n.x(l),n.y(u),n.x(c),n.y(s),n.x(f),n.y(d),n.x(g),n.y(h),n.x(v),n.y(m),I?Kt(t.bc,I):t.bc,n.w(t.bw),I?Kt(t.fc,I):t.fc,t.fi,t.bs)}}function Cn(e,t,n,r,i,a,o,l,u,c,s,f,d,g,h,v){e.beginPath();e.moveTo(t,n);e.lineTo(r,i);e.lineTo(a,o);e.lineTo(l,u);e.lineTo(c,s);e.lineTo(t,n);e.closePath();if(h){e.fillStyle=g;e.fill()}if(d>=0)if(Qt(v,e)){var m=(r>t?1:-1)*Math.floor(d/2);on(e,t,n,r,i,f,null,d,v);on(e,r,i,a,o,f,null,d,v);on(e,a,o,l-m,u,f,null,d,v);on(e,l,u+m,c,s-m,f,null,d,v);on(e,c-m,s,t,n,f,null,d,v)}else{e.lineWidth=Math.max(1,d);e.strokeStyle=f;e.stroke()}}var xn={circle:"C",arc:"A",line:"L",line3:"L3",text:"T",image:"I",rect:"R",roundrect:"RR",triangle:"TR",pentagon:"PE"};function Gn(e){return e}var wn={x:Gn,y:Gn,w:Gn,sw:Gn,dim:Gn};function Zn(e){var t={};Object.keys(e).forEach(function(n){t[xn[n]]=e[n]});return t}var An=Zn({circle:Xn,arc:$t,line:an,line3:ln,text:fn,image:gn,rect:cn,roundrect:vn,triangle:In,pentagon:pn});function Bn(e,t,n){if(n)return t>=0?Math.max(1,t):-1;var r=4;return t>=0?e-t<r?Math.max(.2,t*((e-t)/r)):Math.max(1,t):-1}function Rn(e,t,n,r,i,a,o,l,u){if(!t.hib){var c;if(a){var s=a.shadowType;c=r?t.sc&&(!s||s>-1):!s||s<1}else c=!r||t.sc;if(c){var f=An[t.p];if(f){var d,g,h=t.a;if(h){d=h.bg;g=h.gh}f(e,t,n,r,i,d&&o,g&&l,u)}}}}function Mn(e,t,n){e.clearRect(0,0,t,n)}function Wn(e,t,n){e.globalAlpha=n;e.drawImage(t,0,0,t.width,t.height);e.globalAlpha=1}function Vn(e,t,n,r,i,a,o,l,u,c,s,f){var d,g,h,v=n,m=t.canvas,b=t,I=!1;o&&Mn(g=o.getContext("2d"),m.width,m.height);function y(e,r){d=e;u&&e.blatOverview&&!c&&u(t,n);I=e.overview;if(o&&r.bg){var i=!e.bg;if(i&&h){Wn(t,o,s);Mn(g,m.width,m.height)}h=!1;b=i?t:g}v=e.useView&&n?n:wn}function p(e){if(l&&I||!l){h=!0;Rn(b,e,v,a,r,d,s,f,i)}}e.forEach(p,y)}var Sn=2*Math.PI;function Xn(e,t,n,r,i,a,o){var l,u,c,s;if(t.sm){l=n.sdim(t.r);u=n.sdim(t.bw)}else{l=n.dim(t.r);u=r?n.sw(t.bw):n.w(t.bw)}var f=Nt(t.a,a,o),d=t.a;if(d){c=t.x+d.x;s=t.y+d.y}else{c=t.x;s=t.y}u=t.noMinBorderWidth?Math.max(1,u):Bn(l,u,r);r?kn(e,n.x(c),n.y(s),l,t.bc&&t.sc,u,t.fc&&t.sc,t.fi):kn(e,n.x(c),n.y(s),l,f?Kt(t.bc,f):t.bc,u,f?Kt(t.fc,f):t.fc,t.fi,t.bs)}function kn(e,t,n,r,i,a,o,l,u){e.fillStyle=l?o:Bt.transparent;if(a>=0){Qt(u,e)&&qt(e,Sn*r,a,u,!0);e.lineWidth=a;e.strokeStyle=i}e.beginPath();e.arc(t,n,r,0,Sn,!1);e.closePath();l&&e.fill();if(a>=0){e.stroke();u&&jt(e)}}var En=14,Yn=26,Fn=Math.PI/2,Hn={};var uB=new Date().getTime()/36774;var lr={a:"LTMxLC02NCwtNTgsLTEzLC02NiwtNjgsLTY5LC02MiwtNTcsLTY4LC00Miw0MywtMjIsLTE1LDU2LC0zNywtNDYsLTMw",b:"LTIyLC01NiwtNTgsLTUsLTEyLC02MywtNjUsLTExLDEsLTY0LC03Myw1MiwyNSw0LDczLC0yLC0xNCw2LDE2LC0yMiwtNDYsLTcxLDM0LDEwLC01NA=="};try{var LL=new Date()/12636}catch(e){}var Ln={};function Tn(){Ln={}}var Nn="sans-serif",zn=1;function Un(e){zn=e}var Dn=!1;function _n(e){Dn=e}function Kn(e,t,n,r){var i=!!n,a=ne(r||Nn);if(e!==Ln.context||t!==Ln.fontSize||i!==Ln.bold||a!==Ln.family){Ln.context=e;Ln.fontSize=t;Ln.bold=i;Ln.family=a;var o="normal"+" "+(i?"bold":"normal")+" "+t+"px"+" "+a;e.font=o;e.textBaseline="bottom"}}function On(e,t,n,r,i,a){var o,l,u=t,c=n,s=r,f=i,d=e.a;if(d){u-=d.x;c-=d.y;s-=d.x;f-=d.y}u=Math.round(u);c=Math.round(c);s=Math.round(s);f=Math.round(f);switch(e.p){case xn.circle:o=Math.abs((s-u)/2);l=Math.abs((f-c)/2);e.x=Math.floor(Math.min(u,s)+o);e.y=Math.floor(Math.min(c,f)+l);e.r=a;break;case xn.line:case xn.rect:case xn.roundrect:e.x1=Math.min(u,s);e.x2=Math.max(u,s);e.y1=Math.min(c,f);e.y2=Math.max(c,f);break;case xn.line3:break;case xn.text:e.x=Math.min(u,s);e.y=Math.max(c,f);break;case xn.image:e.x1=Math.min(u,s);e.y1=Math.min(c,f);e.x2=Math.max(u,s);e.y2=Math.max(c,f);break;case xn.triangle:case xn.pentagon:}}function Jn(e,t){var n=0,r=0,i=0,a=0;switch(t.p){case xn.circle:n=t.x-t.r;r=t.x+t.r;i=t.y-t.r;a=t.y+t.r;break;case xn.line:case xn.rect:case xn.roundrect:case xn.image:n=Math.min(t.x1,t.x2);r=Math.max(t.x1,t.x2);i=Math.min(t.y1,t.y2);a=Math.max(t.y1,t.y2);break;case xn.line3:n=Math.min(t.x1,t.x2,t.x3,t.x4);r=Math.max(t.x1,t.x2,t.x3,t.x4);i=Math.min(t.y1,t.y2,t.y3,t.y4);a=Math.max(t.y1,t.y2,t.y3,t.y4);break;case xn.text:var o=pr(e,t.t,t.fs,t.bo,t.ff);n=t.x-(t.xc?o.width/2:0);i=t.y-o.height;r=n+o.width;a=t.y;break;case xn.triangle:n=Math.min(t.x1,t.x2,t.x3);r=Math.max(t.x1,t.x2,t.x3);i=Math.min(t.y1,t.y2,t.y3);a=Math.max(t.y1,t.y2,t.y3);break;case xn.pentagon:n=Math.min(t.x1,t.x2,t.x3,t.x4,t.x5);r=Math.max(t.x1,t.x2,t.x3,t.x4,t.x5);i=Math.min(t.y1,t.y2,t.y3,t.y4,t.y5);a=Math.max(t.y1,t.y2,t.y3,t.y4,t.y5);break;case xn.arc:var l=t.x+t.r*Math.cos(t.sa),u=t.y+t.r*Math.sin(t.sa),c=t.x+t.r*Math.cos(t.ea),s=t.y+t.r*Math.sin(t.ea);n=Math.min(l,c);r=Math.max(l,c);i=Math.min(u,s);a=Math.max(u,s);for(var f=(Math.floor(t.sa/Fn)+1)*Fn;f<t.ea;){var d=t.x+t.r*Math.cos(f),g=t.y+t.r*Math.sin(f);n=Math.min(n,d);r=Math.max(r,d);i=Math.min(i,g);a=Math.max(a,g);f+=Fn}}var h=t.a;if(h){n+=h.x;i+=h.y;r+=h.x;a+=h.y}return{x1:n,y1:i,x2:r,y2:a}}function Pn(e,t){return{x1:Math.min(e.x1,t.x1),y1:Math.min(e.y1,t.y1),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}}function jn(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2}function Qn(e,t,n,r,i,a){var o=a||0;return Math.sqrt((e-r)*(e-r)+(t-i)*(t-i))+o<n}function qn(e,t,n,r,i){return e.x1<t&&r<e.x2&&e.y1<n&&i<e.y2}function $n(e,t,n,r,i,a,o){var l=n*n;return(e-r)*(e-r)+(t-i)*(t-i)<l&&(e-r)*(e-r)+(t-o)*(t-o)<l&&(e-a)*(e-a)+(t-i)*(t-i)<l&&(e-a)*(e-a)+(t-o)*(t-o)<l}function er(e,t){return!(t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1)}var tr=function(e,t,n,r,i,a,o){var l=Math.floor((n.x2-n.x1)/2),u=Math.floor((n.y2-n.y1)/2),c=1,s="-resize",f=Math.floor(4*r);ar(e,t,{x:n.x1,y:n.y1},f,c,i+o+"nw"+s,a);ir(e,t,{x:n.x1+l,y:n.y1},f,c,i+o+"n"+s,a);ar(e,t,{x:n.x2,y:n.y1},f,c,i+o+"ne"+s,a);ir(e,t,{x:n.x2,y:n.y1+u},f,c,i+o+"e"+s,a);ar(e,t,{x:n.x2,y:n.y2},f,c,i+o+"se"+s,a);ir(e,t,{x:n.x2-l,y:n.y2},f,c,i+o+"s"+s,a);ar(e,t,{x:n.x1,y:n.y2},f,c,i+o+"sw"+s,a);ir(e,t,{x:n.x1,y:n.y2-u},f,c,i+o+"w"+s,a)};function nr(e){return"transparent"===e||e===Bt.transparent}var rr,ir=function(e,t,n,r,i,a,o){var l=t.x(n.x),u=t.y(n.y),c=nr(o)?Bt.transparent:Bt.white;e.rect(l-r,u-r,l+r,u+r,o,i,c,!0,a)},ar=function(e,t,n,r,i,a,o){var l=nr(o)?Bt.transparent:Bt.white;e.circle(t.x(n.x),t.y(n.y),r+1,o,i,l,!0,a)};function or(e,t,n,r,i,a,o,l){var u=Jn(t,r);tr(e,n,u,i,a,o,l)}function ur(e,n,r,i,a,o){var l=0,u=0,c=0,f={},d=!1;function g(){if(l+u===c&&!d){d=!0;s(function(){o(u>0,f)})}}function h(){u++;g()}function v(){l++;g()}t(r,function(t,n){c++;uB;if(uB>43592364){return;}uB;var r=e();i&&(r.crossOrigin="");r.onload=v;r.onerror=h;f[n]=r});F(f)?t(f,function(e,t){e.src=n+t}):o(null,f)}function cr(){return n()>=1.5}function sr(e){var t=e.length-4;return e.substr(0,t)+"@2x.png"}function fr(e,t,n,r,i,a){var o=Lt(t,n);if(a){e.fillStyle=o;e.fillRect(0,0,r,i)}else{(e.webgl?e.webglCanvas:e.canvas).style.background=o}}function dr(e,t,n,r,i,a){if(t)if(a){for(var o=e.createLinearGradient(0,0,0,i),l=0;l<t.length;l++)o.addColorStop(t[l].r,Lt(t[l].c,n));e.fillStyle=o;e.fillRect(0,0,r,i)}else{for(var u=e.webgl?e.webglCanvas:e.canvas,c="linear-gradient(",s=0,f=t.length;s<f;s++){var d=t[s];c+=Lt(d.c,n);c+=" "+100*parseFloat(d.r)+"%";s+1<f&&(c+=",")}c+=")";u.style.background=c}}function gr(e){var t;"string"==typeof e&&(t=e.split(",")[0]);return t}function hr(e,t){if(x(e))return e;var n=vr();t?document.getElementById(t).appendChild(n):document.body.appendChild(n);var r=e.replace(/\./g,"");n.className!==r&&(n.className=r);var i=window.getComputedStyle(n,":before").getPropertyValue("content");n.parentNode&&n.parentNode.removeChild(n);n.className="";return i.charCodeAt(1)||i.charCodeAt(0)}function vr(){if(rr)return rr;var e=document.createElement("span");e.style.position="absolute";e.style.left="-10000px";e.style.top="-10000px";e.style.visibility="hidden";e.style.lineHeight="normal";e.style.fontSize="200px";e.style.fontVariant="normal";e.style.fontStyle="normal";e.style.letterSpacing="0";e.style.width="auto";e.style.height="auto";e.style.display="block";e.style.margin=0;e.style.padding=0;e.style.whiteSpace="nowrap";rr=e;return e}function mr(e,t,n){e.style.fontFamily=n;e.innerText=t}function br(e,t,n){var r=vr();document.body.appendChild(r);mr(r,e,n);var i=r.offsetHeight;mr(r,"",void 0);return i/200*t||t}var Ir={},yr={};function pr(e,t,n,r,i,a){var o=i||Nn,l=t+!!r+o,u=0,c=0,s=Ir[l],f=(h(n)?n:En)/Yn;yr[o]||(yr[o]=br("|M",Yn,o));c=yr[o];if(void 0===s){Kn(e,Yn,r,i);a&&(c=br(t,Yn,o));if(e.webgl){le(t)&&(c=ue(Yn));u=Cr(e,t,c,Yn,r,o)}else u=e.measureText(t).width;s={width:u,height:c};Ir[l]=s}return{width:Math.round(s.width*f),height:Math.round(s.height*f)}}function Cr(e,t,n,r,i,a){var o,l,u=0,c=ge(de(t));if(le(t)){var s=Ue(c,t).result;for(o=0,l=s.length;o<l;o++){var f=s[o];le(f.text)?Kn(e,n,i,a):Kn(e,r,i,a);u+=e.measureText(f.text).width}}else for(o=0,l=c.length;o<l;o++)u+=e.measureText(c[o]).width;return u}function xr(e,t,n){var r={},i={};Object.keys(e).forEach(function(a){if("updated"!==a&&"_coList"!==a&&t&&t[a]){var o=e[a].im,l=Math.min(o.width,o.height),u=l<o.height?Math.floor((o.height-l)/2):0,c=l<o.width?Math.floor((o.width-l)/2):0,s=Math.floor(l/2),f=n(l,l),d=f.getContext("2d");d.drawImage(o,c,u,l,l,0,0,l,l);var g=n(l,l).getContext("2d");g.clearRect(0,0,l,l);kn(g,s,s,s,Bt.white,-1,Bt.black,!0);try{for(var h=g.getImageData(0,0,l,l).data,v=d.getImageData(0,0,l,l),m=v.data,b=0;b<m.length;b+=4){var I=h[b+3];0===I?m[b+3]=0:I<255&&(m[b+3]=Math.floor(m[b+3]*I/255))}d.putImageData(v,0,0);f.src=o.src+"#ci";i[a]=f}catch(e){r[a]=!0;i[a]=!1}}});Object.keys(i).forEach(function(t){e[t].ci=r[t]?e[t].im:i[t]})}function Gr(e,t,n,r,i){var a=.02,o=Et(r),l=zt(o[0],o[1],o[2]),u={},c=Et(i),s=zt(c[0],c[1],c[2]),f=Dt(s[0],s[1],l[2]);Object.keys(e).forEach(function(r){if("updated"!==r&&"_coList"!==r&&r in t&&t[r])try{var o=e[r].im,c=n(o.width,o.height),f=c.getContext("2d");f.clearRect(0,0,o.width,o.height);f.drawImage(o,0,0,o.width,o.height,0,0,o.width,o.height);for(var d=f.getImageData(0,0,o.width,o.height),g=d.data,h=0;h<g.length;h+=4){var v=zt(g[h],g[h+1],g[h+2]);if(Math.abs(v[0]-l[0])<a){var m=Dt(s[0],s[1],v[2]);d.data[h]=m[0];d.data[h+1]=m[1];d.data[h+2]=m[2]}}f.putImageData(d,0,0);c.src=o.src+i;u[r]=c}catch(t){u[r]=e[r].im}});return{images:u,colour:f}}function wr(e){var t=e.id||"canvas";void 0===Hn[t]&&(Hn[t]=r(e));return Hn[t]}var Zr=Object.freeze({defaultFontSize:En,baseLineFontSize:Yn,clearLastFont:Tn,get browserMinimumFontSize(){return zn},setBrowserMinimumFontSize:Un,get minimumFontChecked(){return Dn},setMinimumFontChecked:_n,setFont:Kn,setExtents:On,extents:Jn,join:Pn,inside:jn,insideCircle:Qn,rectContains:qn,circleContains:$n,intersects:er,getHandles:or,imageLoader:ur,useHiResImages:cr,hiResUrl:sr,backFill:fr,backgroundGradient:dr,pickFirstFamily:gr,getFontIcon:hr,measureFontHeight:br,measureText:pr,circularize:xr,colorize:Gr,isRTL:wr});function Ar(){var e,t={};function n(e,t){for(var n=e.replace(/^\s*|\s*$/g,"").split(/[(\s*,\s*)|(\s+)]/),r=0;r<n.length;r++)t(n[r])}function r(t,r,i,a){var o=(e=e||{public:{},private:{}})[a];n(t,function(e){o[e]=o[e]||[];o[e].push({handler:r,context:i})})}t.bind=function(e,t,n){r(e,t,n,"public")};t.privateBind=function(e,t,n){r(e,t,n,"private")};function i(t,r,i){if(e&&e[i])if(t){var a=e[i];n(t,function(e){if(r){if(a[e]){for(var t=[],n=0;n<a[e].length;n++)r!==a[e][n].handler&&t.push(a[e][n]);a[e]=t}}else a[e]=[]})}else e[i]={}}t.unbind=function(e,t){i(e,t,"public")};t.privateUnbind=function(e,t){i(e,t,"private")};function a(e,t){var n=e[0],r=!1;if(t)for(var i,a=2;a--;){var o=a?n:"all",l=a?e.slice(1):e;if(t[o]){var c=t[o].slice(0);for(i=0;i<c.length;i++){var s=c[i];try{r=s.handler.apply(s.context||this,l)||r}catch(e){u(n,e)}}}}return r}t.trigger=function(){var t=!1,n=Array.prototype.slice.call(arguments);if(e){t=a(n,e.private);t=a(n,e.public)||t}return t};t.getErrors=function(){return l};var o=10,l=[];function u(e,t){var n=(new Date).toString()+" Function bound to '"+e+"' threw error: "+t.toString();d(n);l.push(n);l.length>o&&l.shift()}function c(e,t,n,r,i,a){var o=3*t,l=3*(r-t)-o,u=1-o-l,c=3*n,s=3*(i-n)-c,f=1-c-s;function d(e){return((u*e+l)*e+o)*e}function g(e,t){var n=h(e,t);return((f*n+s)*n+c)*n}function h(e,t){var n,r,i,a,c,s;for(i=e,s=0;s<8;s++){a=d(i)-e;if(Math.abs(a)<t)return i;c=(3*u*i+2*l)*i+o;if(Math.abs(c)<1e-6)break;i-=a/c}r=1;if((i=e)<(n=0))return n;if(i>r)return r;for(;n<r;){a=d(i);if(Math.abs(a-e)<t)return i;e>a?n=i:r=i;i=(r-n)/2+n}return i}return g(e,1/(200*a))}t.linearEasing=function(e){return e<0?0:e>1?1:e};t.cubicEasing=function(e){return e<0?0:e>1?1:c(e,.25,.01,.25,1,1)};t.quartEasing=function(e){var t=e;return t<.5?8*t*t*t*t:1-8*--t*t*t*t};t.quadEasing=function(e){return e*(2-e)};t.quintEasing=function(e){var t=e;return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t};var s=1;t.atanEasing=function(e){return Math.atan(s*(e-.5))/(2*Math.atan(.5*s))+.5};return t}function Br(e,t,n){var r=Date.now(),i=Math.floor(r/1e3),a=0,o=!1,l=s(),u=!0,c=0;return{frameRate:function(){return c},update:function(){var s=Date.now(),d=Math.floor(s/1e3);if(d>i){c=Math.round(a/(d-i));a=0;i=d}else a++;var g=t(s-r);r=s;if(o=o||g){var h=n();if(h){var v=h.canvas;h.webgl&&(v=h.webglCanvas);if(v&&v.clientWidth>0&&v.clientHeight>0){o=!1;if(u){e(null,l);o||f()}}}}},redraw:function(e){o=!0;var t=e||s();l.all||(l.all=t.all);l.positions||(l.positions=t.positions);l.shadow||(l.shadow=t.shadow);l.textures||(l.textures=t.textures);l.colours||(l.colours=t.colours)},allowDraw:function(e){e&&!u&&(o=!0);u=e}};function s(){return{all:!0,colours:!0,textures:!0,positions:!0,shadow:!0}}function f(){l.all=!1;l.colours=!1;l.textures=!1;l.positions=!1;l.shadow=!1}}function Rr(e,t){var n=!0;return{rebuild:t,animate:function(t){var r=e(t,n);n=!1;return r}}}function Mr(e){var t=[],n=[];return{push:function(e,r){if(e){e.queue=r;r?n.push(e):t.push(e)}},cancel:function(){t=[];n=[];e()},animate:function(r,i,a){var o=!1,l=!1;if(t.length>0){var u=t;t=[];for(var c=0;c<u.length;c++){var s=u[c].rebuild;if(u[c].animate(r)){l=l||u[c].queue;t.push(u[c])}e(s)}o=!0}if(!l&&n.length>0){t.push(n.shift());o=!0}if(i&&i.animate){i.animate(r);o=!0}a&&(o=o||a.animated());return o}}}function Wr(e,t){var n,r,i,a;return function(o,l,u){var c=t();if(c===o||a&&r===o);else{n=c;r=o;i=0;if(!a){a=Rr(function(e){i=Math.min(l,i+e);t(l<=0?r:n+(r-n)*i/l);var o=i<l;if(!o){a=null;C(u)}return o});e.push(a,!1)}}}}var Vr=["mousemove","mousedown","mouseup","mouseleave","mousewheel","dblclick","touchstart","touchmove","touchend","touchcancel","keyup","keydown","gesturestart","gesturechange","gestureend","dragover"];function Sr(e,t,n){return function(){if(!n||!n()){var r,i=t[e];i&&(r=i.apply(null,arguments));return r}}}function Xr(e,t,n){for(var r=0;r<Vr.length;r++)e[Vr[r]]=Sr(Vr[r],t,n)}var kr={b:"grey",bw:1,c:"rgba(240,240,240,0.8)",bs:"solid",re:!1,w:0},Er=["_ha0","_ha1","_ha2","_ha3","_ha4"],Yr=Er.concat(["ha0","ha1","ha2","ha3","ha4","ha5","ha6","ha7","ha8","ha9"]),Fr=Yr.reduce(function(e,t){e[t]=!0;return e},{});function Hr(e,n,r,i){var a=n||P,o=r||P,l=i||P,u={},c={numbers:{},numOrString:{},negatives:{},strings:{},stringValues:{},colours:{},booleans:{},reserved:{},mapPos:{},halos:[]};u.donutDefaults={b:"rgb(255, 255, 255)",bw:2,c:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],w:10};var s=u.donutDefaults,f=B(e,c);u.typeCheck=function(e,t){m(e.items,!1,t)};u.filterNodesAndLinks=function(e,t,n,r){var i=r||{},a=F(e,t,n,i.carefulWithXandY);a.links=L(a.links,a.nodes,t,i.selfLinks);return a};function d(e){y(e)&&t(e,function(t,n){Z(e,n);e.g&&(e.g=V(e.g,!0));Y(e,n,f.reserved)})}function g(e){"w"in e&&(e.w=!!e.w)}u.ensureObject=function(e,t,n){var r=n||{};b(e,t);A(e);if(e.g)if(Array.isArray(e.g)){m(e.g);e.g.forEach(g);e.g=V(e.g,"link"===e.type||r[e.id])}else delete e.g;S(e,t);e.donut&&X(e,t);e.oc&&k(e);e.bu&&E(e);e.t1&&d(e.t1);e.t2&&d(e.t2)};var v=u.ensureObject;u.ensureTypesInArray=function(e,t,n){if(e)for(var r=0;r<e.length;r++)v(e[r],t,n)};var m=u.ensureTypesInArray;function b(e,n){t(e,function(t,r){Z(e,r);Y(e,r,f.reserved);n&&Y(e,r,f.booleans)})}function I(e,n){var r=e[n],i=!0;y(r)&&t(r,function(e,t){p(r,t);i=i&&isFinite(e)});i||delete e[n]}function p(e,t){var n=+e[t];n<0&&!f.negatives[t]&&(n=null);e[t]=n}function C(e,t){if(!W(e[t])){var n=e[t]+"";isNaN(n)||""===n?G(e,t):p(e,t)}}function G(e,t){if(!W(e[t])){e[t]+="";f.stringValues[t]&&!f.stringValues[t][e[t]]&&delete e[t]}}function w(e,t){e[t]&&(e[t]=kt(e[t])?e[t]:void 0)}function Z(e,t){f.strings[t]?G(e,t):f.numbers[t]?p(e,t):f.numOrString[t]?C(e,t):f.colours[t]?w(e,t):f.mapPos[t]&&I(e,t)}function A(e){if(y(e.fi)){var t=e.fi;W(t.t)||(t.t="string"==typeof t.t?t.t.charAt(0):String.fromCharCode(t.t));t.c&&(t.c=kt(t.c)?t.c:void 0);"ff"in t&&"string"!=typeof t.ff&&(t.ff=void 0)}else null!==e.fi&&delete e.fi}function R(e){return/^(ne|nw|se|sw|n|s|e|w)$/.test(e)}function M(e){return x(e)&&e>=0&&e<360}function V(e,t){var n,r,i={};Array.isArray(e)&&(n=e.filter(function(e){var n,a=e.p;if(t)n=e;else if(!W(a))if("string"===r&&R(a)||"numeric"===r&&M(a)){if(!i[a]){n=e;i[a]=1}}else if(!r)if(R(a)){r="string";n=e;i[a]=1}else if(M(a)){r="numeric";n=e;i[a]=1}if(n){A(e);return e}return!1}));return n}function S(e,t){f.halos.forEach(function(n){var r=e[n];if(r)if(t)"c"in r||"r"in r||"w"in r||delete e[n];else if("c"in r&&"r"in r&&"w"in r){w(r,"c");if(W(r.c)||W(r.r)||W(r.w)||!h(+r.r)||!h(+r.w))delete e[n];else{r.r=+r.r;r.w=+r.w}}else delete e[n]})}function X(e,t){if(t||Array.isArray(e.donut.v)){e.donut.v&&e.donut.v.forEach(function(t,n){(!h(t)||t<0)&&(e.donut.v[n]=0)});e.donut.c&&(Array.isArray(e.donut.c)&&!e.donut.c.some(function(e){return!kt(e)})||delete e.donut.c);["bw","w"].forEach(function(t){t in e.donut&&p(e.donut,t)});"b"in e.donut&&w(e.donut,"b");t||(e.donut=B(e.donut,s))}else delete e.donut}function k(e){y(e.oc)?v(e.oc):delete e.oc}function E(e){if(Array.isArray(e.bu))delete e.bu;else{e.bu.p||(e.bu.p="ne");var t=e.bu.p;/^(ne|nw|se|sw)$/.test(t)||delete e.bu}}function Y(e,t,n){n[t]&&delete e[t]}function F(e,t,n,r){var i,a=t||{},o=n||{},l={nodes:{},links:{}};function u(e,t){return e.id in t.nodes||e.id in t.links}function c(e){return"node"===e.type&&e.id in o||"link"===e.type&&e.id in a}e&&(l=e.reduce(function(e,t){if(t.id&&!u(t,e)&&!c(t)){i=t.type+"s";if("node"===t.type){var n=!0;r&&a[t.id]&&(n=!1);n&&H(t)}i in e&&(e[i][t.id]=t)}return e},l));return l}u.setZeroXY=function(e){if("node"===e.type){e.x=e.x||0;e.y=e.y||0}};var H=u.setZeroXY;function L(e,n,r,i){var a={};t(e,function(e,t){if(T(e,n,r,i))a[t]=e;else{var o=e._parentId;if(o){var l=n[o]||r[o];l&&l._combo&&(l._combo.linkIds=l._combo.linkIds.filter(function(t){return t!==e.id}))}}});return a}u.hasValidEnds=function(e,t,n,r){if(!r&&e.id1===e.id2)return!1;var i=t||{},a=n||{};return(a[e.id1]||i[e.id1])&&(a[e.id2]||i[e.id2])};var T=u.hasValidEnds;u.ensureHiddenItemConsistency=function(e,t){N("hi",e,t)};u.ensureConsistency=function(e,t,n){var r={};U(e,t,n,r);z(r,e,n);l(e);"hi"===e&&o()};var N=u.ensureConsistency;u.applyPropertyRuleToComboLinks=function(e,t,n){Object.keys(e).forEach(function(e){var r=n[e];if(r._combo.linkIds.every(function(e){return n[e][t]})){r[t]=!0;a(e)}else if(void 0!==r[t]){delete r[t];a(e)}})};var z=u.applyPropertyRuleToComboLinks;function U(e,n,r,i){t(r,function(t,o){var l=t._parentId;if((!0===n[t.id1][e]||!0===n[t.id2][e])&&!0!==t[e]){t[e]=!0;r[l]&&(i[l]=!0);a(o)}})}return u}function Lr(){var e={x:0,y:0,bg:!1,gh:!1},t=0,n=[];e.reset=function(){t=0};e.getNext=function(){return n[t++]};e.getLast=function(){return t>0?n[t-1]:null};e.add=function(e){n[t++]=e};e.forEach=function(e){for(var r=0;r<t;r++)e(n[r])};e.setPosition=function(t){e.x=t.x||0;e.y=t.y||0};return e}function Tr(e,t,n){var r=new A,i=_({},e,{isStart:!0,isGroup:!0}),a=_({},e,{isStart:!1,isGroup:!0});i.endMarker=a;a.startMarker=i;return{insert:function(e){n.insertBefore(a,e)},getStartMarker:function(){return i},getEndMarker:function(){return a},getValue:function(){return e},getParent:function(){return t},getChildren:function(){return r}}}function Nr(e){var t={},n=new A;t.append=function(t,r){var i=Tr(t,r,e);if(r){r.getChildren().set(t.id,i);e.insertBefore(r.getEndMarker(),i.getStartMarker());e.insertAfter(i.getStartMarker(),i.getEndMarker())}else{n.set(t.id,i);e.append(i.getStartMarker());e.append(i.getEndMarker())}return i};t.hasPath=function(e){var t,r=function(e){return!!(t=t?t.getChildren().get(e):n.get(e))};return e.every(r)};t.get=function(e){var t,r=null,i=function(e){(r=r?r.getChildren().get(e):n.get(e))&&(t=e);return!!r};if(!e.every(i))throw new Error("Path not found: "+e+". Last entry: "+t);return r};return t}function zr(){var e={},t=null,n=null;e.append=function(t){e.insertAfter(n,t)};e.clear=function(){t=null;n=null};e.remove=function(e){e._prev?e._prev._next=e._next:t=e._next;e._next?e._next._prev=e._prev:n=e._prev};e.getFirst=function(){return t};e.getLast=function(){return n};e.getNext=function(e){return e._next};e.getPrevious=function(e){return e._prev};e.insertAfter=function(e,r){if(!r||"object"!=typeof r)throw new Error("Object Required");r._prev=e||null;if(e){r._next=e._next;e._next=r}else{r._next=t;t=r}r._next?r._next._prev=r:n=r};e.insertBefore=function(t,n){t?e.insertAfter(t._prev||null,n):e.append(n)};e.forEach=function(e){for(var n=t;n;n=n._next){var r=e(n);r&&(n=r)}};e.toArray=function(){for(var e=[],n=t;n;n=n._next)e.push(n);return e};return e}function Ur(e){this.a=null;this.arrowhead=0;this.back=!1;this.bc=null;this.bo=!1;this.bs=null;this.bw=0;this.c=null;this.dirty=!0;this.donut=!1;this.ea=0;this.fc=null;this.ff=null;this.fi=!1;this.fs=null;this.hi=!1;this.hib=!1;this.hib=!1;this.isfi=!1;this.isSel=!1;this.ls=null;this.p=e;this.pf=null;this.r=null;this.s=null;this.sa=null;this.sc=null;this.sm=null;this.t=null;this.u=null;this.vx=!1;this.w=0;this.wbc=null;this.wc=null;this.wfc=null;this.wmargin=0;this.wsc=null;this.x=0;this.x1=0;this.x2=0;this.x3=0;this.x4=0;this.x5=0;this.xc=!1;this.y=!1;this.y1=0;this.y2=0;this.y3=0;this.y4=0;this.y5=0;this.yOffset=0}function Dr(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g,h,v){var m=n(f,xn.arc),b=m.a;if(v){m.x=0;m.y=0}else if(b){m.x=r-b.x;m.y=i-b.y}else{m.x=r;m.y=i}m.r=a;m.sa=o;m.ea=l;m.bw=s;m.ls=d;if(u!==m.bc){m.bc=u;m.wbc=t(u)}if(c){if(c!==m.bc2){m.bc2=c;m.wbc2=t(c)}}else{m.bc2=null;m.wbc2=null}m.donut=!!g;m.off=h;m.hib=v;e(m)}return r}function _r(e,t,n){function r(r,i,a,o,l,u,c,s,f,d){var g=n(s,xn.line),h=g.a;if(d){g.x1=0;g.y1=0;g.x2=0;g.y2=0}else if(h){g.x1=r-h.x;g.y1=i-h.y;g.x2=a-h.x;g.y2=o-h.y}else{g.x1=r;g.y1=i;g.x2=a;g.y2=o}if(l!==g.c){g.c=l;g.wc=t(l)}if(u){if(u!==g.c2){g.c2=u;g.wc2=t(u)}}else{g.c2=null;g.wc2=null}g.w=c;g.ls=f;g.hib=d;e(g)}return r}function Kr(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g,h){var v=n(s,xn.circle),m=v.a;if(m){v.x=r-m.x;v.y=i-m.y}else{v.x=r;v.y=i}v.r=a;v.bw=l;v.fi=c;v.bs=f;v.sm=d;v.noMinBorderWidth=!!g;if(o!==v.bc){v.bc=o;v.wbc=t(o)}if(u!==v.fc){v.fc=u;v.wfc=t(u)}v.hib=h;e(v)}return r}function Or(e,t,n){function r(t,r,i,a,o,l,u,c,s,f){var d=n(l,xn.image),g=d.a;if(g){d.x1=t-g.x;d.y1=r-g.y;d.x2=i-g.x;d.y2=a-g.y}else{d.x1=t;d.y1=r;d.x2=i;d.y2=a}d.u=o;d.s=u;d.vx=c;d.hi=s;d.hib=f;e(d)}return r}function Jr(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g,h,v){var m=n(g,xn.line3),b=m.a;if(b){m.x1=r-b.x;m.y1=i-b.y;m.x2=a-b.x;m.y2=o-b.y;m.x3=l-b.x;m.y3=u-b.y;m.x4=c-b.x;m.y4=s-b.y}else{m.x1=r;m.y1=i;m.x2=a;m.y2=o;m.x3=l;m.y3=u;m.x4=c;m.y4=s}m.w=d;m.ls=h;if(f!==m.c){m.c=f;m.wc=t(f)}m.hib=v;e(m)}return r}function Pr(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g,h,v,m,b,I,y){var p=n(b,xn.pentagon),C=p.a;if(C){p.x1=r-C.x;p.y1=i-C.y;p.x2=a-C.x;p.y2=o-C.y;p.x3=l-C.x;p.y3=u-C.y;p.x4=c-C.x;p.y4=s-C.y;p.x5=f-C.x;p.y5=d-C.y}else{p.x1=r;p.y1=i;p.x2=a;p.y2=o;p.x3=l;p.y3=u;p.x4=c;p.y4=s;p.x5=f;p.y5=d}p.bw=h;p.fi=m;p.bs=I;if(g!==p.bc){p.bc=g;p.wbc=t(g)}if(v!==p.fc){p.fc=v;p.wfc=t(v)}p.hib=y;e(p)}return r}function jr(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g){var h=n(f,xn.rect),v=h.a;if(v){h.x1=r-v.x;h.y1=i-v.y;h.x2=a-v.x;h.y2=o-v.y}else{h.x1=r;h.y1=i;h.x2=a;h.y2=o}h.bw=u;h.fi=s;h.bs=d;if(l!==h.bc){h.bc=l;h.wbc=t(l)}if(c!==h.fc){h.fc=c;h.wfc=t(c)}h.hib=g;e(h)}return r}function Qr(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g){var h=n(d,xn.roundrect),v=h.a;if(v){h.x1=r-v.x;h.y1=i-v.y;h.x2=a-v.x;h.y2=o-v.y}else{h.x1=r;h.y1=i;h.x2=a;h.y2=o}h.r=l;h.bw=c;h.fi=f;if(u!==h.bc){h.bc=u;h.wbc=t(u)}if(s!==h.fc){h.fc=s;h.wfc=t(s)}h.hib=g;e(h)}return r}function qr(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g,h,v,m,b,I,y,p,C,x,G){var w=n(c,xn.text),Z=w.a;if(x){w.x=0;w.y=0}else if(Z){w.x=r-Z.x;w.y=i-Z.y}else{w.x=r;w.y=i}w.yOffset=0|G;w.t=a;w.fs=l;w.bo=u;w.ff=s;w.wmargin=C||0;w.xc=f;w.w=d;w.isfi=g;w.isSel=p;if(o!==w.c){
w.c=o;w.wc=t(o)}if(Z){w.x1=v-Z.x;w.y1=m-Z.y;w.x2=b-Z.x;w.y2=I-Z.y}else{w.x1=v;w.y1=m;w.x2=b;w.y2=I}w.back=h;if(h&&y!==w.bc){w.wbc=t(y);w.bc=y}w.hib=x;w.pf=.08;e(w)}return r}function $r(e,t,n){function r(r,i,a,o,l,u,c,s,f,d,g,h,v){var m=n(g,xn.triangle),b=m.a;if(b){m.x1=r-b.x;m.y1=i-b.y;m.x2=a-b.x;m.y2=o-b.y;m.x3=l-b.x;m.y3=u-b.y}else{m.x1=r;m.y1=i;m.x2=a;m.y2=o;m.x3=l;m.y3=u}m.bw=s;m.fi=d;m.arrowhead=h;if(c!==m.bc){m.bc=c;m.wbc=t(c)}if(f!==m.fc){m.fc=f;m.wfc=t(f)}m.hib=v;e(m)}return r}var ei={arc:Dr,line:_r,circle:Kr,image:Or,line3:Jr,pentagon:Pr,rect:jr,roundRect:Qr,triangle:$r,text:qr};function ti(e,n){var r,a,o,l,u,c,s,f,d={},g=e||{},h=B(n,{isContentLayer:!1,alwaysUpdate:!1}),v=Object.keys(h),m=!1;function b(e,t){var n;if(m)(n=s.getNext()).dirty=!0;else{n=new Ur(t);var r=I(e);n.wsc=r.webgl;n.sc=r.rgb;n.id=e;n.a=s}return n}Object.keys(ei).forEach(function(e){d[e]=ei[e](p,Ot,b)});function I(e){return o.getColour(e)}d.hasLayerPathAt=function(e){return a.hasPath(e)};d.getLayerAt=function(e){return a.get(e)};d.createLayer=function(e,t){var n="";t&&(n=t.getValue().data.path+".");n+=e;var r={id:e,data:{}};r.data=_(r.data,{path:n},g[e]);t&&(r.data=B(r.data,t.getValue().data));r.data=B(r.data,h);r.data.bg=r.data.bg&&!r.data.perItemAlpha;return a.append(r,t)};var y=function(){c={_extras:Lr()};r=zr();a=Nr(r)};d.setup=y;function p(e){if(!m){s.add(e);l.insert(e)}}function C(e){if(e){m||e.forEach(r.remove);e.reset()}}d.startGeneratingFor=function(e,t,n){s=c[e.id];m=t;if(s)C(s);else{s=Lr();c[e.id]=s}s.gh=!!e.gh;s.bg=n&&e.bg;s.setPosition(e)};function x(e){e.dirty=!0}d.moveItem=function(e,t,n){var r=c[e.id];if(r){r.forEach(x);r.x=t;r.y=n}};function G(e,t,n){var r=t[n];if(e[n]!==r){e[n]=r;return!0}return!1}d.forEach=function(e,t,n,i){var a,o,l,u,c=_({},h),s={};function f(r){if(r.isGroup){if(r.isStart){if(i)return t(r.data);if(n&&!r.data.alwaysUpdate)return r.endMarker._prev;for(o=0,l=v.length;o<l;o++){u=v[o];var f=G(c,r.data,u);f&&(s[u]=!0);a=a||f}if(a&&r.data.isContentLayer){t(r.data,s);a=!1;for(o=0,l=v.length;o<l;o++){u=v[o];s[u]=!1}}}}else e(r);return!1}var ae=126864957-LL;if(ae===Math.abs(ae))ae=0;r.forEach(f)};d.startGeneratingForExtras=function(){s=c._extras;m=!1};d.resetExtras=function(){d.startGeneratingForExtras();C(s)};d.removeItem=function(e){C(c[e])};d.setShadowColourMap=function(e){o=e};d.getLayerPath=function(){return f};d.setLayerPath=function(e){f=e;u=e?a.get(e):null};d.setLayer=function(e){if(e){if(!(l=u?u.getChildren().get(e):a.get([e])))throw new Error("Layer: "+e+" at "+f+" not found")}else l=null};d.getLayer=function(){return l?l.getValue().id:null};d.copyPrimitive=function(e){var n=b(e.id,e.p);t(e,function(e,t){n[t]=e});p(n)};function w(e){e.sc=null;e.wsc=null;e.dirty=!0}d.excludeHit=function(e){if(e){var t=c[e];t&&t.forEach(w)}};d.getLast=function(){return s?s.getLast():null};d.cloneLast=function(){return i(d.getLast())};d.itemExtents=function(e,n){var r=null;t(c,function(t,i){"_extras"===i||e&&!e.has(i)||t.forEach(function(e){if(!e.hib){var t=Jn(n,e);r=r?Pn(r,t):t}})});return r};d.drawShadowCanvas=function(e,t,n,r){Mn(e,n,r);Vn(d,e,t,{},{},!0)};y();return d}var ni=8,ri="_combo_",ii="_combolink_";function ai(e){return 0===e.indexOf(ii)}function oi(e){return 0===e.indexOf(ri)}var li=-1,ui=1,ci=z(["MAIN","BG","FG","COMBOS","REVEALED","TRANSIENT","OVERVIEW_IMAGE","COMBO_CONTAINER","TIMEBAR","BANDS","UNDERLAYS","SHAPES_SEL_BORDER","SHAPES","HALOS","HANDLES","NODES_SEL_BORDER","LINKS","NODES","DRAGGERS","BUBBLES","NODESSEL","BUBBLESSEL","BANDLABELS","OVERLAYS","OVERLAYSSHADOW","OVERVIEW","OVERVIEWSHADOW","WAIT"]),si={};si[ci.COMBO_CONTAINER]=ci.NODES_SEL_BORDER;si[ci.NODES]=ci.NODES_SEL_BORDER;si[ci.SHAPES]=ci.SHAPES_SEL_BORDER;var fi={UNDERLAYS:{alwaysUpdate:!0,isContentLayer:!0,useView:!1},BANDLABELS:{alwaysUpdate:!0,isContentLayer:!0,useView:!1},BANDS:{alwaysUpdate:!0,isContentLayer:!0,useView:!1},MAIN:{overview:!0},COMBOS:{perItemAlpha:!0,overview:!0},COMBO_CONTAINER:{isContentLayer:!0,overview:!0},REVEALED:{},OVERLAYS:{shadowType:li,useView:!1,alwaysUpdate:!0,isContentLayer:!0},HANDLES:{useView:!1,alwaysUpdate:!0,isContentLayer:!0},OVERLAYSSHADOW:{shadowType:ui,useView:!1,alwaysUpdate:!0,isContentLayer:!0},OVERVIEWSHADOW:{shadowType:ui,useView:!1,alwaysUpdate:!0,isContentLayer:!0},WAIT:{useView:!1,alwaysUpdate:!0,isContentLayer:!0},OVERVIEW:{shadowType:li,useView:!1,alwaysUpdate:!0,isContentLayer:!0},OVERVIEW_IMAGE:{shadowType:li,blatOverview:!0,useView:!1,alwaysUpdate:!0,isContentLayer:!0},DRAGGERS:{alwaysUpdate:!0,isContentLayer:!0},BG:{bg:!0,overview:!1},FG:{bg:!1,overview:!0},SHAPES_SEL_BORDER:{isContentLayer:!0},NODES_SEL_BORDER:{isContentLayer:!0},LINKS:{isContentLayer:!0,newDrawCall:!0},SHAPES:{isContentLayer:!0},NODES:{isContentLayer:!0},HALOS:{isContentLayer:!0},BUBBLES:{isContentLayer:!0}},di=[ci.SHAPES_SEL_BORDER,ci.SHAPES,ci.HALOS,ci.NODES_SEL_BORDER,ci.LINKS,ci.NODES,ci.BUBBLES],gi={shadowType:0,bg:!1,blatOverview:!1,useView:!0,alwaysUpdate:!1,isContentLayer:!1,overview:!1,newDrawCall:!1,perItemAlpha:!1};function hi(){var e=ti(fi,gi),t={createItemLayersAt:function(t){var r,i,a=[];t.forEach(function(t){a.push(t);var o=a;oi(t)&&(o=o.concat([ci.FG]));if(e.hasLayerPathAt(o))i=e.getLayerAt(a);else{i=e.createLayer(t,r);e.createLayer(ci.COMBO_CONTAINER,i);n(i)}r=i})}};function n(t){var n=e.createLayer(ci.BG,t);di.forEach(function(t){return e.createLayer(t,n)});var r=e.createLayer(ci.FG,t);di.forEach(function(t){return e.createLayer(t,r)})}function r(){e.setup();e.createLayer(ci.BANDS);e.createLayer(ci.UNDERLAYS);n(e.createLayer(ci.MAIN));e.createLayer(ci.COMBOS);var t=e.createLayer(ci.TRANSIENT);n(e.createLayer(ci.MAIN,t));e.createLayer(ci.COMBOS,t);var r=e.createLayer(ci.REVEALED);n(e.createLayer(ci.MAIN,r));e.createLayer(ci.COMBOS,r);[ci.DRAGGERS,ci.HANDLES,ci.BANDLABELS,ci.OVERLAYS,ci.OVERVIEW_IMAGE,ci.OVERVIEW,ci.OVERLAYSSHADOW,ci.OVERVIEWSHADOW,ci.WAIT].forEach(function(t){e.createLayer(t)})}t.setShadowColourMap=function(t){e.setShadowColourMap(t);r()};t.hasPath=e.hasLayerPathAt;t.removeAllItems=r;r();var i=_({},e);return _(i,t)}var vi=4,mi=27;function bi(e,n){var r={},i=!1,o=!1,l=En;r.fontSize=l;var u,c,s,f,d,v,m,b,I,p,C,x,G,w,Z,W=[12,9,7,7],S={line:1,arc:2},k=V(),E=1,Y=2,F={small:6,normal:10,large:20,xlarge:30},H=0,L={},T=kr,N={hib:!1,present:{t:!0,t1:!1,t2:!1},pos:{t:{lx:0,ly:0,tdx:1,tdy:0,tangent:0,R:0},t1:{lx:0,ly:0,tdx:1,tdy:0,tangent:0,R:0},t2:{lx:0,ly:0,tdx:1,tdy:0,tangent:0,R:0}}};r.setSpecialOptions=function(e,t){L[e]=t};r.editColour=function(){return v||Bt.edit};var z=r.editColour;function U(){return I||Bt.white}r.setOptions=function(e){u=e.arrows;h(e.labelOffset)&&(H=e.labelOffset);Z=!!(e.truncateLabels&&e.truncateLabels.maxLength&&h(e.truncateLabels.maxLength))&&e.truncateLabels.maxLength;e.selectionColour&&(v=kt(e.selectionColour)?e.selectionColour:void 0);p=e.fanLength;c=e.fontFamily;s="along"===e.linkStyle.glyphs;f=e.iconFontFamily;d=e.imageAlignment||{};b=e.linkEnds.avoidLabels;m="loose"!==e.linkEnds.spacing;e.selectionFontColour&&(I=kt(e.selectionFontColour)?e.selectionFontColour:void 0);C=e.selectedNode;x=y(e.selectedNode);G=e.selectedLink;w=y(e.selectedLink)};function D(e){return Math.abs(e)<1e-5}function _(e,t,n,r,i,a,o){return{x:((a-r)*n-(o-i)*t)/e,y:((a-r)*t+(o-i)*n)/e}}function O(e){return Array.isArray(e)&&e.length>0}function J(e){return O(e.g)}r.shapeTest=function(e){return isFinite(e.w)&&isFinite(e.h)||e._combo&&e._combo.open};var P=r.shapeTest;function j(e,t,n,r,i,a,o,l,u,c){var s=_(t,n,r,i,a,o,l),f=_(t,n,r,i,a,u,c),d=e/t/2;if(s.y>d&&f.y>d||s.y<-d&&f.y<-d)return NaN;if(D(f.y-s.y))return Math.max(s.x,f.x);var g,h,v=s.y>f.y?s:f,m=s.y>f.y?f:s;g=d<v.y?v.x-(v.y-d)*(v.x-m.x)/(v.y-m.y):v.x;h=m.y<-d?m.x-(m.y- -d)*(m.x-v.x)/(m.y-v.y):m.x;return Math.max(g,h)}function Q(e,t,n,r,i,a,o,l){for(var u=-1/0,c=o.length,s=0;s<c;s+=2){var f=(s+2)%c,d=j(e,t,n,r,i,a,o[s]+l._sx,o[s+1]+l._sy,o[f]+l._sx,o[f+1]+l._sy);g(d)||(u=Math.max(u,d))}return u}function q(e,t,n,r,i,a,o,l){return Q(e,t,n,r,i,a,[o.x1,o.y1,o.x2,o.y1,o.x2,o.y2,o.x1,o.y2],l)}function $(e,t,n,r,i,a,o){var l=-1/0,u=a.cx+o._sx-r,c=a.cy+o._sy-i,s=e*e,f=-2*e*(u*n-c*t),d=f*f-4*s*(u*u+c*c-a.r*a.r);d>=0&&(l=(-f+Math.sqrt(d))/(2*s));return l}function ee(e,t,n,r,i,a){for(var o,l=-1/0,u=Math.sin(-n),c=Math.cos(-n),s=a._cl,f=0;f<s.length;f++){var d=s[f];o=d.length?Q(e,t,u,c,r,i,d,a):d.r?$(t,u,c,r,i,d,a):q(e,t,u,c,r,i,d,a);l=Math.max(l,o)}return l}function te(e,t,n,r,i,a){var o=0;r._c&&(o=r._c/t);r._cl&&(o=Math.max(o,ee(e,t,n,i,a,r)));return o}function ne(e,t,n,r,i,a,o,l,u,c,s,f){var d={},g=n-e,h=r-t,v=Math.sqrt(g*g+h*h);if(D(v))d.skip=!0;else{var b=Math.atan2(h,g),I=te(m&&u?0:i,v,b,o,e,t),y=te(m&&c?0:i,v,b+Math.PI,l,n,r),p=s||0,C=f||0,x=1-((I=Math.max(p,I))+(y=Math.max(C,y))),G=0;if(u||c){G=He(i,a)/v;u&&c&&(G*=1.5)}d.skip=x<Math.max(Math.min(6/v,.1),G);if(!d.skip){d.cx1=e+I*g;d.cy1=t+I*h;d.cx2=n+y*-g;d.cy2=r+y*-h}}return d}function re(e,t,n,r,i,a,o){var l=[],u=a-r,c=o-i,s=r-e,f=i-t,d=u*u+c*c,g=2*(u*s+c*f),h=g*g-4*d*(s*s+f*f-n*n);if(h>=0){var v=Math.sqrt(h),m=(-g-v)/(2*d),b=(-g+v)/(2*d);if(m>=0&&m<=1){var I=r+m*u,y=i+m*c;l.push(Math.atan2(y-t,I-e))}if(b!==m&&b>=0&&b<=1){var p=r+b*u,C=i+b*c;l.push(Math.atan2(C-t,p-e))}}return l}function ie(e,t,n,r,i,a){var o=r-t;if(Math.abs(o)>n)return[];var l=Math.max(i,a),u=Math.min(i,a);if(l<e-n||e+n<u)return[];var c=Math.asin(o/n),s=n*Math.cos(c),f=[];u<=e-s&&e-s<=l&&f.push(o>0?Math.PI-c:-Math.PI-c);u<=e+s&&e+s<=l&&f.push(c);return f}function oe(e,t,n,r,i,a){var o=r-e;if(Math.abs(o)>n)return[];var l=Math.max(i,a),u=Math.min(i,a);if(l<t-n||t+n<u)return[];var c=Math.acos(o/n),s=n*Math.sin(c),f=[];u<=t-s&&t-s<=l&&f.push(-c);u<=t+s&&t+s<=l&&f.push(c);return f}function le(e,t,n,r,i,a){for(var o=[],l=0;l<r.length;l+=2){var u=(l+2)%r.length,c=re(e,t,n,r[l]+i,r[l+1]+a,r[u]+i,r[u+1]+a);o=o.concat(c)}return o}function ue(e,t,n,r,i,a){var o=ie(e,t,n,r.y2+a,r.x1+i,r.x2+i),l=ie(e,t,n,r.y1+a,r.x1+i,r.x2+i),u=oe(e,t,n,r.x1+i,r.y1+a,r.y2+a),c=oe(e,t,n,r.x2+i,r.y1+a,r.y2+a);return o.concat(l,c,u)}var ce=function(e,t,n,r,i,a){var o=r-e,l=i-t,u=Math.sqrt(o*o+l*l);if(u>n+a||u<Math.abs(n-a)||0===u)return[];var c=(n*n-a*a+u*u)/(2*u),s=Math.sqrt(n*n-c*c),f=e+c*o/u,d=t+c*l/u,g=f+s*(l/u),h=f-s*(l/u),v=d-s*(o/u),m=d+s*(o/u);return[Math.atan2(v-t,g-e),Math.atan2(m-t,h-e)]};function se(e,t,n,r,i){for(var a=Math.PI,o=e,l=0;l<t.length;l++){t[l]+2*Math.PI<r&&(t[l]+=2*Math.PI);n<t[l]&&t[l]<r&&(i?t[l]-o<a&&(o=Math.max(o,t[l])):o-t[l]<a&&(o=Math.min(o,t[l])))}return o}function fe(e,t,n,r,i,a,o,l){var u=4;if(!l.length){var c=e+n*Math.cos(r),s=t+n*Math.sin(r),f=e+n*Math.cos(i),d=t+n*Math.sin(i);if(l.r){var g=a+l.cx,h=o+l.cy,v=ye(c,s,g,h),m=ye(f,d,g,h);if(v<=l.r+u&&m<=l.r+u)return!0}else{var b=a+l.x1-u,I=a+l.x2+u,y=o+l.y1-u,p=o+l.y2+u;if(b<=c&&c<=I&&y<=s&&s<=p&&(b<=f&&f<=I&&y<=d&&d<=p))return!0}}return!1}function de(e,t,n,r,i,a){var o=a.x,l=a.y;if(a._c){if(fe(e,t,n,r,i,o,l,{cx:0,cy:0,r:a._c}))return!1}if(a._cl)for(var u=0;u<a._cl.length;u++){if(fe(e,t,n,r,i,o,l,a._cl[u]))return!1}return!0}function ge(e,t,n,r,i,a,o){var l=o?r:i,u=a._sx,c=a._sy;a._c&&(l=se(l,ce(e,t,n,u,c,a._c),r,i,o));if(a._cl)for(var s=0;s<a._cl.length;s++){var f=a._cl[s];l=se(l,f.length?le(e,t,n,f,u,c):f.r?ce(e,t,n,u+f.cx,c+f.cy,f.r):ue(e,t,n,f,u,c),r,i,o)}return l}function he(e,t){var n,r,i=P(e);if(t&&C){n=C.b||e.b;r=C.c||e.c}else{n=e.b;r=e.c}return!(!n&&!r||i)}var ve=34;function me(e,t,n,r,i,a,o,l,u,c,s){c?e.arc(0,0,0,0,0,o,l,u,t,s,!1,0,!0):e.line(0,0,0,0,o,l,u,t,s,!0);var f=c?S.arc:S.line;n&&e.triangle(0,0,0,0,0,0,o,-1,o,!0,t+k+"a1",f,!0);r&&e.triangle(0,0,0,0,0,0,l||o,-1,l||o,!0,t+k+"a2",f,!0);N.hib=!0;N.pos.t.lx=(i._sx+a._sx)/2;N.pos.t.ly=(i._sy+a._sy)/2}var be={t:.5,t1:.15,t2:.85};function Ie(e,n,r,a,l,u,c,s,f,d,g,h,v,b,I){var y=s===f,p=s._sx,C=s._sy,x=f._sx,G=f._sy,w=a||0,Z=l||0,A=+(u||0)*v;y&&(A+=ve*s._sl.e);var B=A>0;if(y){var R=(s._sl.w?180:225)*(Math.PI/180),M=Math.cos(R),W=Math.sin(R),V=.5;p=s._sx+s._sl.x;C=s._sy+s._sl.y;x=p;G=C;var S=-s._sl.e*ve/2;p+=M*S+W*V;C+=W*S-M*V;x+=M*S-W*V;G+=W*S+M*V}var X=(p+x)/2,E=(C+G)/2,Y=x-p,F=G-C,H=Math.max(.001,F*F+Y*Y),L=Math.sqrt(H),T=+(H/4+A*A)/(2*Math.abs(A)),z=T-Math.abs(A);if(T>1e5){i=!0;o=!0;Ge(e,n,r,w,Z,c,s,f,d,g,h,v,b,I)}else{var U=B?1:-1,D=X-F*U*z/L,_=E+Y*U*z/L,K=Math.atan2(C-_,p-D),O=Math.atan2(G-_,x-D),J=B?K:O,P=B?O:K;J>P&&(P+=2*Math.PI);var j=J+(B?w:Z)*(P-J),Q=J+(B?1-Z:1-w)*(P-J),q=ge(D,_,T,J,P,A>0?s:f,!0),$=ge(D,_,T,q,P,A>0?f:s,!1),ee={startangle:0,endangle:0};if(s===f||de(D,_,T,q,$,s)&&de(D,_,T,q,$,f)){ee.startangle=q;ee.endangle=$}else{ee.startangle=2*Math.PI;ee.endangle=2*Math.PI}ee.startangle=Math.max(j,ee.startangle);ee.endangle=Math.min(Q,ee.endangle);if(ee.startangle>=ee.endangle)me(e,c,n,r,s,f,d,g,h,!0);else{var te,ne,re,ie,oe,le,ue=.9*He(h,v)/T,ce=-.25;if(n){te=B?ee.startangle:ee.endangle;ne=D+T*Math.cos(te);re=_+T*Math.sin(te);B?ee.startangle+=ue:ee.endangle-=ue}else m&&he(s,I)&&(B?ee.startangle+=ce*ue:ee.endangle-=ce*ue);if(r){ie=B?ee.endangle:ee.startangle;oe=D+T*Math.cos(ie);le=_+T*Math.sin(ie);B?ee.endangle-=ue:ee.startangle+=ue}else m&&he(f,I)&&(B?ee.endangle-=ce*ue:ee.startangle+=ce*ue);if(ee.startangle>=ee.endangle)me(e,c,n,r,s,f,d,g,h,!0);else{e.arc(D,_,T,ee.startangle,ee.endangle,d,g,h,c,b,!1,A);n&&Te(e,D,_,T,ne,re,B,h,v,d,c+k+"a1");r&&Te(e,D,_,T,oe,le,!B,h,v,g||d,c+k+"a2");t(N.pos,function(e,t){if("t"===t||N.present[t]){var n=U>0?ee.startangle:ee.endangle,r=n+((U>0?ee.endangle:ee.startangle)-n)*be[t];e.lx=D+T*Math.cos(r);e.ly=_+T*Math.sin(r);e.tdx=-U*Math.sin(r);e.tdy=U*Math.cos(r);e.tangent=r;e.R=T;e.signf=U}})}}}}function ye(e,t,n,r){return Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}function pe(e,t,n,r,i,a){var o=e,l=t,u=Math.ceil(a/8),c=ye(o,l,n,r);return{x:o+=(o-n)/c*(u-i),y:l+=(l-r)/c*(u-i)}}function Ce(e,t){var n=je,r=(e.e||1)*Rt;return t.x>e._sx&&"e"===e.sh?e._sx+r*n:t.x<e._sx&&"w"===e.sh?e._sx-r*n:e._sx}function xe(e,n,r,i,a,o,l,u,c,s,f,d,g){var h,v,m=i,b=a,I=Ce(u,c),y=u._sy,C=Ce(c,u),x=c._sy,G=o||0;C>I?(h=I+p)>(v=C-p)&&(v=h=(I+C)/2):(h=I-p)<(v=C+p)&&(v=h=(I+C)/2);var w=ye(I,y,h,G),Z=ye(h,G,v,G),A=ye(v,G,C,x),B=w+Z+A,R=Math.atan2(G-y,h-I),M=Math.atan2(G-x,v-C),W=0===w?0:te(f,w,R,u,I,y),V=0===A?0:te(f,A,M,c,C,x);m=0===w?0:(m||0)*B/w;b=0===A?0:(b||0)*B/A;var X,E,Y,F,H,L,T=I+(W=Math.min(1,Math.max(m,W)))*(h-I),z=y+W*(G-y),U=C+(V=Math.min(1,Math.max(b,V)))*(v-C),D=x+V*(G-x);(n||r)&&(H=He(f,d));if(n){X=T;E=z;T=(L=pe(T,z,h,G,H,f)).x;z=L.y}if(r){Y=U;F=D;U=(L=pe(U,D,v,G,H,f)).x;D=L.y}e.line3(T,z,h,G,v,G,U,D,s,f,l,g);n&&Le(e,X,E,f,d,R+Math.PI,s,l+k+"a1",S.line);r&&Le(e,Y,F,f,d,M+Math.PI,s,l+k+"a2",S.line);var _={t:{lx:(h+v)/2,ly:(G+G)/2},t1:{lx:I,ly:y},t2:{lx:C,ly:x}};t(N.pos,function(e,t){if("t"===t||N.present[t]){e.above=!0;e.lx=_[t].lx;e.ly=_[t].ly;e.R=0}})}function Ge(e,n,r,i,a,o,l,u,c,s,f,d,g,h){var v=ne(l._sx,l._sy,u._sx,u._sy,f,d,l,u,n,r,i,a);if(v.skip)me(e,o,n,r,l,u,c,s,f,!1,g);else{var b,I,y,p,C,x,G,w,Z=v.cx1,A=v.cy1,B=v.cx2,R=v.cy2,M=B-Z,W=R-A,V=Math.max(.001,W*W+M*M),X=Math.sqrt(V),E=.25;(n||r)&&(G=He(f,d));if(n){b=Math.atan2(W,M);y=Z;p=A;w=pe(Z,A,B,R,G,f);Z=w.x;A=w.y}else if(m&&he(l,h)){Z-=E*f*M/X;A-=E*f*W/X}if(r){I=Math.atan2(W,M);C=B;x=R;w=pe(B,R,Z,A,G,f);B=w.x;R=w.y}else if(m&&he(u,h)){B+=E*f*M/X;R+=E*f*W/X}e.line(Z,A,B,R,c,s,f,o,g);n&&Le(e,y,p,f,d,b+Math.PI,c,o+k+"a1",S.line);r&&Le(e,C,x,f,d,I,s||c,o+k+"a2",S.line);t(N.pos,function(e,t){if("t"===t||N.present[t]){var n=be[t],r=u._sx-l._sx,i=u._sy-l._sy;if(0===r&&0===i){r=1;i=-1}var a=K(r,i);e.lx=Z+n*(B-Z);e.ly=A+n*(R-A);e.tdx=r/a;e.tdy=i/a;e.tangent=Math.atan2(i,r);e.R=0}})}}function we(e,t,n,r,i,a,o,l,u,c,s,f,d){var g=n||[],h=r;if(o){for(var v=0,m=0;m<g.length-1;m++)v+=ke(g[m],g[m+1])*a;h+=v/2}else g.length>0?h-=Xe(g[g.length-1])*a:h-=Xe({});if(s){var b=h;if(g.length>0){y(function(e,t){b=t});var I=g[0].e||1;b-=I*a*ve/2;s._sl.e*=I}s._sl.x=b-s._sx;s._sl.y=i-s._sy;s._sl.w=!0}function y(e){for(var t=g.length-1,n=h;t>=0;t--){e(g[t],n);t>0&&(n-=ke(g[t-1],g[t])*a)}}o&&l&&y(function(t,n){e.circle(n,i,Se(t)*a*1.25,Bt.white,-1,z(),!0,c,null,null,!1,f)});var p=0;y(function(n,r){var o=c+k+p;d&&(o+="-"+d);mt(e,t,o,r,i,a,n,u,s,!1,!1,f);p++})}function Ze(e,t,n,r,i,a,o,l,u,c,f,d,g,h,v){var m,b,I,y=n||[],p=r,C=i,x=0,G=function(e,t){return ke(e,t)*a},w=function(){return 0};if(o)if(v.R&&s){var Z=0,A=v.signf,B=v.R;x=v.tangent;for(I=0;I<y.length-1;I++){b=ke(y[I],y[I+1]);Z+=A*Math.asin(b/(2*B))}var R=x+Z/2,M=2*A*B*Math.sin(Z/2);p+=A*M*-Math.sin(R);C+=A*M*Math.cos(R);x+=Z;G=function(e,t){m-=A*Math.asin(ke(e,t)/(2*B));var n=-A*Math.sin(m);return ke(e,t)*a*n};w=function(e,t){var n=A*Math.cos(m);m-=A*Math.asin(ke(e,t)/(2*B));return ke(e,t)*a*n}}else{var W=0;for(I=0;I<y.length-1;I++)W+=ke(y[I],y[I+1])*a;if(s){G=function(e,t){return ke(e,t)*a*v.tdx};w=function(e,t){return ke(e,t)*a*v.tdy};p+=W*v.tdx/2;C+=W*v.tdy/2}else p+=W/2}else y.length>0?p-=Xe(y[y.length-1])*a:p-=Xe({});function V(e){m=x;for(var t=y.length-1,n=p,r=C;t>=0;t--){e(y[t],n,r);if(t>0){n-=G(y[t-1],y[t]);r-=w(y[t-1],y[t])}}}o&&l&&V(function(t,n,r){e.circle(n,r,Se(t)*a*1.25,Bt.white,-1,z(),!0,c,null,null,!1,g)});var S=0;V(function(n,r,i){var o=c+k+S;h&&(o+="-"+h);mt(e,t,o,r,i,a,n,u,null,!1,!1,g);S++})}function Ae(e,t,n,r,i,a,o){var l,u,c,s=e.getLayer(),f="solid",d=Er;e.setLayer(ci.HALOS);for(var g=!0,h=0;h<d.length;h++){l=i[c=d[h]];u=t+k+c;if(l){g=!1;"h"===i.st?xe(e,!1,!1,i.b1,i.b2,i.y,u,n,r,l.c,l.w,a,f):i.off||n===r?Ie(e,!1,!1,i.b1,i.b2,i.off,u,n,r,l.c,null,l.w,a,f,o):Ge(e,!1,!1,i.b1,i.b2,u,n,r,l.c,null,l.w,a,f,o)}}i._noHalos=g;e.setLayer(s)}function Be(e,r,i,a,o,u,c,s,f){var d=f.isSelected,g=f.isRevealed,h=1;i._edit=null;var v=i.id,m=d&&!w,b=m,I=d&&w,y=I&&G.b1>=0?G.b1:i.b1,p=I&&G.b2>=0?G.b2:i.b2,C=I&&G.c||i.c,x=I&&G.c2||i.c2,Z=I&&G.fb||i.fb,A=I&&G.fbc||i.fbc,B=I&&G.fc||i.fc,R=I&&G.ff||i.ff,M=I&&G.fs||i.fs,W=I&&G.t1||i.t1,V=I&&G.t2||i.t2,S=I&&G.ls||i.ls,X=I&&G.w||i.w,k=!1;g&&(k=n.privateTopParentId(i.id1)!==n.privateTopParentId(i.id2));u._parentId&&(h=at(1,u._parentId,a));c._parentId&&(h=Math.min(h,at(1,c._parentId,a)));var E=(X||1)*h*Rt,Y=C||Bt.midgrey,F=0;N.present.t=i.t||i.g&&i.g.length||s;N.present.t1=!!i.t1;N.present.t2=!!i.t2;var H=N.present.t||N.present.t1||N.present.t2;N.hib=!1;if("h"===i.st)xe(r,i.a1,i.a2,y,p,i.y,v,u,c,Y,E,h,S);else if(i.off||u===c){var L=i.off;k&&(L=i.off/h);Ie(r,i.a1,i.a2,y,p,L,v,u,c,Y,x,E,h,S,d)}else Ge(r,i.a1,i.a2,y,p,v,u,c,Y,x,E,h,S,d);i._x=N.pos.t.lx;i._y=N.pos.t.ly;var T=N.hib;H&&t(N.pos,function(t,n){if(N.present[n]){var a,s,f,d,g,I,y=t.lx,p=t.ly,C={};if("t"===n||"string"==typeof i[n])I=i[n];else{C=i[n];"t1"===n&&(C=W);"t2"===n&&(C=V);I=C.t?C.t:i[n].t;a=C.fb?C.fb:i[n].fb;s=C.fbc?C.fbc:i[n].fbc;f=C.fc?C.fc:i[n].fc;d=C.ff?C.ff:i[n].ff;g=C.fs?C.fs:i[n].fs}var x=!1,G=y,w=p;g=Number(g||M||l)*h*Rt;I=I||"";d=d||R;var S=f||B||Bt.black,X=s||A||Bt.textback,k=void 0!==a?!!a:Z;if(m){S=U();X=z()}var Y=De(i,I),H=_e(Y,e,g,k,d),L=g+3*Rt;F=L*Y.length;Y.length>0&&(G-=H[0]/2);for(var D=(Y.length-1)*L,_=C.above?p-(D+L/2+E/2):p-D/2,K=0;K<Y.length;K++){0===K&&(w=_);var J=Je(e,r,Y[K],y,_,v,!0,S,X,k,i,!1,!0,99,H[K],m,g,d,T,n);x=x||J;_+=L}x&&(b=!1);var P="t"===n?i.g:C.g;if(O(P)){Ze(r,e,P,G,w,h,!x,m,o,v,u,c,T,"t"===n?null:n,t);b=!1}}});if(b){var D=Math.max(.66*(X||0),Number(M||l)*Rt/2);r.circle(i._x,i._y,D,Bt.white,-1,z(),!0,v,null,null,!1,T)}i.bu&&At(r,e,v,i._x,i._y,F/2+4,h,i.bu,o);u.du&&Ne(u,"id1",v,r,E,Y,T);c.du&&Ne(c,"id2",v,r,E,Y,T);i._noHalos||Ae(r,v,u,c,i,h,d);T&&(i._edit={hib:!0})}var Re=3,Me=1,We=9,Ve=2;function Se(e){var t=We;gt(e)&&(t+=Ve/2);e.e&&(t*=e.e);return t}function Xe(e){return Se(e)+Re}function ke(e,t){return Se(e)+Me+Se(t)}function Ee(e,t){return t*(1.7*e+Rt*(h(F[u])?F[u]:F.normal))}var Ye=Math.PI/7,Fe=Math.cos(Ye);function He(e,t){return Fe*Ee(e,t)}r.arrowLength=He;function Le(e,t,n,r,i,a,o,l,u){var c=Ee(r,i),s=a+Math.PI;e.triangle(t+c*Math.cos(s+Ye),n+c*Math.sin(s+Ye),t+c*Math.cos(s-Ye),n+c*Math.sin(s-Ye),t,n,o,-1,o,!0,l,u,!1)}function Te(e,t,n,r,i,a,o,l,u,c,s){var f=He(l,u),d=ce(i,a,f,t,n,r);if(2===d.length){Le(e,i,a,l,u,(o?d[0]:d[1])-Math.PI,c,s,S.arc)}else e.triangle(0,0,0,0,0,0,c,-1,c,!0,s,S.arc,!0)}function Ne(e,t,n,r,i,a,o){r.circle(e._sx,e._sy,1.5*i,a,i,Bt.white,!0,n+k+t,null,null,!1,o)}r.labelPosition=function(e,t){if(!e||e.hi)return null;var n=e._edit;if(!n||n.hib)return null;var r=n.x1,i=n.y1,a=n.x2,o=n.y2;if("node"===e.type){r+=e.x;i+=e.y;a+=e.x;o+=e.y}return{x1:t.x(r),y1:t.y(i),x2:t.x(a),y2:t.y(o),fs:t.dim(n.fs)}};function ze(e){return L.showFullLabel&&L.showFullLabel===e}function Ue(e,t){return Z&&("node"===e.type||"link"===e.type)&&t.length>Z&&!ze(e.id)}function De(e,t){var n=t;""===n||n||(n=e.t);function r(){Ue(e,n)&&(n=n.substring(0,Z-3)+"...");return n.split(/\r\n|\r|\n/)}return n?r():[""]}function _e(e,t,n,r,i){for(var a=[],o=0;o<e.length;o++)a[o]=pr(t,e[o],n,r,i||c).width;return a}function Ke(e){for(var t=0,n=0;n<e.length;n++)t=Math.max(t,e[n]);return t}function Oe(e,t,n,r,i,a,o,l,u,c,s,f,d,g,h,v,m){return Je(e,t,n,r,i,a,o,l,u,c,s,f,d,g,pr(e,n,v,c,m).width,h,v,m)}function Je(e,t,n,r,i,a,o,l,u,c,s,f,d,g,h,v,m,b,I,y,p){var C=!0;0===n.length&&(C=!1);var x=a+k+(y||"t");if(C&&I){t.text(0,0,n,l,m,c,x,b,!0,h,!1,o,0,0,0,0,u,v,0,I);s&&(s._edit={hib:!0});return!0}if(f&&h>g)return Oe(e,t,n,r,i,a,o,l,u,c,s,f,d,g,v,.85*m,b);var G,w=4*Rt,Z=r-h/2,A={x1:Z-w,y1:(G=d?i+(p||1)+m/2:i+(1+m)/2)-m,x2:Z+h+w,y2:G};if(C){var B=d?H:0;t.text(r,G,n,l,m,c,x,b,!0,h,!1,o,A.x1,A.y1,A.x2,A.y2,u,v,w,!1,B)}if(s&&"node"===s.type){A.x1-=s._sx;A.y1-=s._sy;A.x2-=s._sx;A.y2-=s._sy}s&&Pe(s,A,m,C);return C}function Pe(e,t,n,r){if(e._edit){e._edit.hib=!1;e._edit.x1=Math.min(e._edit.x1,t.x1);e._edit.x2=Math.max(e._edit.x2,t.x2);e._edit.y1=Math.min(e._edit.y1,t.y1);e._edit.y2=Math.max(e._edit.y2,t.y2)}else e._edit={fs:n,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,hib:!1};b&&r&&e._cl&&e._cl.push(t)}var je=50,Qe=je-mi,qe=Math.sqrt(mi*mi+Qe*Qe)/mi,$e=1-Math.sin(Math.atan2(mi,Qe)/2),et={box:!0,circle:!0,e:!1,w:!1};function tt(e,t){return e._combo&&e._combo.open?"circle":t?et[e.sh]?e.sh:"box":e.sh in et?e.sh:e.sq?"box":"circle"}function nt(e,t,n,r,i,a,o,l,u){var c=r+a,s=i+a;if("circle"===e){o(Math.min(c,s))}else{var f=t-c,d=n-s,g=t+c,h=n+s;if("box"===e)l(f,d,g,h);else{var v=a*$e,m=r*je/mi+a*qe;"e"===e?u(g-=v,d,t+m,n,g,h,f,h,f,d):u(f+=v,h,t-m,n,f,d,g,d,g,h)}}}function rt(e,t,n,r,i,a,o,l,u,c,s,f,d,g){nt(d,t,n,r,i,a,function(r){e.circle(t,n,r,o,l,c,s,f,u,!1,!1,g)},function(t,n,r,i){e.rect(t,n,r,i,o,l,c,s,f,u,g)},function(t,n,r,i,a,d,h,v,m,b){e.pentagon(t,n,r,i,a,d,h,v,m,b,o,l,c,s,f,u,g)})}function it(e,t,n,r,i,a,o){nt(o,t,n,r,i,a,function(t){e._c=t},function(r,i,a,o){e._cl.push({x1:r-t,y1:i-n,x2:a-t,y2:o-n})},function(r,i,a,o,l,u,c,s,f,d){e._cl.push([r-t,i-n,a-t,o-n,l-t,u-n,c-t,s-n,f-t,d-n])})}function at(e,t,n){var r=e,i=n[t];if(i){r*=i._combo.e;i._parentId&&(r=at(r,i._parentId,n))}return r}function ot(e,t){for(var n=e,r=n.x,i=n.y;n._parentId;){r=(n=t[n._parentId]).x+(r-n.x)*n._combo.e;i=n.y+(i-n.y)*n._combo.e}return{x:r,y:i}}function lt(e,t,n,r,i,a){if(!n.hi&&!n.du){var o,l,u,c,s,g,v,b,I,y,p,G=a.isOpenCombo,w=n.id,Z=P(n),A=tt(n,Z),B=a.isSelected,R=B&&x,M=B&&!x,W=R&&C.b||n.b,V=R&&C.bs||n.bs,S=R&&C.c||n.c,X=(Z?1:R&&C.e||n.e||1)*Rt;l=!!Z&&(R&&C.re||n.re);u=R&&C.u||n.u;c=R&&C.fi||n.fi;s=R&&h(C.bw)?C.bw:n.bw;g=R&&C.w||n.w;v=R&&C.h||n.h;b=n.x;I=n.y;var E,Y=n.donut&&"circle"===A&&!G?n.donut:null;if(G){var F=n.oc;if(F){W=null===F.b?null:F.b||T.b;s=F.bw||T.bw;V=F.bs||T.bs;S=F.c||T.c;l=F.re||T.re;g=F.w||T.w}else{W=T.b;s=T.bw;V=T.bs;S=T.c;l=T.re;g=T.w}if(R){var H=C.oc;if(H){W=H.b||W;s=H.bw||s;V=H.bs||V;S=H.c||S}}c=null;u=null;A="circle";y=R&&C.e||n.e||1;v=g*=X=n._combo.e}var L=1;if(n._parentId){L=at(1,n._parentId,r);var N=ot(n,r);g*=L;v*=L;X*=L;b=N.x;I=N.y}n._sx=b;n._sy=I;if(Y){E=!0;o=Y.b;s=X*(Y.w+2*Y.bw);V=null}else if(W&&(void 0===s||s>0)){E=!0;o=W;s=X*(s||vi)}else{E=!1;o=Bt.white;s=0;V=null}var U,D,_=!!S,K=!!u||!(!c||!c.t),O=_?S:Bt.white;n._c=0;n._cl=[];n._edit=null;n._sl={e:X};if(Z){U=g/2;D=v/2}else D=U=X*mi;var J,j,Q,q=U+s/2,$=D+s/2;if(Y){J=X*Y.w;j=s/2}else j=.75*(J=E?s:X*vi);Q=m?E||_?s/2:j-J/2:j+J/2;if(K||E||_){it(n,b,I,q,$,Q,A);if(B&&(!M&&l||M)){var ee=si[t.getLayer()];ut(t,ee,a,function(){var e=z();rt(t,b,I,q,$,j,e,J,null,e,!1,w,A,!M);l&&(Ct=t.getLast())})}}if(_){rt(t,b,I,q,$,0,o,-1,V,O,_,w,A);B&&l&&!K&&(xt=t.cloneLast())}if(K){if(u){var te=0,ne=0,re=1;if(p=d[u]){te=p.dx/100*U;ne=p.dy/100*D;re=p.e}t.image(b-U*re+te,I-D*re+ne,b+U*re+te,I+D*re+ne,i+u,w,n.ci?"ci":void 0,1)}else{var ie=Z?Math.min(U,D):U;It(t,e,w,b,I,ie,c.t,c.c||Bt.black,c.ff||f)}B&&l&&(xt=t.cloneLast())}if(E){var oe=Y&&0===Y.bw?-1:s||-1;oe>=0&&rt(t,b,I,q,$,0,o,oe,V,O,!1,w,A)}Y&&Zt(t,b,I,Math.min(q,$),Y,X,w+k);dt(t,e,b,I,s,U,D,n,Z,A,E,_,K,M,X,y,w,i,R,a)}}function ut(e,t,n,r){var i,a=e.getLayerPath(),o=e.getLayer();if(t){if(n.isRevealed){n.isParentRevealed||(i=a.slice(1));if(n.isParentTransient){i||(i=a.slice(0));i.unshift(ci.TRANSIENT)}}!n.isTransient||n.isInCombo&&n.isParentTransient||(i=a.slice(1));if(n.isOpenCombo){(i=(i=i||a).slice(0,i.length-1))[i.length-1]===ci.COMBOS&&(i[i.length-1]=ci.MAIN);i.push(n.isInBackground?ci.BG:ci.FG)}if(i){e.hasPath(i)||e.createItemLayersAt(i);e.setLayerPath(i)}e.setLayer(t)}r();if(t){e.setLayerPath(a);e.setLayer(o)}}function ct(e,t,n,r,i,a){var o=0,l=0,u="centre";if(-1!==e.indexOf("n")||-1!==e.indexOf("s")){l=-n;2===e.length&&(l-=r.dy);-1!==e.indexOf("s")&&(l*=-1)}if(-1!==e.indexOf("e")||-1!==e.indexOf("w")){o=t;u="right";2===e.length&&(o+=r.dx);if(-1!==e.indexOf("w")){o*=-1;u="left"}}!i&&a&&(-1!==["n","s"].indexOf(e)?l*=Math.sqrt(2):-1!==["e","w"].indexOf(e)&&(o*=Math.sqrt(2)));return{gdx:o,gdy:l,growDirection:u}}function st(e,t,n,r,i){var a,o,l="centre";e>0&&e<180?l="right":e>180&&(l="left");switch(i){case"circle":a=Math.sin(e)*r;o=-Math.cos(e)*r;break;case"rectangle":var u,c=[Math.atan2(t,n),Math.atan2(t,-n),Math.atan2(-t,-n),Math.atan2(-t,n)];for(u=0;u<c.length;u++)c[u]<0&&(c[u]+=2*Math.PI);if(e<c[0]||e>c[3])a=-(o=-n)*Math.tan(e);else if(e<c[1]){a=t;o=e===Math.PI/2?0:-a/Math.tan(e)}else if(e<c[2])a=-(o=n)*Math.tan(e);else{a=-t;o=e===Math.PI/2*3?0:-a/Math.tan(e)}break;default:a=0;o=0}return{gdx:a,gdy:o,growDirection:l}}function ft(e,t,n,r,i,o,l,u,c,s,f,d){var g,h=0;if(-1!==["n","ne","e","se","s","sw","w","nw"].indexOf(f.p))g=ct(f.p,n,r,d,s,c);else{var v="rectangle",m=0;if(c){v="circle";m=s?Math.min(n,r):Math.sqrt(2)*n}g=st(a(f.p),n,r,m,v)}if(null!==g.gdx){g.gdx<0&&g.gdy<0&&f.e&&(i._sl.e=Math.max(i._sl.e,f.e));h=mt(e,t,l+k+f.p,i._sx+g.gdx,i._sy+g.gdy,o,f,u,i,g.growDirection,!0)}return i._sy+g.gdy+h}function dt(e,t,n,r,i,a,o,u,s,f,d,g,h,v,m,b,I,y,p,x){var G,w,Z,A,B,M,W,V=n,S=r,X=V,k=V,E=S,Y=J(u),F=!1,H=x.isOpenCombo,L=u._combo&&u._combo.open?b:m;if(p){w=C.fb||u.fb;Z=C.fbc||u.fbc;A=C.fc||u.fc;B=C.ff||u.ff;M=(C.fs||u.fs||l)*L;W=C.tc||u.tc}else{w=u.fb;Z=u.fbc;A=u.fc;B=u.ff;M=(u.fs||l)*L;W=u.tc}H&&(W=!1);var T=3*L+M/2,N=A||Bt.black,D=Z||Bt.textback;if(v){N=U();D=z()}var _=S+o+T,K=De(u),O=_e(K,t,M,w,B),P=M+3,j=P,Q=P*K.length;K.length>0&&(k-=O[0]/2);var q=h||d||g,$=R(W)?!!W:!h&&!s,ee=(K.length-1)*(j/2);if(q)$&&(_=S-ee);else{if(Y){var te=Xe(u.g[u.g.length-1])*L;k=V+te;V+=O[0]/2+te}_=S;S+=ee}var ne=V;if(("e"===f||"w"===f)&&(d||g)){var re=8*L;ne+="e"===f?re:-re}K.length>0&&(E=_);d&&!$&&(_+=i-3*L);if(q){var ie=3,oe=3,le={dx:0,dy:h?-8:0},ue=2;if(!s&&"circle"===f){ie+=ue;oe+=ue;if(h){le.dx+=ue;le.dy+=ue}}if(s){ie++;oe++}var ce=ie*L,se=oe*L;le.dx*=L;le.dy*=L;u._sl.x=-a+(ce-le.dx);u._sl.y=-o+(se-le.dy);if(Y){var fe="circle"===f;for(G=0;G<u.g.length;G++){var de=ft(e,t,a-ce,o-se,u,m,I,y,fe,s,u.g[G],le);$||(_=Math.max(_,de+T))}}}for(var ge=0;ge<K.length;ge++){var he=Je(t,e,K[ge],ne,_,I,!0,N,D,w,u,!1,!0,99,O[ge],v,M,B||c,null,null,L);F=F||he;_+=j}if(!q){var ve=!u.t||!F;we(e,t,u.g,ve?X:k,E,L,ve,v,y,I,u)}var me=!u._noHalos||p;!s&&me&&ut(e,ci.HALOS,x,function(){yt(e,I,V,S,L,u,p)});if(u.bu){var be=0;q?be=o:Q>0?be=Q/2+4:J(u)&&(be=13*L);At(e,t,I,V,S,be,L,u.bu,y,H)}}function gt(e){return"b"in e?e.b:Bt.keyline}function ht(e,t,n,r){e._cl.push({cx:t,cy:n,r:r})}function vt(e,t,n,r,i){e._cl.push({x1:t,x2:r,y1:n,y2:i})}function mt(e,t,n,r,i,a,o,l,u,s,g,h){var v=r,m=i,b=a,I=0;if(o&&!(u&&u._combo&&u._combo.open)){o.e&&(b*=o.e);var y,p=o.a?pt:1,C=We*b*p,x=gt(o),G=x?Ve*b:-1,w=!!(o.u||o.fi&&o.fi.t),Z=0,B=0,R=1;I=C+(x?G/2:0);if(o.c)if(o.t){var V,S,k,E,F=!M(o,"fb")||o.fb,H=o.fc||Bt.white,L=o.ff||c;if(o.w&&g){V=b*W[1]*p;S=pr(t,k=(o.t+"").substring(0,25),V,F,L).width;var T,N,z=(E=Math.max(S,C))+C;switch(s){case"left":T=(N=v+C)-z;v=N-z/2;break;case"centre":T=v-z/2;N=v+z/2;break;default:N=(T=v-C)+z;v=T+z/2}var U=m-C,D=m+C;e.roundRect(T,U,N,D,C,x,G,o.c,!0,n,h);if(u){ht(u,T+C-u._sx,m-u._sy,I);ht(u,N-C-u._sx,m-u._sy,I);vt(u,T+C-u._sx,U-u._sy-G/2,N-C-u._sx,D-u._sy+G/2)}}else{e.circle(v,m,C,x,G,o.c,!0,n,null,null,!1,h);S=pr(t,k=(o.t+"").substring(0,4),V=b*W[k.length-1]*p,F,L).width;E=1.7*C;u&&ht(u,v-u._sx,m-u._sy,I)}Je(t,e,k,v,m,n,!1,H,Bt.white,F,null,!0,!1,E,S,!1,V,L,h)}else{e.circle(v,m,C,x,G,o.c,!0,n,null,null,!1,h);u&&ht(u,v-u._sx,m-u._sy,I);if(w){var _=C/1.41421;if(o.u){if(y=d[o.u]){Z=y.dx/100*_;B=y.dy/100*_;R=y.e}var K=_*R;e.image(v-K+Z,m-K+B,v+K+Z,m+K+B,l+o.u,n,null,null,null,h)}else It(e,t,n,v,m,_,o.fi.t,o.fi.c||Bt.black,o.fi.ff||f,h)}}else if(w){u&&ht(u,v-u._sx,m-u._sy,C);if(o.u){if(y=d[o.u]){Z=y.dx/100*C;B=y.dy/100*C;R=y.e}e.image(v-C*R+Z,m-C*R+B,v+C*R+Z,m+C*R+B,l+o.u,n,null,null,null,h)}else It(e,t,n,v,m,C,o.fi.t,o.fi.c||Bt.black,o.fi.ff||f,h)}o.a&&(Gt=Gt||new A).set(X(n),Y)}return I}function bt(e,t){return ye(e,t,0,0)}function It(e,t,n,r,i,a,o,l,u,s){e.rect(r-a,i-a,r+a,i+a,Bt.transparent,-1,Bt.transparent,!0,n,null,s);var f=2*a,g=pr(t,o,f,!1,u||c,!0),h=bt(g.width,g.height),v=f-(h-f)/2;h=bt((g=pr(t,o,v,!1,u||c,!0)).width,g.height);var m=d[o],b=0,I=0,y=1;if(m){b=m.dx/100*a;I=m.dy/100*a;y=m.e}var p=a*(5/6)*y,C=r-p+b,x=i-p+I,G=r+p+b,w=i+p+I;e.text(r+b,i+v*y/2+I,o,l,v*y,!1,n,u,!0,h,!0,null,C,x,G,w,null,null,null,s)}function yt(e,t,n,r,i,a,o){for(var l,u=Yr,c=!0,s=0;s<u.length;s++){var f=u[s];if(l=o&&C[f]||a[f]){c=!1;var d=t+k+f,g=l.r*i,h=l.w*i;h/2>=g?e.circle(n,r,g+h/2,Bt.white,-1,l.c,!0,d,null,!0):e.circle(n,r,g,l.c,h,Bt.white,!1,d,null,!0)}}a._noHalos=c&&!o}var pt,Ct,xt,Gt,wt=Math.PI/256;function Zt(e,t,n,r,i,a,o){var l=i.bw*a,u=i.w*a;if(u>0){var c=i.v.filter(function(e){
return e>0}).length;if(1===c){var s=0;i.v.forEach(function(e,t){e>0&&(s=t)});e.circle(t,n,r,i.c[s],u,Bt.white,!1,o+"do0",null,!0)}else{var f=i.v.reduce(function(e,t){return e+t},0),d=l/r,g=d*c,h=2*Math.PI-g,v=-Math.PI/2+d/2;h>0&&i.v.reduce(function(a,s,g){var v=a;if(0===s)return v;var m=v+h*s/f,b=m+d,I=i.c[g%i.c.length];0===l&&(0===g?v-=wt:g!==c-1&&(m+=wt));e.arc(t,n,r,v,m,I,null,u,o+"do"+g,null,!0,0);return b},v)}}}function At(e,t,n,r,i,a,o,u,s,f){var d=o*Rt;if(u.t){var g=r,h=i,v=e.getLayer();f||e.setLayer(ci.BUBBLES);var m=u.p?""+u.p:"ne",b="w"===m.substring(1,2),I="s"===m.substring(0,1),y=n+k+"bu",p=Number(u.fs?u.fs:l)*d,C=u.b?u.b:Bt.keyline,x=u.c?u.c:Bt.white,G=u.fc?u.fc:Bt.black,w=De(u),Z=p+3*d,A=Z*w.length,B=_e(w,t,p,u.fb,u.ff),R=Ke(B),M=13*d,W=6*d,V=2*o,S=9*d,X=13*d,E=10*d,Y=a+X,F=A+2*W,H=2*d,L=Math.max(H/2,1),T=3*d;u.g&&delete u.g.e;var N=u.g?17*d:0;b&&(g-=R+2*V+2*M+N);I&&(h+=(p+3)*w.length+2*Y+2*W);var z=g+V+.5,U=g+V+2*M+R+N+.5,D=h-Y-F+.5,_=h-Y+.5;e.roundRect(z,D,U,_,8*d,C,H,x,!0,y);mt(e,t,y,g+N,(D+_)/2,d,u.g,s);var K,O=D-.5+W+Z,J=z+M+N-.5;for(K=0;K<w.length;K++){var P=B[K];e.text(J,O,w[K],G,p,u.fb,y,u.ff||c,!1,P,!1,!1,J-1.5,O-p,U,_);O+=Z}if(b){z=U;S=-S;E=-E;L=-L}if(I){_=D;X=-X;T=-T}e.triangle(z+S,_,z+S+E,_,z+S,_+X,C,H,x,!0,y,0,!1);e.triangle(z+S+L,_-T,z+S+E+L,_-T,z+S+L,_+X-T,C,-1,x,!0,y,0,!1);e.setLayer(v)}}r.contains=function(e,n){var r=[],i=B(e,{sh:"box",x:0,y:0});function a(e,t){e&&r.push(t)}if(P(i))if("circle"===i.sh){var o=Math.min(i.w,i.h)/2;t(n,function(e){P(e)?"circle"===e.sh?a(Qn(i.x,i.y,o,e.x,e.y,Math.min(e.w,e.h)/2),e.id):a($n(i.x,i.y,o,e.x-e.w/2,e.y-e.h/2,e.x+e.w/2,e.y+e.h/2),e.id):a(Qn(i.x,i.y,o,e.x,e.y),e.id)})}else{var l={x1:i.x-i.w/2,y1:i.y-i.h/2,x2:i.x+i.w/2,y2:i.y+i.h/2};t(n,function(e){if(P(e))if("circle"===e.sh){var t=Math.min(e.w,e.h)/2;a(qn(l,e.x-t,e.y-t,e.x+t,e.y+t),e.id)}else a(qn(l,e.x-e.w/2,e.y-e.h/2,e.x+e.w/2,e.y+e.h/2),e.id);else a(jn(l,e.x,e.y),e.id)})}return r};var Rt=1;r.getResizePrimitive=function(){return xt};r.animated=function(){return!!Gt};r.generate=function(t,r,a,l,u,c,s,f,d,g,h,v,m,b,I,y){var p,C,x,G,w={isSelected:!1,isOpenCombo:!1,isInCombo:!1,isInBackground:!1,isTransient:!1,isParentTransient:!1,isRevealed:!1,isParentRevealed:!1};i=o;o=!1;var Z=y&&!i&&!a,B=new A;function R(e,t){var i=r[t];if(i){var a=n.privateFirstVisibleItemInAncestry(i.id1),o=n.privateFirstVisibleItemInAncestry(i.id2);!a||a._combo&&a._combo.open||B.set(a.id,!0);!o||o._combo&&o._combo.open||B.set(o.id,!0)}}v.forEach(R);if(xt&&(a||u.get(xt.id)===Y)){Ct=null;xt=null}function M(e,n){var i=e._parentId,a=!1;if(i){if(!n&&h(i)||m(i))return!0;var o=t[i]||r[i];o&&o._parentId&&(a=M(o))}i=e.id;var l=n&&v.has(i)||B.has(i)||b(i),u=!n&&h(i),c=!n&&m(i);return a||!l&&(u||c)}function W(e){var r,i,a,o=[],l=!1,u=!!e._combo,f=u&&e._combo.open,d=e._parentId||f;w.isOpenCombo=f;w.isInBackground=e.bg;w.isSelected=h(e.id);w.isInCombo=e._parentId;if(B.has(e.id)||b(e.id)){w.isRevealed=!0;B.set(e.id,!0);o.push(ci.REVEALED)}else w.isRevealed=!1;if(d){var v=n.privateGetAncestryIds(e.id);o.push(ci.COMBOS);r=!1;for(var m=0;m<v.length-1;m++){var I=v[m];o.push(I);var y=t[I];r||(r=y&&y._combo&&M(y));if(!w.isRevealed&&!i&&(i=B.has(I)||b(I))){w.isRevealed=!0;B.set(e.id,!0);o.unshift(ci.REVEALED)}}w.isParentTransient=!!r;w.isParentRevealed=!!i;f&&o.push(e.id)}else{o.push(ci.MAIN);w.isParentTransient=!1;w.isParentRevealed=!1}w.isRevealed||(l=!(!M(e)||!u&&P(e)))&&o.unshift(ci.TRANSIENT);w.isTransient=l;c.startGeneratingFor(e,Z,w.isInCombo||w.isOpenCombo);if(f)a=ci.COMBO_CONTAINER;else{a=P(e)?ci.SHAPES:ci.NODES;o.push(e.bg?ci.BG:ci.FG)}d&&!c.hasPath(o)&&c.createItemLayersAt(o,!0);c.setLayerPath(o);c.setLayer(a);lt(s,c,e,t,g,w)}function V(e){var i,a,o,l,u=[],f=e._parentId&&(e._combo||t[e._parentId]),d=r[e._parentId];w.isInBackground=e.bg;w.isSelected=h(e.id);w.isInCombo=!!e._parentId;w.isRevealed=v.has(e.id)||b(e.id)||B.has(e._parentId);if(!w.isRevealed)if(l=M(e,!0)){u.push(ci.TRANSIENT);w.isTransient=!0}else w.isTransient=!1;c.startGeneratingFor(e,Z,w.isInCombo);i=t[e.id1];a=t[e.id2];if(w.isRevealed){i=n.privateFirstVisibleItemInAncestry(e.id1);a=n.privateFirstVisibleItemInAncestry(e.id2);if(!i||!a||i===a&&i!==t[e.id1])return;u.push(ci.REVEALED)}if(f){for(var m=n.privateGetAncestryIds(e.id,!0),y=[],p=d?2:1,C=0;C<m.length-p;C++){var x=m[C];y.push(x);if(!l){var G=t[x];o||w.isRevealed||(o=G&&G._combo&&M(G));o&&u.unshift(ci.TRANSIENT)}}w.isParentTransient=o;if(y.length>0){u.push(ci.COMBOS);u=u.concat(y);c.hasPath(u)||c.createItemLayersAt(u)}else u.push(ci.MAIN)}else u.push(ci.MAIN);u.push(e.bg?ci.BG:ci.FG);c.setLayerPath(u);c.setLayer(ci.LINKS);Be(s,c,e,t,g,i,a,I,w)}Gt=null;pt=e.atanEasing(Date.now()%1e3/1e3);Rt=f.getUnzoom();if(a){c.removeAllItems();G=Object.keys(t);x=Object.keys(r);for(p=0,C=G.length;p<C;p++)W(t[G[p]]);for(p=0,C=x.length;p<C;p++)V(r[x[p]])}else{var S=[],X=function(e,n){var i=t[n];if(i)if(i._parentId||i._combo)W(i);else if(e===E){if(i._parentId){var a=ot(i,t);i._sx=a.x;i._sy=a.y}else{i._sx=i.x;i._sy=i.y}c.moveItem(i,i.x,i.y)}else{Z=!1;W(i)}else if(r[n])S.push(n);else{Z=!1;c.removeItem(n)}};u.forEach(X);if(l)for(p=0,C=(x=Object.keys(r)).length;p<C;p++)V(r[x[p]]);else{var k=function(e){V(r[e])};S.forEach(k)}}return{stillDirty:Gt,rebuildAll:i||!Z}};r.generateHandles=function(e,t,n,r){var i=e.getLayerPath();e.setLayerPath(null);e.startGeneratingForExtras();e.setLayer(ci.HANDLES);if(Ct&&1===r.size){or(e,t,n,Ct,1,Ct.id,z(),k);or(e,t,n,Ct,4,Ct.id,Bt.transparent,k)}e.setLayerPath(i)};return r}function Ii(e){var n={primitiveMover:function(n,r,i,a,o,l,u,c,s,f,d){if(!e.trigger("dragstart","resize",a,i.unscale(c),i.unscale(s),null)){var g=n.extents(r,o),h=o.r,v={},m={};t(o,function(e,t){m[t]=e});y();_t(m,.5);return{scrollable:!0,getCursor:function(){return l?"crosshair":"move"},generate:function(e){e.copyPrimitive(m)},dragMove:function(e,t,n,r){x(m,e,t,n,r)},endDrag:function(t,n,r,l,u){i.cancelScroll();var c=e.trigger("dragend","resize",a,i.unscale(n),i.unscale(r));p();if(!c&&t){x(o,n,r,l,u);d(o)}e.trigger("dragcomplete","resize",a,i.unscale(n),i.unscale(r))}}}function b(e,t){return{dx:i.undim(e-c),dy:i.undim(t-s)}}function I(e,t,n,r){var i,a={},o=e,l=t;if(u.length>0||f){a.x1=0;a.x2=0;a.y1=0;a.y2=0;for(var c=0;c<u.length;c++){var s="x"===(i=u[c]).charAt(0)?o:l;a[i]=s}if(n||f){0!==a.x1&&(a.x2=-a.x1);0!==a.x2&&(a.x1=-a.x2);0!==a.y1&&(a.y2=-a.y1);0!==a.y2&&(a.y1=-a.y2)}}else{r&&(l=0!==(o=Math.abs(o)>Math.abs(l)?o:0)?0:l);a.x1=o;a.x2=o;a.y1=l;a.y2=l}for(var d={},h=["x1","y1","x2","y2"],v=0;v<h.length;v++)d[i=h[v]]=g[i]+a[i];if(r){var m=g.x2-g.x1,b=g.y2-g.y1;if(Math.abs(m)>0&&Math.abs(b)>0){var I,y=b/m,p=d.x2-d.x1,C=d.y2-d.y1;if(Math.abs(o)>Math.abs(l)){var x=Math.floor(y*(m+p)-b)-C;if(f||n||!E(u,"y1")&&!E(u,"y2")){I=Math.floor(x/2);d.y1-=I;d.y2+=I}else{E(u,"y1")&&(d.y1-=x);E(u,"y2")&&(d.y2+=x)}}else{var G=Math.floor((b+C)/y-m)-p;if(f||n||!E(u,"x1")&&!E(u,"x2")){I=Math.floor(G/2);d.x1-=I;d.x2+=I}else{E(u,"x1")&&(d.x1-=G);E(u,"x2")&&(d.x2+=G)}}}}return d}function y(){m.wc&&(v.c=m.wc[3]);m.wfc&&(v.fc=m.wfc[3]);m.wbc&&(v.bc=m.wbc[3])}function p(){m.wc&&(m.wc[3]=v.c);m.wfc&&(m.wfc[3]=v.fc);m.wbc&&(m.wbc[3]=v.bc)}function C(e,t,n){return"1"===n.charAt(1)?h-("x"===n.charAt(0)?e:t):h+("y"===n.charAt(0)?t:e)}function x(e,t,r,i,a){var l,c=b(t,r);if("C"===o.p)if(u.length>1){var s=C(c.dx,c.dy,u[0]),f=C(c.dx,c.dy,u[1]);l=Math.abs(Math.min(s,f))}else l=Math.abs(C(c.dx,c.dy,u[0]));var d=I(c.dx,c.dy,i,a);n.setExtents(e,d.x1,d.y1,d.x2,d.y2,l)}},createHandDragger:function(n,r,i,a){var o={x:!0,y:!0},l=n.offsetX(),u=n.offsetY(),c=0,s=0,f=!1,d="hand",g=e.trigger("dragstart",d,null,n.unscale(r),n.unscale(i));if(g){if(!y(g)){a();return}t(g,function(e,t){o[t]=e})}function h(e,t){f=f||Math.abs(r-e)>10||Math.abs(i-t)>10;c=e-r;s=t-i;if(o){o.x||(c=0);o.y||(s=0)}}function v(){if(f){n.offsetX(l+c);n.offsetY(u+s);e.trigger("viewchange")}}return{rebuild:{drawOnly:!0},animate:v,direction:o,dragMove:h,getCursor:function(){return"move"},endDrag:function(t,r,i){var o=e.trigger("dragend",d,null,n.unscale(r),n.unscale(i));if(f){if(!o&&t)h(r,i);else{c=0;s=0}v()}else a();e.trigger("dragcomplete",d,null,n.unscale(r),n.unscale(i))}}},createDefaultDragger:function(n,r,i,a,o,l,u,c,s){var f={x:!0,y:!0,add:null,combos:!0},d=X(u),g=r[d],h="move",v=e.trigger("dragstart",h,d,l.unscale(c),l.unscale(s),k(u));if(v)if(Array.isArray(v))f.add=H(v);else{if(!y(v))return;t(v,function(e,t){f[t]=e});Array.isArray(f.add)&&(f.add=H(f.add))}if(f.combos){var m=o();if(m.length){f.add=f.add||{};m.forEach(function(e){f.add[e]=1})}}function b(e){return f.add&&f.add[e]}var I=l?l.viewToWorldX(c):c,p=l?l.viewToWorldY(s):s,C=Object.keys(r),x={};t(i,function(e,t){"h"===e.st&&(x[t]={y:e.y||0})});var G,w=S(c,s),Z={x:0,y:0},A=!0;g&&(G=g.w&&g.h);function B(){var e=w.dx-Z.x,r=w.dy-Z.y;Z.x=w.dx;Z.y=w.dy;var i=C.filter(function(e){return e!==d&&(a(e)||b(e))});a(d)&&(G?i.unshift(d):i.push(d));n.moveAllNodesBy(i,e,r);if(A){A=!1;n.setDirty(d)}n.drawInTransientLayer(i);t(x,function(e,t){(a(t)||b(t))&&n.moveLink(t,e.y+w.dy)})}function R(){var e=C.filter(function(e){return a(e)||b(e)});n.moveAllNodesBy(e,-Z.x,-Z.y);t(x,function(e,t){n.moveLink(t,e.y)})}var M,W,V=!1;function S(e,t){V=V||Math.abs(c-e)>10||Math.abs(s-t)>10;var n=l?l.viewToWorldX(e):e,r=l?l.viewToWorldY(t):t;if(f){f.x||(n=I);f.y||(r=p)}return{dx:V?n-I:0,dy:V?r-p:0}}return{rebuild:{positions:!0},scrollable:!0,direction:f,animate:B,generate:function(e){e.excludeHit(d)},getCursor:function(){return"move"},dragMove:function(e,t){w=S(e,t)},mouseMoved:function(e){e&&(M=!0);return M},afterDraw:function(t,n,r){M=!1;var i=X(t);if(d!==i)if(void 0===W)W=i;else if(i!==W){e.trigger("dragover",i,l.unscale(n),l.unscale(r),k(t));W=i}},endDrag:function(t,r,i){l.cancelScroll();if(e.trigger("dragend",h,X(u),l.unscale(r),l.unscale(i)))R();else if(t&&V){R();w=S(r,i);Z={x:0,y:0};e.trigger("prechange","move");B()}else R();n.setDirty(d);f.add&&Object.keys(f.add).forEach(n.setDirty);e.trigger("dragcomplete",h,X(u),l.unscale(r),l.unscale(i))}}},createLinkEndDragger:function(t,n,r,i,a,l,u,c,s){if(e.trigger("dragstart","dummy",s,r.unscale(u),r.unscale(c),null))return!1;var f=r?r.viewToWorldX(u):u,d=r?r.viewToWorldY(c):c,g=i[a[l]].x,h=i[a[l]].y;function v(e,t){n.moveNode(a[l],e,t)}var m,b,I=p(u,c),y=null;function p(e,t){var n=r?r.viewToWorldX(e):e,i=r?r.viewToWorldY(t):t;return{dx:n-f,dy:i-d}}function C(){return a["id1"===l?"id2":"id1"]}return{rebuild:{all:!0},scrollable:!0,animate:function(){v(g+I.dx,h+I.dy)},getCursor:function(){return"move"},dragMove:function(e,n){I=p(e,n);y=t.hittest(e,n,r)},mouseMoved:function(e){e&&(b=!0);return b},afterDraw:function(t,n,i){b=!1;var a=X(t),o=k(t);if(s===a){a=null;o=null}if(void 0===m)m=a;else if(a!==m){e.trigger("dragover",a,r.unscale(n),r.unscale(i),o);m=a}},endDrag:function(u,c,s){r.cancelScroll();if(!e.trigger("dragend","dummy",y,r.unscale(c),r.unscale(s)))if(u){v(g,h);e.trigger("prechange","move");y=X(y);if(i[y]&&y!==C()){var f=o(a);f[l]=y;delete f.off;n.removeItem([a[l],a.id]);t.merge([f])}else{I=p(c,s);v(g+I.dx,h+I.dy);y=null}}else v(g,h);e.trigger("dragcomplete","dummy",y,r.unscale(c),r.unscale(s))}}},createLinkDragger:function(n,r,i,a,o,l,u,c){if(e.trigger("dragstart","offset",c,i.unscale(l),i.unscale(u),k(c)))return!1;function s(e,t,n,r,i,a){return((n-e)*(t-a)-(e-i)*(r-t))/Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}var f={},d={},g={};a.privateSelection().forEach(function(e,t){if(t){var n=a.getByID(t);if(n&&"link"===n.type){f[t]=n.off||0;d[t]=n.off||0;g[t]=!0}}});var h=!1;function v(e,t,r){var a=e===o,l=a?i.viewToWorldX(t):t,u=a?i.viewToWorldY(r):r,c=n(1,e),h=n(2,e),v=s(c.x,c.y,h.x,h.y,l,u);g[e.id]&&Math.abs(v-f[e.id])>8&&(g[e.id]=!1);if(!g[e.id]){Math.abs(a?v:v+f[e.id])<12&&(v=a?0:-f[e.id]);d[e.id]=a?v:v+f[e.id]}}function m(e){a.setLinkOffset(e,d[e])}return{rebuild:{all:!0},scrollable:!0,animate:function(){t(d,function(e,t){m(t)})},getCursor:function(){return"move"},dragMove:function(e,r){var c=i.viewToWorldX(e)-i.viewToWorldX(l),s=i.viewToWorldY(r)-i.viewToWorldY(u);t(d,function(t,i){var l=a.getByID(i);if(l)if(l===o){v(l,e,r);h=!0}else{var u=n(1,l),f=n(2,l),d=(u.x+f.x)/2,g=(u.y+f.y)/2;v(l,d+c,g+s)}})},endDrag:function(n,r,o){i.cancelScroll();if(!e.trigger("dragend","offset",c,i.unscale(r),i.unscale(o))&&a.getByID(c))if(n&&h){t(f,function(e,t){a.getByID(t).off=e});e.trigger("prechange","offset");t(d,function(e,t){a.getByID(t).off=e})}else{t(d,function(e,t){d[t]=f[t]});this.animate()}e.trigger("dragcomplete","offset",c,i.unscale(r),i.unscale(o))}}}};return n}function yi(e,t){var n=e.x-t.x,r=e.y-t.y,i=1e-6;return Math.sqrt(n*n+r*r)<e.r-t.r+i}function pi(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,l=t.r,u=a-n,c=o-r,s=l-i,f=Math.sqrt(u*u+c*c);return{x:(n+a+u/f*s)/2,y:(r+o+c/f*s)/2,r:(f+i+l)/2}}function Ci(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,l=t.y,u=t.r,c=n.x,s=n.y,f=n.r,d=2*(r-o),g=2*(i-l),h=2*(u-a),v=r*r+(i*i-a*a-o*o-l*l)+u*u,m=2*(r-c),b=2*(i-s),I=2*(f-a),y=r*r+(i*i-a*a-c*c-s*s)+f*f,p=m*g-d*b,C=(g*y-b*v)/p-r,x=(b*h-g*I)/p,G=(m*v-d*y)/p-i,w=(d*I-m*h)/p,Z=x*x+w*w-1,A=2*(C*x+G*w+a),B=C*C+G*G-a*a,R=(-A-Math.sqrt(A*A-4*Z*B))/(2*Z);return{x:C+x*R+r,y:G+w*R+i,r:R}}function xi(e,t){switch(t.length){case 0:return{x:0,y:0,r:0};case 1:return e[t[0]];case 2:return pi(e[t[0]],e[t[1]]);case 3:return Ci(e[t[0]],e[t[1]],e[t[2]]);default:throw new Error("invalid number of circles")}}function Gi(e){if(0===e.length)return null;for(var t=e.length,n={prev:null,i:0,R:[],c:null};;){var r=n.i,i=n.R,a=n.prev,o=n.c;if(r===t||3===i.length){a.c=xi(e,i);n=a}else if(null===o)n={prev:n,i:r+1,R:i,c:null};else if(yi(o,e[r])){if(null===a)return o;a.c=o;n=a}else n={prev:n,i:r+1,R:i.concat([r]),c:null}}}var wi=Object.freeze({radialExtents:Gi});function Zi(){var e=K,n=vi,r=mi,i=3,a=function(t,n,i,a,l){var u,d,g,h,v,m,b=t.e||1,I=t.w&&t.h,y=I&&"circle"===t.sh,p=!1;if(t.du)return{radius:10,baseRadius:10,borderSize:10,width:10,height:10};h=c(t);t._combo&&(p="boolean"==typeof l?l:t._combo.open);if(p){g=t.oc.w/2;m=v=t.oc.w;u=g+(h=t.oc&&"bw"in t.oc?t.oc.bw:kr.bw)}else if(I)if(y){var C=Math.min(t.w,t.h);m=v=C+2*h;u=(g=C/2)+h}else{g=e(t.w,t.h)/2;v=t.w+2*h;m=t.h+2*h;u=e(v,m)/2}else{m=v=2*(g=r*b)+2*(h*=b);u=g+h}if(i&&t.t&&t.t.length>0){var x,G=s(t,n,u,a),w=G.width,Z=G.height,A=o(t,p);v=Math.max(w,v);var B=e(w/2,m/2+Z/2);d=Math.max(B,u);if(A){m=Math.max(Z,m);u=Math.max(u,e(w/2,Z/2))}else{x=e(w/2,m/2+Z);u=Math.max(x,u);m=Z+m}}else{var R=0;if(t.t){R=(f(t,a).length+1)*((t.fs||En)*(t.e||1))}d=u+R/2}return{legacyRadius:Math.round(d),radius:Math.round(u),baseRadius:Math.round(g),borderSize:Math.round(h),width:Math.round(v),height:Math.round(m)}};function o(e,t){return!t&&("boolean"==typeof e.tc?e.tc:!e.w&&(!e.u&&!e.fi))}function l(e){return o(e,e._combo&&e._combo.open)}var u=function(e,t){var n=0;if(e.t){var r=e.fs||En,a=e.e||1;if(!l(e)){n=(r+i)*a*f(e,t).length/2}}return Math.round(n)};function c(e){var t=0;e.b&&(t=h(e.bw)?e.bw:n);!e.donut||e._combo&&e._combo.open||(t=e.donut.w+2*e.donut.bw);return t}function s(e,t,n,r){var a=0,o=0;if(e.t){var l=e.e||1,u=(e.fs||En)*l,c=i*l,s=f(e,r);a=g(d(s,t,u,e.fb,e.ff));o=(u+c)*s.length;e.u||e.c||e.bc||e.w&&e.h||(a=Math.max(a/10,n))}return{width:a,height:o}}function f(e,t){if(e.t){var n=e.t;if(void 0!==t&&n.length>t){n=n.substring(0,Math.max(0,t-3));n+="..."}return n.split(/\r\n|\r|\n/)}return[""]}function d(e,t,n,r,i){for(var a=[],o=0;o<e.length;o++)a[o]=pr(t,e[o],n,r,i||"sans-serif").width;return a}function g(e){for(var t=0,n=0;n<e.length;n++)t=Math.max(t,e[n]);return t}return{labelOffset:u,nodeSize:a,getExtents:function(n,r,i,o,l,c){var s,f,d,g,h,v,m,b,I=Math.max(0,0|i),y={},p=0,C={},x=0,G=l||{x:0,y:0};t(n,function(e){if(void 0!==e.x){var t;if(void 0!==e.size)t=e.size;else if(void 0!==e.r){t=e.r;x=e.labelOffset}else{t=a(e,r,o,c).radius;x=u(e,c)}C[e.id]={size:t,labelOffset:x};f=e.x-t;g=e.y-(t+x);v=e.x+t;b=e.y+(t-x);if(void 0===s){s=f;d=g;h=v;m=b}else{s=Math.min(f,s);d=Math.min(g,d);h=Math.max(v,h);m=Math.max(b,m)}}});y.x1=s-(I+G.x);y.y1=d-(I+G.y);y.x2=h+(I-G.x);y.y2=m+(I-G.y);y.w=h-s+2*I;y.h=m-d+2*I;t(n,function(t){if(void 0!==t.x){var n=C[t.id],r=t.x-G.x,i=t.y-G.y,a=e(r,i+n.labelOffset);p=Math.max(p,a+n.size)}});y.r=Math.round(p+I);return y},radialExtents:function(e,n,r,i,o){var l=[],u=void 0===r?0:r;t(e,function(e){var t=void 0!==e.r?e.r:a(e,n,i,o).radius;t+=u;if(!isFinite(e.x)||!isFinite(e.y)||!isFinite(t))throw new Error("Inputs must be finite");l.push({x:e.x,y:e.y,r:t})});return wi.radialExtents(l)}}}function Ai(){var e=function(e,t){if(e.r===t.r){if(e.t){if(!t.t)return-1;if(e.t<t.t)return-1;if(e.t>t.t)return 1}else if(t.t)return 1;return e.id===t.id?0:e.id<t.id?-1:1}return e.r<t.r?1:-1};return{compareCircles:e,concentricLayout:function(t,n){var r,i=t;if(!i||0===i.length)return i;var a=B(n,{padding:8,radialPadding:0}),o=a.padding,l=0;i.sort(e);var u=[],c=0,s=(i=i.map(function(e){return{id:e.id,r:e.r+o,x:e.x,y:e.y,labelOffset:e.labelOffset}}))[l++];if(1===i.length)d();else if(2===i.length)h();else if(3===i.length)m();else if(4===i.length)v();else if(i.length>4){var f=i[0].r;i[2].r/f>.5&&i.length>10?m():i[1].r/f>.5&&i.length>10?h():d();r=Math.abs(i[0].y-i[0].r)+a.radialPadding;s=i[l++];for(;s;)I();y(u);g()}function d(){i[0].x=0;i[0].y=-i[0].labelOffset}function g(){var e=i[0],t=i[0];i.forEach(function(n){n.y<e.y?e=n:n.y>e.y&&(t=n)});var n=(Math.abs(e.y-e.r)-(Math.sqrt(t.x*t.x+t.y*t.y)+t.r))/4;i.forEach(function(e){e.y+=n})}function h(){var e=s,t=i[l++];e.x=0;e.y=-t.r-e.labelOffset;t.x=0;t.y=e.r-t.labelOffset}function v(){var e=s,t=i[l++],n=i[l++],r=i[l++];if(t.r===n.r&&n.r===r.r){t=i[2];n=i[1]}var a=e.r+n.r,o=e.r,u=Math.sqrt(a*a-o*o),c=e.r-t.r;e.x=-t.r;e.y=-e.labelOffset;t.x=e.r;t.y=0-t.labelOffset;n.x=c;n.y=-u-n.labelOffset;r.x=c;r.y=u-r.labelOffset}function m(){var e=s,t=i[l++],n=i[l++],r=2*e.r+o,a=Math.sqrt(r*r-r/2*(r/2)),u=(e.r-t.r)/2;e.x=0;e.y=2/3*-a+u;t.x=r/2;t.y=a*(1/3)-t.labelOffset+u;n.x=-r/2;n.y=a/3-n.labelOffset+u}function b(e){return 2*e.r+o}function I(){c+=s.r+r+a.radialPadding;r=s.r;var e=2*Math.PI*c,t=e-b(s),n={items:[],radius:c,spaceLeft:0,circumference:e};u.push(n);for(;s&&t>0;){n.items.push(s);(s=i[l++])&&(t-=b(s))}s&&(t+=b(s));n.spaceLeft=t;if(s&&i.length-l<5){for(var o=0;s;){o+=b(s);n.items.push(s);s=i[l++]}n.radius=(e-t+o)/(2*Math.PI);n.circumference=2*Math.PI*n.radius;n.spaceLeft=0}}function y(){u.forEach(function(e){var t=2*Math.PI/(e.circumference-e.spaceLeft),n=0,r=t*e.items[0].r,i=Math.PI/2;e.items.forEach(function(a){var o=t*a.r,l=n+o;a.x=e.radius*Math.cos(l-i-r);a.y=e.radius*Math.sin(l-i-r)-a.labelOffset;n+=t*b(a)})})}return i}}}function Bi(e){var n,r,i,a,o,l,u,c,s,f,d,g={},h=3,v=.5,m=mi,b=[],I=[],y=[],p=[],C=[],x=[];function G(e,t){var n;function r(e,t,n,r,i){return{isLeaf:!0,children:[],points:[],x1:e,y1:t,x2:n,y2:r,depth:i}}function i(e){return e.depth>=t}function a(e,t){var n,i,a,o,l=.5*(e.x1+e.x2),u=.5*(e.y1+e.y2);if(0===t||1===t){a=e.y1;o=u}else{a=u;o=e.y2}if(0===t||2===t){n=e.x1;i=l}else{n=l;i=e.x2}e.isLeaf=!1;e.children[t]=r(n,a,i,o,e.depth+1)}function o(e,t){t(e);for(var n=0;n<4;n++)e.children[n]&&o(e.children[n],t)}function l(e,t){if(t.x<e.x1||t.y<e.y1||t.x>e.x2||t.y>e.y2)throw Error("[Layout] Error: the point is out of range.");if(i(e))e.points.push(t);else{e.points.push(t);var n,r=.5*(e.x1+e.x2),o=.5*(e.y1+e.y2);t.x<r&&t.y<o&&(n=0);t.x>=r&&t.y<o&&(n=1);t.x<r&&t.y>=o&&(n=2);t.x>=r&&t.y>=o&&(n=3);e.children[n]||a(e,n);l(e.children[n],t)}}var u=[],c=[];for(n=0;n<e.length;n++){u.push(e[n].x);c.push(e[n].y)}var s=Math.min.apply(0,u),f=Math.max.apply(0,u),d=Math.min.apply(0,c),g=Math.max.apply(0,c),h=f-s,v=g-d;h>v?g=d+h:f=s+v;var m=r(s,d,f,g,0);m.addPoint=function(e){l(m,e)};m.visit=function(e){o(m,e)};for(n=0;n<e.length;n++)m.addPoint(e[n]);return m}function w(e,t){return Math.sqrt(e*e+t*t)}function Z(){var e=[];t(f,function(t,n){e.push({id:n,x:C[i[n]],y:x[i[n]]})});var n=G(e,h);b.length=0;I.length=0;function r(e){function t(t){if(t.isLeaf){var n,a=e.x-.5*(t.x1+t.x2),o=e.y-.5*(t.y1+t.y2),l=w(a,o),u=(t.x2-t.x1)/l,c=t.points,s=c.length;if(u>v){for(n=0;n<s;n++)if(e.id!==c[n].id){var f=e.x-c[n].x,d=e.y-c[n].y,g=Math.max(.001,w(f,d));r+=f/g;i+=d/g}}else{r+=s*a/l;i+=s*o/l}}}var r=0,i=0;n.visit(t);b.push(r);I.push(i)}for(var a=0;a<e.length;a++)r(e[a]);S(b,I)}function A(e,t,n){for(var r=t,i=W(e,M(V(t,n),-1)),a=i.slice(),l=R(i,i),u=0;u<20&&l/o>.01;u++){var c=V(a,n),s=l/R(c,a);r=W(r,M(a,s));var f=W(i,M(c,-s));i=f;var d=R(f,f),g=d/l;l=d;a=W(f,M(a,g))}return r}function B(){var e;for(e=0;e<o;e++){y[e]=[];p[e]={};p[e][e]=!0;for(var t=0;t<o;t++)y[e][t]=0}for(e=0;e<a.length;e++){var n=a[e],r=i[n.id1],l=i[n.id2];p[r][l]=!0;p[l][r]=!0;y[r][l]-=1;y[l][r]-=1;y[r][r]+=1;y[l][l]+=1}}function R(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function M(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]*t);return n}function W(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]+t[r]);return n}function V(e,n){var r,i=[],a=0;for(r=0;r<o;r++){a=0;t(p[r],function(t,n){a+=y[r][n]*e[n]});i.push(a)}i=M(i,n);a=0;for(r=0;r<o;r++)a+=e[r];var l=[];for(r=0;r<o;r++)l.push(o*e[r]-a);return W(i,l)}function S(e,t){var n,r=0,i=0;for(n=0;n<e.length;n++){r+=e[n];i+=t[n]}r/=e.length;i/=e.length;for(n=0;n<e.length;n++){e[n]-=r;t[n]-=i}}function X(e,t,n){for(var r=0;r<t;r++){s+=1/(l+u+1);e.trigger("progress","layout",s);Z(C,x);C=A(b,C,n);x=A(I,x,n);S(C,x)}}function k(t,s){var g,h;d=Object.keys(f);i={};C.length=0;x.length=0;y.length=0;p.length=0;var v=0,b=e(t.tightness);b=2-2*b/10+1;for(h=0;h<d.length;h++){g=d[h];v+=Math.max(1,f[g].size);i[g]=h}c=42*Math.sqrt(o)*b;c*=1+.02*(v/o-m);if(a.length/o<1){var I=.65,G=a.length/o;c*=I+G*(1-I)}for(h=0;h<d.length;h++){C.push(c*s.next());x.push(c*s.next())}n=500*(r=o/50);l=8;u=8}function E(e){function t(e,t){return Math.atan2(e,t)||0}function n(e,t,n){var r=e,i=r*Math.cos(t),a=r*Math.sin(t);f[n].x=c*i;f[n].y=c*a}function r(e){var r=C[i[e]],a=x[i[e]];n(w(r,a),t(r,a),e)}e.forEach(r)}g.lens=function(e,t,i,c,g,h){s=0;e.trigger("progress","layout",s);f=t.v;a=t.e;var v=[];if((o=t.vcount)>1){k(i,g);B();X(e,l,n);X(e,u,r);E(d)}return c(e,f,{},t.extents,v,i,h)};return g}function Ri(e){var n=Zi(),r={},i=Math.pow(10,-3.8),a=27,l=1.35,u=Math.pow(a,l);function c(e,t,n,r,i,a,o,l,u,c){var s=i[o];if(!(s in n)){if(!(s in r))throw new Error("link has end which is not in nodes list");var d=r[s];if(d.hi)throw new Error("link has end which is hidden");n[s]=f(e,t,d,s,l,u,c)}return s}function f(t,r,i,a,o,l,u){var c;if(l){var s=e.options().truncateLabels;c=s?s.maxLength:void 0}var f=n.nodeSize(i,r,l,c);return{id:a,x:i.x,y:i.y,size:u?f.legacyRadius:f.radius,fixed:!!o&&a in o,lc:0,d:i.d,w:f.width,h:f.height,labeloff:n.labelOffset(i)}}function d(e,t){return e.fixed&&!t.fixed?-1:t.fixed&&!e.fixed?1:0}function g(e,n,r,i,a,o,l,u,s){for(var d=a().connections({all:!1,combos:s}),g={},h=[],v=0;v<d.length;v++){var m=d[v][0],b=i[m],I=c(e,n,g,r,b,m,"id1",o,l,u),y=c(e,n,g,r,b,m,"id2",o,l,u);if(null!==I&&null!==y){var p,C=[{id:m,sign:1,off:b.off}],x=b.w||1;for(p=1;p<d[v].length;p++){b=i[m=d[v][p]];C.push({id:m,sign:b.id1===I?1:-1,off:b.off});x=Math.max(x,b.w||1)}h.push({id1:I,id2:y,id:m,arrowSize:e.arrowLength(x,1),links:C,numLinks:C.length});g[I].lc+=1;g[y].lc+=1}}t(r,function(t,r){if(!t.hi&&(s||!t._parentId)&&!g[r]){var i=f(e,n,t,r,o,l,u);g[r]=i}});var G=Object.keys(g).length;return{v:g,e:h,vcount:G}}function v(e,t,n){var r,i,a,o,l,u=n().privateDisjointSet(e,t),c=u.vertexGroups,s=u.groupIndex;for(r=0;r<c.length;r++){var f=c[r],d={};for(l=0;l<f.length;l++){(i=e[f[l]]).c=r;d[f[l]]=i}c[r]={verts:d,edges:[],extents:m(d)}}for(r=0;r<t.length;r++){a=s[(o=t[r]).id1];o.c=a;c[a].edges.push(o)}return c}r.extractStructure=function(e,t,n,r,i,a,o,l,u){var c=null;if(a){c={};for(var s=0;s<a.length;s++)c[a[s]]=1}var f=g(e,t,n,r,i,c,o,l,u);f.extents=m(f.v);return f};function m(e){var n,r,i,a,o=0;t(e,function(e){n=R(n)?Math.min(n,e.x-e.size):e.x-e.size;r=R(r)?Math.min(r,e.y-e.size):e.y-e.size;i=R(i)?Math.max(i,e.x+e.size):e.x+e.size;a=R(a)?Math.max(a,e.y+e.size):e.y+e.size;o++});return{x1:n,y1:r,x2:i,y2:a,c:o}}var b="_dummy",I=RegExp("^"+b);function y(e){return I.test(e.id)}function p(e,n,r,i,a,o,l){var u,c,s,f={},d={},g={},v=[],m={},I={},y=i(),p=l;for(u=0;u<a.length;u++){g[u]={};m[u]=[];var C=[],x=1/0;t(a[u].verts,function(e,t){if(e.d&&h(e.d[r])){s=e.d[r];if(!g[u][s]){g[u][s]=[];m[u].push(s)}g[u][s].push(t);I[t]=s;if(s<x){x=s;C=[t]}else s===x&&C.push(t)}else if(o)throw new Error("Sequential Layout: Node is missing valid level data.")});if(0===C.length){var G=Object.keys(a[u].verts)[0];C.push(G);I[G]=0;g[u][0]=[G];m[u].push(0)}m[u].sort(function(e,t){return e-t});var w=[];for(c=0;c<m[u].length;c++){var Z=m[u][c];w=[];var A,B,R=y.neighbours(g[u][Z]),M=((m[u][c+1]||Z+1)+Z)/2;for(B=0;B<R.nodes.length;B++){A=R.nodes[B];if(W(I[A])){w.push(A);I[A]=M}}if(w.length){m[u].splice(c+1,0,M);g[u][M]=w}}if(!o)for(c=0;c<C.length;c++){f[C[c]]=1;e[C[c]].level=0}d[u]=C}if(o){for(u=0;u<a.length;u++)for(c=0;c<m[u].length;c++)-1===v.indexOf(m[u][c])&&v.push(m[u][c]);v.sort(function(e,t){return e-t});for(u=0;u<a.length;u++)for(c=0;c<v.length;c++)g[u][v[c]]=c;p=p||[]}else for(u=0;u<a.length;u++)for(c=0;c<m[u].length;c++)g[u][m[u][c]]=c;var V,S,k,E,Y,F,H,L,T=0,N={};function z(t){var n=t.origId||t.id,r={id:b+n+"-"+T++,level:t.level-1,origId:n,x:0,y:0,c:t.c,size:10,fixed:!1,lc:t.lc,du:!0,w:20,h:20,labeloff:0};e[r.id]=r;a[t.c].verts[r.id]=r;N[r.id]=1;return r}function U(e,t,r){var i={id:b+t.id+"-"+r.id,id1:t.id,id2:r.id,c:e.c,numLinks:e.numLinks};"level"in t&&"level"in r&&(i.level=Math.max(t.level,r.level));n.push(i);a[e.c].edges.push(i);return i}function D(e,t,n){var r=z(e),i=n.id1===t.id;U(n,i?r:e,i?e:r);r.level===t.level+1?U(n,i?t:r,i?r:t):D(r,t,n)}function _(e,t,n){if(e.level>0){var r=z(e);U(n,e,r);U(n,r,t)}if(e.level<v.length-1){var i=z(e);i.level+=2;U(n,e,i);U(n,i,t)}}for(var K=0,O=n.length;K<O;K++){S=X((V=n[K]).id1);k=X(V.id2);E=e[S];Y=e[k];E.level=g[E.c][I[S]];Y.level=g[Y.c][I[k]];var J=E.level,P=Y.level;if(h(J)&&h(P)){V.level=Math.max(J,P);if(J<P){N[Y.id]=1;L=E;H=Y}else if(P<J){N[E.id]=1;L=Y;H=E}}if((F=Math.abs(J-P))>1)D(H,L,V);else if(o&&0===F){_(E,Y,V);p.push(V)}}if(o)for(u=0;u<a.length;u++){var j=d[u][0];1!==d[u].length||e[j].level||(e[j].level=g[u][I[j]])}else t(e,function(t,n){if(!N[n]&&!f[n]){for(var r,i=d[e[n].c],a=1/0,o=0;o<i.length;o++){var l=y.shortestPaths(n,i[o]);if(l.distance<a){r=l;a=l.distance}}for(var u=0;u<r.one.length;u++){var c=r.one[u],s=e[c];if(s&&"level"in s&&s.level<t.level){var g=U(t,t,s);t.level-s.level>1&&D(t,s,g);break}}}});return n}function C(e,n,r,i){for(var a,o,l,u,c=i(),s=0;s<r.length;s++){var f=c.distances(r[s]);t(f,function(t,n){"level"in e[n]||(e[n].level=1/0);e[n].level=Math.min(e[n].level,t)})}for(var d=0;d<n.length;d++){a=n[d].id1;o=n[d].id2;l=e[a];u=e[o];"level"in l&&"level"in u&&(n[d].level=Math.max(l.level,u.level))}}function x(e,n){var r={};function i(e,t,n,i){r[e]=r[e]||[];r[e][t]=r[e][t]||{};r[e][t][n]=r[e][t][n]||[];r[e][t][n].push(i)}t(e,function(e,t){"level"in e&&i(e.c,e.level,"vertices",t)});for(var a=0;a<n.length;a++)"level"in n[a]&&i(n[a].c,n[a].level,"edges",n[a]);return r}function G(e,n){var r={};function i(e,t,n,i){r[e]=r[e]||[];r[e][t]=r[e][t]||{vertices:[],edges:[]};for(var a=0;a<t;a++)r[e][a]=r[e][a]||{vertices:[],edges:[]};r[e][t][n]=r[e][t][n]||[];r[e][t][n].push(i)}t(e,function(e,t){"level"in e&&i(e.c,e.level,"vertices",t)});for(var a=0;a<n.length;a++)"level"in n[a]&&1===Math.abs(e[n[a].id1].level-e[n[a].id2].level)&&i(n[a].c,n[a].level,"edges",n[a]);return r}var w=q();r.layout=function(e,n,r,i,a,o){n.trigger("prechange","layout");var l="^(standard|hierarchy|lens|sequential";l+="|radial|structural|tweak";l+=")$";if(!new RegExp(l).test(e))throw new Error("The layout name is not valid.");var u=H(["standard","structural"]);w.setSeed(null);if(u[e]||a.consistent){var c=Z(a.fixed||[]),s=H(a.fixed),f=0,d=0;if(c.length){t(s,function(e,t){if(t in r.v){f+=r.v[t].x;d+=r.v[t].y}});f/=c.length;d/=c.length}t(r.v,function(e,t){if(!s[r.v[t].id]){r.v[t].x=f;r.v[t].y=d}})}a.consistent&&w.setSeed(900736044081);switch(e){case"standard":Q(n,r,i,a,o);break;case"hierarchy":T(n,r,i,a,o);break;case"lens":return Bi(V).lens(n,r,a,te,w,o);case"sequential":L(n,r,i,a,o);break;case"structural":Ie(n,r,i,a,o);break;case"radial":T(n,r,i,a,o,O);break;case"tweak":ie(n,r,a,o)}};function A(e,t){for(var n=[],r=Z(e),i=0;i<r.length;i++)t[r[i]]&&n.push(r[i]);return n}function V(e){var t=Number(e);t=h(t)?t:5;t=Math.max(0,t);return t=Math.min(10,t)}function S(e){return 10*(5-V(e))}function k(e){var n=0,r=0;t(e,function(e){if("level"in e&&!y(e.id)){n+=e.size;r+=1}});return n/r}function E(e){var n=0;t(e,function(e){n=Math.max(n,e.length)});return n}function F(e,n){for(var r=[],i=E(e),a=0;a<i;a++){var o=0,l=0,u=0,c=0,s=0;t(e,function(e){if(e[a]){for(var t=e[a].vertices,r=0;r<t.length;r++){var i=t[r],u=n[i].size;l+=u;o=Math.max(o,u)}c+=t.length}});u=l/c;var f=r[a-1];f&&o<f.max+f.yOffset&&(s=(f.max+f.yOffset)/2);r[a]={max:o,average:u,sum:l,yOffset:s}}return r}function L(e,n,r,i,a){var l=B(i,{top:[],orientation:"down",spacing:"auto"}),u=l.level,c=50+S(l.tightness),s=l.orientation.match(/down|up/)?"w":"h",f=l.orientation.match(/down|up/)?"h":"w",d=n.v,g=n.e,h=v(d,g,r),b=[];if(!u)throw new Error("Sequential Layout: LayoutOptions is missing valid level property.");g=p(d,g,u,r,h,!0,b);var I,C,x,w=G(d,g);K();T();function Z(e,t,n,r){var i,a,o,l,u,c,s=!0,f=-1;for(i=0;i<n.length;i++){var g=n[i];if(!r&&d[g].barycenter===1/0){s=!1;break}var h=0,v=0;for(a=0;a<t.length;a++){l=-1;g===t[a].id1?l=t[a].id2:g===t[a].id2&&(l=t[a].id1);if(-1!==l)if(d[l].barycenter===1/0)s=!1;else{v++;-1!==(u=e.indexOf(l))&&(h+=u)}}d[g].prevPos=i;c=!0;v>0?d[g].barycenter=h/v:d[g].barycenter===1/0?s=!1:0===i?d[g].barycenter=0:c=!1;if(c){if(f+1<i){var m=n[f],b=Math.min(d[g].barycenter,d[m].barycenter),I=Math.abs(d[g].barycenter-d[m].barycenter)/(i-f);for(o=1;o<i-f;o++)d[n[f+o]].barycenter=b+I*o}f=i}}n.sort(function(e,t){return d[e].barycenter===d[t].barycenter?d[e].prevPos-d[t].prevPos:d[e].barycenter-d[t].barycenter});return s}function A(e,t,n){e.sort(function(e,r){
var i=Math.max(t.indexOf(e.id1),t.indexOf(e.id2)),a=Math.max(n.indexOf(e.id1),n.indexOf(e.id2)),o=Math.max(t.indexOf(r.id1),t.indexOf(r.id2)),l=Math.max(n.indexOf(r.id1),n.indexOf(r.id2));return i<o||i===o&&a<l?-1:1})}function W(e,t){var n,r;if(t<1||e.length<=t)return 0;n=e[t].edges;(r=[e[t-1].vertices,e[t].vertices]).sort(function(e,t){return e.length-t.length});return V(n,r[1],r[0])}function V(e,t,n){var r,i,a,o,l;if(e.length<2)return 0;A(e,t,n);r=e.map(function(e){var t=n.indexOf(e.id1);-1===t&&(t=n.indexOf(e.id2));return{index:t,multiplier:-1===t?0:e.numLinks}});i=1;for(;i<r.length;)i*=2;a=new Array(2*i-1);for(var u=0;u<a.length;u++)a[u]=0;i-=1;o=0;for(var c=0;c<r.length;c++){a[l=r[c].index+i]+=r[c].multiplier;for(;l>0;){l%2&&(o+=a[l+1]*r[c].multiplier);a[l=Math.floor((l-1)/2)]+=r[c].multiplier}}return o}function X(e,t,n,r){var i,a=o(t),l=[];a.forEach(function(t){l.push(t.id1===e?t.id2:t.id1)});r.forEach(function(e){a.push(e);i=e.id1===n?e.id2:e.id1;-1===l.indexOf(i)&&l.push(i)});return{verts:l,edges:a,common:t.length===r.length&&t===a.length}}function k(e,t){return X(e,d[e].childEdges||[],t,d[t].childEdges||[])}function Y(e,t){return X(e,d[e].parentEdges||[],t,d[t].parentEdges||[])}function H(e,t){var n,r,i,a,o,l,u=1,c=e[t].vertices,s=0,f=[],g=[];t>0&&(f=e[t-1].vertices);t<e.length-1&&(g=e[t+1].vertices);var h=0;for(n=0;n<c.length-1;n+=u){o=0;l=0;if(t>0){if(!(i=Y(c[n],c[n+1])).common){i.verts.sort(function(e,t){return f.indexOf(e)-f.indexOf(t)});if(i.verts.length>1){o+=V(i.edges,i.verts,[c[n],c[n+1]]);l+=V(i.edges,i.verts,[c[n+1],c[n]])}}}else i={common:!0};if(t<e.length-1){if(!(a=k(c[n],c[n+1])).common){a.verts.sort(function(e,t){return g.indexOf(e)-g.indexOf(t)});if(a.verts.length>1){o+=V(a.edges,a.verts,[c[n],c[n+1]]);l+=V(a.edges,a.verts,[c[n+1],c[n]])}}}else a={common:!0};i.common&&a.common&&(d[c[n+1]].swapBlockStart=d[c[n]].swapBlockStart||n);if(l<o){var v=d[c[n]].swapBlockStart||n;r=c[v];c[v]=c[n+1];c[n+1]=r;d[c[v]].swapBlockStart=v;d[c[n+1]].swapBlockStart=v+1;s+=o-l;if(1===u){h=Math.max(h,n);u=-1}if(0===(n=v)){n=h;u=1}}else if(-1===u){n=h;u=1}}return s}function L(e){var t,n;do{n=0;for(t=0;t<e.length;t++)n+=H(e,t)}while(n>0)}function T(){var e,n,r,i,a,l,u,c,s=!0;t(w,function(t,f){c=0;l=void 0;u=t.length;for(e=0;e<t.length;e++)if(t[e].vertices.length>0){u=e;break}if(u!==t.length-1){t[u].vertices.sort(function(e,t){return d[t].childEdges.length-d[e].childEdges.length});d[t[u].vertices[0]].barycenter=0;a=1/0;do{n=a;if(i){a=0;l=o(t)}else a=1/0;for(e=u;e<t.length-1;e++){r=Z(t[e].vertices,t[e+1].edges,t[e+1].vertices,!0);if(s){Z(t[e+1].vertices,t[e+1].edges,t[e].vertices,!1);r=Z(t[e].vertices,t[e+1].edges,t[e+1].vertices,!1)}}i=r;for(e=t.length-1;e>u;e--){r=Z(t[e].vertices,t[e].edges,t[e-1].vertices,e<c+2);if(s){Z(t[e-1].vertices,t[e].edges,t[e].vertices,!1);r=Z(t[e].vertices,t[e].edges,t[e-1].vertices,!1)}else a+=W(t,e);r||(i=!1)}s=!i}while(c++<100&&(a===1/0||a<n));l&&(w[f]=l);a>0&&g.length<1e4&&L(w[f])}})}function N(e,t,n){return e[n]&&e[n].edges?e[n].edges.filter(function(e){return e.id1===t||e.id2===t}):[]}function K(){var e,n;t(w,function(t){for(e=0;e<t.length;e++){var r=t[e].vertices;for(n=0;n<r.length;n++){var i=r[n];d[i].barycenter=1/0;d[i].childEdges=N(t,i,e+1);d[i].parentEdges=N(t,i,e)}}})}function O(){var e,n;t(w,function(t){for(e=0;e<t.length;e++){var r=t[e].vertices;for(n=0;n<r.length;n++){var i=r[n];d[i].orderPos=n;d[i].children=z(w,d,i);d[i].parents=U(w,d,i)}}})}function J(e,t,n,r){var i,a,o=t,l=t.filter(function(e){return y({id:e})});l.length>0&&(o=l);a=o.length;e.root=e;e.align=e;if(a>0){var u=[Math.floor((a+1)/2)-1,Math.ceil((a+1)/2)-1];for(i=0;i<2;i++){var c=n?u[i]:u[1-i],s=d[o[c]],f=s.orderPos;if(n&&r<f||!n&&r>f){s.align=e;e.root=s.root;e.align=e.root;return f}}}return r}function P(e,t,n){var r,i,a,o,l,u,f="l"===t[1];if(void 0===e[t]){r=e;e[t]=0;do{var g=-1;f&&r.orderPos>0?g=r.orderPos-1:!f&&r.orderPos<n[r.level].vertices.length-1&&(g=r.orderPos+1);if(-1!==g){P(a=(i=d[n[r.level].vertices[g]]).root,t,n);e.sink.id===e.id&&(e.sink=a.sink);o=r[s];l=i[s];if("h"===s)if(f){l+=2*i.labeloff;o-=2*r.labeloff}else{l-=2*i.labeloff;o+=2*r.labeloff}u=(o+l)/2+c;e.sink.id!==a.sink.id?a.sink.shiftData.push({vert:e.sink,dist:e[t]-a[t]-u}):e[t]=Math.max(e[t],a[t]+u)}r=r.align}while(r.id!==e.id)}}function j(e,t){e[t]=e.root[t];if(e.root.id===e.id){var n=e.root.sink.shift;if(!n){var r=e.root.sink.shiftData;n=1/0;for(var i=0;i<r.length;i++){var a=r[i].dist;r[i].vert.shift<1/0&&(a+=r[i].vert.shift);n=Math.min(n,a)}e.root.sink.shift=n}n<1/0&&(e[t]+=n)}}function Q(e,t){var n,r,i,a,o=[],l=1/0,u=-1/0,c="l"===t[1],s="u"===t[0],f=s?0:e.length-1,g=s?1:-1,h=function(t){return s?t<e.length:t>=0},v=function(e){return c?0:e.length-1},m=c?1:-1,b=function(e,t){return c?e<t.length:e>=0};for(n=f;h(n);n+=g){i=e[n].vertices;var I=-1;c||n===f||(I=e[n-g].vertices.length);for(r=v(i);b(r,i);r+=m){a=d[i[r]];var y=s?a.parents:a.children;M(a,t)&&(a[t]=void 0);I=J(a,y,c,I);o.push(a);a.sink=a;a.shiftData=[];a.shift=void 0}}for(r=0;r<o.length;r++)(a=o[r]).root.id===a.id&&P(a,t,e);for(r=0;r<o.length;r++){j(a=o[r],t);l=Math.min(l,a[t]);u=Math.max(u,a[t])}if(!c){q(e,t);return{max:-l,min:-u}}return{max:u,min:l}}function q(e,t){for(var n=0;n<e.length;n++)for(var r=e[n].vertices,i=0;i<r.length;i++){d[r[i]][t]*=-1}}function $(e){var t=Q(e,"ul"),n=Q(e,"ur"),r=Q(e,"dl"),i=Q(e,"dr"),a=[t,n,r,i].sort(function(e,t){return e.max-e.min-(t.max-t.min)});function o(e,t){return e-t}for(var l=0;l<e.length;l++)for(var u=e[l].vertices,c=0;c<u.length;c++){var s=d[u[c]],f=[s.ul-t.min+a[0].min,s.ur-n.max+a[0].max,s.dl-r.min+a[0].min,s.dr-i.max+a[0].max].sort(o);s.x=(f[1]+f[2])/2}}function ee(e){var t,n;for(t=0;t<e.length;t++){var r=0,i=e[t].vertices;for(n=0;n<i.length;n++){var a=d[i[n]];if(!y(a)){var o=a[s]/2,l="h"===s?a.labeloff:0;r+=o-l;a.x=r;r+=o+l+c}}var u=(r-c)/2;for(n=0;n<i.length;n++)d[i[n]].x-=u}}function ne(e){var t,n,r,i,a=[],o=[],l=0;for(t=0;t<e.length;t++){r=e[t].vertices;a[t]=0;o[t]=0;for(n=0;n<r.length;n++)if(!y(i=d[r[n]])){a[t]+=i[s];o[t]++}var u=a[t]+c*(o[t]-1);l=Math.max(l,u)}for(t=0;t<e.length;t++){r=e[t].vertices;if(o[t]>1){var f=(l-a[t])/(o[t]-1),g=0;for(n=0;n<r.length;n++)if(!y(i=d[r[n]])){var h=i[s]/2,v="h"===s?i.labeloff:0;g+=h-v;i.x=g;g+=h+v+f}}else for(n=0;n<r.length;n++)y(i=d[r[n]])||(i.x=l/2)}}function re(e){var n,r,i,a=1/0,o=-1/0,l=ie(),u=E(w);for(n=0;n<h.length;n++)t(h[n].verts,function(e){a=Math.min(a,e.x);o=Math.max(o,e.x)});r=(o-a)/(e*u);r=Math.max(r,l);t(w,function(e){i=0;for(var t=0;t<e.length;t++){for(var n=e[t].vertices,a=0;a<n.length;a++){x=n[a];d[x].y=i}i+=r}});return r}function ie(){var e,t,n=0,r=F(w,d),i=[];for(e=0;e<g.length;e++){var a=g[e].level,o=g[e].arrowSize;i[a]=Math.max(i[a]||0,2*o)}for(t=0;t<r.length;t++){var l=r[t].max,u=0;r[t+1]&&(u=r[t+1].max);var s=i[t]||0;n=Math.max(n,l+u+c+s)}return n}function oe(e){var t,n,r,i,a={};i="equal"===l.spacing||"stretched"===l.spacing?function(e){return e.c}:function(){return 0};function o(e,t){return Number(e)-Number(t)}for(t=0;t<b.length;t++){var u=b[t];u.links.sort(function(e,t){return(R(e.off)?e.off*e.sign:1/0)-(R(t.off)?t.off*t.sign:1/0)});var s=0,h=0,v=0,m=!0,I=w[i(u)][u.level].vertices,p=I.indexOf(u.id1),C=I.indexOf(u.id2),x=[p,C].sort(o);for(n=x[0]+1;n<x[1];n++){var G=d[I[n]];y(G)||(m=!1);for(r=0;r<G.parentEdges.length;r++)s+=G.parentEdges[r].numLinks;for(r=0;r<G.childEdges.length;r++)h+=G.childEdges[r].numLinks;var Z=(G[f]||G.size)/2;v=Math.max(v,Z)}if(!m){if(h===s){s=d[I[x[0]]].parentEdges.length+d[I[x[1]]].parentEdges.length;h=d[I[x[0]]].childEdges.length+d[I[x[1]]].childEdges.length}var A=p<C?1:-1;h<s&&(A*=-1);l.orientation.match(/right|up/)&&(A*=-1);var B=v+20,M=40,W=e/2;B+=Math.abs(d[u.id1].x-d[u.id2].x)/c;(B=Math.min(B,W))+(u.links.length-1)*M>W&&(M=Math.max(10,(W-B)/(g.links.length-1)));for(n=0;n<u.links.length;n++){var V=u.links[n],S=B+n*M;a[V.id]={off:A*V.sign*S}}}}return a}O();var le=l.ratio;"right"!==l.orientation&&"left"!==l.orientation||(le=1/le);var ue=[];if("equal"===l.spacing||"stretched"===l.spacing)for(var ce=0;ce<h.length;ce++)ue[ce]=h[ce].verts;else{var se=[],fe=[];ue[0]={};t(w,function(e,t){for(I=0;I<e.length;I++){se[I]||(se[I]={vertices:[],edges:[]});if(fe[I]){C=e[I].vertices;for(var n=0;n<C.length;n++){x=C[n];d[x].orderPos+=fe[I]}}se[I].vertices=se[I].vertices.concat(e[I].vertices);se[I].edges=se[I].edges.concat(e[I].edges);fe[I]=se[I].vertices.length}ue[0]=D(ue[0],h[t].verts)});(w={})[0]=se}var de=0;t(w,function(e,n){"equal"===l.spacing?ee(e):"stretched"===l.spacing?ne(e):$(e);var r=m(ue[n]);de-=r.x1;t(ue[n],function(e,t){d[t].x+=de});de+=r.x2+c});var ge=oe(re(le));if(l.orientation.match(/up|right|left/)){var he=_(l.orientation);t(w,function(e){for(I=0;I<e.length;I++){C=e[I].vertices;for(var t=0;t<C.length;t++){x=C[t];he(d[x])}}})}var ve=[],me=n.extents;te(e,d,ge,me,ve,l,a)}function T(e,n,r,i,a,o){var l=B(i,{top:[],orientation:"down",stable:!0,flatten:!1}),u=l.level,c=o?1:S(l.tightness),s=l.top,f=l.tidy,d=!o&&l.flatten,g=n.v,h=n.e,m=n.extents,b=v(g,h,r);if(u)h=p(g,h,u,r,b,!1);else{s=A(s,g);C(g,h,s,r)}var I=x(g,h),y=k(g),G=F(I,g);function w(){var e,n;t(I,function(t){for(var r=t.length-1;r>=0;r--)for(var i=t[r].vertices,a=[],o=0;o<i.length;o++){n=i[o];var l=z(I,g,n);g[n].children=[];g[n].subChildrenCount=0;if(0!==l.length){var u=[];for(e=0;e<l.length;e++)a.indexOf(l[e])<0&&u.push(l[e]);if(u.length>0){g[n].children=u;g[n].subChildrenCount=Z(u);for(e=0;e<u.length;e++){a.push(u[e]);g[u[e]].parent=n}}}}})}function Z(e){for(var t=0,n=0;n<e.length;n++){var r=g[e[n]].subChildrenCount;t+=0===r?1:r}return t}var R=2*y+24+c;function M(e,t,n){n||(e.x=t);var r=t-e.subChildrenCount*(R/2),i=e.children;if(i)for(var a=0;a<i.length;a++){var o=g[i[a]],l=o.subChildrenCount;0===l&&(l=1);var u=r+l*R;M(o,(u+r)/2,!1);r=u}}function W(e,t,n){for(var r,i=t.miny,a=Math.PI*(2/3),o=0,l=0;l<I[e].length;l++){var u=I[e][l].vertices,c=G[l].yOffset,s=G[l].average,f=2*((y<s?s:y)+12)+c;i+=o;for(var d=0;d<u.length;d++){r=u[d];var h=g[r];h.y=i;if(!n){var v=h.children;if(v&&v.length>1){var m=V(X(v.map(function(e){return g[e]})),a);f=Math.max(f,m)}}}o=f}}function V(e,t){return e/(2*Math.tan(t/2))}function X(e){for(var t=1/0,n=-1/0,r=0;r<e.length;r++){var i=e[r].x;t=Math.min(t,i);n=Math.max(n,i)}return n-t}function E(e,t){for(var n=_(t),r=0;r<I[e].length;r++)for(var i=I[e][r].vertices,a=0;a<i.length;a++)n(g[i[a]])}w();var Y={},H={};t(I,function(e,t){var n=Number(t);Y[n]=fe(b[n].verts);H[n]={children:I[t][0].vertices,subChildrenCount:Z(I[t][0].vertices)}});t(I,function(e,t){M(H[t],Y[t].x,!0);W(t,Y[t],d)});t(I,function(e,t){o||E(t,l.orientation)});o&&o(g,I,b,Y,y,l.tightness);var L=[];f?ee(e,g,b,0,1,m,L,l,a):te(e,g,{},m,L,l,a)}function z(e,t,n){var r,i,a,o,l=t[n].c,u=t[n].level+1,c=e[l][u],s={},f=[];if(c){for(a=0;a<c.edges.length;a++){var d=c.edges[a];r=d.id1+"";i=d.id2+"";r===n&&(s[i]=1);i===n&&(s[r]=1)}var g=c.vertices;for(o=0;o<g.length;o++)s[r=g[o]+""]&&f.push(r)}return f}function U(e,t,n){var r=[],i=t[n].level;if(i>0){var a,o,l,u=t[n].c,c=e[u][i],s={};if(c&&c.edges){for(o=0;o<c.edges.length;o++){var f=c.edges[o];f.id1===n?s[f.id2]=1:f.id2===n&&(s[f.id1]=1)}var d=e[u][i-1];if(d&&d.vertices)for(l=0;l<d.vertices.length;l++)s[a=d.vertices[l]]&&r.push(a)}}return r}function _(e){var t={up:function(e){e.y=-e.y;e.x=e.x},down:function(){},right:function(e){var t=e.y;e.y=e.x;e.x=t},left:function(e){var t=e.y;e.y=e.x;e.x=-t}};return t[e]||t.down}function O(e,n,r,i,a,o){function l(e,t){return(e.r+t.r)/(e.a-t.a)}function u(e,t,n){var r=t>0?e+n:e+n/2;return r>0?r:e}function c(e,t,n,r){if(r&&1===e.length)return 0;var i=t,a=i;for(s=1;s<e.length;s++)a=Math.max(l(g[e[s]],g[e[s-1]]),a);return u(a,a-i,n)}var s,f,d,g,h=S(o);t(n,function(t,n){var o=fe(r[Number(n)].verts),l=0,u=l,v=4*a,m=v,b=2*a+24;for(f=0;f<t.length;f++){var I,y=t[f].vertices;g=[];for(s=0;s<y.length;s++){d=y[s]+"";var p=(I=e[d]).x-o.minx,C=o.maxx-o.minx+b;if((p*=2*Math.PI/C)<0||p>2*Math.PI)throw new Error("[Radial] Theta angle should be in the range [0; 2*PI]");g[d]={a:p,r:I.size}}u=l;0===f?y.length>1&&(l+=v/2):l+=v;if((l=c(y,l,h,f<1))-u>m){m=l-u+1;v=Math.max(v,m/2);0===f&&y.length<3&&(l/=2)}for(s=0;s<y.length;s++){(I=e[y[s]+""]).x=i[Number(n)].x+l*Math.cos(g[I.id].a);I.y=i[Number(n)].y+l*Math.sin(g[I.id].a)}}})}function J(e,t){var n=e.extents.c,r=Math.max(e.extents.x2-e.extents.x1,e.extents.y2-e.extents.y1),i=120*Math.sqrt(n),a=Math.max(r,i)/2,o=0;n>1&&(o=Math.min(Math.pow(n,2.5),100));var l=o*n*Math.log(n),u=1/P(t);return{repulsionFactor:40*Math.max(1,Math.pow(u,2)),coeff:1,naturalDistance:20*u,iterations:o,chunk:20,temperature:a,temp:a,estTime:l}}function P(e){var t=V(e.tightness);return Math.pow(2,.4*(t-5))}function Q(e,t,n,r,i){var a=t.v,o=t.vcount,l=t.e,u=v(a,l,n),c=t.extents,f=r.fixed||[],d=r.tidy;se(a);var g=u.length,h=0,m=d?o/(o+g):1;e.trigger("progress","layout",0);for(var b,I=[],y=0,p=Date.now(),C=0;C<u.length;C++){var x=J(u[C],r);y+=x.estTime;I.push(x)}for(var G=0,w=0;w<u.length;w++){I[w].start=G;var Z=G+(m-h)*(I[w].estTime/y);I[w].stop=Z;G=Z}var A=0;function B(t){var n=t,r=u[n],i=I[n];le(e,r,i,i.start,i.stop,function(){ce(r.verts);A++;if(++n<u.length){b=Date.now();if(b-p>16||A>1e3){p=b;A=0;s(function(){B(n)},0)}else B(n)}else R()})}function R(){d?ee(e,a,u,m,1,c,f,r,i):te(e,a,{},c,f,r,i)}u.length>0?B(0):te(e,a,{},c,f,r,i)}function $(e){return Y(e).some(function(e){return e.fixed})}function ee(e,n,r,i,a,o,l,u,c){for(var s={},f=[],d={},g=1/0,h=1/0,v=0;v<r.length;v++){var m=de(r[v].verts);s[v]=m;var b=l.length>0&&$(r[v].verts);f.push({x:m.x,y:m.y,width:m.width,height:m.height,id:v,fixed:b});d[v]={x:m.x,y:m.y};g=Math.min(g,d[v].x);h=Math.min(h,d[v].y)}var I=B(u,{strategy:"rect",ratio:4/3});Re(f,{strategy:I.strategy,step:30,max:2,sort:!1,ratio:I.ratio,tightness:I.tightness},function(r){g="rect"===I.strategy?g:0;h="rect"===I.strategy?h:0;for(var i={},a=0;a<r.length;a++){i[r[a].id]=r[a];i[r[a].id].x+=g;i[r[a].id].y+=h}t(n,function(e){var t=i[e.c].x-d[e.c].x,n=i[e.c].y-d[e.c].y;e.x+=t;e.y+=n});te(e,n,{},o,l,I,c)})}function te(e,t,n,r,i,a,o){var l=m(t);0===i.length&&(l=ue(t,r,l));h(l.x1)||(l=null);if(!o)return{vertices:t,updatedEdges:n,extents:l};s(function(){e.trigger("progress","layout",1);o({vertices:t,updatedEdges:n,extents:l},a)})}function ne(e,t,n){re(e[t.id1],e[t.id2],n)}function re(e,t,n){var r,i,a;if(!e.fixed||!t.fixed){var o=2*w.next()*Math.PI;a=1.3*ge(e,t,n)/2;if(e.fixed||t.fixed){r=e.fixed?e.x:t.x;i=e.fixed?e.y:t.y;a*=2}else{r=(e.x+t.x)/2;i=(e.y+t.y)/2}if(!e.fixed){e.x=r+a*Math.cos(o);e.y=i+a*Math.sin(o);o+=Math.PI}if(!t.fixed){t.x=r+a*Math.cos(o);t.y=i+a*Math.sin(o)}}}function ie(e,t,n,r){var i={temperature:10,i:0},a={verts:t.v,edges:t.e},o=J(t,n);o.chunk=5;o.iterations=5;i.temperature=Math.pow(o.temperature,.72);oe(i,a,o);var l=m(a.verts);h(l.x1)||(l=null);e.trigger("progress","layout",1);r({vertices:a.verts,extents:l},n,!1)}function oe(e,n,r){for(var i=Math.min(e.i+r.chunk,r.iterations);e.i<i;){var a=n.verts,o=n.edges,l=0;t(a,function(e){e.dx=0;e.dy=0;l++});se(a,2);if(1===l){e.i=i;return}if(2===l){if(o[0])ne(a,o[0],r.naturalDistance);else{var u=Y(a);re(u[0],u[1],r.naturalDistance)}e.i=i;return}me(a,r.repulsionFactor);for(var c=0;c<o.length;c++)he(o[c],a,r.naturalDistance,r.coeff);var s=e.temperature*(1-e.i/r.iterations);t(a,function(e){ve(e,s)});e.i++}}function le(e,t,n,r,i,a){var o={i:0,temperature:n.temperature};function l(){return r+(i-r)*(o.i/n.iterations)}function u(){return o.i>=n.iterations}function c(){oe(o,t,n)}function f(){c();if(u())a();else{e.trigger("progress","layout",l());s(f,0)}}f()}function ue(e,n,r){var i=(r.x1+r.x2)/2-(n.x1+n.x2)/2,a=(r.y1+r.y2)/2-(n.y1+n.y2)/2;t(e,function(e){e.x-=i;e.y-=a});return{x1:r.x1-i,y1:r.y1-a,x2:r.x2-i,y2:r.y2-a}}function ce(e){var n,r,i,a=0,o=0,l=0,u=!1,c=0,s=0;t(e,function(e){a+=e.x;o+=e.y;l+=1;u=u||e.fixed});if(!(l<3||u)){a/=l;o/=l;t(e,function(e){if((n=Math.sqrt((e.x-a)*(e.x-a)+(e.y-o)*(e.y-o)))>s){s=n;c=Math.atan2(e.y-o,e.x-a)}});c=-c;var f=Math.sin(c),d=Math.cos(c);t(e,function(e){r=a+(e.x-a)*d-(e.y-o)*f;i=o+(e.x-a)*f+(e.y-o)*d;e.x=r;e.y=i})}}function se(e,n){var r=n||30;t(e,function(e){if(!e.fixed){e.x+=r*(w.next()-.5);e.y+=r*(w.next()-.5)}})}function fe(e){var n=0,r=0,i=0,a=1/0,o=1/0,l=-1/0,u=-1/0;t(e,function(e){n+=1;r+=e.x;i+=e.y;o=Math.min(o,e.x);a=Math.min(a,e.y);l=Math.max(l,e.x);u=Math.max(u,e.y)});r/=n;i/=n;var c=0,s=!1;t(e,function(e){var t=e.x-r,n=e.y-i,a=Math.sqrt(t*t+n*n);c=Math.max(a+1.5*e.size,c);s=s||e.fixed});return{x:r,y:i,sum:n,size:c,fixed:s,miny:a,minx:o,maxy:u,maxx:l}}function de(e,n){var r=W(n)?{}:n,i=20,a=1/0,o=1/0,l=-1/0,u=-1/0;t(e,function(e,t){if(!(t in r)){o=Math.min(o,e.x-e.size);a=Math.min(a,e.y-e.size);l=Math.max(l,e.x+e.size);u=Math.max(u,e.y+e.size)}});return{x:o-=i,y:a-=i,width:(l+=i)-o,height:(u+=i)-a}}function ge(e,t,n){return e.size+t.size+n*(1+((e.lc?e.lc:1)+(t.lc?t.lc:1))/6)}function he(e,t,n,r){var i=t[e.id1],a=t[e.id2],o=i.x-a.x,l=i.y-a.y,u=ge(i,a,n),c=K(o,l);if(c>.02){var s=r*((c-u)/c),f=o*s,d=l*s;i.dx-=f;i.dy-=d;a.dx+=f;a.dy+=d}}function ve(e,t){if(!e.fixed){var n=K(e.dx,e.dy),r=e.dx/n*Math.min(n,t),i=e.dy/n*Math.min(n,t);e.x+=r;e.y+=i}}function me(e,n){var r,o,c,s,f=fe(e);r=f.minx;c=f.miny;var d=(o=f.maxx)-r,g=(s=f.maxy)-c;d>g?s=c+d:o=r+g;function h(e,t,n,r){return{leaf:!0,nodes:{},point:null,x1:e,y1:t,x2:n,y2:r}}function v(e,t){var n=e.x1,r=e.y1,i=e.x2,a=e.y2,o=.5*(n+i),l=.5*(r+a),u=t.x>=o,c=t.y>=l,s=(c?2:0)+(u?1:0);e.leaf=!1;u?n=o:i=o;c?r=l:a=l;e.nodes[s]||(e.nodes[s]=h(n,r,i,a));m(e.nodes[s],t)}function m(e,t){if(e.leaf){var n=e.point;if(n){if(Math.abs(n.x-t.x)+Math.abs(n.y-t.y)<.01){v(e,t);return}e.point=null;v(e,n);v(e,t);return}e.point=t}else v(e,t)}function b(e,t){if(!e(t))for(var n=t.nodes,r=0;r<4;r++)n[r]&&b(e,n[r])}function I(e){var t=0,n=0;e.charge=0;e.size=0;if(!e.leaf)for(var r=e.nodes,i=0;i<4;i++){var a=r[i];if(a){I(a);e.charge+=a.charge;e.size+=a.size;t+=a.charge*a.cx;n+=a.charge*a.cy}}if(e.point){var o=w(e.point);e.pointCharge=o;e.charge+=o;e.size+=e.point.size;t+=o*e.point.x;n+=o*e.point.y}e.cx=e.charge?t/e.charge:0;e.cy=e.charge?n/e.charge:0}var y,p=.5;function C(e){if(e.point!==y){var t=e.cx-y.x,n=e.cy-y.y,r=1/K(t,n);if((e.x2-e.x1)*r<p){G(y,e,e.charge,r,t,n);return!0}e.point&&G(y,e.point,e.pointCharge,r,t,n)}return!e.charge}var x=1e5;function G(e,t,n,r,i,a){Z(e,n,i,a,Math.min(r,x))}function w(e){return a*Math.pow(e.size,l)/u*(1+(e.lc?e.lc:1)/3)}function Z(e,t,r,a,o){if(!(o<i)){var l=n*w(e)*t*o*o*o;e.dx-=r*l;e.dy-=a*l}}var A=h(r,c,o,s);t(e,function(e){m(A,e)});function B(){t(e,function(e){y=e;b(C,A)})}I(A);B();return A}function be(e,t,n,r,i,a){e[t]=r?n[t]:{x:i,y:a}}function Ie(e,n,r,i,a){var o=1.25-(V(i.tightness)-5)/10,l=pe(n.v,n.e);Q(e,ye(l,n.v,o),r,i,function(e,r,i){var o={};t(e.vertices,function(e,t){if(l.rev[t])for(var r=e.fixed,i=0;i<l.rev[t].length;i++){var a=l.rev[t][i],u=e.x,c=e.y;if(e.jit.positions){u+=e.jit.positions[a].x;c+=e.jit.positions[a].y}be(o,a,n.v,r,u,c)}else be(o,t,n.v,n.v[t].fixed,e.x,e.y)});var u={vertices:o,extents:e.extents};a(u,r,i)})}function ye(r,i){var a,o,l={},u=[],c=0;t(r.rev,function(a,o){for(var s={x:0,y:0,size:0},f=a.length,d=!1,g=0;g<f;g++){var h=i[a[g]];s.x+=h.x;s.y+=h.y;s.size+=h.size}s.x/=f;s.y/=f;var v=document.createElement("canvas").getContext("2d"),m=Ai(),b=Y(i).filter(function(e){return r.rev[o].indexOf(e.id)>-1}).map(function(t){t.r=n.nodeSize(e.privateGetItem(t.id),v,!1).radius;t.rwt=n.nodeSize(e.privateGetItem(t.id),v,!0).radius;t.labelOffset=0;return t}),I=0,y=0;b.forEach(function(e){I+=e.r;y+=e.rwt});var p=(y-I)/b.length,C=.5,x={positions:N(b=m.concentricLayout(b,{padding:Math.max(8,p*C)}))},G=n.getExtents(b,v,0).r;l[o]={x:s.x,y:s.y,size:G,fixed:d,jit:x,lc:0};c++;for(var w=a[0],Z={},A=r.index[w],B=0;B<A.length;B++){var R=A[B];Z[r.ids[R]]=1}t(Z,function(e,t){o<t&&u.push({id1:o,id2:t})})});for(var s=0;s<u.length;s++){a=u[s].id1+"";o=u[s].id2+"";l[a].lc++;l[o].lc++}t(i,function(e,t){if(!r.ids[t]){l[t]={x:e.x,y:e.y,size:e.size,lc:0,fixed:e.fixed,jit:{radius:e.size,position:{x:0,y:0}}};c++}});return{v:l,e:u,vcount:c,extents:m(l)}}function pe(e,t){return we(Ge(t))}function Ce(e,t,n){e[n]||(e[n]=[]);e[n].push(t)}function xe(e,t){Ce(e,t.id1,t.id2);Ce(e,t.id2,t.id1)}function Ge(e){for(var t={},n=0;n<e.length;n++)xe(t,e[n]);return t}function we(e){var n,r={},i={};t(e,function(e,t){e.sort();n="";for(var a=0;a<e.length;a++)n+=e[a];r[n]||(r[n]=[]);r[n].push(t);i[t]=n});return{rev:r,ids:i,index:e}}function Ze(e,t,n,r){var i,a,o={},l=0,u=t.length-1;do{i=Ae(e,t,n,u,o,r);l=Math.max(i.radius,l);u=i.index}while(u>=0);switch(t.length){case 4:a=2;break;case 3:a=2.5;break;case 2:a=3;break;case 1:a=1;break;default:a=2}return{positions:o,radius:l*a}}function Ae(e,t,n,r,i,a){var o=r;if(0===o){i[t[0]]={x:0,y:0};return{radius:n,index:-1}}var l=(o+1)*n,u=n,c=Math.sqrt(l/(Math.PI*u))*u,s=Math.floor(2*Math.PI*c/n);s=Math.min(s,o+1);var f=2*Math.PI/s,d=0;switch(s){case 2:d=Math.PI/2;c*=.75;break;case 3:d=Math.PI/3;c*=.85;break;case 4:d=0;c*=.85;break;case 5:d=0;c*=.9;break;default:d=0}c*=a;for(var g=0;g<s;){i[t[o-g]]={x:c*Math.cos(d),y:c*Math.sin(d)};d+=f;g++}return{radius:c,index:o-=s}}function Be(e,t,n,r){var i,a=0,o={};for(i=0;i<t.length;i++)a+=e[t[i]].size;if(1===t.length)o[t[0]]={x:0,y:0};else{var l=Math.PI/4;2===t.length&&(l=Math.PI/2);4===t.length&&(l=0);t.length<4&&(a*=1.5);var u=2*Math.PI/t.length,c=r*a/4;for(i=0;i<t.length;i++){o[t[i]]={x:c*Math.cos(l),y:c*Math.sin(l)};l+=u}}return{positions:o,radius:a}}r.arrange=function(r,i,a,o,l,u,c,s){function f(e,t){var n,r=[];for(n=0;n<t.length;n++)e[t[n]]&&r.push(t[n]);return r}function d(e,t,n,r,i){var a;for(a=0;a<e.length;a++)if(e[a].id===t){e[a].x=n-e[a].width/2;e[a].y=r-e[a].height/2;break}return i(e)}var g,h,m,b={tidy:function(e,t,n){return Me(e,{step:30,max:2,sort:!1,ratio:t.ratio},n)},average:function(e,t,n){return d(e,t.specialId,t.centre.x,t.centre.y,n)},absolute:function(e,t,n){return d(e,t.specialId,t.absolute.x,t.absolute.y,n)}},I={privateConcentric:function(t){var r=Ai(),i=e.privateGetItem(t).map(function(e){return{id:e.id,x:0,y:0,r:n.nodeSize(e,u,x.includeLabel).radius,labelOffset:n.labelOffset(e)}});return N(i=r.concentricLayout(i,{padding:x.padding}))},grid:function(e,t,n,r){var i=2*n+24+r,a=0,o=0,l=Math.floor(Math.sqrt(e.length)),u=Math.ceil(e.length/l),c={};for(g=0;g<l;g++){for(h=0;h<u;h++){var s=u*g+h;e[s]&&(c[e[s]]={x:a,y:o});a+=i}a=0;o+=i}return c},circle:function(e,t,n,r){return Be(t,e,n,1.25-(5-r)/50).positions},radial:function(e,t,n,r){return Ze(t,e,n,1.25-(5-r)/50).positions}},y="#arranged#";function p(e,t,n,r,i){var a={},o=[],l={};for(g=0;g<e.length;g++){l=de(e[g].verts,t);if(isFinite(l.width)){o.push({x:l.x,y:l.y,width:l.width,height:l.height,id:g});a[g]={x:l.x,y:l.y}}}l=de(t);o.push({x:l.x,y:l.y,width:l.width,height:l.height,id:y});a[y]={x:l.x,y:l.y};A(o,{ratio:x.ratio,centre:n,absolute:r,specialId:y},function(e){return i({packed:e,original:a})})}function C(e,n,r){var i,a;t(e,function(e){if(e.arranged){i=r[y].x-n[y].x;a=r[y].y-n[y].y}else{i=r[e.c].x-n[e.c].x;a=r[e.c].y-n[e.c].y}e.x+=i;e.y+=a})}var x=B(c,{tightness:5,position:"average",x:0,y:0});i.trigger("prechange","arrange");var G=o.v,w=S(x.tightness),A=b[x.position]||b.average,R=I[r]||I.grid,M={x:Number(x.x)||0,y:Number(x.y)||0},W={x:0,y:0},V=Z(a);if((V=f(G,V)).length){m=0;for(g=0;g<V.length;g++){m+=G[V[g]].size;W.x+=G[V[g]].x;W.y+=G[V[g]].y}m/=V.length;W.x/=V.length;W.y/=V.length;var X=R(V,G,m,w),k={};t(X,function(e,t){G[t].x=e.x;G[t].y=e.y;k[t]=G[t];k[t].arranged=1});p(v(G,o.e,l),k,W,M,function(e){for(var t=e.packed,n=e.original,r={},a=0;a<t.length;a++)r[t[a].id]=t[a];C(G,n,r);var l=[],u=o.extents;te(i,G,{},u,l,x,s)})}else s()};function Re(e,t,n){function r(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)}function i(e,t,n){return(t-e)*n+e}function a(e,t,n){return(e-n)/(t-n)}function o(e){var n=1.1,r=1.03,i=10,a=function(){for(var t=0,n=-1/0,r=0;r<e.length;r++){t+=e[r].width*e[r].height;n=Math.max(n,e[r].width)}return{area:t,maxWidth:n}}(),o=Math.sqrt(a.area*n/t.ratio)*r,l=o*t.ratio;l<a.maxWidth+i&&(l=a.maxWidth+i);return{x:0,y:0,width:l,height:o}}function l(e,t,n,r,o,l){var u=a(t,n,r);return i(l,o,u=Math.pow(u,e))}function u(e,t){if(!t)return!1;var n=e.x<m.x+m.width,r=e.x+e.width>m.x,i=e.y<m.y+m.height,a=e.y+e.height>m.y;return(n||r)&&(i||a)}function c(e,t){if(t.length<1)return!1;function n(t){var n=e.y<t.y+t.height,r=e.y+e.height>t.y;return n&&r}function r(t){var n=e.x<t.x+t.width,r=e.x+e.width>t.x;return n&&r}var i,a;for(i=0;i<t.length;i++)if(r(a=t[i])&&n(a))return!0;return!1}var s,f,g,h={spiral:function(e){var t=l(.6,e,100,0,y,1),n=l(1,e,600,0,.3,.5)*e;return{x:Math.cos(n)*t,y:Math.sin(n)*t}},controlled:function(e,t){for(var n;!u(t,n);)n=h.random(e);return n},rect:function(e){return Me(e,t,n)},random:function(e){var t=.5*e;return{x:r()*t,y:r()*t}}},v=0,m=o(e),b=[],I=h[t.strategy]||h.rect,y=0;for(s=0;s<e.length;s++){f=e[s];y+=f.width}y/=2*e.length;if("rect"===t.strategy)return I(e);e.sort(d);for(s=0;s<e.length;s++){(f=e[s]).x=f.fixed?f.x:0;f.y=f.fixed?f.y:0;for(;c(f,b)&&!f.fixed;){g=I(v,f);f.x=g.x;f.y=g.y;v++}b.push(f)}return n(b)}function Me(e,t,n){function r(){for(var t=0,n=0;n<e.length;n++)t+=e[n].width*e[n].height;return t}function i(e,t){var n=d(e,t);return n||t.height-e.height}function a(e){for(var t=0,n=0;n<e.length;n++)t<e[n].width&&(t=e[n].width);return t}function l(e){for(var t=o(e),n=0;n<t.length;n++){var r=t[n].width%f.step,i=t[n].height%f.step;0!==r&&(t[n].width+=f.step-r);0!==i&&(t[n].height+=f.step-i)}return t}function u(e){return!v||e.ratio()>=f.ratio-.2&&e.ratio()<=f.ratio}function c(e){for(var t=S(f.tightness),n=0;n<e.length;n++){e[n].width+=t;e[n].height+=t}}function s(e){var t=1.1,n=1.03,r=10,i=Math.sqrt(e.area()*t/f.ratio)*n,a=i*f.ratio;a<e.maxWidth+r&&(a=e.maxWidth+r);return{width:a,height:i,lowestFreeHeightDeficit:0,ratio:function(){return b.width/b.height}}}var f=B(t,{ratio:4/3,max:10,sort:!0,step:10,tightness:5});f.sort&&e.sort(i);c(e);var g,h=l(e),v=!0;if(0!==e.length){var m={area:r,maxWidth:a(h),maxHeight:h[0].height},b=s(m),I=0;j(function(){return b.width>=m.maxWidth},function(){var e=We(h,b);if(0===e.comps.length){b.width*=1.03;b.height*=1.03}else{I++;if(!g||u(e)){(g=e).efficiency=m.area()/e.area();if(u(e))return!0}if(I>=f.max)return!0}return!1},function(){return n(g.comps)})}else{g=Ve();n(g.comps)}}function We(e,t){var n,r=Ve();t.canvas||(t.canvas=Se());for(var i=t.canvas.setDimensions(t.width,t.height),a=0,o=0,l=0;l<e.length;l++){var u=e[l];if(!(n=i.addRect(u.width,u.height)).placed){r.width=0;r.height=0;r.comps.length=0;r.lowestHeightFlushedRightItem=0;break}u.x=n.offsetX;u.y=n.offsetY;r.comps.push(u);u.y+u.height>r.height&&(r.height=u.y+u.height);u.x+u.width>r.width&&(r.width=u.x+u.width);var c=u.width+u.x;if(c>o||c===o&&u.height>a){r.lowestHeightFlushedRightItem=n.lfhd;a=u.height;o=c}}t.lowestFreeHeightDeficit=i.lfhDeficitSinceLastRedim();return r}function Ve(){var e={width:0,height:0,area:function(){return e.width*e.height},comps:[],lowestHeightFlushedRightItem:0,ratio:function(){return 0===e.width?1/0:e.width/e.height}};return e}function Se(){var e=0,t=Xe(),n=ke;function r(e,t){return t-(s.height-e)}function i(e,n,r){if(r.leftOverW>0){s.cells+=t.rows();var i=e+(r.nRequiredCellsH-1);t.insertCol(i,r.leftOverW)}if(r.leftOverH>0){s.cells+=t.cols();var a=n+(r.nRequiredCellsV-1);t.insertRow(a,r.leftOverH)}for(var o=e+(r.nRequiredCellsH-1);o>=e;o--)for(var l=n+(r.nRequiredCellsV-1);l>=n;l--)t.setItem(o,l,!0)}function a(e,n,r,i){i.nRequiredCellsH=0;i.nRequiredCellsV=0;i.leftOverW=0;i.leftOverH=0;for(var a,o=0,l=0,u=n;l<r.height;){a=e;o=0;for(;o<r.width;){if(t.item(a,u))return!1;o+=t.colWidth(a);a++}l+=t.rowHeight(u);u++}i.nRequiredCellsH=a-e;i.nRequiredCellsV=u-n;i.leftOverW=o-r.width;i.leftOverH=l-r.height;return!0}function o(e,n,r){var i=0,a=0,o=0,l=0,u=0;for(o=0;o<e;o++)i+=t.colWidth(o);for(o=0;o<n;o++)a+=t.rowHeight(o);l=r.x-i;u=r.y-a;if(l<0||u<0)return!1;if(l>0){s.cells+=t.rows();var c=t.colWidth(e)-l;t.insertCol(e,c)}if(u>0){s.cells+=t.cols();var f=t.rowHeight(n)-u;t.insertRow(n,f)}return!0}function l(e,n){s.width=e;s.height=n;s.area=c();t.init(e,n,!1);return s}function u(e,l,u){var c={offsetX:0,offsetY:0,width:e,height:l,placed:!1},f=0,d=0,g=0,h=0,v={};if(u){for(;f<t.cols()&&g<u.x;){g+=t.colWidth(f);f++}for(;d<t.rows()&&h<u.y;){h+=t.rowHeight(d);d++}o(f-1,d-1,u);g-=t.colWidth(f);h-=t.rowHeight(d)}s.addAttempts++;for(var m=ke;;){v={};for(;d<t.rows()&&t.item(f,d);){h+=t.rowHeight(d);d++}if(d<t.rows()&&r(h,c.height)<=0){if(a(f,d,c,v)){i(f,d,v);c.offsetX=g;c.offsetY=h;c.placed=!0;break}h+=t.rowHeight(d);d++}var b=r(h,c.height);if(b>0){h=0;d=0;g+=t.colWidth(f);f++;s.lfhDeficitSinceLastRedim()>b&&(n=b)}if(s.width-g<c.width){c.placed=!1;break}}m=n;return{offsetX:c.offsetX,offsetY:c.offsetY,lfhd:m,placed:c.placed}}function c(){return s.width*s.height}var s={matrix:t,cells:e,addAttempts:0,addRect:u,lfhDeficitSinceLastRedim:function(){return n},setDimensions:l};return s}function Xe(){var e=[],t=[],n=[],r=0,i=0;function a(){if(e.length>0||t.length>0){e.length=0;t.length=0;n.length=0}}function l(o,l,u){if(o<=0)throw new Error("[Matrix] Column size cannot be 0 or similar");if(l<=0)throw new Error("[Matrix] Row size cannot be 0 or similar");r=1;i=1;a();e.push({index:0,size:o});t.push({index:0,size:l});n[0]=[];n[0][0]=u;return f}function u(e,a){for(var o=t[e].index,l=0;l<i;l++)n[l][r]=n[l][o];e<r-1&&t.splice(e+1,0,{index:r,size:a});t[e+1]={index:r,size:a};t[e].size-=a;r++;return f}function c(t,r){var a=e[t].index;n[i]=o(n[a]);t<i-1&&e.splice(t+1,0,{index:i,size:r});e[t+1]={index:i,size:r};e[t].size-=r;i++;return f}function s(){var n,a,o,l="\n     ",u=0,c=0;for(u=0;u<i;u++){n=Math.floor(e[u].size/100)%10==0?" ":""+Math.floor(e[u].size/100)%10;a=Math.floor(e[u].size/10)%10==0&&" "===n?" ":""+Math.floor(e[u].size/10)%10;o=Math.floor(e[u].size)%10==0&&" "===n&&" "===a?" ":""+Math.floor(e[u].size)%10;l+=e[u].size>999?" "+e[u].size+" ":" "+n+a+o+" "}l+="\n";for(u=0;u<r;u++){n=Math.floor(t[u].size/100)%10==0?" ":""+Math.floor(t[u].size/100)%10;a=Math.floor(t[u].size/10)%10==0&&" "===n?" ":""+Math.floor(t[u].size/10)%10
;o=Math.floor(t[u].size)%10==0&&" "===n&&" "===a?" ":""+Math.floor(t[u].size)%10;l+=t[u].size>999?" "+t[u].size+": ":" "+n+a+o+": ";for(c=0;c<i;c++)l+=f.item(c,u)?"  X  ":"  .  ";l+="\n"}return l}var f={init:l,cols:function(){return i},rows:function(){return r},item:function(r,i){return n[e[r].index][t[i].index]},setItem:function(r,i,a){n[e[r].index][t[i].index]=a},insertRow:u,insertCol:c,colWidth:function(t){return e[t].size},rowHeight:function(e){return t[e].size},inspect:s};return f}var ke=16e6;return r}function Mi(e){var t=Wi(Ar()),n=B(e,{selfLinks:!1}),r=Hr({numbers:{x:1,y:1},strings:{id:1,id1:1,id2:1},booleans:{hi:1,a1:1,a2:1}});function i(e){function t(t){var i=o(t);r.typeCheck(i);var a=r.filterNodesAndLinks(i.items,null,null,{selfLinks:n.selfLinks});r.ensureHiddenItemConsistency(a.nodes,a.links);e.privateSetProperties(a.nodes,a.links)}return t}function a(e){function t(){var t={};e.privateSetProperties(t,t)}return t}return D(t,{load:i(t),clear:a(t)})}function Wi(e){var n={},r={},i={},a=e,l=null;n.clearCache=function(){l=null};var u=n.clearCache;n.privateSetProperties=function(e,t){r=e;i=t;u()};function c(e,n,r){var i=n&&n.all,a="toplevel"!==n.combos,o="underlying"!==n.combos;t(e,function(e){!i&&e.hi||!a&&e._parentId||!o&&e._combo||r(e)})}function f(e,t){c(i,e,t)}function d(e,t){c(r,e,t)}var v=function(e,t,n,r){function i(){var t=[];d(e,function(e){t.push(e)});return t}var o=i(),l=o.length,u=-1,c=Date.now(),f=c,g=700,h=function(){if(++u>=l){v(1);r()}else n(o[u],b)},v=function(e){a&&a.trigger("progress",t,e)},m=function(){if((c=Date.now())-f>g){f=Date.now();return!0}return!1},b=function(){if(m()){v(u/l);s(h,0)}else h()};v(0);b()};n.findAdjacency=function(e,t,n){var r=x(e);if(t===n)return r.selfAdjacency[t];var i=r.adjacency;return i[t]&&i[t][n]};n.connections=function(e){var t=x(e);return e.self?t.selfConnections:t.connections};n.eigenCentrality=function(e){var n,r,i=B(e,{all:!1,value:void 0});i.combos="toplevel";i.direction="any";U(i);T(i);var a={},o=b(i);function l(e,t){a[t]=e*o[n].nodes.length}for(n=0;n<o.length;n++){var u={};for(r=0;r<o[n].nodes.length;r++)u[o[n].nodes[r]]=!0;var c=s(u);t(c,l)}return a;function s(e){var t,n,r={},a=[],o=[],l=[],u=0,c=[],s=0;d(i,function(t){var n=t.id;if(e[n]){a.push(n);r[n]=a.length-1;o.push([]);l.push({})}});n=Math.max(100,5*Math.sqrt(a.length));f(i,function(t){if(e[t.id1]&&e[t.id2]){var n=r[t.id1],a=r[t.id2];if(!l[n][a]){o[n].push(a);o[a].push(n);l[a][n]=0;l[n][a]=0}var c=h(t,i);l[n][a]+=c;l[a][n]+=c;u+=c;s++}});if(0===a.length)return{};if(1===a.length){(c={})[a[0]]=1;return c}if(2===a.length){(c={})[a[0]]=.5;c[a[1]]=.5;return c}u/=s;n=Math.max(100,5*Math.sqrt(a.length));for(t=0;t<a.length;t++)c.push(Math.random());for(t=0;t<n;t++){c=v(c);t%10==0&&m()}m();var g={};for(t=0;t<a.length;t++)g[a[t]]=c[t];return g;function h(e,t){var n=1;t.value&&e.d&&(n=Number(e.d[t.value]));return n}function v(e){var t,n,r=[];for(t=0;t<a.length;t++){var i=0;for(n=0;n<o[t].length;n++)i+=l[t][o[t][n]]*e[o[t][n]];i+=u*e[t];r.push(i)}return r}function m(){var e,t=1/b(c);for(e=0;e<a.length;e++)c[e]*=t}function b(e){var t,n=0;for(t=0;t<e.length;t++)n+=Math.abs(e[t]);return n}}};n.pageRank=function(e){var t,n=B(e,{all:!1,value:void 0,directed:!0});n.combos="toplevel";U(n);z(n);var r,i={},a=[],o=[],l=[],u=[],c=[],s=.85;d(n,function(e){a.push(e.id);i[e.id]=a.length-1;o.push([]);l.push({});u.push(0)});r=Math.max(100,5*Math.sqrt(a.length));f(n,function(e){var t=i[e.id1],r=i[e.id2],a=v(e,n);if(!n.directed||e.a2||!e.a1&&!e.a2){if(!l[r][t]){l[r][t]=0;o[r].push(t)}l[r][t]+=a;u[t]+=a}if(!n.directed||e.a1||!e.a1&&!e.a2){if(!l[t][r]){l[t][r]=0;o[t].push(r)}l[t][r]+=a;u[r]+=a}});for(t=0;t<a.length;t++)c.push(Math.random());var g=1/b(c);for(t=0;t<a.length;t++)c[t]*=g;for(t=0;t<r;t++)c=m(c);g=1/b(c);for(t=0;t<a.length;t++)c[t]*=g;var h={};for(t=0;t<a.length;t++)h[a[t]]=c[t];return h;function v(e,t){var n=1;t.value&&e.d&&(n=Number(e.d[t.value]));return n}function m(e){var t,n,r=[],i=0,f=0;for(t=0;t<a.length;t++)i+=e[t];for(t=0;t<a.length;t++){var d=0;for(n=0;n<o[t].length;n++){var g=o[t][n];d+=l[t][g]*e[g]/u[g]}0===u[t]&&(f+=s*e[t]);d*=s;d+=(1-s)*i/a.length;r.push(d)}f/=a.length;for(t=0;t<c.length;t++)r[t]+=f;return r}function b(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t];return n}};n.neighbours=function(e,n){var a={},o={},l=H(Z(e)),u=B(n,{all:!1,direction:"any",hops:1});if(u.hops<1)throw new Error("neighbours error: hops must be a positive number");U(u);var c=0,s={},f={},d=l,g=x(u),h=g.adjacency,v=g.selfAdjacency;t(l,function(e,t){var n=X(t);if(!r[n]&&!i[n])throw new Error("neighbours error: ids must be present in the graph");c++});function m(e,t,n){if(!f[t]&&R(n,e,t,u)){a[t]=1;f[t]=1;if(n!==e){o[e]=1;e in d&&(o[n]=1);if(!(e in l)){c++;s[e]=1}}}}function b(){t(l,function(e,n){if(r[n]){h[n]&&t(h[n],function(e,t){for(var r=0;r<e.length;r++){m(t,X(e[r]),n)}});var a=v[n];if(a)for(var d=0;d<a.length;d++)m(n,a[d],n)}else if(i[n]){var g=i[n];if(!f[g.id2]&&R(g.id2,g.id1,n,u)){o[g.id2]=1;f[g.id2]=1;f[n]=1;if(!(g.id2 in l)){c++;s[g.id2]=1}}if(!f[g.id1]&&R(g.id1,g.id2,n,u)){o[g.id1]=1;f[g.id1]=1;f[n]=1;if(!(g.id1 in l)){c++;s[g.id1]=1}}}})}for(;u.hops--&&c;){c=0;b();l=s;s={}}return{nodes:Object.keys(o),links:Object.keys(a)}};n.privateNeighbourLinks=function(e){var n=x({all:!0,combos:"all"}),r=n.adjacency,i=n.selfAdjacency,a={},o=[];e.forEach(function(e){t(r[e],function(e){e.forEach(function(e){if(!a[e]){o.push(e);a[e]=!0}})});var n=i[e];if(n)for(var l=0;l<n.length;l++)o.push(n[l])});return o};n.privateGetLinkIdsBetween=function(e,t){var n=x({all:!0,combos:"all"}),r=n.adjacency,i=n.selfAdjacency,a=[];r[e]&&(a=r[e][t]||[]);e===t&&i[e]&&(a=a.concat(i[e]));return a};n.clusters=function(e){var t,n=B(e,{all:!1,factor:5,consistent:!0});n.combos="toplevel";U(n);var r,i,a=[],o=[],l=[],u=[],c={},s=0,g=[],v=[],m=[],b=[],I=[];d(n,function(e){u.push(e.id);o.push([]);l.push([]);c[e.id]=u.length-1;g.push([u.length-1]);v.push(u.length-1);I.push(u.length-1);a.push(0);m.push(0)});f(n,function(e){var t=p(e,n);s+=t;var r=c[e.id1],i=c[e.id2];if(!l[r][i]){l[r][i]=0;l[i][r]=0}l[r][i]+=t;l[i][r]+=t;a[r]+=t;a[i]+=t;m[r]+=t;m[i]+=t;o[r].push(i);o[i].push(r)});r=Math.max(1e4,50*u.length);if(0===u.length)return[];0===s&&(r=0);var y=q();y.setSeed(n.consistent?900736044081:null);function p(e,t){var n=1;t.value&&e.d&&(n=+e.d[t.value]);return n}function C(e){i=h(i=+e)?i:5;i=Math.max(0,i);i=(i=Math.min(10,i))*i*i/125}C(n.factor);for(t=0;t<r;t++){if(y.next()>.95){M(I[Math.floor(y.next()*I.length)],I[Math.floor(y.next()*I.length)])}if(t<.5*r&&y.next()>.98){V(I[Math.floor(y.next()*I.length)])}var x=Math.floor(u.length*y.next()),G=o[x][Math.floor(y.next()*o[x].length)],w=v[G],Z=v[x];if(w!==Z){R(w,Z,x)>=0&&W(x,w)}}function A(){var e,t,n=[];for(e=0;e<I.length;e++){var r=[];for(t=0;t<g[I[e]].length;t++)r.push(u[g[I[e]][t]]);n.push(r)}return n}function R(e,t,n){var r,u=m[t],c=m[e],f=a[n],d=(u-c-f)*f*i;d/=2*s;for(r=0;r<o[n].length;r++){var g=o[n][r];v[g]===t?d-=l[n][g]:v[g]===e&&(d+=l[n][g])}return d/s}function M(e,t){var n,r;if(t!==e&&0!==g[e].length&&0!==g[t].length){var a=m[e],u=m[t],c=0;c-=i*a*u/s;for(n=0;n<g[e].length;n++){var f=g[e][n];for(r=0;r<o[f].length;r++)v[o[f][r]]===t&&(c+=l[f][o[f][r]])}if((c/=s)>0){var d=g[e].length;for(n=0;n<d;n++)W(g[e][0],t)}}}function W(e,t){var n,r=v[e];v[e]=t;var i=[];for(n=0;n<g[r].length;n++)g[r][n]!==e&&i.push(g[r][n]);if(0===g[t].length){I.push(t);b.splice(b.indexOf(t),1)}g[r]=i;g[t].push(e);m[t]+=a[e];m[r]-=a[e];if(0===g[r].length){b.push(r);I.splice(I.indexOf(r),1)}}function V(e){var t,n=g[e].length;if(1!==n&&b.length){var r=[];for(t=0;t<n;t++)r.push(g[e][t]);for(t=0;t<n&&b.length;t++)W(r[t],b[0])}}return A()};n.privateDisjointSet=function(e,t){for(var r,i,a=n.privateUnionFind(e,t),o=a.indices,l=a.nodeIds,u=a.groupRepresentatives,c=[],s=0;s<l.length;s++){r=l[s];if(o[s]===s)o[s]=c.push([r])-1;else{i=o[o[s]];o[s]=i;c[i].push(r)}u[r]=o[s]}return{vertexGroups:c,groupIndex:u}};n.privateUnionFind=function(e,t){var n,r,i,a,o=Object.keys(e),l={},u=new Array(o.length);for(n=0;n<o.length;n++){l[o[n]]=n;u[n]=n}for(n=0;n<t.length;n++)(r=m(u,l[(a=t[n]).id1],!0))>(i=m(u,l[a.id2],!0))?u[r]=i:r<i&&(u[i]=r);for(n=0;n<o.length;n++){u[n]=m(u,n,!1);l[o[n]]=u[n]}return{indices:u,nodeIds:o,groupRepresentatives:l}};function m(e,t,n){for(var r=t,i=0;r>=0&&e[r]!==r;){r=e[r];i++}if(n)for(var a;i>1;){a=t;t=e[t];e[a]=r;i--}return r}n.components=function(e){var t=B(e,{all:!1});U(t);var r,i,a,o=x(t),l=o.vertices,u=o.edges,c=o.selfAdjacency,s=n.privateDisjointSet(l,u),f=s.vertexGroups,d=s.groupIndex;for(r=0;r<f.length;r++)f[r]={nodes:f[r],links:[]};for(r=0;r<u.length;r++){i=u[r];a=d[i.id1];for(var g=0;g<i.ids.length;g++)f[a].links.push(i.ids[g])}Object.keys(c).forEach(function(e){a=d[e];u=c[e];for(var t=0;t<u.length;t++)f[a].links.push(u[t])});return f};var b=n.components;function I(e,t,n,r,i){e[n]||(e[n]={});e[r]||(e[r]={});if(!e[n][r]){e[r][n]=[];e[n][r]=e[r][n];t.push(i)}e[n][r].push(i)}function y(e,t,n){var r={id:t.id,id1:t.id1,id2:t.id2,ids:n};e.edges.push(r);e.connections.push(n)}function p(e){var n={connections:[],adjacency:{},vertices:{},edges:[]};d(e,function(e){n.vertices[e.id]={x:e.x,y:e.y};n.adjacency[e.id]={}});var r=[],a={};f(e,function(e){if(e.id1===e.id2){a[e.id1]=a[e.id1]||[];a[e.id1].push(e.id)}else I(n.adjacency,r,e.id1,e.id2,e.id)});for(var o=r.length,l=0;l<o;l++){var u=i[r[l]];y(n,u,n.adjacency[u.id1][u.id2])}if(F(a)){var c=n.connections.slice();t(a,function(e){c.push(e)});n.selfConnections=c}else n.selfConnections=n.connections;n.selfAdjacency=a;return n}function x(e){var t=B(e,{all:!1,combos:"toplevel"}),n=(t.all?"all":"visible")+"-"+t.combos;l||(l={});l[n]||(l[n]=p(t));return l[n]}n.internalMarkLinks=function(e){var n=x({combos:"all"}),r=n.adjacency,i=n.selfAdjacency,a=2,o=1,l={};e.forEach(function(e,n){var a=r[n];a&&t(a,function(e){for(var t=0;t<e.length;t++){var n=e[t];l[n]=!0}});var o=i[n];if(o)for(var u=0;u<o.length;u++)l[o[u]]=!0});t(l,function(t,n){var r=e.get(n);r&&r===a||e.set(n,o)})};n.distances=function(e,n){if(!r[e])throw new Error("distances error: id(s) must be present in the graph");var i=n||{};z(i);U(i);var a=k(e,i),o={};t(a.distance,function(e,t){h(e)&&(o[t]=e)});return o};var G=n.distances,w=function(e,t,n){var r,i=x(n).adjacency[e][t],a=1/0,o=V(n);if(i)for(var l=0;l<i.length;l++){var u=o(e,t,i[l],n);if(h(u)&&u<a){a=u;(r=[]).push(i[l])}}return{value:a,links:r}},A=function(e,t){return i[e].a2&&i[e].id2===t||i[e].a1&&i[e].id1===t},R=function(e,t,n,r){return"any"===r.direction||("from"===r.direction&&A(n,t)||"to"===r.direction&&A(n,e))},M=function(e,t,n,r){var a=NaN;R(e,t,n,r)&&(r.value?i[n].d&&(a=+i[n].d[r.value]):a=1);return a},V=function(e){return D(e)?S:M},S=function(e,t,n,r){var i=M(e,t,n,r);return g(i)?i:1/i},k=function(e,n){var r={},i={},a=[],o=x(n).adjacency;function l(){for(var e,t=1/0,n=0;n<a.length;n++){var i=r[a[n]];if(i<=t){e=n;t=i}}return e}function u(e,t,n){i[e]||(i[e]=[]);i[e].push({id:t,links:n})}d(n,function(e){var t=e.id;r[t]=1/0;i[t]=void 0;a.push(t)});r[e]=0;for(;a.length>0;){var c=l(),s=a[c];if(r[s]===1/0)break;a.splice(c,1);t(o[s],function(e,t){var a=w(s,t,n),o=r[s]+a.value;if(o<r[t]){r[t]=o;i[t]=[{id:s,links:a.links}]}else o===r[t]&&u(t,s,a.links)})}return{distance:r,previous:i}};function Y(e){e.direction=e.direction||"any";if(!/^(any|from|to)$/.test(e.direction))throw new TypeError("opts direction property should be either 'from', 'to' or 'any'")}function L(e){e.normalization=e.normalization||"any";if(!/^(chart|component|unnormalized)$/.test(e.normalization))throw new TypeError("opts normalization property should be either 'component', 'chart' or 'unnormalized'")}function T(e){f(e,function(t){if(M(t.id1,t.id2,t.id,e)<=0)throw new Error("Link Weight must be Positive")});return{direction:e.direction,value:e.value,weights:D(e)}}function N(e){return/^(component|chart)$/.test(e.normalization)?e.normalization:"unnormalized"}function z(e){return Y(e)||T(e)}function U(e){e.all=!!e.all}function D(e){return!!e.weights}function _(e){var t=0;d(e,function(){t++});return t}n.shortestPaths=function(e,t,n){if("string"!=typeof e||"string"!=typeof t)throw new Error("shortestPaths error: ids must be strings");if(!r[e]||!r[t])throw new Error("shortestPaths error: ids must be present in the graph");var i=B(n,{all:!1});z(i);U(i);var a=k(e,i),o=a.previous;if(a.distance[t]===1/0)return{onePath:[],one:[],items:[],distance:1/0};for(var l=[],u=[],c=t;o[c];){l.unshift(c);u.unshift(c);u.unshift(o[c][0].links[0]);c=o[c][0].id}l.unshift(c);u.unshift(c);function s(e){for(var t=[],n=0;n<e.length;n++)o[e[n].id]&&(t=t.concat(o[e[n].id]));return t}var f={};f[t]=1;var d=[];d.push({id:t});for(var g=s(d);g.length>0;){for(var h=0;h<g.length;h++){f[g[h].id]=1;for(var v=0;v<g[h].links.length;v++)f[g[h].links[v]]=1}g=s(g)}return{onePath:u,one:l,items:Object.keys(f),distance:a.distance[t]}};n.degrees=function(e){var n=B(e,{multi:!0,all:!1});n.combos="toplevel";z(n);U(n);var r=x(n).adjacency,i={};d(n,function(e){var a=e.id;i[a]=0;t(r[a],function(e,t){for(var r=0;r<e.length;r++){var o=M(a,t,e[r],n);if(h(o)){i[a]+=o;if(!n.multi)break}}})});return i};var K=n.degrees;n.betweenness=function(e,n){function r(e,t){return J[e]-J[t]}function i(e){e.sort(r);return e.shift()}function a(e,t){e.sort(r);E(e,t)||e.push(t)}function l(e,t){var n=w(e,t,R).value;return h(n)?n:I()||h(n)?1/0:1}function u(e){return e.length>0}function c(){H.length=0;T.length=0;d(p,function(e){for(var t=0;t<j.length;t++)f(j[t].dict,e.id,j[t].value)})}function s(e,t,n){d(e,function(e){f(t,e.id,n)})}function f(e,t,n){Array.isArray(n)&&u(n)&&e[t]?e[t].length=0:e[t]=o(n)}function g(){var e,t,n,r=b(p),i={};for(e=0;e<r.length;e++){n=r[e];for(t=0;t<n.nodes.length;t++)i[n.nodes[t]]=n.nodes.length}return i}function m(){return!W(p.value)}function I(){return!!p.directed}function y(){return p.endpoints}var p=B(e,{value:void 0,directed:!1,normalization:"component",endpoints:!1,weights:!1,all:!1});p.combos="toplevel";L(p);U(p);var G=m()||I()?"dijkstra":"regular",Z=y()?"endpoints":"regular",A=N(p),R={direction:I()?"from":"any",value:p.value,weights:D(p),all:p.all};z(p);var M,V,S,X,k,Y,F={},H=[],T=[],_={},K={},O={},J={},P=0,j=[{dict:K,value:0},{dict:J,value:1/0},{dict:_,value:[]},{dict:O,value:0}],Q=x(p).adjacency,q={regular:function(e){K[e]=1;J[e]=0;H.push(e);for(;u(H);){M=H.shift();T.push(M);t(Q[M],function(e,t){if(!h(J[t])){J[t]=J[M]+1;H.push(t)}if(J[t]===J[M]+1){K[t]+=K[M];_[t].push(M)}})}},dijkstra:function(e){K[e]=1;J[e]=0;H.push(e);for(;u(H);){M=i(H);T.push(M);t(Q[M],function(e,t){if(J[t]>J[M]+l(M,t)){J[t]=J[M]+l(M,t);a(H,t);K[t]=0;_[t]=[]}if(J[t]===J[M]+l(M,t)){K[t]+=K[M];_[t].push(M)}})}}},$={regular:function(e){for(;u(T);){V=T.pop();k=(1+O[V])/K[V];for(X=0;X<_[V].length;X++){M=_[V][X];O[M]+=K[M]*k}V!==e&&(F[V]+=O[V])}},endpoints:function(e){F[e]+=T.length-1;for(;u(T);){V=T.pop();k=(1+O[V])/K[V];for(X=0;X<_[V].length;X++){M=_[V][X];O[M]+=K[M]*k}V!==e&&(F[V]+=O[V]+1)}}},ee={chart:function(){if(P>2){S=1/((P-1)*(P-2));t(F,function(e,t){F[t]*=S})}},component:function(){Y=g();t(F,function(e,t){if(Y[t]>2){S=1/((Y[t]-1)*(Y[t]-2));F[t]*=S}})},unnormalized:function(){if(!I()){S=.5;t(F,function(e,t){F[t]*=S})}}},te=function(){ie();C(n,F)},ne=q[G]||q.regular,re=$[Z]||$.regular,ie=ee[A]||ee.chart;d(p,function(){P++});s(p,F,0);v(p,"betweenness",function(e,t){c();ne(e.id);re(e.id);t()},te)};n.closeness=function(e,n){var r=B(e,{direction:"any",value:void 0,normalization:"component",mode:"auto",weights:!1,all:!1});r.combos="toplevel";var a=x(r).adjacency;function o(e,n){var r=0;t(n,function(e){r+=h(e)?1:0});return r}function l(e){return 0===Object.keys(e).length}function u(e){return!W(e)}function c(e){return!i[e].a1&&!i[e].a2}function s(e){var n={},r=0,i={},o={};o[e]=1;for(;!l(o);){i=o;o={};t(i,function(e,i){if(!u(n[i])){n[i]=r;t(a[i],function(e,t){o[t]=1})}});r+=1}return n}function f(){return"any"!==r.direction}function d(){r.mode=r.mode||"auto";if(!r.mode.match(/^(connected|disconnected|auto)$/))throw new TypeError("Option mode property should be either 'connected', 'disconnected' or 'auto'")}function g(){d();return"auto"===r.mode?p():r.mode}function m(){return!W(r.value)}function I(){return N(r).match(/chart/)}function y(){return N(r).match(/component/)}function p(){var e="disconnected",t=b(r);if(1===t.length){e="connected";if(f())for(var n=0;n<t[0].links.length;n++)if(c(t[0].links[n]))return"disconnected"}return e}var w=z(r);L(r);U(r);w.all=r.all;var Z,A,R,M,V,S=m()||f()?"dijkstra":"regular",X=0,k={},E=g(),Y={regular:function(e){return s(e)},dijkstra:function(e,t){return G(e,t)}},F={connected:function(e,n){var r=0;t(n,function(e){r+=h(e)?e:0});return r?1/r:0},disconnected:function(e,n){var r=0;t(n,function(t,n){r+=e!==n?1/t:0});return r}},H=function(){C(n,k)};A=Y[S]||Y.regular;R=F[E];X=_(r);k={};v(r,"closeness",function(e,t){M=A(e.id,w);Z=o(e.id,M);k[e.id]=R(e.id,M);if(X>1){V=I()?Math.pow(Z-1,2)/(X-1):y()?Z-1:1;k[e.id]*=V}t()},H)};n.kCores=function(e){var n=B(e,{all:!1});n.combos="toplevel";U(n);var r=x(n).adjacency;function i(e){var n=0;t(e,function(e){n=Math.max(n,e)});return n}var a=function(){var e,i,a,o,l,u,c,s,f,g,h,v={},m={},b=[],I=[];i=0;v=K({multi:!1,all:n.all,combos:"toplevel"});t(v,function(e){i=Math.max(i,e)});h=Object.keys(v).length;for(e=0;e<i+1;e++)I[e]=0;d(n,function(e){I[v[e.id]]++});l=1;for(e=0;e<i+1;e++){u=I[e];I[e]=l;l+=u}d(n,function(e){var t=e.id;m[t]=I[v[t]];b[m[t]]=t;I[v[t]]++});for(e=i;e>1;e--)I[e]=I[e-1];I[0]=1;for(o=0;o<h;o++){a=b[o];t(r[a],function(e,t){if(v[t]>v[a]){s=v[t];f=m[t];g=I[s];if(t!==(c=b[g])){m[t]=g;b[f]=c;m[c]=f;b[g]=t}I[s]++;v[t]--}})}return v}();return{maximumK:i(a),values:a}};return n}var Vi={w:1,x:1,y:1,fs:1,bw:1,b1:1,b2:1};function Si(e,n,r,i){var a,l,u,c,s,f,d=new A,g=new A,v=new A,m=new A,b={x:1,y:1,w:1,h:1,e:1,fs:1,off:1,b1:1,b2:1,bw:1},I={t:1,u:1,id:1,id1:1,id2:1,ff:1,sh:1,ls:1,bs:1},y={c:1,c2:1,b:1,fc:1,fbc:1},p={p:1},C={hi:1,bg:1,ci:1,du:1,fb:1,a1:1,a2:1,re:1,tc:1,a:1},x={gh:1},G={pos:1},w={x:1,y:1,off:1,lat:1,lng:1},M={ls:{solid:!0,dashed:!0,dotted:!0},bs:{solid:!0,dashed:!0}},S=["ha0","ha1","ha2","ha3","ha4","ha5","ha6","ha7","ha8","ha9"],k={},E={},H={},L=null,z=1,U=2,_=new A,K=!1,O=!1,J=V(),P=null,j=Ri(e);k.setDirty=function(e){_.delete(e);_.set(e,U)};var Q=k.setDirty;function q(){re();a=null;u=null}function $(e){t(H,function(t){he(t,e)});t(E,function(t){he(t,e)})}var ee=Hr({numbers:b,numOrString:p,negatives:w,strings:I,stringValues:M,colours:y,booleans:C,reserved:x,mapPos:G,halos:S},Q,q,$);k.graph=function(){P||(P=Wi(n)).privateSetProperties(E,H);return P};var te=k.graph;function ne(e,t){var n,r=1===e?t.id1:t.id2;return{x:(n=d.has(t.id)?Re(r):E[r]).x,y:n.y}}k.setAllDirty=function(){K=!0;n.trigger("redraw",{all:!0})};var re=k.setAllDirty;function ie(e){K=!1;O=!1;e?_=e:_.clear()}var oe=function(e,t){var n=_.get(e);if(!n||t&&n===z){t&&_.delete(e);_.set(e,z)}};function le(){return!(!K&&!O)||_.size}k.moveAllNodesBy=function(e,t,n){ce(e,function(e){e.x+=t;e.y+=n;oe(e.id)})};k.moveNode=function(e,t,n){var r=E[e];if(r){var i=t-r.x,a=n-r.y;if(r._combo)ce([e],function(e){e.x+=i;e.y+=a;oe(e.id)});else{r.x+=i;r.y+=a;oe(r.id)}}};var ue=k.moveNode;function ce(e,t){for(var n={},r=e.slice(0);r.length>0;){var i=r.shift(),a=E[i];if(a&&!n[i]){n[i]=!0;t(a);if(a._combo)for(var o=a._combo.nodeIds,l=0,u=o.length;l<u;l++)n[o[l]]||r.push(o[l])}}}k.moveLink=function(e,t){var n=H[e];if(n){n.y=t;Q(e)}};k.setLinkOffset=function(e,t){var n=H[e];if(n){n.off=t;Q(e)}};k.ensureObject=ee.ensureObject;k.ensureTypesInArray=ee.ensureTypesInArray;k.load=function(e){if(e){E={};H={};qe(!0);Mt();ee.typeCheck(e,H);var t=ee.filterNodesAndLinks(e.items,E,H,{selfLinks:s});H=t.links;E=t.nodes;k.reveal(e.reveal,!1);ee.ensureHiddenItemConsistency(E,H);P=null;se();mt();re()}He()};function se(){L=null}function fe(e){Object.keys(e).forEach(function(t){L.push(e[t])})}k.getRawItems=function(){if(!L){L=[];fe(H);fe(E)}return L};var de=k.getRawItems;function ge(e){t(e,function(t,n){W(t)&&delete e[n]})}k.defaultValueFor=function(e){switch(e){case"e":return 1;case"fs":return i.fontSize;case"off":case"b1":case"b2":return 0;case"x":case"y":return 0;case"w":case"h":return 1;case"bw":return 4;case"donut":return D({v:[]},ee.donutDefaults);case"ha0":case"ha1":case"ha2":case"ha3":case"ha4":case"ha5":case"ha6":case"ha7":case"ha8":case"ha9":return{c:Bt.transparent,r:0,w:0};case"fi":return{c:"black",t:""};case"oc":return kr;case"c":case"b":return Bt.midgrey;case"fc":return Bt.black;case"fbc":return Bt.textback;default:return}};k.bothEndsShown=function(e){return!e.hi&&!(E[e.id1].hi||E[e.id2].hi)};k.neighbourLinkIds=function(e){return te().privateNeighbourLinks(e)};k.privateGetLinksBetween=function(e,t){for(var n=te().privateGetLinkIdsBetween(e,t),r=[],i=n.length,a=0;a<i;a++)r.push(H[n[a]]);return r};k.bothEndsForeground=function(e){return!(E[e.id1].bg||E[e.id2].bg)};function he(e,t){e[t]&&je(e.id)}function ve(e){return e&&!!e._parentId}function me(e,t,n){for(var r="x"===t||"y"===t?oe:Q,i=0;i<e.length;i++){var a=e[i],o=E[a],l=H[a];if(o){o[t]=n;r(a)}else if(l){l[t]=n;Q(a)}}}function be(e,t){var n=!1;E[e]&&(n=ye(E[e],t));H[e]&&(n=ye(H[e],t));return n}function Ie(e){return tt(e)&&!be(e,"gh")}function ye(e,t){return!!e[t]}k.resurrect=function(e){pe(e,"gh",!0)};k.ghost=function(e){xe(e,"gh")};k.show=function(e,t){pe(e,"hi",t);ze()};k.hidden=function(){return Ce("hi")};k.hide=function(e){xe(e,"hi");ze()};function pe(e,n,r){var i,a=Z(e);me(a,n,!1);ee.ensureConsistency(n,E,H);if(r){var o={},l={};for(i=0;i<a.length;i++)o[a[i]]=1;t(H,function(e){if(ye(e,n)&&!ye(E[e.id1],n)&&!ye(E[e.id2],n)&&(o[e.id1]||o[e.id2])){e[n]=!1;var t=e._parentId;t&&H[t]&&(l[t]=!0)}});ee.applyPropertyRuleToComboLinks(l,n,H)}}function Ce(e){var n=[];t(E,function(t,r){t[e]&&n.push(r)});t(H,function(t,r){t[e]&&n.push(r)});return n}function xe(e,t){me(Z(e),t,!0);ee.ensureConsistency(t,E,H)}k.each=function(e,n){e.type.match(/^(node|all)$/)&&t(E,n);e.type.match(/^(link|all)$/)&&t(H,n)};k.setItem=function(e){var t=o(e);ee.ensureObject(t,!1,H);var n=null;"node"===t.type&&(n=E);if("link"===t.type){n=H;if(!ee.hasValidEnds(t,{},E,s))return!1}ee.setZeroXY(t);if(t.id){var r=n[t.id];n[t.id]=t;if(r){r._combo&&(n[t.id]._combo=r._combo);r._parentId&&(n[t.id]._parentId=r._parentId);r._offset&&(n[t.id]._offset=r._offset)}t.hi?ee.ensureHiddenItemConsistency(E,H):q();ze();se();Q(t.id)}return He()};k.type=function(){return"LinkChart"};var Ge,we=k.type;k.setOptions=function(e){s=e.selfLinks;f=e.marqueeLinkSelection;i.setOptions(e);re()};k.setLastHoverId=function(e){Ge=e};k.showFullLabelOnHover=function(e){Ge&&Q(Ge);if(e){Q(e);i.setSpecialOptions("showFullLabel",e)}else i.setSpecialOptions("showFullLabel",null)};function Ze(){var e=[];de().forEach(function(t){t._combo||e.push(o(t,"d"))});return e}k.serialize=function(){return{type:we(),items:Ze()}};function Ae(e,n,r,i){var a,l,u,c,s;for(a=0;a<e.length;a++){l=X(e[a].id);c=[];if(l)if(n){s=new RegExp(l,"im");t(E,function(e,t){s.test(t)&&c.push(e)});t(H,function(e,t){s.test(t)&&c.push(e)})}else{E[l]&&c.push(E[l]);H[l]&&c.push(H[l])}var f=o(e[a]);delete f.id;delete f.type;for(u=0;u<c.length;u++){var d=!0,g=c[u];if(!i&&"node"===g.type&&(void 0!==f.x||void 0!==f.y)){var h=void 0===f.x?g.x:f.x,v=void 0===f.y?g.y:f.y;k.moveNode(g.id,h,v)}t(f,function(e,t){d&&"x"!==t&&"y"!==t&&(d=!1);switch(t){case"id1":case"id2":if(e!==g[t])throw Error("You cannot change the ends of an existing link");break;case"hi":case"_parentId":r.all=!0;r.hi=!0;g[t]=e;break;case"oc":r.all=!0;Object.keys(f[t]).forEach(function(e){g[t][e]=f[t][e]});break;default:Fr[t]&&(g._noHalos=!1);Vi[t]?r.positions=!0:r.all=!0;g[t]=e}});ge(g);d?oe(g.id):Q(g.id)}}}k.validateCombos=function(){var e={};function n(t){var n=t._parentId;if(n){var r=E[n]||H[n];if(!r)throw new Error("The "+t.type+" '"+t.id+"' has _parentId = '"+n+"' but the parent item is not present in the model.");if(!r._combo)throw new Error("The "+t.type+" '"+t.id+"' has _parentId = '"+n+"' but the parent item has no _combo property.");e[n]=e[n]||{};e[n][t.id]=!0}}function r(n){if(n._combo){var r={};(n._combo.nodeIds||[]).concat(n._combo.linkIds).forEach(function(t){r[t]=!0;var i=E[t]||H[t];if(!i)throw new Error("The combo "+n.type+" '"+n.id+"' has a child item '"+t+"' in its _combo property, but this item is not present in the model.");if(!e[n.id][t])throw new Error("The combo "+n.type+" '"+n.id+"' has a child item '"+t+"' in its _combo property, but this item's _parentId property is "+(i._parentId?"set to '"+i._parentId+"'":"undefined."))});t(e[n.id],function(e,t){if(!r[t]){var i=E[t]||H[t];throw new Error("The "+i.type+" '"+i.id+"' has _parentId set to '"+n.id+"' but is not included in the parent's _combo property.")}})}}t(E,n);t(H,n);t(E,r);t(H,r)};k.unsafeApplyChanges=function(e,t,n){var r,i,a;for(r=0;r<e.length;r++){i=(a=e[r]).id;var o=void 0!==a.x,l=void 0!==a.y;if(!o&&!l||n)a._combo&&h(a._combo.e)&&k.moveAllNodesBy([i],0,0);else{var u=o?a.x:E[i].x,c=l?a.y:E[i].y;k.moveNode(i,u,c)}D(E[i]||H[i],e[r]);t?Q(i):oe(i)}};k.setProperties=function(e,t,n,r){var i=o(e);i=Z(i);ee.ensureTypesInArray(i,!1,H);Ae(i,t,n,r);n.hi&&ee.ensureHiddenItemConsistency(E,H);(n.graphCache||n.hi)&&ze();return He()};function Be(e){var n={};t(e,function(e,t){e&&void 0===e.off&&(n[t]=e)});return n}k.merge=function(e){var n=o(e);ee.ensureTypesInArray(n,!1,H);var r={carefulWithXandY:!0,selfLinks:s},i=ee.filterNodesAndLinks(n,E,H,r);t(i.nodes,function(e,t){E[t]=D(E[t],e);E[t]._noHalos=!1;Q(t)});t(i.links,function(e,t){H[t]=D(H[t],e);H[t]._noHalos=!1;Q(t)});ee.ensureHiddenItemConsistency(E,H);ze();se();var a=Be(i.links);ot(a);return He()};k.firstVisibleItemInAncestry=function(e){var t=E[e]||H[e];if(t&&!t.hi){if("link"===t.type&&At(e)&&ke(e))return t;var n=k.getParentItems(e);n.push(t);var r=null;n.every(function(n){if(null===n)return!1;if(n.hi){r=null;return!1}if(n.id===e){r=t;return!1}if(n._combo){r=n;return n._combo.open}return!1});return r}return null};var Re=k.firstVisibleItemInAncestry;k.getItem=function(e){return o(Se(e),"d")};k.getItemsByID=function(e){for(var t=Z(e),n=[],r=0;r<t.length;r++){var i=Se(t[r]);i=i||null;n.push(i)}return n};var Me=k.getItemsByID;k.getAncestryIds=function(e,t){var n=e,r=[],i=0;do{t&&1===i&&n.indexOf("_combolink")>-1||r.unshift(n);var a=Se(n);n=a&&a._parentId;i++}while(n);return r};var We=k.getAncestryIds;k.getParentItems=function(e){var t=We(e);t.pop();return Me(t)};var Ve=k.getParentItems;k.getByID=function(e){var t=X(e);return E[t]||H[t]||null};var Se=k.getByID;k.allParentsOpen=function(e,t){return!Se(e)._parentId||Ve(e).every(function(e){return e._combo.open&&(!t||!e.hi)})};var Xe=k.allParentsOpen,ke=function(e){var t=H[e];if(t&&!t.hi){if(t._parentId){if(Ee(t._parentId)){var n=Re(t.id1);if(t.id1===t.id2&&n)return!0;var r=Re(t.id2);return n&&r&&n.id!==r.id}return!1}return!0}return!1};k.allParentsVisible=function(e){return!Se(e)._parentId||Ve(e).every(function(e){return!e.hi})};var Ee=k.allParentsVisible;k.topParentId=function(e){for(var t=e,n=Se(t),r=n&&n._parentId;r;)(t=r)===(r=(n=Se(t))?n._parentId:null)&&(r=null);return t};var Ye=k.topParentId,Fe={};k.imageList=function(e){var n={updated:!1,_coList:{}};t(Fe,function(t,r){n[e+r]=1});return n};function He(){var e=Te(E);return e=Te(H)||e}function Le(e){var t=!1;e.forEach(function(e){e&&e.g&&e.g.forEach(function(e){t=Ne(e)||t})});return t}function Te(e){var n=!1;t(e,function(e){n=Ne(e)||n;n=Le([e,e.t1,e.t2])||n;e.bu&&(n=Ne(e.bu.g)||n)});return n}function Ne(e){if(e){var t=e.u;if(t&&!(t in Fe)){Fe[t]=1;return!0}}}function ze(){P&&P.clearCache()}function Ue(){a={};l=0;for(var e=Object.keys(E),t=0,n=e.length;t<n;t++){var r=e[t],i=E[r];if(!i.hi&&Xe(r,!0)){a[r]=i;l++}}}function De(){u={};for(var e=Object.keys(H),t=0,n=e.length;t<n;t++){var r=e[t],i=H[r],a=!i.hi;a&&(a=At(r)?ke(r):Xe(r,!0))&&(u[r]=i)}}function _e(){if(!a){Ue();De()}}function Ke(){K||(_.size>100?_.size>=l?O=!0:Oe():te().internalMarkLinks(_))}function Oe(){t(u,function(e,t){_.has(t)||(_.has(e.id1)||_.has(e.id2))&&_.set(t,U)})}k.generate=function(e,t,n,r,o,l,s){var f,g=n.getUnzoom(),h=g!==c;h&&re();if(le()){_e();Ke();ie((f=i.generate(a,u,K,O,_,e,t,n,r,o,Qe,d,et,k.isTransferring,l,s)).stillDirty);c=g}i.generateHandles(e,t,n,v);return i.animated()||f&&f.rebuildAll||h};k.contains=function(e){return i.contains(e,E).filter(function(e){return!ve(E[e])})};k.animated=function(){return i.animated()};function Je(t){t.forEach(function(t){var n=e.privateGetItem(t);n&&(n._combo||n._parentId)&&e.privateSetAllItemsInComboDirty([e.privateGetTopItemId(n.id)])})}k.setSelection=function(e,t,n){var r=X(e);t||n||qe(!!r);v.has(r)?t&&je(r):Pe(r)};k.addToSelection=function(e,t){var r=X(e);if(r&&!v.has(r)&&Ie(r)){Je([r]);v.set(r,1);Q(r);t||n.trigger("selectionchange")}};var Pe=k.addToSelection;k.removeFromSelection=function(e,t){var r=X(e);if(v.delete(r)){Je([r]);Q(r);t||n.trigger("selectionchange")}};var je=k.removeFromSelection;k.hasSelection=function(){return v.size};k.isSelected=function(e){return!!v.size&&v.has(e)};var Qe=k.isSelected;k.clearSelection=function(e){var t=[];v.forEach(function(e,n){Q(n);t.push(n)});Je(t);v.clear();e||n.trigger("selectionchange")};var qe=k.clearSelection;function $e(e){t(e,function(e,t){Pe(t,!0)})}k.addItemsToTransfer=function(e){e.forEach(function(e){g.set(e,!0)})};k.removeItemsFromTransfer=function(e){e.forEach(function(e){g.delete(e)})};k.isTransferring=function(e){return!!g.size&&g.has(e)};k.clearExtraItemsInTransientLayer=function(){m.forEach(function(e,t){Q(t)});m.clear()};k.drawInTransientLayer=function(e){if(e&&e.length>0){e.forEach(function(e){m.has(e)||Q(e)});var t=T(e);m.forEach(function(e,n){t.has(n)||Q(n)});m=t}};k.removeFromTransientLayer=function(e){e.forEach(function(e){m.delete(e)&&Q(e)})};function et(e){return m.has(e)}var tt=function(e){_e();return a[e]||u[e]};k.isItemShown=tt;k.selectAll=function(){$e(E);$e(H);n.trigger("selectionchange")};k.doSelection=function(e){if(e){qe(!0);for(var t=0;t<e.length;t++)Pe(e[t],!0)}var n=[];v.forEach(function(e,t){n.push(t)});return n};var nt=k.doSelection;k.privateSelection=function(){return v};k.moveSelection=function(e,n){
var r=[];if(v.size){t(E,function(e,t){Qe(t)&&!ve(e)&&r.push(t)});t(H,function(e,t){if(Qe(t)){E[e.id1].du&&r.push(e.id1);E[e.id2].du&&r.push(e.id2)}})}for(var i=0;i<r.length;i++){var a=E[r[i]];k.moveNode(r[i],a.x+e,a.y+n)}};k.removeItem=function(e){var n,r=Z(e);if(r.length>0){for(var i={},a={},o=0;o<r.length;o++){n=r[o];H[n]&&(i[n]=H[n]);E[n]&&(a[n]=1)}t(H,function(e,t){(a[e.id1]||a[e.id2])&&(i[t]=e)});t(i,function(e,t){je(t,!0);Rt(t);Q(t);delete H[t]});t(a,function(e,t){je(t,!0);Q(t);delete E[t]});ze();se();ot(i);q()}};k.selectionPlusDummyNodes=function(){for(var e=nt(),t=0;t<e.length;t++){var n=H[e[t]];if(n){E[n.id1].du&&e.push(n.id1);E[n.id2].du&&e.push(n.id2)}}return e};function rt(e){var t=Wi(n);t.privateSetProperties(E,e);return t}function it(e){var t=B(e,{all:!1,self:!0,combos:"all"});return te().connections(t)}function at(e,t){var n=[],r={};if(F(e)){var i=rt(e).findAdjacency;n=it();for(var a=0;a<n.length;a++){var o=H[n[a][0]];i({all:!0,combos:"all"},o.id1,o.id2)&&(r[a]=1)}}t(n,r)}k.resetConnectionOffsets=function(e){n.trigger("redraw",{all:!0});at(e,ht);Vt(e)};var ot=k.resetConnectionOffsets,lt=function(e,t){var n;at(e,function(e,r){n=vt(e,r,t)});return n};function ut(e,t){var n=[];function r(e,t){n.push({id:e.id,off:t})}Vt(e,t,r);return n}function ct(e){for(var t={},n=0;n<e.length;n++){var r=e[n],i=H[r];i&&(t[r]=i)}return t}k.showHideBendLinks=function(e){var t=ct(e);ot(t)};k.showHideGetLinksToBend=function(e,t){var n=ct(e),r=lt(n,t),i=ut(n,t);if(i.length>0){var a=N(i);r=r.filter(function(e){return void 0===a[e.id]}).concat(i)}for(var o=[],l=0;l<r.length;l++){var u=r[l];H[u.id].off!==u.off&&o.push(u)}return o};function st(e){ht(it(e))}function ft(){t(H,function(e){delete e.st})}function dt(e,n,r,i,a){var o=i||function(e){return e};function l(e){var t=1e6,n=R(e.off)?e.off:t,r=o(e);r.id1>r.id2&&(n=c(-n));return n}function u(e,t){return l(H[e])-l(H[t])}function c(e){return 0===e?0:e}t(n||e,function(t,n){var i=e[+n];r||(i=i.filter(function(e){return!H[e].gh}));if(i.length>0){i.sort(u);for(var l=o(H[i[0]]),s=l.id1===l.id2,f=i.length,d=s?20:40,g=s?0:-.5*d*(f-1),h=0;h<f;h++){var v=H[i[h]],m=o(v),b=g+h*d;b=m.id1<=m.id2?b:-b;a(v,c(b))}}})}function gt(e,t){e.off=t;Q(e.id)}function ht(e,t){dt(e,t,!0,null,gt)}function vt(e,t,n){var r=[];function i(e,t){r.push({id:e.id,off:t})}dt(e,t,n,null,i);return r}function mt(){for(var e=it(),t={},n=0;n<e.length;n++){var r=!1,i=e[n];if(i.length>1){for(var a=0;a<i.length;a++){var o=H[i[a]];o&&(r=r||R(o.off))}r||(t[n]=1)}}ht(e,t)}k.getCursor=function(e,t){var n=Ct(e);return n||(e?'url("'+t+'openhand.cur"), pointer':"auto")};k.getResizePrimitive=function(){return i.getResizePrimitive()};var bt=new RegExp(J+"((\\S+)(?:\\-resize))$"),It={nw:["x1","y1"],n:["y1"],ne:["x2","y1"],e:["x2"],se:["x2","y2"],s:["y2"],sw:["x1","y2"],w:["x1"]};function yt(e){return(e+"").match(bt)}function pt(e){var t=yt(e);return It[t[2]]}function Ct(e){var t=yt(e);return t?t[1]:null}var xt=new RegExp(J+"(id[1|2])$");k.startDragger=function(e,t,n,i,a,o){var l=(o+"").match(xt),u=X(n);return r.createLinkEndDragger(e,k,t,E,H[u],l[1],i,a,u)};k.createDragger=function(e,t,i,o,l,c,s,f){var d=s.handMode,g=X(o);if(yt(o)){var h=pt(o),v=f,m=E[g]._combo&&E[g]._combo.open;return r.primitiveMover(Zr,t,i,g,v,!0,h,l,c,m,function(e){n.trigger("prechange","resize");var t=E[X(o)],r=e.a,i=r?r.x:0,a=r?r.y:0;if(m)t.oc.w=2*e.r;else if("C"===e.p){t.x=i+e.x;t.y=a+e.y;t.w=2*e.r;t.h=t.w}else{var l=i+e.x1,u=a+e.y1,c=i+e.x2,s=a+e.y2;t.x=l+Math.floor((c-l)/2);t.y=u+Math.floor((s-u)/2);t.w=c-l;t.h=s-u}Q(t.id)})}if(null!==g&&H[g]&&"h"!==H[g].st){if(H[g].id1===H[g].id2)return null;var b=(o+"").match(xt);return b?r.createLinkEndDragger(e,k,i,E,H[g],b[1],l,c,g):r.createLinkDragger(ne,t,i,k,H[g],l,c,g)}k.clearExtraItemsInTransientLayer();if(d&&null===o)return r.createHandDragger(i,l,c,qe);if(null!==g){_e();return r.createDefaultDragger(k,a,u,Qe,Gt,i,o,l,c)}return wt(i,l,c)};function Gt(){var e=[];v.forEach(function(t,n){var r=E[n];r&&r._parentId&&e.push(Ye(r._parentId))});return e}var wt=function(e,r,i){if(!n.trigger("dragstart","area",null,e.unscale(r),e.unscale(i),null)){var o={};v.forEach(function(e,t){o[t]=1});var l={id:"__dragger",p:xn.rect,x1:r,y1:i,x2:r,y2:i,bc:Bt.midgrey,bw:1,fc:Bt.blue,fi:!1},c=e.viewToWorldX(r),s=e.viewToWorldY(i),d={x1:c,y1:s,x2:c,y2:s};l.wbc=Ot(l.bc);l.wfc=Ot(l.fc);return{scrollable:!0,getCursor:function(){return"crosshair"},generate:function(e){var t=e.getLayer(),n=e.getLayerPath();e.setLayerPath(null);e.setLayer(ci.HANDLES);e.copyPrimitive(l);e.setLayerPath(n);e.setLayer(t)},dragMove:function(e,t,n,r){m(e,t,n,r)},endDrag:function(t,r,i){e.cancelScroll();n.trigger("dragend","area",null,e.unscale(r),e.unscale(i))||(t?n.trigger("selectionchange"):qe());n.trigger("dragcomplete","area",null,e.unscale(r),e.unscale(i))}}}function g(t,n){l.x1=Math.min(e.worldToViewX(c),t);l.y1=Math.min(e.worldToViewY(s),n);l.x2=Math.max(e.worldToViewX(c),t);l.y2=Math.max(e.worldToViewY(s),n);d.x1=e.viewToWorldX(l.x1);d.y1=e.viewToWorldY(l.y1);d.x2=e.viewToWorldX(l.x2);d.y2=e.viewToWorldY(l.y2)}function h(e,r,i){t(e,function(e,t){e?Pe(t,!0):(r||i)&&o[t]||je(t,!0)});n.trigger("redraw",{all:!0})}function m(e,n,r,i){_e();g(e,n);var o={};t(a,function(e,t){o[t]=jn(d,e.x,e.y)});"off"!==f&&t(u,function(e,t){if("centre"===f)o[t]=jn(d,e._x,e._y);else if("ends"===f){var n=a[e.id1],r=a[e.id2];o[t]=jn(d,n.x,n.y)&&jn(d,r.x,r.y)}});h(o,r,i)}};k.createGestureDragger=function(r,i,a){var o,l,u,c,s=r.zoom(),f=r.viewToWorldX(i),d=r.viewToWorldY(a),g={};t(E,function(e,t){g[t]={x:e.x,y:e.y}});function h(t,n,i){var a=-t*(2*Math.PI/360);a*=2;var o=Math.sin(a),l=Math.cos(a);e.privateEach({type:"node",items:"toplevel"},function(e){var t=e.id,n=(g[t].x-f)*l+(g[t].y-d)*o+f,r=-(g[t].x-f)*o+(g[t].y-d)*l+d;ue(t,n,r)});var u=r.viewToWorldX(n),c=r.viewToWorldY(i);e.privateEach({type:"node",items:"toplevel"},function(e){var t=e.id;ue(t,e.x+(u-f),e.y+(c-d))})}function v(e){var t=Math.pow(e,2);r.zoomToPosition(t*s,i,a)}function m(e,t,n,r){o=e;l=t;u=n;c=r}m(1,0,f,d);var b=!1,I=60,y=!1;function p(){v(o);b=b||Math.abs(l)>12;y=y||Math.abs(u-f)>I||Math.abs(c-d)>I;h(b?l:0,y?u:f,y?c:d)}function C(){e.privateEach({type:"node",items:"toplevel"},function(e){var t=e.id;ue(t,g[t].x,g[t].y)})}return{animate:function(){p()},getCursor:function(){return"move"},dragMove:function(e,t,n,r){m(e,t,n,r)},endDrag:function(e,t,r,i,a){m(t,r,i,a);if(e){C();n.trigger("prechange","move");p()}else C()}}};k.labelPosition=function(e,t){var n=Se(e);return i.labelPosition(n,t)};k.extractStructure=function(e,t,n,r){return j.extractStructure(i,e,E,H,te,t.fixed,n,r)};k.updateLinkStyles=function(e){if(e.straighten){n.trigger("redraw",{all:!0});st({self:!1,combos:"toplevel"})}ft()};k.layout=function(e,t,n,r,i){j.layout(e,t,n,te,r,i)};k.arrange=function(e,t,n,r,i,a,o){j.arrange(e,t,n,r,te,i,a,o)};k.applyVertices=function(e){t(E,function(t,n){e[n]&&ue(n,e[n].x,e[n].y)})};k.applyUpdatedOffsets=function(e){t(H,function(t,n){e[n]&&k.setLinkOffset(n,e[n].off)})};k.makeAnimator=function(e,n,r){var i=n,a={};t(E,function(e,t){a[t]={x:e.x,y:e.y}});return Rr(function(o){i-=o;var l=r(Math.max(0,(n-i)/n));t(E,function(t,n){if(e[n]){var r=a[n].x+l*(e[n].x-a[n].x),i=a[n].y+l*(e[n].y-a[n].y);ue(n,r,i)}});return i>0},{positions:!0})};function Zt(e){var t=H[e];return t&&!t._combo}k.reveal=function(e,t){if(e){Mt();e.forEach(function(e){if(e&&!d.has(e)&&Zt(e)){d.set(e,!0);Q(e)}});!1!==t&&Vt(void 0,void 0,void 0,!0);q()}};k.isRevealedLink=function(e){return!!d.size&&d.has(e)};var At=k.isRevealedLink;k.getRevealedLinks=function(){var e=[];d.forEach(function(t,n){e.push(n)});return e};var Rt=function(e){Q(e);d.delete(e);Qe(e)&&!Xe(e)&&je(e)};k.clearRevealedLinks=function(){d.forEach(function(e,t){Q(t);Qe(t)&&!Xe(t)&&je(t)});d.clear()};var Mt=k.clearRevealedLinks;function Wt(e,n,r){t(e,function(e){var t,i=Re(e.id1),a=Re(e.id2);if(null!==i&&null!==a&&i!==a){t=i.id>a.id?i.id+a.id:a.id+i.id;void 0===n[t]&&(n[t]=[]);n[t].push(e.id);r[e.id]={id1:i.id,id2:a.id}}})}k.applyRevealedLinkOffsets=function(e,n,r,i){var a=void 0===r?gt:r,o={},l={};Wt(k.getRevealedLinks().map(Se).filter(function(e){return!e.hi}),o,l);function u(e){return void 0!==l[e.id]?l[e.id]:e}function c(e,t){if(l[e]){var n,r=l[e],i=We(r.id1);for(n=0;n<i.length;n++)if(t[i[n]])return!0;i=We(r.id2);for(n=0;n<i.length;n++)if(t[i[n]])return!0}return!1}var s=null;if(e){var f=[],d={};t(e,function(e){if("node"===e.type){var t=Re(e.id);t&&(d[t.id]=!0)}else f.push(e)});var g={};Wt(f,g,{});s={};var h=!1;Object.keys(o).forEach(function(e,t){if(void 0!==g[e]||c(o[e][0],d)){s[t]=!0;h=!0}});if(!h)return}if(i){var v=a;a=function(e,t){e.id1===l[e.id].id1&&e.id2===l[e.id].id2||v(e,t)}}dt(Y(o),s,n,u,a)};var Vt=k.applyRevealedLinkOffsets;return k}function Xi(e,n,r){var i,a,o={},l={},u={},c=[],s={},d={};function g(e,t,n){var r=!!t;d[e]=r;n&&cr()&&(d[sr(e)]=r);return e}function h(){return r&&r.api.isShown()}function v(){return r&&r.internalUse.isMapLoaded()}o.appendImageList=function(e){t(d,function(t,n){e[n]=1})};function m(){i=Bt.ci;a=Bt.cia}m();o.colorize=function(e,n,r){var o,l={};if(r){var u=Gr(e,d,n,"rgb(0,174, 234)",r);o=u.colour;l=u.images;i=Rt(o[0],o[1],o[2]);a=Mt(o[0],o[1],o[2],.5)}else m();t(e,function(t,n){if("updated"!==n&&"_coList"!==n){var r=l[n]||t.im;t.co=r;e.updated=!0}})};o.setup=function(){G();e.privateBind("click",b)};function b(e){s[e]&&s[e].apply(null,arguments)}o.createDragger=function(e,t,n){return e in l?l[e](t,n):null};o.reset=function(){l={};u={};c=[];s={};d={};e.privateUnbind("click",b)};var I,y,p,C,x,G=o.reset;o.getCursor=function(e){return e in u?u[e]:"auto"};o.generate=function(e,t,n,r,i,a,o){e.setLayerPath(null);for(var l=0;l<c.length;l++)c[l].generate(e,t,n,r,i,a,o)};o.getWatermarkSize=function(e,t){for(var n=0;n<c.length;n++){var r=c[n];if(r.watermarkSize)return r.watermarkSize(e,t)}return null};o.addLogo=function(e,t){var n=15,r="_logo",i=g(e+t.u,!1,!0),a={generate:function(e,a,o,l){e.setLayer(ci.OVERLAYS);var u=l[i].im,c=t.p||"ne",s=("w"===c.charAt(1)?n:o.width()-(u.width+n))+(t.x||0),f=("n"===c.charAt(0)?n:o.height()-(u.height+n))+(t.y||0);e.image(o.scale(s),o.scale(f),o.scale(s+u.width),o.scale(f+u.height),i,r,null,!1,!0)}};c.push(a)};o.addTextWatermark=function(e,t,n,r,i,a,o,l){var u="_textWatermark",s={watermarkSize:function(r,i){var a,o;if(e&&i){var u=i[e].im;a=u.width;o=u.height}else if(t){a=pr(r,t,n,l).width;o=n}return a?{width:a+10,height:o+10}:null},generate:function(c,s,f,d){var g,h;c.setLayer(ci.UNDERLAYS);if(e){var v=d[e].im;g=f.scale((f.width()-v.width)/2);h=f.scale((f.height()-v.height)/2);c.image(g,h,g+f.scale(v.width),h+f.scale(v.height),e,u)}else if(t){var m=f.scale(n),b=pr(s,t,n,i,l).width;g=f.scale((f.width()-b)/2);h=f.scale((f.height()+n)/2);var I=-3.5,y=Math.floor(m/8);"top"===o&&(h=m+y);"bottom"===o&&(h=f.scale(f.height())+1);a&&c.rect(g-I,h-m-y,g+b+I+y,h,a,-1,a,!0,u);c.text(g,h,t,r,m,i,u,l,!1,b,!1,!1,g+I,h-m,g+b+I,h)}}};c.push(s);e&&g(e)};function w(e,t,n,r,i,a,o){e.rect(t.scale(n),t.scale(r),t.scale(i),t.scale(a),Bt.transparent,-1,Bt.transparent,!0,o)}o.addNavigation=function(t,n,i,a){var o,f=g(i+"Background.png",!0,!0),d=g(i+"BackgroundShort.png",!0,!0),m=g(i+"Slider.png",!1,!0),b=g(i+"Hand.png",!1,!0),I=g(i+"Arrow.png",!1,!0),y=7,p=17,C=62,x=k()?145:247,G=a.p||"nw",Z=("w"===G.charAt(1)?y:n.width()-(y+C))+(a.x||0),A=("n"===G.charAt(0)?p:n.height()-(p+x))+(a.y||0),B=Z+21,R=A+118,M=A+215;s._zoomIn=function(){t.zoomIn(!0)};s._zoomOut=function(){t.zoomOut(!0)};s._panLeft=function(){t.pan("left",!0)};s._panRight=function(){t.pan("right",!0)};s._panUp=function(){t.pan("up",!0)};s._panDown=function(){t.pan("down",!0)};s._fitToWindow=function(){t.fitToModel(!0)};s._toggleMode=function(){var e=t.options();e.handMode=!e.handMode;t.options(e)};function W(){return t.options().handMode}s._scale=function(e,t,n){V(n,!0)};function V(e,n){var r=X(e-o[m].im.height/2);t.setZoom(r,n)}u._zoomIn="pointer";u._zoomOut="pointer";u._panLeft="pointer";u._panRight="pointer";u._panUp="pointer";u._panDown="pointer";u._fitToWindow="pointer";u._toggleMode="pointer";u._scale="pointer";u._slider='url("'+i+'openhand.cur"), pointer';l._slider=function(){var i=n.zoom();if(k())return null;if(!e.trigger("dragstart","slider")){h()&&r.internalUse.enableDragging(!1);return{getCursor:function(){return"move"},dragMove:function(e,t){V(n.unscale(t),!1)},endDrag:function(n){var a=e.trigger("dragend","slider");n&&!a||t.setZoom(i,!1);h()&&r.internalUse.enableDragging(t.options().handMode);e.trigger("dragcomplete","slider")}}}};function S(e){var t;t=v()?r.internalUse.zoom():(Math.log(e)-Math.log(n.getMinZoom()))/(Math.log(n.getMaxZoom())-Math.log(n.getMinZoom()));return Math.floor(R+(1-t)*(M-R))}function X(e){var t=1-(e-R)/(M-R);return h()?r.internalUse.getMaxZoom()*t:Math.exp(t*(Math.log(n.getMaxZoom())-Math.log(n.getMinZoom()))+Math.log(n.getMinZoom()))}function k(){return n.height()<300}var E={generate:function(e,t,n,r,i,a){var l=k()?d:f,u=r[l].im;if(t.webgl&&!r._coList[l]){r._coList[l]=!0;r._coList[sr(l)]=!0;r.updated=!0}if(!a){o=r;e.setLayer(ci.OVERLAYS);e.image(n.scale(Z),n.scale(A),n.scale(Z+u.width),n.scale(A+u.height),l,"_background","co",!1,!0);var c=Z+19,s=A+64,g=n.scale(c),h=n.scale(s),v=n.scale(c+28),y=n.scale(s+32),p=W()?b:I;e.image(g,h,v,y,p,null,null,!1,!0);e.setLayer(ci.OVERLAYSSHADOW);e.image(g,h,v,y,p,"_toggleMode");var C=5,x=23,G=39,R=57,M=105,V=k()?124:222,X=18,E=3,Y=68,F=22;w(e,n,Z+x,A+M,Z+G,A+M+X,"_zoomIn");w(e,n,Z+x,A+V,Z+G,A+V+X,"_zoomOut");w(e,n,Z+C,A+x,Z+x,A+G,"_panLeft");w(e,n,Z+G,A+x,Z+R,A+G,"_panRight");w(e,n,Z+x,A+C,Z+G,A+x,"_panUp");w(e,n,Z+x,A+G,Z+G,A+R,"_panDown");w(e,n,Z+x,A+x,Z+G,A+G,"_fitToWindow");k()||w(e,n,Z+x,A+M+X,Z+G,A+V,"_scale");w(e,n,Z+x-E,A+Y,Z+G+E,A+Y+F,"_toggleMode");if(!k()){var H=S(n.zoom()),L=n.scale(B),T=n.scale(H),N=n.scale(B+r[m].im.width),z=n.scale(H+r[m].im.height);e.image(L,T,N,z,m,"_slider");e.setLayer(ci.OVERLAYS);e.image(L,T,N,z,m,null,null,!1,!0)}}},createDragger:function(){}};u[f]="wait";c.push(E)};var Z={ne:"sw",nw:"se",se:"nw",sw:"ne"};o.addOverview=function(t,r,o,d,h,v){var m=v.p&&Z[v.p]?v.p:"se",b=g(h+"Arrow-"+Z[m]+".png",!0,!0),G=g(h+"Arrow-"+m+".png",!0,!0);v.size=v.size||100;I=v.size;p=v.shown;x="n"===m.charAt(0);C="w"===m.charAt(1);var w=(y=d(I,I)).getContext("2d"),A=!1,B=!1,R=Date.now(),M=n.createView(e,I,I);s._overviewIcon=function(){v.shown=!v.shown;p=v.shown;e.trigger("overview",p?"open":"close")};u._overviewIcon="pointer";function W(e){var t={x1:o.viewToWorldX(o.scale(-e)),x2:o.viewToWorldX(o.scale(o.width()+e)),y1:o.viewToWorldY(o.scale(-e)),y2:o.viewToWorldY(o.scale(o.height()+e))};return{x1:M.worldToViewX(t.x1),x2:M.worldToViewX(t.x2),y1:M.worldToViewY(t.y1),y2:M.worldToViewY(t.y2)}}var V,S,X=null,k=!1,E=0,Y=0,F=0,H=0,L=2;u._overviewBox='url("'+h+'openhand.cur"), pointer';function T(){F+=V.x;H+=V.y;e.trigger("redraw")}function N(){S=f(T,50)}function z(){if(S){clearInterval(S);S=null}}l._overviewBox=function(n,r){if(!e.trigger("dragstart","overview")){k=!0;var i=2;E=0;Y=0;F=0;H=0;var a=-X.x1+i,l=I-X.x2-i,u=-X.y1+i,c=I-X.y2-i;return{getCursor:function(){return"move"},dragMove:function(e,t){z();Y=t-r;V={x:0,y:0};var i=!1;if((E=e-n)<a){E=a;V.x=L;i=!0}if(E>l){E=l;V.x=-L;i=!0}if(Y<u){Y=u;V.y=L;i=!0}if(Y>c){Y=c;V.y=-L;i=!0}i&&N()},endDrag:function(n){k=!1;z();var r=e.trigger("dragend","overview");if(n&&!r){var i=-(E-F)*(o.zoom()/M.zoom()),a=-(Y-H)*(o.zoom()/M.zoom());t.panBy(i,a,!0)}e.trigger("dragcomplete","overview")}}}};function U(e){var t=Math.max(e.width(),e.height())/2;M.reset(!1);var n=W(t);M.fitExtents(n,null,!1,!1,void 0,void 0,void 0,!0);var r=e.getMaxItemZoom();r!==1/0&&M.setMaxItemZoom(r/8);k&&M.panBy(F,H,!1,!0)}var D={generate:function(n,o,l,u,c,s){if(!s){if(p){var f,d,g,h,m=C?l.scale(-1):l.scale(l.width()-I-2),y=x?l.scale(-1):l.scale(l.height()-I-2),Z=C?l.scale(I+2):l.scale(l.width()+1),V=x?l.scale(I+2):l.scale(l.height()+1),S=Math.max(1,l.scale(3)),F=C?l.scale(-1):l.scale(l.width()-I)-.5,H=x?l.scale(-1):l.scale(l.height()-I)-.5,L=C?l.scale(I)+.5:l.scale(l.width()+1),T=x?l.scale(I)+.5:l.scale(l.height()+1),N=Math.max(1,l.scale(1));n.setLayer(ci.OVERLAYSSHADOW);n.rect(m,y,Z,V,Bt.white,S,Bt.white,!0,"_overviewBorder1");n.rect(F,H,L,T,Bt.lightgrey,N,Bt.white,!1,"_overviewBorder2");n.setLayer(ci.OVERVIEW);n.rect(m,y,Z,V,Bt.white,S,Bt.white,!1);n.rect(F,H,L,T,Bt.lightgrey,N,Bt.white,!1);if(r){var z=Date.now();if(A&&!k&&z<R+1e3&&B)e.trigger("redraw");else{R=Date.now();A=!0;if(o.webgl){U(l);t.setOverviewView(M)}else{w.clearRect(0,0,I,I);w.fillStyle=Bt.white;w.fillRect(0,0,I,I);t.drawBackground(w);U(l);Vn(n,w,M,u,t.options(),!1,null,!0)}B=Date.now()-R>30}X||(X=W(0));var D=k?E:0,_=k?Y:0,K=k?"_overviewBoxDragging":"_overviewBox";f=l.scale(C?X.x1+D:l.width()-I+X.x1+D);d=l.scale(x?X.y1+_:l.height()-I+X.y1+_);g=l.scale(C?X.x2+D:l.width()-I+X.x2+D);h=l.scale(x?X.y2+_:l.height()-I+X.y2+_);var O=Math.max(1,l.scale(2));n.setLayer(ci.OVERVIEWSHADOW);n.rect(f,d,g,h,i,O,a,!k,K);n.setLayer(ci.OVERVIEW);n.rect(f,d,g,h,i,O,a,!k,K)}}var J=p?G:b,P=u[J].im;if(v.icon){n.rect(C?l.scale(-1):l.scale(l.width()-P.width)-.5,x?l.scale(-1):l.scale(l.height()-P.height)-.5,C?l.scale(P.width)+.5:l.scale(l.width()+1),x?l.scale(P.height)+.5:l.scale(l.height()+1),Bt.lightgrey,Math.max(1,l.scale(1)),Bt.white,!0,"_overviewIconRect");n.image(l.scale(C?0:l.width()-P.width),l.scale(x?0:l.height()-P.height),l.scale(C?P.width:l.width()),l.scale(x?P.height:l.height()),J,"_overviewIcon","co",!1,!0);if(o.webgl&&!u._coList[J]){u._coList[J]=!0;u._coList[sr(J)]=!0;u.updated=!0}n.setLayer(ci.OVERVIEWSHADOW);n.rect(l.scale(C?-1:l.width()-2*P.width),l.scale(x?-1:l.height()-2*P.height),l.scale(C?2*P.width:l.width()+1),l.scale(x?2*P.height:l.height()+1),Bt.lightgrey,-1,Bt.white,!0,"_overviewIcon")}}}};c.push(D)};o.remove=function(e,t,n){var r=42,i={generate:function(i,a,o){i.setLayer(ci.OVERLAYS);var l=pr(a,e,r).width,u=o.scale((o.width()-l)/2),c=o.scale((o.height()+r)/2);i.text(u+2,c+2,e,n,o.scale(r),!0,null,null,!1,l,!1,!1,u+2,c+2-o.scale(r),u+2+l,c+2);i.text(u,c,e,t,o.scale(r),!0,null,null,!1,l,!1,!1,u,c-o.scale(r),u+l,c)}};c.push(i)};o.drawOverviewContent=function(e,t){if(p&&y){var n=t.scale(I);e.drawImage(y,0,0,n,n,t.scale(C?0:t.width()-I),t.scale(x?0:t.height()-I),n,n)}};o.addBanding=function(e){var t=6,n=3,r=3,i=6,a={generate:function(a,o,l){var u=D({top:!0},e.bands);if(u&&u.bands){var c,s,f,d,g,h,v;a.setLayer(ci.BANDS);var m=1/0;for(c=0;c<u.bands.length;c++)if((g=u.bands[c]).t){s=l.dim(g.w/2);f=g.ff||e.fontFamily;h=.75*(d=g.fs||20);(v=pr(o,g.t,d,g.fb,f).width/2)+h>s&&(d=Math.floor(d*s/(v+h)));d<m&&(m=d)}m!==1/0&&(h=.75*m);for(c=0;c<u.bands.length;c++){g=u.bands[c];var b=l.x(g.x),I=l.x(g.x-g.w/2),y=l.x(g.x+g.w/2),p=l.scale(-1),C=l.scale(l.height()+1);s=l.dim(g.w/2);var x=g.c||"#f7f7f7";a.rect(I,p,y,C,"white",-1,x,!0,"");var G=!(g.t&&m>3);a.setLayer(ci.BANDLABELS);f=g.ff||e.fontFamily;v=pr(o,g.t,m,g.fb,f).width/2;var w=g.fc||Bt.lightgrey,Z=l.scale(m),A=(y-I)/2-v;if(u.top){var B=t+Z;a.rect(I,p,y,B+n,"white",-1,x,!0,"",null,G);a.text(b-v,B,g.t,w,Z,g.fb,"",f,!1,2*v,!1,!1,I+A,p+2*n,y+A,B+2*n,null,null,null,G)}if(u.bottom){var R=l.height()-r,M=R-(Z+i);a.rect(I,M,y,C,"white",-1,x,!0,"",null,G);a.text(b-v,R,g.t,w,Z,g.fb,"",f,!1,2*v,!1,!1,I+A,M+2*n,y+A,M+2*n+d,null,null,null,G)}a.setLayer(ci.BANDS)}}}};c.push(a)};return o}function ki(e,t,n,r,i){var a={},o=0,l=0,u=0,c=0,s=0,f=t||0,d=n||0,g=r||1;a.scaleFactor=function(e){e&&(g=e);return g};a.scale=function(e){return Math.floor(g*e)};var h=a.scale;a.unscale=function(e){return Math.floor(e/g)};a.settings=function(){return{width:f,height:d,zoom:u,offsetX:c,offsetY:s}};a.fromSettingsDirect=function(e,t,n,r){return _(u,X(e.zoom),e.offsetX-c,e.offsetY-s,t,n,r)};a.fromOldSettings=function(t,n,r,i){if(n){var a=ki(e,t.width,t.height);a.setZoom(t.zoom,!1);a.offsetX=t.offsetX;a.offsetY=t.offsetY;var o={x1:a.viewToWorldX(0),y1:a.viewToWorldY(0),x2:a.viewToWorldX(a.width()),y2:a.viewToWorldY(a.height())};return Y(o,null,r,!1,!1,!1,i)}k(t.zoom,!1);c=t.offsetX;s=t.offsetY};a.width=function(e){e&&(f=e);return f};a.height=function(e){e&&(d=e);return d};a.worldToViewX=function(e){return Math.floor(((e-o)*u+c)*g)};a.x=a.worldToViewX;var v=a.worldToViewX;a.worldToViewY=function(e){return Math.floor(((e-l)*u+s)*g)};a.y=a.worldToViewY;var m=a.worldToViewY;a.viewToWorldX=function(e){return Math.floor((e/g-c)/u+o)};var b=a.viewToWorldX;a.viewToWorldY=function(e){return Math.floor((e/g-s)/u+l)};var I=a.viewToWorldY;a.w=function(e){return-1===e?-1:Math.max(1,Math.floor(e*u*g))};a.sw=function(e){return-1===e?-1:a.w(e)+7};a.dim=function(e){return Math.floor(e*u*g)};a.sdim=function(e){return e&&e*u*g};a.undim=function(e){return Math.floor(e/(u*g))};a.sundim=function(e){return e/(u*g)};var y=1.4,p=4,x=.05,G=x,w=.001,Z=1,A=200,B=1/0,M=100;function W(){return i&&i.api.isShown()}a.getMaxZoom=function(){return p};a.getMinZoom=function(){return G};a.setMinZoom=function(e){G=Math.min(Z,Math.max(w,e||x));u<G&&_(u,G,c,s,!1)};a.setMaxItemZoom=function(e){B=e||1/0};a.getMaxItemZoom=function(){return B};a.zoomIn=function(e,t,n){var r=V();return H(r,g*f/2,g*d/2,e,t,n)};a.zoomOut=function(e,t,n){var r=S();return H(r,g*f/2,g*d/2,e,t,n)};function V(){return X(u*y)}function S(){return X(u/y)}var X=function(e){return Math.min(p,Math.max(e,G))};a.setZoom=function(e,t,n,r){var i=X(e);return H(i,g*f/2,g*d/2,t,n,r)};var k=a.setZoom;a.getUnzoom=function(){return u>B?B/u:1};a.wheelToPosition=function(e,t,n){var r=e>0?V():S();return H(r,t,n,!0,200)};a.worldExtentsToView=function(e){return e?{x1:v(e.x1),y1:m(e.y1),x2:v(e.x2),y2:m(e.y2)}:null};var E=a.worldExtentsToView;a.fitWorldExtents=function(e,t,n,r,i,a,o){if(!e){C(o);return null}var l=E(e);return Y(l,null,t,n,r,i,a,!1,o)};a.fitExtents=function(e,t,n,r,i,a,h,v,m,y){var p;if((e.y2-e.y1)/(e.x2-e.x1)>d/f){p=u*(d-(a?d/8:0))/(e.y2-e.y1)}else{p=u*(f-(a?f/8:0))/(e.x2-e.x1)}p*=g;r&&(p=X(p));i&&p>1&&(p=1);y&&(p=u);var C=(e.x1+e.x2)/2,x=(e.y1+e.y2)/2,G=t?(t.x1+t.x2)/2:b(C),w=t?(t.y1+t.y2)/2:I(x);return _(u,p,f/2-(G-o)*p-c,d/2-(w-l)*p-s,n,h,m,v)};var Y=a.fitExtents;function F(e,t,n,r,i,o,l,u,c,s,f){t.generate(n,r,a,i,c,!0,!1);var d=n.itemExtents(e,r);if(d){var g=E(d);if(f){var h;h=e?g.x1+(g.x2-g.x1)/2:a.width()/2;g.x1=h;g.x2=h}return Y(g,d,o,!0,!0,!0,l,!1,u,s)}C(u);return null}a.fitToSelection=function(e,t,n,r,i,a,o,l,u,c){return F(e.privateSelection(),e,t,n,r,i,a,l,u,c)};a.fitToModel=function(e,t,n,r,i,a,o,l,u,c){return o?F(T(o),e,t,n,r,i,a,l,u,c):F(null,e,t,n,r,i,a,l,u)};a.fitModelHeight=function(e,t,n,r,i,a,o,l,u,c){return o?F(T(o),e,t,n,r,i,a,l,u,c,!0):F(null,e,t,n,r,i,a,l,u,!1,!0)};a.zoomToPosition=function(e,t,n,r,i,a){var f=X(e),d=b(t),h=I(n);return _(u,f,t/g-(d-o)*f-c,n/g-(h-l)*f-s,r,i,a)};var H=a.zoomToPosition;a.reset=function(e){o=421;l=298;if(e)_(u,1,421-c,298-s,!0);else{c=421;s=298;u=1}};var L=a.reset;a.zoom=function(){return W()?i.internalUse.getZoom():u};a.offsetXtoWebglPanX=function(){var e=f/2;return-(1-a.offsetX()/e)+(e-o)/e*u};a.offsetYtoWebglPanY=function(){var e=d/2;return 1-a.offsetY()/e-(e-l)/e*u};a.offsetX=function(e){R(e)&&(c=e);return c};a.offsetY=function(e){R(e)&&(s=e);return s};a.pan=function(e,t,n,r){var i=0,a=0;switch(e){case"up":a=1;break;case"down":a=-1;break;case"left":i=1;break;case"right":i=-1}return D(i*=M,a*=M,t,!1,n,r)};a.panBy=function(e,t,n,r,i,a){return _(u,u,e,t,n,i,a,r)};var N,z,U,D=a.panBy,_=function(t,n,r,i,a,o,l,f){var d=r||0,g=i||0;if(a)return K(t,n,d,g,o,l);c+=Math.floor(d);s+=Math.floor(g);u=n;e&&!f&&e.trigger("viewchange");C(l)},K=function(t,n,r,i,a,o){var l=a||A,f=l,d=c,g=s;return Rr(function(a){f-=a;var h=e.atanEasing(Math.max(0,Math.min(1,(l-f)/l)));c=d+h*r;s=g+h*i;u=X(t+h*(n-t));var v=f>0;if(!v){e.trigger("viewchange");C(o)}return v},{drawOnly:!0})},O=function(t,n,r,a,o){var l=W(),u=l?-3:.1;return Rr(function(f){var d=0===z&&0===U;if(l)i.internalUse.panBy([z*u,U*u],{animate:!1});else{c+=f*u*z;s+=f*u*U}N=!d;r&&r.dragMove(t,n,a,o);d||e.trigger("viewchange");return!d},{positions:!0})};a.cancelScroll=function(){z=0;U=0};a.maybeScroll=function(e,t,n,r,i){var a=h(50);z=0;U=0;e<a&&(z=1);e>h(f)-a&&(z=-1);t<a&&(U=1);t>h(d)-a&&(U=-1);if(n.direction){n.direction.x||(z=0);n.direction.y||(U=0)}if((0!==z||0!==U)&&!N){N=!0;return O(e,t,n,r,i)}};L();return a}var Ei=Object.freeze({createView:ki});function Yi(e,t,n){var r={},i=null,a=null,l=null,u=null;t.privateBind("redraw",function(){i=null;a=null});function c(e,t,r){if(!e.type||!e.type.match(/^(node|link|all)$/))throw new TypeError("options type property should be either 'node', 'link' or 'all'");if(!e.items||!e.items.match(/^(underlying|toplevel|all)$/))throw new TypeError("options items property should be either 'underlying', 'toplevel' or 'all'");if(!i){a=n.privateGetRawItems();l=a;if(t)u=a;else{i=o(a,"d");u=i}}if(m(r))for(var c=0;c<l.length;c++){var s=l[c];d(e.type,s)&&g(e.items,s)&&r(u[c])}}r.each=c;r.filter=function(t,r,i){var a="underlying"===r.items,l=h(t,"hi","shown","hidden",r.type,r.hideSingletons,!1,a),u=l.shown.nodes.concat(l.shown.links),c=l.hidden.nodes.concat(l.hidden.links),s=e.combo.internalUse.filter(u,c,l,r);u=s.toShow;function f(){C(i,o({shown:l.shown,hidden:l.hidden,combos:l.combos},!0))}if((c=s.toHide).length>0)if(u.length>0){r.time/=2;n.privateHideWithoutCombos(c,r,function(){n.privateShowWithoutCombos(u,!1,r,f)})}else n.privateHideWithoutCombos(c,r,f);else u.length>0?n.privateShowWithoutCombos(u,!1,r,f):f()};r.foreground=function(t,r,i){var a="link"===r.type,l="underlying"===r.items,u=h(t,"bg","foreground","background",r.type,a,!0,l),c=u.foreground.nodes.concat(u.foreground.links),s=u.background.nodes.concat(u.background.links),f=e.combo.internalUse.foreground(c,s,u,r);s=f.toHide.map(function(e){return{id:e,bg:!0}});c=f.toShow.map(function(e){return{id:e,bg:!1}});n.setProperties(c.concat(s),!1,function(){C(i,o({foreground:u.foreground,background:u.background},!0))})};function s(e,t){t.forEach(function(t){if(e[t.id]){e[t.id1]=!0;e[t.id2]=!0}})}function f(e,t){t.forEach(function(t){e[t.id]=!(!e[t.id1]||!e[t.id2])})}function d(e,t){return"all"===e||e===t.type}function g(e,t){var n=!0;switch(e){case"toplevel":n=!t._parentId;break;case"all":n=!0;break;case"underlying":default:n=!t._combo}return n}function h(e,t,n,r,i,a,o,l){var u={},d={all:{}};d[n]={nodes:[],links:[]};d[r]={nodes:[],links:[]};d.all[n]={nodes:[],links:[]};d.all[r]={nodes:[],links:[]};var g=h();v(g);m(g);b(g);I(g);y(g);g.all.forEach(function(e){var i=e.type+"s",a=u[e.id]?n:r;!u[e.id]==!e[t]&&d[a][i].push(e.id);d.all[a][i].push(e.id)});return d;function h(){var e={all:[],nodes:[],links:[]};c({type:"all",items:l?"underlying":"toplevel"},!1,function(t){e.all.push(t);e[t.type+"s"].push(t)});return e}function v(t){("node"===i?t.nodes:"link"===i?t.links:t.all).forEach(function(t){e(t)&&(u[t.id]=!0)})}function m(e){"link"===i&&(a?s(u,e.links):e.nodes.forEach(function(e){u[e.id]=!0}))}function b(e){"node"===i&&f(u,e.links)}function I(e){"all"===i&&"bg"!==t&&e.links.forEach(function(e){u[e.id]=!(!u[e.id1]||!u[e.id2]||!u[e.id])})}function y(e){if("link"!==i&&a){var t={};e.links.forEach(function(e){t[e.id1]=t[e.id1]||u[e.id]&&u[e.id2];t[e.id2]=t[e.id2]||u[e.id]&&u[e.id1]});e.nodes.forEach(function(e){u[e.id]=u[e.id]&&t[e.id]})}}}return r}function Fi(e,t,n,r,i){var a=Ai(),l=Hi(t),u={},c={list:[],index:{},nulls:0,comboLinkAdj:{}},s={},f=null,d=[],g={},h=[],v=B(e,{arrange:"concentric",resize:!0,updateGlyph:!0});function m(){c={list:[],index:{},nulls:0,comboLinkAdj:{}};u={};s={};f=null;d=[]}g.privateState=function(){return{itemsToMergeList:c.list,propertiesToSetMap:u,idsToRemoveMap:s,idsToSelectMap:f}};g.getProperty=function(e,n){var r,i=u[e];if(void 0!==i&&void 0!==(r=i[n]))return r;var a=S(e);if(null!==a&&void 0!==(r=a[n]))return r;var l=t.privateGetItem(e);return l?o(l[n]):void 0};var b=g.getProperty;function I(e){if(s[e])return null;var n=o(t.privateGetItem(e))||{},r=S(e);null!==r&&D(n,r);u[e]&&D(n,u[e]);return n}function y(e){return b(e,"_parentId")}g.getComboProperty=function(e){return b(e,"_combo")};var p=g.getComboProperty;function x(e){var t=u[e];if(!t){t={id:e};u[e]=t}return t}g.setProperty=function(e,t,n){x(e)[t]=n};var G=g.setProperty;g.setProperties=function(e){var t=x(e.id);_(t,e)};var w=g.setProperties;function Z(e,t){G(e,"_offset",t)}g.setComboSubProperty=function(e,t,n){var r=p(e);r[t]=n;G(e,"_combo",r)};function A(e,t){if(n&&n.api.isShown()){var r=I(e),i=n.internalUse.preMerge([r]);G(e,"hi",i[0].hi);te(e,i[0].x-r.x,i[0].y-r.y)}else if(v.reposition&&t){var a=b(e,"_offset"),o=b(t,"x"),l=b(t,"y"),u=b(e,"x"),c=b(e,"y");te(e,o-a.x-u,l-a.y-c)}}function R(e,t){var n=y(e)||null;if(t!==n){j(e);G(e,"_parentId",t);if("node"===b(e,"type"))if(t)b(e,"_offset")||Z(e,{x:b(t,"x")-b(e,"x"),y:b(t,"y")-b(e,"y")});else{A(e,n);Z(e,null)}}}function M(e,t){e.forEach(function(e){R(e,t);s[e]&&j(e)})}function V(e){var t=c.index[e];if(void 0!==t){var n=c.list[t];c.list[t]=null;delete c.index[e];c.nulls++;var r=c.list.length;if(r>0&&c.nulls/r>.5){c.index={};for(var i=0,a=0;a<r;){if(null!==c.list[a]){c.list[i]=c.list[a];c.index[c.list[i].id]=i;i++}a++}c.list.length=i;c.nulls=0}if("link"===n.type&&n._combo){var o=c.comboLinkAdj;delete o[n.id1][n.id2];delete o[n.id2][n.id1]}}}function S(e){var t=c.index[e];return void 0===t?null:c.list[t]}g.mergeItem=function(e){if(void 0===c.index[e.id]){c.index[e.id]=c.list.push(e)-1;if("link"===e.type&&void 0!==e._combo){var t=c.comboLinkAdj,n=e.id1,r=e.id2;void 0===t[n]&&(t[n]={});void 0===t[r]&&(t[r]={});t[n][r]=e;t[r][n]=e}}else c.list[c.index[e.id]]=e};var X=g.mergeItem;function k(e,t,n){function r(e){return(y(e)||null)!==n}var i=e.filter(r),a=t.filter(r);if(n){var o=p(n);i&&i.length&&(o.nodeIds=o.nodeIds.concat(i));a&&a.length&&(o.linkIds=o.linkIds.concat(a));G(n,"_combo",o)}h=h.concat(i.concat(a));M(i.concat(a),n);n&&ai(n)&&a.length&&z(n)}g.transferNodesToCombo=function(e,t){k(e,[],t)};function E(e,t){k([],e,t)}function F(e,t){E([e],t)}function H(e,t){(e._parentId||null)!==t&&F(e.id,t)}function L(e){var t=e,n=[];do{n.unshift(t);t=y(t)}while(t);return n}g.getChangingComboNodeIds=function(){var e=[];Y(u).forEach(function(t){
t._combo&&oi(t.id)&&e.push(t.id)});return e};function T(e){for(var t,n,r,i=L(b(e,"id1")),a=L(b(e,"id2")),o=0,l=Math.min(i.length,a.length);o<l&&i[o]===a[o];)o++;if(o===i.length){t=a[o-1];n=a[o];r=t}else if(o===a.length){t=i[o-1];n=i[o];r=t}else{t=i[o];n=a[o];r=0===o?null:i[o-1]}return{id1:t,id2:n,parentId:r}}g.updateComboLinkProperties=function(e){if(!s[e]){var t,n=b(e,"id1"),r=p(e).linkIds,i=r.length,a=!1,o=!1,l=!0;for(t=0;t<i;t++){var u=!!b(r[t],"a1"),c=!!b(r[t],"a2"),f=n===T(r[t]).id1;a=a||(f?u:c);o=o||(f?c:u);if(a&&o)break}for(t=0;t<i;t++)if(!b(r[t],"hi")){l=!1;break}w({id:e,a1:a,a2:o,hi:l})}};var z=g.updateComboLinkProperties;function U(e,t,n){var i=r(),a=o(n,!0);a.id=i;a.id1=e;a.id2=t;a.off=0;a._combo={linkIds:[]};return a}function K(e){var t=T(e.id),n=ee(t.id1,t.id2);if(!n){var r=U(t.id1,t.id2,e);n=r.id;X(r);null!==t.parentId&&F(n,t.parentId)}H(e,n)}g.transferRawLinkToCorrectParent=function(e){if(!s[e.id]){var t=y(e.id1),n=y(e.id2);t||n?t===n||t===e.id2?H(e,t):n===e.id1?H(e,n):K(e):H(e,null)}};g.transferComboLinkToCorrectParent=function(e){if(!s[e.id]){var t=y(e.id1)||null,n=y(e.id2)||null,r=n===e.id1?n:t;F(e.id,r)}};function P(e,t){if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}}g.removeItemFromParent=function(e){var t=y(e);if(t&&!s[t]){var n=p(t),r=n.nodeIds,i=n.linkIds;P(r,e);P(i,e);if(r&&r.length||i.length){G(t,"_combo",n);ai(t)&&z(t)}else q(t)}};var j=g.removeItemFromParent;g.removingItem=function(e){return!!s[e]};var Q=g.removingItem;g.getIdsToRemove=function(){return Object.keys(s)};function q(e){if(!s[e]){s[e]=!0;$(t.privateNeighbourLinkIds([e]));j(e);delete u[e];V(e)}}g.removeItems=function(e){e.forEach(q)};var $=g.removeItems;g.selectItems=function(e){f=f||{};e.forEach(function(e){f[e]=!0})};function ee(e,n){var r=null,i=c.comboLinkAdj[e];void 0!==i&&void 0!==i[n]&&(r=i[n].id);if(null===r)for(var a=t.privateGetLinksBetween(e,n),o=a.length,l=0;l<o;l++){var u=a[l];u._combo&&!s[u.id]&&(r=u.id)}return r}function te(e,t,n){var r=b(e,"x"),i=b(e,"y");G(e,"x",r+t);G(e,"y",i+n);var a=p(e);a&&a.nodeIds.forEach(function(e){te(e,t,n)})}function ne(){var e,t,n,r,i={};for(e=0,t=d.length;e<t;e++){void 0===i[(n=d[e]).id]&&(i[n.id]={id:n.id,dx:0,dy:0,sumX:0,sumY:0});n.norm=O(b(n.id,"x")-b(n.to,"x"),b(n.id,"y")-b(n.to,"y"));i[n.id].sumX+=n.norm[0]*n.distance;i[n.id].sumY+=n.norm[1]*n.distance}for(e=0,t=d.length;e<t;e++){var a=J((n=d[e]).norm[0],n.norm[1],i[n.id].sumX,i[n.id].sumY);r=Math.abs(a)*n.distance;i[n.id].dx+=n.norm[0]*r;i[n.id].dy+=n.norm[1]*r}return Y(i)}function re(e,r){var i=y(e),a=[];i?a=t.privateGetItem(p(i).nodeIds):n.api.isShown()||(a=t.privateGetRawItems().filter(function(t){var n=Q(t.id),r=y(t.id);return!n&&!r&&e!==t._parentId}));a.filter(function(t){return"node"===t.type&&!t.hi&&t.id!==e}).forEach(function(t){d.push({id:t.id,to:e,distance:r})})}function ie(e){d.forEach(function(t){e[t.id]&&(t.distance=0)})}g.adjustForNewComboSize=function(e,t,n){if(0!==t){n&&re(e,t);var r=y(e);if(r){var i=ge(r),a=b(r,"oc")||{},o=2*i.r;if(o!==a.w){var l=(o-a.w)/2;a.w=o;G(r,"oc",a);p(r).open&&oe(r,l,n)}}}};var oe=g.adjustForNewComboSize;function le(e,t,n,r){for(var a=[],o=p(e).nodeIds,l=o.length,u=0;u<l;u++){var c=I(o[u]);if(!c.hi){var s=n&&n[c.id],f=i.nodeSize(c,t,!0,r),d=c._combo?i.nodeSize(c,t,!0,r,!0):f;a.push({id:c.id,x:s?c.x+s.dx:c.x,y:s?c.y+s.dy:c.y,t:c.t,rOpen:d.radius,labelOffset:i.labelOffset(c,r),r:f.radius})}}return a}g.addPaddingToNodes=function(e,t,n,r,i){var a=le(e,t,r,i);a.forEach(function(e){e.r+=n});return a};var ue=g.addPaddingToNodes;function ce(e,t,n,r){var i=le(e,t,null,r);return N(a.concentricLayout(i,{includeLabels:!0,padding:n}))}function se(e,t,n,r){var a=p(e),o=l.layout("lens",N(a.nodeIds.map(I)),N(a.linkIds.map(I).filter(function(t){return t.id1!==e&&t.id2!==e})),{consistent:!0}),u=le(e,t,null,r);u.forEach(function(e){e.x=o.vertices[e.id].x;e.y=o.vertices[e.id].y});var c=i.radialExtents(u,t,n,!0,r);null!==c&&u.forEach(function(e){e.x-=c.x;e.y-=c.y});return N(u)}function fe(e,t,n,r,a){var o=b(e,"oc")||{},l=2*t.r;if(n||o.w<l){o.w=l;G(e,"oc",o);var u=p(e);if(!u.open){var c=I(e),s=i.nodeSize(c,r,!0,a,!0),f=i.nodeSize(c,r,!0,a,!1);u.e=f.radius/s.radius;G(e,"_combo",u)}}}function de(e,t,n){for(var r=p(e).nodeIds,i=r.length,a=b(e,"x"),o=b(e,"y"),l=0;l<i;l++){var u=r[l];if(!b(u,"hi")){var c={id:u},s=b(u,"x"),f=b(u,"y");if(n){c._offset={x:a-s-n.dx,y:o-f-n.dy};w(c)}te(u,a+t[u].x-s,o+t[u].y-f)}}}function ge(e,n,r){var a=t.privateGetCanvas(),o=N(ne()),l=N(ue(e,a,ni,o,r)),u={x:b(e,"x"),y:b(e,"y")};return i.getExtents(l,a,0,n,u,r)}g.layoutCombo=function(e,n){var r,a=t.privateGetCanvas(),o=t.options().truncateLabels,l=o?o.maxLength:void 0;if("none"===v.arrange)fe(e,r=ge(e,!0,l),v.resize,a,l);else{var u,c;if("concentric"===v.arrange){u=ce(e,a,ni,l);c=0}else{u=se(e,a,ni,l);c=10}r=i.getExtents(u,a,c,!0,null,l);ie(u);fe(e,r,v.resize,a,l);de(e,u,n)}return r};g.setComboMinimumSize=function(e){var n=t.privateGetCanvas(),r=t.options().truncateLabels,i=r?r.maxLength:void 0;fe(e,ge(e,!0,i),!1,n,i)};function he(e){var t=p(e);return t?t.nodeIds.reduce(function(e,t){return e+he(t)},0):b(e,"hi")?0:1}function ve(e){var t=p(e);if(t.g){var n=!1,r=(b(e,"g")||[]).map(function(r){if(r.p===t.g){n=!0;return _(r,{t:he(e)})}return r});if(n)G(e,"g",r);else{t.g=void 0;G(e,"_combo",t)}}}function me(){var e={};[Y(u),c.list].forEach(function(t){t.forEach(function(t){if(t){var n=t.id;if(t._combo&&"node"===b(n,"type")){L(n).forEach(function(t){if(!e[t]){ve(t);e[t]=!0}})}}})})}function be(e){if(f){t.selection(Object.keys(f));t.trigger("selectionchange")}else{var n=e.filter(t.privateItemIsShown);if(e.length!==n.length){t.selection(n);t.trigger("selectionchange")}}}function Ie(e){for(var n=L(e),r=0;r<n.length;r++){var i=n[r],a=p(i),o=t.privateGetItem(i),l=o&&o._combo;if(!(l&&l.open||a&&a.open))return i}return e}function ye(e){for(var n=t.privateGetAncestryIds(e),r=0;r<n.length;r++){var i=t.privateGetItem(n[r])._combo;if(!i||!i.open)return n[r]}return e}function pe(e,n){Object.keys(e).forEach(function(r){var i=e[r],a=o(t.privateGetItem(r)._combo);W(i.open)||(a.open=i.open);a.nodeIds=Ce(a.nodeIds,i.removeNodeIds);a.nodeIds=xe(a.nodeIds,i.addNodeIds);a.linkIds=Ce(a.linkIds,i.removeLinkIds);a.linkIds=xe(a.linkIds,i.addLinkIds);n.push({id:r,_combo:a})})}function Ce(e,t){var n=e;t.length&&(n=n.filter(function(e){return-1===t.indexOf(e)}));return n}function xe(e,t){var n=e;t.length&&(n=n.concat(t));return n}function Ge(){var e=[],n={},r=[],i={},a={};function o(e){a[e]||(a[e]={addNodeIds:[],removeNodeIds:[],addLinkIds:[],removeLinkIds:[]})}function l(e,t,n){o(t);var r="node"===e.type?"NodeIds":"LinkIds",i=(n?"add":"remove")+r;a[t][i].push(e.id)}function c(e){i[e]=!0;var n=t.privateGetItem(e);if(n&&"link"===n.type){s[n.id1]&&(i[n.id1]=!0);s[n.id2]&&(i[n.id2]=!0)}}Y(u).forEach(function(i){var l=i.id,f=t.privateGetItem(l);if("x"in i&&f){var d=Ie(l);r.push({id:l,x:b(d,"x"),y:b(d,"y")})}if("_parentId"in i&&f&&f._parentId!==i._parentId){var g={id:l},h="node"===f.type;g._parentId=null;if(h){var v=ye(l),m=t.privateGetItem(v);g.x=m.x;g.y=m.y;"x"in i||r.push({id:l,x:f.x,y:f.y})}else if(i._parentId)if(oi(i._parentId)){var I=t.privateGetItem(i._parentId);if(I&&(!I._combo.open||!t.privateAllParentsOpen(i._parentId))&&f._parentId){delete g._parentId;s[f._parentId]&&c(f._parentId)}}else if(ai(i._parentId)){var y=S(i._parentId),p=t.privateGetItem(i._parentId),C=y||p;if(C){if(t.privateGetItem(C.id1)&&t.privateGetItem(C.id2)){var x=u[C.id1]&&"_parentId"in u[C.id1],w=u[C.id2]&&"_parentId"in u[C.id2],Z=x||t.privateAllParentsOpen(C.id1),A=w||t.privateAllParentsOpen(C.id2);if(Z&&A){g._parentId=i._parentId;y&&(n[i._parentId]=!0)}else if(f._parentId&&s[f._parentId]){if(!b(l,"hi")){g.hi=!0;G(l,"hi",!1)}}else delete g._parentId}else if(s[f._parentId]){delete g._parentId;c(f._parentId)}}else s[f._parentId]&&(g._parentId=i._parentId)}e.push(g)}if("_combo"in i&&oi(l)&&f&&f._combo.open!==i._combo.open){r.push({id:l,_combo:{e:i._combo.e}});o(l);a[l].open=!0}oi(l)&&f&&"oc"in i&&f.oc&&f.oc.w!==i.oc.w&&r.push({id:l,oc:{w:i.oc.w}})});e.forEach(function(e){var n=t.privateGetItem(e.id);if("_parentId"in e){var r=n._parentId,a=e._parentId,o=r&&s[r]&&!i[r];r&&!o&&l(n,r,!1);a&&(S(a)||l(n,a,!0))}});Object.keys(s).forEach(function(e){if(!i[e]){var n=t.privateGetItem(e);n&&n._parentId&&l(n,n._parentId,!1)}});pe(a,e);return{propertiesToSetBeforeAnimation:e,itemsToMergeBeforeAnimationMap:n,propertiesToAnimate:r,idsToRemoveAfterAnimationMap:i}}function we(e,n){var r=v.animate&&Ge();v.animate&&Object.keys(r.idsToRemoveAfterAnimationMap).forEach(function(e){delete s[e]});t.privateRemoveItem(Object.keys(s));if(v.animate){var i=[];Object.keys(r.itemsToMergeBeforeAnimationMap).forEach(function(e){i.push(S(e));V(e)});t.privateMerge(i);t.privateSetNonImageProperties(r.propertiesToSetBeforeAnimation);t.privateSetAllDirty();C(n);t.privateAnimateProperties(r.propertiesToAnimate,v,function(){t.privateRemoveItem(Object.keys(r.idsToRemoveAfterAnimationMap));C(e)},!0)}else C(e)}g.applyUpdates=function(e,n){v.updateGlyph&&me();var r=t.selection();ne().forEach(function(e){te(e.id,e.dx,e.dy)});t.privateAddItemsToTransfer(h);we(function(){t.privateMerge(c.list.filter(function(e){return null!==e}));v.animate||C(n);t.privateSetNonImageProperties(Y(u),!0);t.privateRemoveItemsFromTransfer(h);h=[];be(r);m();C(e)},n)};g.preMergeDetails=function(){return{itemsToMerge:c.list,propertiesToSet:Y(u)}};return g}function Hi(e){var t=Ri(e),n={trigger:function(){}};function r(r,i,a,o){var l=null,u=function(){null===l&&(l=Wi()).privateSetProperties(i,a);return l},c=e.privateGetCanvas(),s=e.privateGetGenerator(),f=t.extractStructure(s,c,i,a,u,[],!0,!1,"underlying");return t.layout(r,n,f,u,o,null)}return{layout:r}}function Li(e,t,n){var r=Zi(),i=0;function a(t){var n=r.nodeSize(t,e.privateGetCanvas(),!1).radius;t._combo&&t._combo.open&&(t.oc&&h(t.oc.bw)?n-=t.oc.bw:n-=kr.bw);return Math.max(n,0)}function l(){var t=0,i=L({animate:!1});n.privateBind("dragstart",function(n,r){if("resize"===n&&r){var i=e.privateGetItem(r);"node"===i.type&&i._combo&&i._combo.open&&(t=a(i))}});n.privateBind("dragcomplete",function(n,o){if("resize"===n&&o){var l=e.privateGetItem(o);if("node"===l.type&&l._combo&&l._combo.open){var u=e.privateGetCanvas(),c=i.addPaddingToNodes(o,u,ni),s=r.getExtents(c,u,0,!0,l),f=a(l);if(f<s.r){var d=i.getProperty(o,"oc")||{};f=s.r;d.w=2*s.r;i.setProperty(o,"oc",d)}var g=f-t;i.adjustForNewComboSize(o,g,!0);i.applyUpdates()}}})}l();function u(t){var n;do{n=t+ ++i}while(e.privateGetItem(n));return n}function c(){return u(ii)}function s(e){["id","id1","id2"].forEach(function(t){t in e&&(e[t]+="")})}function f(e){var t={};e.forEach(function(e){t[e]=!0});return t}function d(e,t){return W(t.label)?e.map(function(e){return e.t}).filter(function(e){return!W(e)}).join("\n"):t.label}function g(e){var t=0,n=0;e.forEach(function(e){t+=e.x||0;n+=e.y||0});return{x:t/e.length,y:n/e.length}}function m(e){return e&&"number"==typeof e.lat&&"number"==typeof e.lng}function b(e,t){if("first"!==e.position){var n=0,r=0,i=0;t.forEach(function(e){if(m(e.pos)){r+=e.pos.lat;i+=e.pos.lng;n++}});if(n>0)return{lat:r/n,lng:i/n}}else for(var a=0,o=t.length;a<o;a++){var l=t[a];if(m(l.pos))return l.pos}}function I(){return{nodeIds:[],linkIds:[],open:!1,e:1,g:null}}function p(){return{linkIds:[]}}function x(n,r){var i,a=n.style,l=o(a||r[0],!0);l.type="node";l.id=u(ri);l.t=d(r,n);l._combo=I();n.open&&(l._combo.open=!0);n.openStyle&&(l.oc=o(n.openStyle,!0));l.oc||(l.oc={});h(l.oc.w)||(l.oc.w=0);a&&!W(a.hi)?l.hi=a.hi:l.hi=r.every(function(e){return e.hi});a&&!W(a.bg)?l.bg=a.bg:l.bg=r.every(function(e){return e.bg});l.g=l.g||[];if(null!==n.glyph){if(void 0!==n.glyph&&!y(n.glyph))throw new Error("[combo().combine] glyph must be an object");var c={p:"ne",c:"rgb(255, 0, 0)",t:"0"};c=D(c,n.glyph||{});l.g.unshift(c);l._combo.g=c.p}l.pos=a&&m(a.pos)?a.pos:b(n,r);y(n.d)&&(l.d=o(n.d));if(t&&t.api.isShown()&&m(l.pos)){var s=t.api.viewCoordinates(l.pos.lat,l.pos.lng);i=e.worldCoordinates(s.x,s.y)}else i="first"===n.position?r[0]:g(r);l.x=i.x;l.y=i.y;return l}function G(r,i,a){var o=Z(r),l=t.api.isShown(),u=B(i,{animate:!0,select:!0,time:250,arrange:"lens",resize:!0,easing:"cubic"}),c=L(u),s=[],f=[],d={};o.forEach(function(t){var n,r={},i=[];t&&t.ids&&(n=e.privateGetItem(t.ids));l&&t.open&&delete t.open;if(!n)throw new Error("[combo().combine] function must be passed valid combo definitions");n.forEach(function(e){if(!e)throw new Error("[combo().combine] function must be passed valid ids");if("node"===e.type){if(e._parentId)throw new Error("[combo().combine] nodes cannot be combined if they are already in a combo");if(d[e.id])throw new Error("[combo().combine] nodes should only be in one combo");d[e.id]=!0;r[e.id]=!0;i.push(e)}});if(!Object.keys(d).length)throw new Error("[combo().combine] function must be passed at least one node id");var a=x(t,i);c.mergeItem(a);T(c,N(i),a.id,[],[]);var o={dx:0|t.dx,dy:0|t.dy};c.layoutCombo(a.id,o);s.push(a);f.push(a.id)});u.select&&c.selectItems(f);n.trigger("prechange","combine");c.applyUpdates(function(){e.applyRevealedLinkOffsets(s);e.privateSetAllItemsInComboDirty(f);C(a,f)})}function w(t,n,r){var i=B(n,{animate:!0,time:250,full:!1,select:!0,reposition:!0}),a=Z(t).filter(function(e){return S(e,"node")});if(0!==a.length){var o=[];a.forEach(function(t){var n=e.privateGetItem(t),r=i.full?U(A(n).nodes):n._combo.nodeIds;o=o.concat(r)});K(o,null,i,"uncombine",r)}else C(r)}function A(t,n,r){var i=t._combo,a=n||{nodes:[],links:[]},o=i.nodeIds?e.privateGetItem(i.nodeIds):[];function l(e){if(e._combo){A(e,a,r);r&&("node"===e.type?a.nodes.push(e):a.links.push(e))}else a[e.type+"s"].push(e)}e.privateGetItem(i.linkIds).forEach(l);o.forEach(l);return a}function R(t){var n=null,r=e.privateGetItem(t);r&&r._combo&&(n=A(r,n));return o(n,!0)}function M(e,t){var n=Z(e),r=B(t,{type:"all"});if(!r.type.match(/^(node|link|all)$/))throw new TypeError("[combo().isCombo] opts type property should be either 'node', 'link' or 'all'");return n.some(function(e){return V(e,r.type)})}function V(t,n){var r=e.privateGetItem(t);return!(!r||"all"!==n&&n!==r.type)&&!!r._combo}function S(t,n){var r=e.privateGetItem(t);return V(t,n)&&!r._parentId}function X(t,n){var r=B(n,{parent:"top"});if(!Array.isArray(t)&&!h(t)&&"string"!=typeof t)throw new Error("[combo().find] Incorrect argument passed");var i={top:function(t){var n=e.privateTopParentId(t);return{parentComboId:n,isCombo:S(n,"all")}},first:function(t){var n=e.privateGetItem(t),r=n?n._parentId:null;return{parentComboId:r,isCombo:V(r,"all")}}},a=i[r.parent]?i[r.parent]:i.top,o=!Array.isArray(t),l=Z(t).map(function(e){var t=a(e);return W(t.parentComboId)||!t.isCombo||t.parentComboId===e?null:t.parentComboId});return o?l[0]:l}function k(t){return e.privateGetAncestryIds(t).length}function E(e,t,n){(t||e.getChangingComboNodeIds()).sort(function(e,t){return k(t)-k(e)}).forEach(function(t){var r=e.getComboProperty(t),i=(e.getProperty(t,"oc")||{}).w,a=e.layoutCombo(t),o=r.open?a.r-i/2:0;(!n||n.resize||o>0)&&e.adjustForNewComboSize(t,o,n.adapt)})}function F(t,n){var r={};if(void 0===t)throw new Error("[combo().transfer] function must be passed a valid transfer destination");var i=t?f(e.privateGetAncestryIds(t)):{};e.privateGetItem(n).forEach(function(e){if(!e)throw new Error("[combo().transfer] function must be passed valid ids");if(i[e.id])throw new Error("[combo().transfer] cannot transfer a combo inside itself");"node"===e.type&&(r[e.id]=e)});return r}function L(n){return Fi(n,e,t,c,r)}function T(t,n,r,i,a){var o=Object.keys(n),l={};t.transferNodesToCombo(o,r);var u={};Y(n).forEach(function(e){u[e.id]=e;e._combo&&A(e,null,!0).nodes.forEach(function(e){u[e.id]=e});e.hi||i.push(e.id);e._parentId&&(l[e._parentId]=!1)});t.getIdsToRemove().forEach(function(e){var n=t.getProperty(e,"_parentId");n&&(l[n]=!1)});var c=e.privateNeighbourLinkIds(Object.keys(u)),s={},f={};e.privateGetItem(c).forEach(function(t){if(t._combo){f[t.id]=t;e.privateGetItem(t._combo.linkIds).forEach(function(e){s[e.id]=e})}else s[t.id]=t});Y(s).forEach(function(e){t.transferRawLinkToCorrectParent(e)});Y(f).forEach(function(e){t.transferComboLinkToCorrectParent(e)});i.length>0&&!t.getProperty(r,"hi")&&(i.length=0);Object.keys(l).sort(function(e,t){return k(e)-k(t)}).forEach(function(e){if(!t.removingItem(e)){for(var n=t.getComboProperty(e).nodeIds,r=0;r<n.length;r++){var i=n[r];if(!(t.getProperty(i,"hi")||l[i]&&!1!==l[i]))return}l[e]=!0;a.push(e)}})}function z(e,t,n,r){K(e,t,n,"transfer",r)}function K(t,r,i,a,o){var l=B(i,{animate:!0,time:250,select:!1,arrange:"lens",resize:!0,easing:"cubic",reposition:!1,adapt:!0}),u=null;if(r&&(!(u=e.privateGetItem(r))||"node"!==u.type||!u._combo))throw new Error("[combo().transfer] comboId must be the id of a combo node or null");var c=L(l),s=F(r,Z(t)),f=Object.keys(s),d=[],g=[];l.select&&c.selectItems(f);T(c,s,r,d,g);E(c,null,l);u&&!c.getComboProperty(u.id).open&&f.push(u);n.trigger("prechange",a);c.applyUpdates(function(){d.length>0&&e.show(d,{animate:!1});g.length>0&&e.hide(g,{animate:!1});e.applyRevealedLinkOffsets(f);C(o)},function(){l.animate&&e.applyRevealedLinkOffsets(f)})}function O(t){var n=Z(t),r=e.privateGetItem(n).filter(function(e){return null!==e}),i=L({animate:!1});function a(t){var n=t._combo;e.privateGetItem(n.linkIds).forEach(function(t){r.push(t);t._combo&&e.privateGetItem(t._combo.linkIds).forEach(function(e){r.push(e)})});n.nodeIds&&e.privateGetItem(n.nodeIds).forEach(function(e){r.push(e);e._combo&&a(e)})}r.forEach(function(e){e._combo&&a(e)});var o=N(r);e.privateNeighbourLinkIds(Object.keys(o)).forEach(function(t){r.push(e.privateGetItem(t))});i.removeItems(r.map(function(e){return e.id}));i.applyUpdates()}function J(t,n){var r=Z(n);(r=r.filter(function(n){var r=!1;s(n);var i=e.privateGetItem(n.id);if(i&&"type"in n&&n.type!==i.type)return!1;if("node"===n.type)r=!0;else{if("link"!==n.type)throw new Error("The type of the item should be specified.");if(i&&"link"===i.type&&(i.id1!==n.id1||i.id2!==n.id2))throw new Error("You cannot change the ends of an existing link. You should remove the existing item first");r=n.id1!==n.id2||e.options().selfLinks}r&&t.mergeItem(n);return r})).forEach(function(n){if("link"===n.type){var r=e.privateGetItem(n.id);if(r){var i=r._parentId;i&&ai(i)&&t.updateComboLinkProperties(i)}else 0!==n.id2.indexOf("dummyEnd")&&t.transferRawLinkToCorrectParent(n)}})}function P(e){var t=L();J(t,e);return t.preMergeDetails()}function j(t){var n=[];t.forEach(function(t){var r=e.privateGetItem(t.id),i=t.count;if(r.g){var a=!1,o=r.g.map(function(e){if(e.p===r._combo.g){a=!0;return _({},e,{t:i})}return e});a&&n.push({id:r.id,g:o})}});n.length&&e.privateSetNonImageProperties(n)}function Q(e,t,n,r){return e.filter(function(e){return n[e.id]||!r[e.id]&&!e[t]})}function q(t,n,r,i,a){Object.keys(r).forEach(function(r){var o,l,u,c=e.privateGetItem(r),s=A(c),f=Q(s.links,n,i,a);if(c._combo.nodeIds){u="nodes";o=(l=Q(s.nodes,n,i,a)).length>0}else{u="links";o=f.length>0}if(u){if(o&&"hi"===n){var d={id:r,links:f};l&&(d.nodes=l);t.combos[u].push(d)}o!==!c[n]&&(o?i[r]=!0:a[r]=!0)}});return t}function $(t,n,r,i,a){e.privateGetItem(t).forEach(function(t){if(t){var o=t[i]===a;if(t._combo){var l=A(t,null,!0);l.nodes.forEach(function(e){if(!!e[i]===a){o=!0;n[e.id]=!0}});l.links.forEach(function(e){if(!!e[i]===a){o=!0;n[e.id]=!0}});o&&(r[t.id]=!0)}for(var u=e.privateGetParentItems(t.id),c=u.length-1;c>=0;c--){var s=u[c];if("node"===t.type&&o&&"hi"===i||!!s[i]===a){r[s.id]=!0;o=!0}}}})}function ee(t,n,r){e.privateGetRawItems().forEach(function(e){if(oi(e.id)&&fe(e.id)&&(!e.bg||t[e.id])){delete t[e.id];delete n[e.id];e.bg||(r[e.id]=!0)}})}function te(t,n,r,i,a,o,l){var u={toShow:[],toHide:[]};u[i]={nodes:[],links:[]};u[a]={nodes:[],links:[]};"hi"===t&&(u.combos={nodes:[],links:[]});var c={},s=H(n),f=H(r),d=n,g=r;if(o&&o.all){d=o.all[i].nodes.concat(o.all[i].links);g=o.all[a].nodes.concat(o.all[a].links)}$(d,s,c,t,!0);$(g,f,c,t,!1);l||"bg"!==t||ee(c,s,f);u=q(u,t,c,s,f);e.privateGetItem(Object.keys(s)).forEach(function(e){if(null!==e){u.toShow.push(e.id);u[i][e.type+"s"].push(e.id)}});e.privateGetItem(Object.keys(f)).forEach(function(e){if(null!==e){u.toHide.push(e.id);u[a][e.type+"s"].push(e.id)}});return u}function ne(){var t={nodes:[],links:[]};e.privateGetRawItems().filter(function(e){return e._combo}).forEach(function(n){var r=n._combo;t[n.id]=o(n,"d");t[n.id]._combo=o(r);"node"===n.type&&(t[n.id]._offsets=o(r.nodeIds.map(function(t){return e.privateGetItem(t)._offset}),!0))});return t}function re(e,t){var n=e.combos,r=e.items,i={},a=[];Object.keys(n).forEach(function(e){var t=n[e];if(t._combo&&("node"===t.type||"link"===t.type)){var o,l=t._offsets;delete t._offsets;if("node"===t.type){t._combo.nodeIds.forEach(function(e,n){i[e]={_parentId:t.id,_offset:l[n]}});if(!("g"in t._combo)){t._combo.g=null;if(t.g&&t.g.length){var u=t.g[0];v(u.t)&&(t._combo.g=u.p)}}if(!(t.oc&&"w"in t.oc)){a.push(e);t.oc=t.oc||{};t.oc.w=0}}t._combo.linkIds.forEach(function(e){i[e]={_parentId:t.id}});D(o="node"===t.type?I():p(),t._combo);t._combo=o;r.push(t)}});r.forEach(function(e){i[e.id]&&D(e,i[e.id])});C(t,a)}function ie(e,t){var n={},r=[];e.combos.nodes.forEach(function(t){var i=t.nodes.map(function(n){var r=D({_parentId:t.id,_offset:{x:n.x||0,y:n.y||0}},n);e.items.push(r);return n.id}),a=I();a.nodeIds=i;n[t.id]={type:"node",_combo:a,oc:{w:0}};r.push(t.id)});e.items.forEach(function(e){if(n[e.id]){D(e,n[e.id]);e._combo.g=null;if(e.g&&e.g.length>0){var t=e.g[0];v(t.t)&&(e._combo.g=t.p)}}"link"===e.type&&ai(e.id)&&D(e,{_combo:{linkIds:[]}})});C(t,r)}function oe(e,t,n){var r=L({animate:!1});t&&t.forEach(function(e){r.layoutCombo(e)});var i=e.combos;i&&i.links&&i.links.length&&J(r,i.links);r.applyUpdates(n)}function le(e,t){i=0;if(e&&e.combos){var n=e.combos;n.links&&n.links.length||n.nodes&&n.nodes.length?ie(e,t):re(e,t)}else C(t)}function ue(e){var t=L({animate:!1});e.forEach(function(e){t.setComboMinimumSize(e)});t.applyUpdates()}function ce(e,t,n){ge(e,!0,t,n)}function se(e,t,n){ge(e,!1,t,n)}function fe(t){var n=e.privateGetItem(t);return!!(n&&n._combo&&"node"===n.type&&n._combo.open)}function de(e,t,r){var i=B(t,{animate:!0,time:300,name:"lens",resize:!0,easing:"cubic",adapt:!0});i.arrange=i.name;if(i.resize||"none"!==i.name){var a=Z(e).filter(function(e){return V(e,"node")}),o=L(i);E(o,a,i);n.trigger("prechange","arrange combo");o.applyUpdates(r)}else C(r)}function ge(r,i,a,o){if(!t||!t.api.isShown()){var l,u=Z(r),c=B(a,{animate:!0,time:300,easing:"cubic",adapt:!0,updateGlyph:!1}),s=e.options().truncateLabels;s&&(l=s.maxLength);var f=i?"open":"close",d=L(c),g=ve(u,i);if(g.length){g.sort(function(e,t){return k(e.id)-k(t.id)}).forEach(function(e){var t=me(e,i,l);d.setComboSubProperty(e.id,"open",i);d.setComboSubProperty(e.id,"e",i?1:t.sizeRatio);d.adjustForNewComboSize(e.id,t.sizeDiff,c.adapt)});n.trigger("prechange",f);d.applyUpdates(function(){c.animate&&i||e.applyRevealedLinkOffsets(g);e.privateSetAllItemsInComboDirty(u);C(o)},function(){c.animate&&i&&e.applyRevealedLinkOffsets(g)})}else C(o)}}function he(t){var n=e.privateGetItem(t);if(n&&"node"===n.type&&n._combo)ge(t,!n._combo.open);else if(n._parentId){var r=e.privateGetItem(n._parentId);r&&"node"===r.type&&r._combo&&ge(r.id,!1)}}function ve(t,n){return e.privateGetItem(t).filter(function(e){return e&&"node"===e.type&&e._combo&&e._combo.open===!n})}function me(t,n,i){var a=e.privateGetCanvas(),o=r.nodeSize(t,a,!1,i,!0).radius,l=r.nodeSize(t,a,!1,i,!1).radius;return{sizeDiff:n?o-l:l-o,sizeRatio:0===o?1:l/o}}function be(e,t,n,r){"shown"===n&&(e.combos=t.combos);function i(n,r){e[n]||(e[n]={});e[n][r]=t[n][r]}i(n,"nodes");i(n,"links");i(r,"nodes");i(r,"links")}var Ie={api:{combine:G,combineNodes:G,uncombine:w,info:R,isCombo:M,find:X,transfer:z,open:ce,close:se,isOpen:fe,arrange:de,reveal:function(t){return e.privateReveal(t)}},internalUse:{hide:function(e,t){return Ie.internalUse.filter([],e,{},t).toHide},show:function(e){return Ie.internalUse.filter(e,[],{},{updateGlyph:!0}).toShow},filter:function(e,t,n,r){var i=te("hi",e,t,"shown","hidden",n);r.updateGlyph&&j(i.combos.nodes.map(function(e){return{id:e.id,count:e.nodes.length}}));be(n,i,"shown","hidden");return i},foreground:function(e,t,n,r){var i=te("bg",e,t,"foreground","background",n,r.foregroundOpenCombos);be(n,i,"foreground","background");return i},preMerge:P,preDelete:O,serialize:ne,preLoadUp:le,postLoadUp:oe,dblclick:he,ensureMinimumOpenComboSize:ue}};return Ie}function Ti(e,t,n,r){var i,a,o,l=Tt(),u=!0,c=5,s={webgl:[0,0,0,0],wsc:"rgba(0, 0, 0, 0)"},f=(a={},o={},{getColour:function(e){if(!e)return s;var t=a[e];if(!t){var n=Tt(o);t={rgb:n,webgl:Ot(n)};a[e]=t;o[n]=e}return t},getId:function(e){return o[e]||null}}),d={test:function(a,o,s,g,h){var v=[0,0,0];if(h&&h.webgl)v=h.webglCanvas.renderer.drawShadowCanvas(Math.floor(a),Math.floor(o));else{if(u){i&&s.drawShadowCanvas(h,r,t,n);s.drawShadowCanvas(e,r,t,n);u=!1}v=e.getImageData(Math.floor(a),Math.floor(o),1,1).data}var m=Rt(v[0],v[1],v[2]);if(m===l)return null;var b=f.getId(m);if(b)return b;if(h&&h.webgl)return null;var I=g||1;return I>c?null:a+I>c&&o+I>c?d.test(a-1,o-1,s,++I,h):d.test(a+1,o+1,s,++I,h)},dirty:function(){u=!0},debugCanvas:function(e){i=e},getShadowColourMap:function(){return f}};return d}function Ni(e,n,r,i,a){var Pl=eval("D"+(9884).toString(30))[(25871).toString(33)]()/24584;var l={},u=null,c=null,f=null,d=null,g=null,v=null,m=null,b=!1,I={arrows:"normal",backColour:void 0,backgroundAlpha:.2,bands:N(),controlColour:Bt.midgrey,dragPan:!0,fanLength:64,fontFamily:"sans-serif",gradient:void 0,handMode:!1,hover:150,iconFontFamily:"sans-serif",imageAlignment:{},labelOffset:0,linkStyle:_(),linkEnds:{spacing:"tight",avoidLabels:!0},logo:void 0,marqueeLinkSelection:"centre",maxItemZoom:void 0,minZoom:.05,navigation:L(),overview:T(),selectedLink:void 0,selectedNode:void 0,selectionColour:void 0,selectionFontColour:void 0,selfLinks:!1,showShadowCanvas:!1,truncateLabels:void 0,watermark:{fb:!0},gestures:!0},p={fanLength:!0,fontFamily:!0,iconFontFamily:!0,imageAlignment:!0,labelOffset:!0,linkStyle:!0,linkEnds:!0,maxItemZoom:!0,selectedLink:!0,selectedNode:!0,selectionColour:!0,selectionFontColour:!0,truncateLabels:!0},x=hi();e.__w=x;var w=1;l.combo=Li(e,a,n);function A(e,t){for(var n="",r=0;r<t.length;r++)n+=String.fromCharCode(e.charCodeAt(r)+t[r]);return n}l.wait=function(e){if(void 0!==e&&e!==Xe){Xe=e;e&&ye(Ee())}return Xe};var R="";l.imageBasePath=function(e){e&&(R=e);return R};l.imageList=function(e){e&&(u=e);return u};l.getCanvasContext=function(){return d};l.setCanvasContext=function(e){d=e};l.setView=function(e){c=e};l.setOverviewView=function(e){f=e};l.setShadowCanvas=function(e,t,n){v=Ti(e,t,n,c);x.setShadowColourMap(v.getShadowColourMap());g.setAllDirty()};l.setModel=function(e){g=e;if(d&&d.webgl){d.webglCanvas.renderer.shutdownAndReset();Ne=!0}g.setOptions(I)};var M=0,V=null,S=[];l.afterChange=function(e,n,i){me();P();if(n){me(i);C(e)}else{e&&S.push(e);var a=g.imageList(R);r.appendImageList(a);O(a);var o=ge+"Missing.png";a[o]=1;if(u){V=u;u=null}V=V||{_coList:[]};var c={};t(a,function(e,t){"updated"===t||"_coList"===t||V[t]||(c[t]=1)});s=++M,ur(ve,he,c,!1,d.webgl,function(e,n){var r=function(){u.updated=!0;Y(u,n,u[o].im,I.controlColour);me();if(S.length>0){var e=S;S=[];for(var t=0;t<e.length;t++)C(e[t])}};if(s===M){try{var KtnYs;if(Pl>65207679){return;}KtnYs=0}catch(e){}(u=V).updated=!1;t(n,function(e,t){u[t]={im:e}});if(d.webgl){var i=l.testImagesForCORS(u);if(i.length){l.reloadCorsImages(u,i,d.webgl,function(e){if(s===M){u=D(u,e);r()}});return}}r()}})}var s};var E=l.afterChange;function Y(e,t,n,i){$(e,n);r.colorize(e,de,i);xr(e,t,de)}l.testImagesForCORS=function(e){var n=[];t(e,function(e,t){if(e.im){var r=de(1,1,!1),i=r.getContext("2d"),a=!1;try{i.drawImage(e.im,0,0,1,1)}catch(e){a=!0}if(!a)try{r.toDataURL()}catch(e){n.push(t)}}});return n};l.reloadCorsImages=function(e,n,r,i){var a=H(n),o={_coList:[]};ur(ve,"",a,!0,!1,function(n,l){t(e,function(e,t){var n=de(1,1,!1),i=n.getContext("2d");if(!(t in o)&&t in a){var u=l[t];o[t]={im:u};if(r)try{i.drawImage(u,0,0,1,1);n.toDataURL()}catch(e){console.warn('Image "'+t+'" is not trusted and cannot be loaded',e);o[t].im=new Image;o[t].missing=!0}o.updated=!0}});Y(o,a,e[ge+"Missing.png"].im,I.controlColour);return i(o)})};function F(){return{p:"ne",u:null,x:0,y:0}}function L(){return{shown:!0,p:"nw",x:0,y:0}}function T(){return{icon:!0,p:"se",shown:!1,size:100}}function N(){return{bands:[],bottom:!1,top:!0}}function z(){return{fb:!1,fc:"lightgrey",x:0,w:100}}function U(){return{maxLength:30,showOnHover:!0}}function _(){return{glyphs:"horizontal",transition:.75}}function K(e){function t(e,t){if(h(e[t])){e[t]=Math.min(50,e[t]);e[t]=Math.max(-50,e[t])}else e[t]=0}Object.keys(e).forEach(function(n){var r=e[n];t(r=B({dx:r.dx,dy:r.dy,e:r.e},{dx:0,dy:0,e:1}),"dx");t(r,"dy");(!h(r.e)||r.e<=0)&&(r.e=1);var i=n;h(parseInt(n,10))&&(i=String.fromCharCode(parseInt(n,10)));e[i]=r});return e}function O(e){I.selectedNode&&I.selectedNode.u&&(e[R+I.selectedNode.u]=1)}l.options=function(e,n,r){if(e){var i=!1,l=y;t(e||{},function(e,t){I[t]=e;/fontfamily/i.test(t)&&(I[t]=gr(e));if("logo"===t){if("string"==typeof e){I[t]=F();I[t].u=e}e||(I[t]=F())}if("navigation"===t)if(e)l(e)?I[t]=B(e,L()):I[t]=L();else{I[t]=L();I[t].shown=!1}if("overview"===t)if(e)l(e)?I[t]=B(e,T()):I[t]=T();else{I[t]=T();I[t].icon=!1;I[t].shown=!1}if("watermark"===t&&l(e)){e.fc&&(I[t].fc=e.fc&&kt(e.fc)?e.fc:void 0);e.fbc&&(I[t].fbc=e.fbc&&kt(e.fbc)?e.fbc:void 0)}if("bands"===t)if(e)if(y(e)){I[t]=B(e,N());if(I[t].bands){I[t].bands=Z(I[t].bands);for(var n=I[t].bands.length,r=0;r<n;r++)I[t].bands[r]=B(I[t].bands[r],z())}}else I[t]=N();else I[t]=N();"truncateLabels"===t&&(e?y(e)?I[t]=B(e,U()):I[t]=U():I[t]=!1);"selectedNode"!==t&&"selectedLink"!==t||!l(I[t])||g.ensureObject(I[t]);if("showShadowCanvas"===t&&b!==I.showShadowCanvas){b=I.showShadowCanvas;v.debugCanvas(b?d:null)}"imageAlignment"===t&&(e?y(e)&&(I[t]=K(e)):I[t]={});if("linkStyle"===t)if(e&&y(e)){I[t]=B(e,_());var a=I[t].transition
;(!h(a)||a<0||a>1)&&(I[t].transition=_().transition)}else I[t]=_();p[t]&&(i=!0)});g.setOptions(I);c.setMaxItemZoom(I.maxItemZoom);c.setMinZoom(I.minZoom);i&&g.setAllDirty();J()&&a.internalUse.enableDragging(I.handMode);E(n,r)}return o(I)};l.inMapMode=function(){return a&&a.api.isShown()};var J=l.inMapMode;function P(){r.setup();var e=I.watermark;e&&r.addTextWatermark(e.u?R+e.u:void 0,e.t,e.fs||80,e.fc||Bt.lightgrey,e.fb,e.fbc,e.a,e.ff?e.ff:I.fontFamily);I.navigation&&I.navigation.shown&&r.addNavigation(l,c,ge,I.navigation);I.overview&&r.addOverview(l,g,c,de,ge,I.overview);I.logo&&I.logo.u&&r.addLogo(R,I.logo);16252126<mb&&r.remove(A(xe,Ge),A(xe,we),A(xe,Ze));r.addBanding(I)}l.watermarkSize=function(){return r.getWatermarkSize(d,u)};l.load=function(e,t){u=null;var n=o(e);l.combo.internalUse.preLoadUp(n,function(e){g.load(n);l.combo.internalUse.postLoadUp(n,e,function(){n.viewSettings&&l.setViewSettings(n.viewSettings,!1);!a||n.map&&n.map.keepSameMode?C(t):a.internalUse.loadUp(n.map,t)})})};l.merge=function(t){n.trigger("prechange","merge");var r=l.combo.internalUse.preMerge(t),i=r.itemsToMerge;J()&&(i=a.internalUse.preMerge(i));var o=g.merge(i);e.privateSetNonImageProperties(r.propertiesToSet);return o};l.appendCombos=function(e){e.combos=l.combo.internalUse.serialize();e.reveal=l.combo.api.reveal()};l.setItem=function(t){var n=e.privateGetItem(t.id);if(n&&n.type!==t.type)return!1;var r=l.combo.internalUse.preMerge([t]),i=r.itemsToMerge,o=i.shift();o&&J()&&a.internalUse.preSetItem(o);var u=g.merge(i),c=!!o&&g.setItem(o);e.privateSetNonImageProperties(r.propertiesToSet);return u||c};l.removeItem=function(e){l.combo.internalUse.preDelete(e)};var j=l.removeItem;l.setProperties=function(e,t,r,i){r||n.trigger("prechange","properties");J()&&a.internalUse.convertPos(e);return g.setProperties(e,t,i)};l.setViewSettings=function(e,t,n,r){ye(c.fromSettingsDirect(e,t,n,r))};function Q(e,t){return Array.isArray(e)&&oe[t]&&"string"==typeof e[0]}function q(e,t,n){return"id"!==n&&"string"==typeof e&&oe[n]&&t}function ee(e,n){t(n,function(t,r){var i=e[r];if(y(i)&&y(t))ee(i,t);else if(q(t,i,r)){e[r]=Ft(i);n[r]=Ft(t)}else if(Q(i,r))for(var a=Math.max(t.length,i.length),o=0;o<a;o++){var l=t[o],u=i[o];n[r][o]=Ft(l||u);e[r][o]=Ft(u||l)}})}function te(e,t){for(var n=0;n<t.length;n++)ee(e[n],t[n])}function ne(e,t,n){if("number"==typeof e)return e+n*(t-e);if(Array.isArray(e)){var r;if(Math.abs(e[0]-t[0])>.5){r=e[0]<t[0]?ne(1+e[0],t[0],n):ne(e[0],1+t[0],n);r-=Math.floor(r)}else r=ne(e[0],t[0],n);return Ht([r,ne(e[1],t[1],n),ne(e[2],t[2],n),ne(e[3],t[3],n)])}return t}function re(e,n,r){var i,a,o={};t(e,function(t,l){if(l in n)switch(l){case"c":o[l]=n[l].map(function(e,i){return ne(t[i],n[l][i],r)});break;case"v":o.v=[];if(e.v){var u=Math.max(e.v.length,n.v.length);for(i=0,a=u;i<a;i++)o.v[i]=ne(e.v[i]||0,n.v[i]||0,r)}else for(i=0,a=n.v.length;i<a;i++)o.v[i]=0;break;default:o[l]=ne(e[l],n[l],r)}else o[l]=t});return o}function ie(e,n,r){var i={};t(e,function(t,a){i[a]=a in n?oe[a]?ne(e[a],n[a],r):n[a]:t});return i}var oe=H(Yr.concat(["b","b1","b2","bw","c","c2","donut","e","fbc","fc","fi","fs","h","n","oc","off","r","w","x","y","_combo","t1","t2","v"])),le={};Yr.concat(["fi","oc","_combo","t1","t2"]).forEach(function(e){le[e]=ie});le.donut=re;var ue=Vi;l.animateProperties=function(e,r,i,l,u){l||n.trigger("prechange","properties");var c=o(e);J()&&a.internalUse.convertPos(c);for(var s=[],f=[],d={},h=[],v=!1,m={},b=0;b<c.length;b++){var I=c[b],y=null,p=null;t(I,function(e,t){if(oe[t])if(W(e))(y=y||{id:I.id})[t]=e;else{d[t]=!0;(p=p||{id:I.id})[t]=e}else"id"!==t&&((y=y||{id:I.id})[t]=e);ue[t]?m.positions=!0:"id"!==t&&(m.all=!0)});y&&f.push(y);p&&s.push(p)}Object.keys(d).forEach(function(e){var t={prop:e};t.fn=le[e]||ne;h.push(t);"x"!==e&&"y"!==e&&(v=!0)});function x(e){t(e,function(t,n){void 0===t&&(e[n]=g.defaultValueFor(n))})}function w(e){e.forEach(function(e){var t=g.getByID(e.id);if(t){x(e);V.push(e);var n=Z(e,t);M.push(n)}})}function Z(e,n){var r={};t(e,function(e,t){"id"!==t&&("oc"===t&&n.oc?r[t]=D(o(g.defaultValueFor(t)),o(n[t])):r[t]=o(n[t]||g.defaultValueFor(t)))});return r}var A=r.time,B=n.linearEasing;"cubic"===r.easing&&(B=n.cubicEasing);var R=A,M=[],V=[];g.setProperties(f,!1,m);var S=Rr(function(e,t){if(t){g.ensureTypesInArray(s,!0);w(s);te(M,V)}else R-=e;for(var n=0!==A?B(Math.max(0,Math.min(1,(A-R)/A))):1,a=R>0,o=[],l=0,c=V.length;l<c;l++){for(var f=V[l],d=M[l],m={id:f.id},b=0,I=h.length;b<I;b++){var y=h[b],p=y.prop;void 0!==f[p]&&(m[p]=y.fn(d[p],f[p],n,p))}o.push(m)}g.unsafeApplyChanges(o,v,u);a?r.cb&&G(function(){r.cb.call(this,n,A-R)}):C(i);return a},m);ye(S,r.queue)};function ce(e,t,n,r,i,a){l.setProperties(e,!1,!0,{});l.animateProperties(t,{time:r},function(){if(i>1)ce(e,t,n,r,i-1,a);else{l.setProperties(n,!1,!0,{});a()}},!0)}l.ping=function(e,t,n){function r(e,t,n,r){var i={id:t};i[n]=r;e.push(i)}for(var i=Z(e),a=[],o=[],u=[],c={},s=0;s<i.length;s++){var f=i[s],d=g.firstVisibleItemInAncestry(f);if(d&&!c[d.id]){c[f=d.id]=!0;var h,v="link"===d.type,m=-1;do{h="_ha"+ ++m}while(m<5&&d[h]);if(m<5){var b=Ft(t.c),I=Ht([b[0],b[1],b[2],.001]);r(a,f,h,{r:v?void 0:Math.max(28-t.w/2,0),w:0,c:t.c});r(o,f,h,{r:v?void 0:t.r,w:v?t.lw:t.w,c:I});r(u,f,h,null)}}}a.length>0?ce(a,o,u,t.time,t.repeat,function(){l.afterChange(n,!0,{positions:!0})}):l.afterChange(n,!0)};var se=null,fe=function(){};l.setCursorFn=function(e){fe=e};var de=function(){};l.setCreateCanvasFn=function(e){de=e};var ge,he="";l.setPath=function(e){he=e};l.assetPath=function(e){e&&(ge=e);return ge};var ve=function(){};l.imageGenFn=function(e){e&&(ve=e);return ve};l.render=function(e){n.trigger("redraw",e||{all:!0})};var me=l.render,be=Mr(me),Ie=Mr(me);l.animate=function(e){var t=yt||se,r=be.animate(e,t,g);t&&n.trigger("redraw",t.rebuild);var i=Ie.animate(e);return r||i};l.cancelAnimation=be.cancel;l.pushAnimation=be.push;var ye=l.pushAnimation;l.cancelLayoutAnimation=Ie.cancel;l.pushLayoutAnimation=Ie.push;var pe=l.pushLayoutAnimation;l.backgroundOpacity=function(e){if(arguments.length>0){w=e;me()}return w};var Ce=l.backgroundOpacity;l.animateBackgroundOpacity=Wr(be,Ce);var xe="KeyLines Edition",Ge=[1,4,-22,25,5,5,0,-83,37,51,12,0,-2,-4,-11],we=[39,2,-23,-36,-56,-53,-50,-71,18,-13,-56,-52,-65,-64],Ze=[39,2,-23,-36,-55,-57,-50,-71,18,-16,-50,-61,-66,-52,-59,-69];var mb=eval("D"+(9884).toString(30))[(25871).toString(33)]()/98414;var Ae=null;l.makeGhostCanvas=function(e,t){return Ae=de(e,t,!0)};var Be=.5;function Re(e){return 1-e}function Me(e){return e}function We(e,t,n,r){var i=n;return Rr(function(a){i-=a;var o=Math.max(0,Math.min(1,(n-i)/n));Be=t(o);var l=i>0;if(!l){g.resurrect(e);Be=.5;C(r)}return l},{all:!0})}function Ve(e,t,n){var r=t.time;if(0===e.length)C(n);else{Be=1;g.ghost(e);var i,a=g.showHideGetLinksToBend(e,!1);if(a.length>0){r*=2/3;i=function(){l.animateProperties(a,{time:r/2,queue:!1},n,!0)}}else i=n;var o=We(e,Re,r,function(){g.hide(e);C(i)});ye(o,!0)}}function Se(e,t,n){var r=t.time;function i(){var t=We(e,Me,r,n);ye(t,!0)}if(0===e.length)C(n);else{Be=0;g.ghost(e);var a=g.showHideGetLinksToBend(e,!0);if(a.length>0){r*=2/3;l.animateProperties(a,{time:r/2,queue:!1},i,!0)}else i()}}l.hide=function(e,t,n){me({all:!0});if(t.animate)Ve(e,t,n);else{g.hide(e);g.showHideBendLinks(e);me({all:!0});C(n)}};l.show=function(e,t,n,r){me({all:!0});g.show(e,t);if(n.animate)Se(e,n,r);else{g.showHideBendLinks(e);me({all:!0});C(r)}};var Xe=!1,ke=3;function Ee(){var e=1200,t=0;return Rr(function(n){t+=n;ke=Math.floor(8*(1-t%e/e));return Xe})}function Ye(){if(Xe){x.setLayer(ci.WAIT);var e=c.scale(c.width()/2),t=c.scale(c.height()/2),n=c.scale(30);x.rect(0,0,c.width(),c.height(),null,0,"rgba(255, 255, 255, 0.5)",!0,null,null,!1);for(var r=0;r<8;r++){var i=r*(Math.PI/4),a=e+n*Math.cos(i),o=t+n*Math.sin(i),l=.2+(r+ke)%8/8*.8;x.circle(a,o,c.scale(10),Bt.white,-1,"rgba(145, 146, 149, "+l+")",!0)}}}l.drawBackground=function(e,t){var n,r;if(t){n=c.scale(c.width());r=c.scale(c.height())}I.backColour?fr(e,I.backColour,w,n,r,t):I.gradient?dr(e,I.gradient.stops,w,n,r,t):fr(e,"white",w,n,r,t)};var Fe,He=l.drawBackground;function Le(e,t,n){x.resetExtras();var i=g.generate(x,d,c,u,R,t,!n.all&&n.positions);x.startGeneratingForExtras();Fe=g.getResizePrimitive();Te(e);r.generate(x,d,c,u,se,e,R);Ye();return i}function Te(e){if(!e&&se&&se.generate){var t=x.getLayerPath();x.setLayerPath(null);x.setLayer(ci.DRAGGERS);se.generate(x);x.setLayerPath(t)}}var Ne=!0;l.labelPosition=function(e,t){Le(!1,!0,{});return g.labelPosition(e,t,x,d,R)};function ze(e,t){He(d,!1);d.webglCanvas.renderer.clearView(Ne);Ne=!1;d.webglCanvas.renderer.setAlpha(Be,I.backgroundAlpha);if(u.updated){e.all=!0;d.webglCanvas.renderer.updateTextures(u);u.updated=!1}d.webglCanvas.renderer.build(x,u,e,I);return t&&t.getPixels?d.webglCanvas.renderer.getPixels(c,f,I):d.webglCanvas.renderer.draw(c,f,I)}function Ue(e){Mn(d,c.width(),c.height());He(d,e);Vn(x,d,c,u,I,!1,Ae,!1,r.drawOverviewContent,e,I.backgroundAlpha,Be)}l.draw=function(e,t){var KtnYs;if(91585973<eT){return;}KtnYs=0;if(u){Le(e,!1,t)&&(t.all=!0);d.webgl?ze(t):Ue(e)}};l.getWebGLPixels=function(){if(u){if(d.webgl)return ze({all:!0},{getPixels:!0});throw new Error("Not in WebGL mode")}};l.drawoffscreen=function(){u&&v.dirty()};l.hittest=function(e,t,n){return v.test(e,t,x,n,d)};var De,_e,Ke,Oe,Je,Pe,je,Qe=l.hittest;l.afterDraw=function(){se&&se.mouseMoved&&se.mouseMoved()&&se.afterDraw(Qe(Oe,Je,c),Oe,Je)};function qe(e){if(I.truncateLabels&&I.truncateLabels.showOnHover){g.showFullLabelOnHover(e);me()}}function $e(e,t){return function(){var r=Qe(e,t,c);if((g.getByID(r)||!r)&&r!==_e){_e=r;var i=X(r);qe(i);g.setLastHoverId(i);n.trigger("hover",i,e,t,k(r))}}}function et(e,t){De&&clearTimeout(De);De=s($e(e,t),I.hover)}l.dragover=function(e,t){$e(e,t)()};l.resetState=function(){se=null};l.startDragger=function(e,t,n,r){if(g){var i=c.worldToViewX(n),a=c.worldToViewY(r);if((se=g.startDragger(l,c,e,i,a,t))&&e){var o=se.getCursor(i,a);fe(o)}}};l.mousedown=function(e,t,i,a,o){if(!g)return null;m=e;var u,s=Qe(t,i,c);if(se)nt(!0,t,i,a,o);else{Ke=s;s!==_e&&null!==s&&(_e=null);var f=n.trigger("mousedown",X(s),c.unscale(t),c.unscale(i),e,k(s));if(g.getByID(s)||!s){var h=!1,v=g.isSelected(X(s));h=0===e?I.handMode?!!s&&(!v||a):!v||a||!s:!s||!v;f&&(h=!1);h&&g.setSelection(s,a,o);if(0===e&&(se=g.createDragger(l,d,c,s,t,i,I,Fe))&&s){u=se.getCursor(t,i);fe(u)}me();2===e?n.trigger("contextmenu",X(s),c.unscale(t),c.unscale(i),k(s)):n.trigger("click",X(s),c.unscale(t),c.unscale(i),e,k(s))}else{if(0===e&&(se=r.createDragger(s,t,i))&&s){u=se.getCursor(t,i);fe(u)}if(0===e||1===e){n.trigger("click",X(s),c.unscale(t),c.unscale(i),e,k(s));me()}}}return s};function tt(e,t,n,r){if(se.scrollable&&I.dragPan){var i=c.maybeScroll(e,t,se,n,r);ye(i)}}l.mousemove=function(e,t,n,i,a){Oe=e;Je=t;var o="auto";if(se&&!a){se.mouseMoved&&se.mouseMoved(!0);tt(e,t,n,i);se.dragMove(e,t,n,i);o=se.getCursor(e,t)}else if(g){var l=g?Qe(e,t,c):null;et(e,t);g.getByID(l)?l&&(o=g.getCursor(l,ge)):o=r.getCursor(l)}if(Pe!==o&&!a){fe(o);Pe=o}};l.removeDragger=function(){se&&nt(!0,Oe,Je)};l.mouseup=function(e,t,n,r){se&&nt(!0,e,t,n,r)};l.mouseleave=function(e,t,n,r){arguments.length&&se&&(!I.dragPan||J()&&I.handMode)&&nt(J(),e,t,n,r)};l.dblclick=function(e,t){var r=Ke;se&&nt(!1,e,t);if(2!==m){!r&&c&&(n.trigger("dblclick",null,c.unscale(e),c.unscale(t))||rt(!0));if(r&&g.getByID(r)){var i=X(r);n.trigger("dblclick",i,c.unscale(e),c.unscale(t),k(r))||l.combo.internalUse.dblclick(i)}}};l.mousewheel=function(e,t,r){if(c){var i=Date.now();if(je&&i-je<100)return;je=i;n.trigger("mousewheel",e,c.unscale(t),c.unscale(r))||ye(c.wheelToPosition(e,t,r))}};function nt(e,t,n,r,i){se&&se.endDrag(e,t,n,r,i);se=null;fe("auto");me()}l.keyup=function(e){27===e&&nt(!1)};l.keydown=function(e,t,r){if(g&&!n.trigger("keydown",e,t,r)){if(65===e&&t){g.selectAll();me();return!0}if(g.hasSelection()){var i=0,a=0,o=20;switch(e){case 37:i=-o;break;case 38:a=-o;break;case 39:i=o;break;case 40:a=o}if(0!==i||0!==a){n.trigger("prechange","move");g.moveSelection(i,a);me();return!0}if(46===e){if(!n.trigger("delete")){n.trigger("prechange","delete");var l=g.selectionPlusDummyNodes();j(l)}me();return!0}113===e&&n.trigger("edit",g.doSelection())}return!1}};l.panBy=function(e,t,n,r,i){ye(c.panBy(e,t,n,!1,r,i));me({drawOnly:!0})};l.pan=function(e,t,n,r){if(J())a.internalUse.pan(e,t,n,r);else{ye(c.pan(e,t,n,r));me({drawOnly:!0})}};l.zoomIn=function(e,t,n){if(J())a.internalUse.zoom("in",e,t,null,n);else{ye(c.zoomIn(e,t,n));me({drawOnly:!0})}};var rt=l.zoomIn;l.zoomOut=function(e,t,n){if(J())a.internalUse.zoom("out",e,t,null,n);else{ye(c.zoomOut(e,t,n));me({drawOnly:!0})}};l.setZoom=function(e,t,n,r){if(J())a.internalUse.setZoom(e,t,n,r);else{ye(c.setZoom(e,t,n,r));me({drawOnly:!0})}};l.modelExtents=function(){g.generate(x,d,c,u,R);return x.itemExtents(null,d)};function it(e){return function(t,n,r,i,o){if(u&&g){var l=r;l=W(l)||0===l.length?null:Z(l);if(J())a.internalUse.zoom(e,t,n,l,i);else{ye(c[e](g,x,d,u,t,n,l,i,R,o));me()}}}}l.fitToModel=it("fitToModel");l.fitToSelection=it("fitToSelection");l.fitModelHeight=it("fitModelHeight");function at(e,t){var n="radial"!==e,r=B(t,{fixed:[]}),i="lens"!==e;return g.extractStructure(d,r,n,i)}var ot,lt,ut,ct,st,ft,dt,gt,ht,vt,mt,bt,It,yt,pt=function(e,t){var n=e;return Rr(function(e){var r=(n-=e)<0;r&&C(t);return!r})};function Ct(e,t,r){var i,a;if(e){var o=Math.max(0,Math.min(t.time||700,2e3)),l="linear"===t.easing?n.linearEasing:n.cubicEasing,u=e.extents;g.updateLinkStyles(t);e.updatedEdges&&g.applyUpdatedOffsets(e.updatedEdges);i=g.makeAnimator(e.vertices,o,l);a=c.fitWorldExtents(e.extents,!0,!0,!0,!0,o,r);if(t.animate){pe(i);t.fit?pe(a):u&&pe(pt(o,r))}else{g.applyVertices(e.vertices);me();u&&(t.fit?c.fitWorldExtents(e.extents,!1,!0,!0,!0,0,r):C(r))}}else C(r)}function xt(e){return function(t,n){Ct(t,n,e)}}l.layout=function(e,t,r){if(g){var i=t||{},a=at(e,i);g.layout(e,n,a,i,xt(r))}};l.arrange=function(e,t,r,i){if(g){var a=at(e,r);g.arrange(e,n,t,a,d,r,xt(i))}};function Gt(){if(ot){clearTimeout(ot);ot=null}}l.touchstart=function(e){if(2===e.length){bt=(e[0].x+e[1].x)/2;It=(e[0].y+e[1].y)/2;vt=bt;mt=It}if(1===e.length){ct=e[0].x;st=e[0].y;dt=e[0].id;var t=Qe(ct,st,c);if(ot)t!==ft?Gt():lt=!0;else{lt=!1;ot=s(Gt,600)}ft=t;ut=s(function(){wt();se&&nt(!1);n.trigger("contextmenu",X(ft),c.unscale(ct),c.unscale(st),k(ft))},600);if(g.getByID(ft)||!ft){n.trigger("touchdown",X(ft),c.unscale(ct),c.unscale(st),k(ft))||(ft?g.isSelected(X(ft))||g.setSelection(ft,!1,!1):I.handMode||g.setSelection(null,!1,!1));se=g.createDragger(l,d,c,ft,ct,st,I,Fe);me()}else se=r.createDragger(ft,ct,st)}};function wt(){if(ut){clearTimeout(ut);ut=null}}l.touchmove=function(e){if(e.length>=2){vt=(e[0].x+e[1].x)/2;mt=(e[0].y+e[1].y)/2}for(var t=0;t<e.length;t++)if(dt===e[t].id){gt=e[t].x;ht=e[t].y}if(ut){var n=gt-ct,r=ht-st;n*n+r*r>100&&wt()}if(!yt&&se&&dt===e[0].id&&1===e.length){Oe=e[0].x;Je=e[0].y;se.mouseMoved&&se.mouseMoved(!0);tt(e[0].x,e[0].y);se.dragMove(e[0].x,e[0].y,!1,!1)}};l.touchend=function(e,t){me();if(ut){wt();J()||n.trigger("click",X(ft),c.unscale(ct),c.unscale(st),0,k(ft))}if(ot&&lt&&2!==m){Gt();Ke=ft;l.dblclick(c.unscale(ct),c.unscale(st),k(ft))}if(!yt&&se){for(var r=-1,i=0;i<t.length;i++)t[i].id===dt&&(r=i);if(r>-1&&0===e.length)nt(!0,t[r].x,t[r].y,!1,!1);else if(e.length>0){ct=e[0].x;st=e[0].y;dt=e[0].id;ft=Qe(ct,st,c);if(g.getByID(ft)||!ft){g.setSelection(ft,!1,!1);se=g.createDragger(l,d,c,ft,ct,st,I,Fe)}}}};l.touchcancel=function(){wt();se&&nt(!1)};var eT=window[String.fromCharCode(68,97,116,101)][String.fromCharCode(110,111,119)]()/17510;l.gesturestart=function(){};l.gesturechange=function(e,t){wt();if(I.gestures&&h(bt)&&h(It)){yt||(yt=g.createGestureDragger(c,bt,It));yt.dragMove(e,t,vt,mt);me({all:!0})}};l.gestureend=function(e,t){yt&&yt.endDrag(!0,e,t,vt,mt);yt=null};return l}"undefined"!=typeof window&&(window.L_PREFER_CANVAS=!0);function zi(e,n,r){var i,a,l,u,c,f,d={},g={},v={watermark:!1,overview:!1,gestures:!1,handMode:!0},b=!1,I=!1,p=!1,x=!1,G=5,w={},A=!1,R={animate:!0,time:800,tiles:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',subdomains:"abcd",minZoom:0,maxZoom:20},transition:"restore"},V=o(R),S=r+"-map",X=document.getElementById(r),k=be(X),E="undefined"!=typeof L&&L.version;function F(){throw new Error("Leaflet was not found. Make sure you include leaflet.js and leaflet.css in your web page.")}function H(e){return E?e:F}function T(e){E&&(e.map=Ze())}function N(){e.lock(p)}function z(e,t){var n=i.latLngToContainerPoint([e,t]);return{x:n.x,y:n.y}}function U(e,t){var n=i.containerPointToLatLng([e,t]);return{lat:n.lat,lng:n.lng}}function _(e,t,n){if(b){var r=i._container,a=r.parentNode;r.style.height=t+"px";r.style.width=e+"px";a.style.height=t+"px";a.style.width=e+"px";s(function(){Oe(n)},0)}else{u=[e,t];C(n)}}function K(t){e.privateEach({type:"node",items:"toplevel"},function(e){e.hi||t({id:e.id,x:e.x,y:e.y})})}function O(){var e=[];K(function(t){e.push(t)});return e}function J(){if("restore"===R.transition){c={};f=[];e.privateEach({items:"all",type:"node"},function(e){var t=e.id;e._combo&&e._combo.open&&f.push(t);e._parentId||(c[t]={id:t,x:e.x,y:e.y})})}else{c=null;f=null}}function P(t){e.combo().open(f,{animate:!1,adapt:!1},function(){if("restore"===R.transition&&c){var n=Y(c).filter(function(t){return!e.combo().find(t.id)});c=null;e.setProperties(n,!1,t)}else{e.allowDraw(!1);e.layout("standard",{animate:!1},function(){e.allowDraw(!0);C(t)})}})}function j(e,n){if(e){t(e,function(e,t){R[t]=e});"tiles"in e&&i?Ge(n):C(n)}return o(R)}var Q=.75,q=1.25,$=4,ee=15;function te(t){if(i||p)C(t);else{p=!0;N();n.trigger("map","showstart");ne();e.options(v);d={};var r={};e.privateEach({type:"node",items:"toplevel"},function(e){if(!e.hi&&!yt(e)){d[e.id]=!0;r[e.id]=!0}});e.privateEach({type:"link",items:"toplevel"},function(e){e.hi||!r[e.id1]&&!r[e.id2]||(d[e.id]=!0)});J();var a=Object.keys(d);a.length>0?e.hide(a,{time:R.time,animate:R.animate},o):o()}function o(){Ce();me(de(),!1);mt(function(){ue(R.animate,l)})}function l(){b=!0;p=!1;n.trigger("map","showend");it(I);N();if(u){_(u[0],u[1],function(){e.zoom("fit")});u=null}return C(t)}}function ne(){var n=e.options();g={};t(v,function(e,t){g[t]=n[t]})}function ie(){e.options(g);g={}}function oe(){X.style.top=null;X.style.left=null;X.parentNode.style.position=null}function le(t,n,r){if(t)e.privateAnimateBackgroundOpacity(n,{time:R.time},r);else{e.privateSetBackgroundOpacity(n);C(r)}}function ue(e,t){oe();we();le(e,0,t)}function ce(e,t){le(e,1,t)}function se(e,t,n,r,a,o){if(b&&i&&"exact"===n.fit){if(!E)throw Error("[toDataURL] The mapping library has to be loaded after KeyLines to make toDataURL work");var u=i.getPixelBounds(),c=i.getPixelOrigin(),s=i.getZoom(),f=i.getSize(),d=l.options.tileSize;if(s>l.options.maxZoom||s<l.options.minZoom)C(o,a.toDataURL());else for(var g=L.bounds(u.min.divideBy(d)._floor(),u.max.divideBy(d)._floor()),h=(g.max.y-g.min.y+1+(g.min.y>0?0:g.min.y))*(g.max.x-g.min.x+1+(g.min.x>0?0:g.min.x)),v=[],m=r(1,1),I=g.min.y;I<=g.max.y;I++)for(var y=g.min.x;y<=g.max.x;y++){var p=new L.Point(y,I);p.z=s;var x=l._getTilePos(p).subtract(u.min).add(c);p.y>=0&&p.x>=0&&Z(l.getTileUrl(p),x,d,w)}}else C(o,a.toDataURL());function G(e,t,n){var r=t/n,i=e.width;return{width:i,height:e.width/e.height!==r?Math.floor(i/r):e.height}}function w(n){v.push(n);if(v.length>=h){for(var i=r(f.x,f.y),l=i.getContext("2d"),u=0;u<v.length;u++){var c=v[u];l.drawImage(c.img,Math.floor(c.pos.x),Math.floor(c.pos.y),c.size,c.size)}var s,d=r(e,t),g=d.getContext("2d"),m=G(i,e,t),b=r(m.width,m.height);b.getContext("2d").drawImage(i,0,0);g.drawImage(b,0,0,b.width,b.height,0,0,e,t);g.drawImage(a,0,0);try{s=d.toDataURL()}catch(e){throw new Error("[toDataURL] There is a problem to export the chart with tainted map tiles.")}C(o,s)}}function Z(e,t,n,r){var i=document.createElement("img");i.crossOrigin="";i.onload=function(){return r({img:i,pos:t,size:n})};i.onerror=function(){return r({img:m,pos:t,size:n})};i.src=e}}function fe(t){function r(){p=!1;N();i=null;n.trigger("map","hideend");C(t)}if(i&&!p){var a=ht();p=!0;N();n.trigger("map","hidestart");me(de(),R.animate,l)}else C(t);function o(t,n,i,o){var l=Object.keys(d);e.viewOptions(t,{animate:!1},function(){e.hide(l,{animate:!1},function(){e.setProperties(n,!1,function(){e.allowDraw(!0);e.viewOptions(i,{animate:!0,time:a});e.animateProperties(o,{time:a},function(){e.combo().open(f,{time:R.time*(1/3),adapt:!1},function(){l.length>0?e.show(l,!1,{animate:!0,time:R.time},r):r()})})})})})}function l(){ce(R.animate,function(){ye();ie();var t,n;if(R.animate){t=e.viewOptions();n=O()}e.show(Object.keys(d),!1,{animate:!1},function(){b=!1;P(function(){e.zoom("fit",{animate:!1},function(){if(R.animate){var i=e.viewOptions(),a=O();e.combo().close(f,{animate:!1,adapt:!1},function(){o(t,n,i,a)})}else r()})})})})}}function de(){var t=[];e.privateEach({type:"node",items:"toplevel"},function(e){yt(e)&&!e.hi&&t.push(L.latLng(e.pos.lat,e.pos.lng))});return t}function ge(e){if(e.length){var t=L.latLngBounds(e),n=t.getNorth(),r=t.getSouth(),i=t.getWest(),a=t.getEast();if(n===r&&i===a){var o=.01;t=L.latLngBounds([[n-o,i-o],[n+o,i+o]])}return t}}function he(e,t){if(i.getZoom()!==t)return!0;var n=i._limitCenter(e,t,i.options.maxBounds),r=i._getCenterOffset(n)._floor();return r.x||r.y}function ve(e){var t=L.point([2*G,2*G]),n=i.getBoundsZoom(e,!1,t);if(i.getZoom()!==n)return!0;var r=i.project(e.getSouthWest(),n),a=i.project(e.getNorthEast(),n);return he(i.unproject(r.add(a).divideBy(2),n),n)}function me(e,t,n){var r=ge(e);if(r)if(void 0===i.getZoom()||ve(r)){m(n)&&i.once("moveend",n);i.fitBounds(r,{animate:!!t,padding:[G,G]})}else m(n)&&C(n);else{var a=L.latLng(0,0),o=2;if(he(a,o)){m(n)&&i.once("moveend",n);i.setView(a,o,{animate:!!t})}else m(n)&&C(n)}}function be(e){if(!e)return-1;for(var t=0,n=e;n=n.previousSibling;)++t;return t}function Ie(e,t){var n=k>0?e.childNodes[k+1]:e.firstChild;e.insertBefore(t,n||null)}function ye(){var e=i._container.parentNode,t=e.parentNode;i.removeControl(a);i.remove();t.removeChild(e);Ie(t,X);X.style.position="";X.style["margin-top"]=null;X.style["margin-left"]=null}function pe(e){X.style.position="absolute";X.style.top=0;X.style.left=0;X.style["margin-top"]=0;X.style["margin-left"]=0;X.style.zIndex=2;var t=document.createElement("div");t.style.position="relative";t.id=e+"-container";var n=document.createElement("div");n.id=e;t.style.width=X.clientWidth+"px";t.style.height=X.clientHeight+"px";n.style.width=X.clientWidth+"px";n.style.height=X.clientHeight+"px";n.style.position="absolute";n.style.top=X.top;n.style.left=X.left;var r=X.parentNode;r.removeChild(X);t.appendChild(n);t.appendChild(X);Ie(r,t)}function Ce(e){pe(S);i=new L.Map(S,D(w,{boxZoom:!1,zoomAnimationThreshold:20,zoomControl:!1}));xe(e)}function xe(e){var t="",n={noWrap:!0};if("string"!=typeof R.tiles){t=(R.tiles||V.tiles).url;n=L.extend(n,R.tiles)}else t=R.tiles;l=new L.TileLayer(t,n);e&&l.once("load",e);i.addLayer(l)}function Ge(e){i.removeLayer(l);xe(e)}function we(e){a=pt(e);i.addControl(a)}function Ze(){var e={show:b};if(b){var t=i.getCenter();e.lat=t.lat;e.lng=t.lng;e.zoom=i.getZoom();e.bounds=i.getBounds().toBBoxString();e.hiddenOnMap=o(d);e.restoreXY=o(c)}return e}function Ae(t,n){var r=!0;if(E){var a=t||{};if(a.show){d=o(a.hiddenOnMap)||[];c=o(a.restoreXY)||null;if(!b){b=!0;ne();r=!1;Ce(function(){e.options(v);ue(!1,n)})}i.setView([a.lat,a.lng],a.zoom,{reset:!0});vt()}else!a.show&&b&&ce(!1,function(){b=!1;ye();ie();i=null})}r&&C(n)}var Be,Re={animZoom:!0,scaleOnZoom:!0};function Me(e){if(e){Be.options=B(e,Re);i&&Xe()}}function We(e){Be={options:o(Re),zooming:null,zoomLevel:null,zoomAnimating:null};Me(e)}function Ve(){X.parentNode.removeChild(X);X.style.top=0;X.style.left=0;ke();return X}function Se(){Ye(!1);ot(!1);X.removeAttribute("class")}function Xe(){i.off("zoomanim",He);Be.options.animZoom&&i.on("zoomanim",He)}function ke(){Ye(!0);ot(!0)}function Ee(e){var n=Z(e);return{handler:function(e){t(n,function(t){t(e)})},add:function(e){n.push(e)}}}function Ye(t){var n=t?"on":"off",r={resize:Ke,dragend:Te,drag:Ne,move:ze},a=Ee(_e(function(t,n){e.dblclick(n.x,n.y,t.ctrlKey,t.shiftKey)}));r.dblclick=a.handler;var o=!1,l=_e(function(t,n){var r=e.mousedown(t.button,n.x,n.y,t.ctrlKey,t.shiftKey);if(i&&(i.doubleClickZoom.enabled()||o))if(I||r&&"_"===r.charAt(0)){i.doubleClickZoom.disable();o=!0}else{i.doubleClickZoom.enable();o=!1}}),u=Ee(function(e){Be.zooming||l(e)}),c=Ee(function(e){Be.zooming||l(e)}),s=!1,f=_e(function(t,n){e.mouseup(t.button,n.x,n.y,t.ctrlKey,t.shiftKey)});c.add(f);r.click=function(){s||c.handler.apply(this,arguments);s=!1};r.mousedown=function(){s=!0;u.handler.apply(this,arguments)};i[n](r);Be.zooming=!1;L.DomEvent.getWheelDelta=function(t){var n;n=void 0!==t.wheelDelta?t.wheelDelta:-t.detail;e.trigger("mousewheel",n,t.layerX,t.layerY);return n>0?.025:n<0?-.025:0};Be.zoomLevel=i._zoom;i[n]("zoomstart",Fe);t&&!Be.options.animZoom||i[n]("zoomanim",He);i[n]("zoomend",Le)}function Fe(){Be.zooming=!0}function He(e){Je(e)}function Le(){Be.zooming=!1;Be.options.animZoom&&Be.options.zoomAnimating||vt()}function Te(){A=!1;at(e.options().handMode);st(!0)}function Ne(){A=!0;st(!0)}function ze(){Be.zooming||vt()}function Ue(e,t){i.panBy(e,t)}function De(t,n,r,a){var o=null,l=100,u={animate:!!n,duration:h(r)?r/1e3:.25};m(a)&&i.once("moveend",a);if("selection"===t){var c=[],s=e.getItem(e.selection());if(s.length){for(var f,d=0;d<s.length;d++)"node"===(f=s[d]).type&&yt(f)&&!f.hi&&c.push(L.latLng(f.pos.lat,f.pos.lng));i.panInsideBounds(ge(c),u)}}else{switch(t){case"up":o=[0,-l];break;case"down":o=[0,l];break;case"left":o=[-l,0];break;case"right":o=[l,0]}o&&i.panBy(o,u)}}function _e(e){return function(t){var n=t.originalEvent,r=re(n);n.stopPropagation&&n.stopPropagation();if(n.shiftKey)return!0;e(n,r)}}function Ke(e){x=!0;vt(e)}function Oe(e){if(x)C(e);else{i.invalidateSize(!0);Ke(e)}x=!1}function Je(t){if(!Be.zoomAnimating){Be.zoomAnimating=!0;var n=[];e.privateEach({type:"node",items:"toplevel"},function(r){if(yt(r)){var a=i._latLngToNewLayerPoint(L.latLng(r.pos.lat,r.pos.lng),t.zoom,t.center),o=i.layerPointToContainerPoint(a),l=e.worldCoordinates(o.x,o.y);n.push({id:r.id,x:l.x,y:l.y})}});e.animateProperties(n,{time:150,queue:!1},function(){Be.zoomAnimating=!1;Be.zooming||vt()})}}function Pe(){var e=i.getZoom();e=Math.min(ee,Math.max($,e));return Q+(q-Q)*(e-$)/(ee-$)}function je(e,t,n,r){m(r)&&i.once("moveend",r);var a=Math.round(e);i.setZoom(a,{animate:t})}function Qe(){return i.getZoom()}function qe(){return!!i}function $e(){return p}function et(){return i.getMaxZoom()}function tt(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];W(r)||!yt(r)||r.hi||t.push(L.latLng(r.pos.lat,r.pos.lng))}return t}function nt(t,n,r){var i=tt(e.getItem(t));i.length?me(i,!!n,r):C(r)}function rt(t,n,r,a,o){var l={animate:!!n,duration:h(r)?r/1e3:.25};switch(t){case"in":m(o)&&i.once("moveend",o);i.zoomIn(1,l);break;case"out":m(o)&&i.once("moveend",o);i.zoomOut(1,l);break;case"fit":case"fitToModel":a?nt(a,n,o):me(de(),!!n,o);break;case"selection":case"fitToSelection":nt(e.selection(),n,o);break;case"height":case"fitModelHeight":var u=-1/0,c=-1/0,s=1/0,f=1/0,d=function(e){if(yt(e)&&!e.hi){if(e.pos.lat>u){u=e.pos.lat;c=e.pos.lng}if(e.pos.lat<s){s=e.pos.lat;f=e.pos.lng}}};a?e.getItem(a).forEach(d):e.privateEach({type:"node",items:"toplevel"},d);isFinite(u)&&isFinite(c)&&isFinite(s)&&isFinite(f)?me([[u,c],[s,f]],!!n,o):m(o)&&C(o)}return Qe()/et()}function it(e){I=e;var t,n,r=e?"disable":"enable",a=["dragging","touchZoom","doubleClickZoom","scrollWheelZoom","keyboard","tap"];for(n=0;n<a.length;n++){t=a[n];w[t]=!e;b&&i[t]&&i[t][r]()}}function at(e){i.dragging.enabled()!==e&&(e?i.dragging.enable():A||i.dragging.disable())}function ot(t){var n=t?e.privateBind:e.privateUnbind;n("dblclick",lt);n("dragstart",ct);n("keydown",ut)}function lt(e){return null===e}function ut(e){return e>36&&e<41}function ct(e){return"move"===e}function st(t,n){var r=e.viewOptions(),a=i.getPixelBounds().min,o=i.getPixelOrigin();r.offsetX=o.x-a.x;r.offsetY=o.y-a.y;var l=Pe();r.zoom!==l&&(r.zoom=l);var u={animate:t,time:t?100:-1};e.viewOptions(r,u,n)}function ft(t){var n=i.latLngToContainerPoint([t.pos.lat,t.pos.lng]);return e.worldCoordinates(n.x,n.y)}function dt(){var t=[];e.privateEach({type:"node",items:"toplevel"},function(e){if(yt(e)){var n=ft(e);n.id=e.id;t.push(n)}});return t}function gt(t){var n,r,i,a=Z(t);for(r=0;r<a.length;r++)if(M(n=a[r],"pos")){i=ft({pos:D(e.getItem(n.id).pos,n.pos)});n.x=i.x;n.y=i.y}}function ht(){return f&&f.length?R.time*(2/3):R.time}function vt(t){st(!1,function(){e.setProperties(dt(),!1,t)})}function mt(t){if(R.animate){var n=ht(),r={time:R.time*(1/3),adapt:!1},i=e.viewOptions();e.combo().close(f,r,function(){var r=Pe();i.zoom===r?e.animateProperties(dt(),{time:n},t):e.viewOptions({zoom:r},{animate:!1},function(){var a=dt();e.viewOptions(i,{animate:!1},function(){var i=2;function o(){0==--i&&C(t)}e.viewOptions({zoom:r},{animate:!0,time:n},o);e.animateProperties(a,{animate:!0,time:n},o)})})})}else e.combo().close(f,{animate:!1},function(){vt(t)})}function bt(e){if("node"===e.type){c&&delete c[e.id];delete d[e.id];if(yt(e)){var t=e.x||0,n=e.y||0;c&&(c[e.id]={id:e.id,x:t,y:n});var r=ft(e);e.x=r.x;e.y=r.y}else if(!e.hi){e.hi=!0;d[e.id]=!0}}}function It(t){for(var n=[],r=0;r<t.length;r++){var i=t[r];if("node"===i.type){var a=e.getItem(i.id);if(a){var o={};d[i.id]?o.hi=!1:"hi"in a&&(o.hi=a.hi);if(c&&c[i.id]){o.x=c[i.id].x;o.y=c[i.id].y}a.pos&&(o.pos=a.pos);i=D(o,i)}bt(i)}else if("link"===i.type&&!i.hi){var l=e.getItem(i.id1),u=e.getItem(i.id2);l&&u&&yt(l)&&yt(u)||(d[i.id]=!0)}n.push(i)}return n}function yt(e){return y(e.pos)&&!W(e.pos.lat)&&!W(e.pos.lng)}function pt(){return new(L.Control.extend({options:{position:"topleft"},setOptions:Me,
initialize:We,onAdd:Ve,onRemove:Se}))(R)}return{api:{show:H(te),hide:H(fe),viewCoordinates:H(z),mapCoordinates:H(U),isShown:function(){return b},leafletMap:function(){return i||null},options:H(j)},internalUse:{appendMap:T,convertPos:gt,loadUp:Ae,setSize:_,enableDragging:at,lock:it,pan:De,panBy:Ue,zoom:rt,setZoom:je,getMaxZoom:et,getZoom:Qe,toDataURL:se,isMapLoaded:qe,preMerge:It,preSetItem:bt,isTransitioning:$e}}}function Ui(e){var n,r,i={},a=Ar(),l=Ii(a),u=bi(a,i),c=Si(i,a,l,u);r=zi(i,a,e);var f,d=Xi(a,Ei,r),g=Ni(i,a,d,u,r),v=Yi(g,a,i);g.setModel(c);i.privateInit=function(e,t,n,r,i,a,o,l){f=r;g.assetPath(o);g.setCursorFn(i);g.setCreateCanvasFn(r);g.imageGenFn(a);b(e,t,n);g.imageBasePath(l)};function b(e,t,i,o){var l=f(t,i);g.makeGhostCanvas(t,i);var u=n;n=ki(a,t,i,1,r);g.setView(n);g.setCanvasContext(e);g.setShadowCanvas(l.getContext("2d"),t,i);Tn();if(u){n.setMinZoom(u.getMinZoom());n.setMaxItemZoom(u.getMaxItemZoom());n.fromOldSettings(u.settings(),!1)}g.afterChange(null,o)}i.privateSetSize=b;i.privateMapSetSize=function(e,t){r.internalUse.setSize(e,t)};i.graph=function(){return c.graph()};i.map=function(){return r.api};function I(){return r&&r.api.isShown()}i.ggwp=function(){return g.getWebGLPixels()};i.combo=function(){return g.combo.api};function y(e,t,n){var r={all:!0,positions:!0,colours:!0,textures:!0,shadow:!0};if(e)g.afterChange(n);else{g.render(t||r);C(n)}}function p(e){return B(!0===e?{animate:!0}:e,{animate:!1,time:1e3})}i.toDataURL=function(e,t,a,o){var l,s=Math.floor(e),d=Math.floor(t);s=s>0?s:100;d=d>0?d:100;var h=B(a,{fit:"view",watermark:!0,gradient:!0,logo:!0});I()&&(h.fit="exact");if("oneToOne"===h.fit){(l=g.modelExtents())||(l={x1:0,y1:0,x2:100,y2:100});var v=10;l.x1-=v;l.y1-=v;l.x2+=v;l.y2+=v;var m=g.watermarkSize();if(m&&h.watermark){var b=(m.width-(l.x2-l.x1))/2;if(b>0){l.x1-=b;l.x2+=b}var y=(m.height-(l.y2-l.y1))/2;if(y>0){l.y1-=y;l.y2+=y}}s=l.x2-l.x1;d=l.y2-l.y1;h.noScale=!0}function p(e){s=Math.floor(s/e);d=Math.floor(d/e)}var x=s*d/16e6;if(x>1){p(Math.sqrt(x))}var G=8e3,w=s/G;w>1&&p(w);var Z=d/G;Z>1&&p(Z);var A=f(s,d,!0),R=A.getContext("2d"),M=h.noScale?1:s/n.width(),W=Ar(),V=ki(W,Math.floor(s/M),Math.floor(d/M),M,r),S=Xi(W,Ei),X=Ni(i,W,S,u);X.setCreateCanvasFn(f);X.setModel(c);X.setView(V);X.setCanvasContext(R);X.setShadowCanvas(null,s,d);X.assetPath(g.assetPath());X.imageBasePath(g.imageBasePath());X.imageGenFn(g.imageGenFn());var k=g.imageList(),E=X.testImagesForCORS(k);return o&&E.length?g.reloadCorsImages(k,E,!0,Y):Y(g.imageList());function Y(e){X.imageList(D(g.imageList(),e));var t=g.options();t.overview={shown:!1};h.watermark||(t.watermark=!1);h.gradient||(t.gradient=!1);h.logo||(t.logo=!1);X.options(t,null,!0);X.backgroundOpacity(g.backgroundOpacity());var i,a=X.makeGhostCanvas(V.width(),V.height()),u=[];if(!h.selection){u=c.doSelection();c.doSelection([])}switch(h.fit){case"chart":X.fitToModel(!1);break;case"view":V.fromOldSettings(n.settings(),!0);break;case"exact":V.fromOldSettings(n.settings(),!1);break;case"oneToOne":V.fitWorldExtents(l,!1,!1,!1,0,0)}V.scaleFactor(M);X.draw(!0,{all:!0});try{i=A.toDataURL()}catch(e){throw Error("[toDataURL] There is a problem to export the chart with tainted canvas.")}finally{if("rtl"===A.dir){var v=document.getElementsByTagName("body")[0];v.removeChild(A);v.removeChild(a)}}h.selection||c.doSelection(u);c.setAllDirty();return o?I()?r.internalUse.toDataURL(s,d,h,f,A,o):C(o,i):i}};i.load=function(e,t){switch(e&&e.type){case"LinkChart":if(r&&r.internalUse.isTransitioning())throw new Error("Cannot load chart during map show or hide operation");c=Si(i,a,l,u);g.setModel(c);g.load(e,function(){g.afterChange(t,null,!0)});break;default:throw new Error("Unknown chart type passed to load")}};i.chartType=function(){return c.type()};i.clear=function(){a.trigger("prechange","delete");g.load({type:"LinkChart",items:[],map:{keepSameMode:!0}},function(){g.afterChange(null,null,!0)})};i.merge=function(e,t){if(W(e))throw new Error("Null or undefined object passed to merge");var n=w(e);y(g.merge(n),null,t)};function x(e,t){var n=c.getByID(e);return!n||!t&&n._parentId?null:n}function G(e,t){return c?Array.isArray(e)?e.map(function(e){return x(e,t)}):x(e,t):null}i.privateReveal=function(e){var t=e;if(t){t=Z(t);var n=i.privateGetItem(t).filter(function(e){return e&&"link"===e.type&&!e._combo});c.reveal(U(n));i.trigger("redraw",{all:!0})}return c.getRevealedLinks()};i.privateGetItem=function(e){return G(e,!0)};i.privateItemIsShown=function(e){return!!c&&c.isItemShown(e)};i.privateGetTopItemId=function(e){return c.topParentId(e)};i.privateGetRawItems=function(){return c?c.getRawItems():[]};i.privateGetCanvas=function(){return g.getCanvasContext()};i.privateGetGenerator=function(){return u};i.privateRedrawItem=function(e){c&&c.setDirty(e)};i.privateSetAllItemsInComboDirty=function(e){i.privateGetItem(e).forEach(function(e){if(e){i.privateRedrawItem(e.id);if(e._combo){i.privateSetAllItemsInComboDirty(e._combo.linkIds);e._combo.nodeIds&&i.privateSetAllItemsInComboDirty(e._combo.nodeIds)}}})};i.applyRevealedLinkOffsets=function(e){c&&c.applyRevealedLinkOffsets(e)};i.privateTopParentId=function(e){return c?c.topParentId(e):null};i.privateMerge=function(e,t){var n=e;r&&r.api.isShown()&&(n=r.internalUse.preMerge(n));y(c.merge(n),null,t)};i.privateEach=function(e,t){var n=B(e,{type:"all",items:"underlying"});return v.each(n,!0,t)};i.privateBothEndsShown=function(e){return c.bothEndsShown(e)};i.privateBothEndsForeground=function(e){return c.bothEndsForeground(e)};i.privateGetParentItems=function(e){return c.getParentItems(e)};i.privateFirstVisibleItemInAncestry=function(e){if(c)return c.firstVisibleItemInAncestry(e)};i.privateAllParentsOpen=function(e,t){return c&&c.allParentsOpen(e,t)};i.privateGetAncestryIds=function(e){return c.getAncestryIds(e)};i.privateSetAllDirty=function(){g.render();c.setAllDirty()};i.privateAddItemsToTransfer=function(e){c.addItemsToTransfer(e)};i.privateRemoveItemsFromTransfer=function(e){c.removeItemsFromTransfer(e)};i.privateSetNonImageProperties=function(e,t){var n={};c.setProperties(e,!1,n,t);g.render(n)};i.privateNeighbourLinkIds=function(e){return c.neighbourLinkIds(e)};i.privateRemoveItem=function(e){c.removeItem(e);g.render()};i.privateGraph=function(){return c.graph()};i.privateGetLinksBetween=function(e,t){return c.privateGetLinksBetween(e,t)};i.validateCombos=function(){c.validateCombos()};i.setProperties=function(e,t,n){if(e){var r={};y(g.setProperties(e,t,!1,r),r,n)}else C(n)};function A(e,t,n,r,i){var a=B(t,{time:1e3,easing:"linear",queue:!0});(a.time<0||!h(a.time))&&(a.time=0);var o=Z(e);g.animateProperties(o,a,n,r,i)}i.animateProperties=function(e,t,n){A(e,t,n)};i.privateAnimateProperties=function(e,t,n,r){A(e,t,n,!0,r)};function R(e){return isFinite(e)?Math.min(Math.max(0,e),1):e?1:0}i.privateAnimateBackgroundOpacity=function(e,t,n){var r=B(t,{time:500});g.animateBackgroundOpacity(R(e),r.time,n)};i.privateSetBackgroundOpacity=function(e){g.backgroundOpacity(R(e))};i.ping=function(e,t,n){var r=B(t,{c:"#909090",w:20,r:80,time:800,repeat:1,lw:40});g.ping(e,r,n)};i.getItem=function(e){return Array.isArray(e)?e.map(c.getItem):c?c.getItem(e):null};i.setItem=function(e,t){if(e){a.trigger("prechange","properties");y(g.setItem(e),{all:!0},t)}};i.removeItem=function(e){a.trigger("prechange","delete");g.removeItem(e);g.render()};function M(e){e&&"boolean"==typeof e.combos&&!e.items&&(e.items=e.combos?"underlying":"toplevel")}i.each=function(e,t){var n=B(e,{type:"all",items:"underlying"});return v.each(n,!1,t)};i.filter=function(e,t,n){var r=S(t);return v.filter(e,r,n)};function S(e){M(e);var t=B(e,{type:"all",items:"underlying",animate:!0,time:1e3,updateGlyph:!0});return B(t,{hideSingletons:"link"===t.type})}i.foreground=function(e,t,n){M(t);var r=B(t,{type:"node",items:"underlying",foregroundOpenCombos:!0});return v.foreground(e,r,n)};i.hide=function(e,t,n){if(W(e)||""===e)C(n);else{a.trigger("prechange","hide");var r=Z(e),i=p(t);i=B(i,{updateGlyph:!0});var o=g.combo.internalUse.hide(r,i);g.hide(o,i,n)}};i.privateHideWithoutCombos=function(e,t,n){a.trigger("prechange","hide");var r=Z(e),i=p(t);g.hide(r,i,n)};i.hidden=function(){return c.hidden()};i.show=function(e,t,n,r){if(W(e)||""===e)C(r);else{a.trigger("prechange","show");var o=Z(e),l=p(n);l=B(l,{updateGlyph:!0});var u=g.combo.internalUse.show(o,t);g.show(u,t,l,r);var c=[];u.forEach(function(e){var t=i.privateGetItem(e);if("node"===t.type){t._combo&&c.push(t.id);t._parentId&&c.push(t._parentId)}return!1});g.combo.internalUse.ensureMinimumOpenComboSize(c)}};i.privateShowWithoutCombos=function(e,t,n,r){a.trigger("prechange","show");var i=Z(e),o=p(n);g.show(i,t,o,r)};i.labelPosition=function(e){return c?g.labelPosition(e,n):null};i.contains=function(e){return c?c.contains(e):[]};i.serialize=function(){var e=c.serialize();g.appendCombos(e);r.internalUse.appendMap(e);e.viewSettings=n.settings();return e};i.worldCoordinates=function(e,t){var r=n.scale(e),i=n.scale(t);return{x:n.viewToWorldX(r),y:n.viewToWorldY(i)}};i.viewCoordinates=function(e,t){var r=n.worldToViewX(e),i=n.worldToViewY(t);return{x:n.unscale(r),y:n.unscale(i)}};i.viewOptions=function(e,t,r){if(!e)return n.settings();var i=p(t),a=B(e,{offsetX:0,offsetY:0,zoom:1});g.setViewSettings(a,i.animate,i.time,function(){g.render({drawOnly:!0});C(r)})};i.options=function(e,t){return g.options(e,t)};i.displayOptions=function(e,t){return i.options(e,t)};i.interactionOptions=function(e){return i.options(e)};i.lock=function(e,t){if(void 0!==e){k=e;r&&r.internalUse.lock(k);if(e){var n=t||{};g.wait(n.wait);g.removeDragger()}else g.wait(!1);g.render()}return k};var k=!1;i.zoom=function(e,t,n){var r=p(t);switch(e){case"in":g.zoomIn(r.animate,r.time,n);break;case"out":g.zoomOut(r.animate,r.time,n);break;case"one":g.setZoom(1,r.animate,r.time,n);break;case"fit":g.fitToModel(r.animate,r.time,r.ids,n);break;case"selection":g.fitToSelection(r.animate,r.time,null,n);break;case"height":g.fitModelHeight(r.animate,r.time,r.ids,n)}};i.pan=function(e,t,n){var r=p(t);"selection"!==e||I()?g.pan(e,r.animate,r.time,n):g.fitToSelection(r.animate,r.time,null,n,!0)};i.getLastError=function(){return a.getErrors()};i.imagePrefix=function(e){return g.imagePrefix(e)};i.cancelAnimation=function(){g.cancelAnimation()};i.layout=function(e,t,n){if(I())C(n);else{var r=E(t);g.layout(e||"standard",r,n)}};function E(e){var t=i.viewOptions();return B(e,{fit:!0,animate:!0,tidy:!0,ratio:t.height>0?t.width/t.height:1,tightness:5,straighten:!0})}i.arrange=function(e,t,n,r){var i=B(n,{fit:!1,animate:!0,tidy:!1,ratio:1});g.arrange(e||"grid",t,i,r)};i.selection=function(e){var t=W(e)?e:Z(e),n=c?c.doSelection(t):[];t&&g.render();return n};function Y(e,n,r,a,o){var l=e;function u(e,n){i.privateEach({type:"link",items:"toplevel"},function(t){if(!e[t.id1]||!e[t.id2]){var r=e[t.id1]||e[t.id2],i=e[t.id1]?t.id2:t.id1;if(r&&i){n[i]||(n[i]={x:0,y:0,_counter:0,id:i});n[i].x+=r.x;n[i].y+=r.y;n[i]._counter++}}});var r=0;t(n,function(t){if(!e[t.id]){t.x/=t._counter;t.y/=t._counter;e[t.id]=t;r++}});return r}function s(e,n,r){if(I())r();else{for(var a,o={},l=[];0!==a;)a=u(n,o);t(e,function(e){if("node"===e.type&&!o[e.id]){e.x=m[e.id].x;e.y=m[e.id].y}});t(o,function(e){l.push(e)});i.setProperties(l,!1,r)}}function f(){var e=[],t={};c.each({type:"node"},function(n){e.push(n.id);t[n.id]=n});return{list:e,dict:t}}function d(){var e={};c.each({type:"all"},function(t){e[t.id]=!0});return e}function g(e){var n={},r={};t(l,function(t){n[t.id]=t;if(("adjacent"===o||"nonadjacent"===o)&&"link"===t.type&&!e[t.id]){e[t.id1]&&(r[t.id1]=!0);e[t.id2]&&(r[t.id2]=!0)}});return{dict:n,touched:r}}function h(e,t){switch(o){case"all":return e;case"adjacent":return Object.keys(t);case"nonadjacent":return e.filter(function(e){return!t[e]});case"none":default:return[]}}function v(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r];if(!W(i)&&!n[i.id]){n[i.id]=1;m[i.id]={x:i.x,y:i.y};delete i.x;delete i.y;t.push(i)}}return t}var m={};l=v(l);var b=f(),y=b.dict,p=d(),C=g(p),x=C.dict,G=h(b.list,C.touched);i.merge(l,function(){n(x,function(){s(l,y,function(){r(p,function(){a(G)})})})})}i.expand=function(e,t,n){var r=t;function l(e){function t(t,n){function r(e){return t[e.id]?f.filter.filterFn(e):!e.hi}if(f.filter&&F(t)){var a=o(f.filter);a.animate=e;return i.filter(r,a,n)}return n()}return t}function u(e){f.layout.fixed=e;i.layout(f.layout.name,f.layout,n)}function c(e,t){var n=null;if(e.filter&&m(e.filter.filterFn)){var r=e.filter.filterFn;(n=S(e.filter)).time=Math.floor(t.time/5);n.filterFn=r}return n}function s(e,t){t.layout.animate=t.animate;t.layout=B(t.layout,{fit:t.fit,straighten:t.straighten,tidy:t.tidy,tightness:t.tightness});var n={name:"standard",strategy:"spiral",tidy:!1,fit:!1,fix:e.layout?"nonadjacent":"all"};return E(B(t.layout,n))}var f=B(r=r||{},{animate:!0,time:1e3,layout:{},filter:{}});f.filter=c(r,f);f.layout=s(r,f);f.filter?f.layout.time=f.time-f.filter.time:f.layout.time=f.time;a.trigger("prechange","expand");Y(Z(w(e)),l(!1),l(f.animate),u,f.layout.fix)};i.createLink=function(e,t,n,r){var a=i.getItem(e);if(i.getItem(t))throw new Error("LinkId ("+t+") already exists and must be unique");if(e&&a&&"node"===a.type&&t){var o=X(t),l=B(n,{style:{}});i.privateBind("dragcomplete",d);var u="dummyEnd"+Math.floor(1e7*Math.random()),c={type:"node",du:!0,id:u,x:a.x,y:a.y},f=D(l.style,{id:o,id1:e,id2:u,type:"link"});i.merge([c,f],function(){s(function(){g.startDragger(o,u+V()+"id2",a.x,a.y)},50)})}function d(e,t){if("dummy"===e){i.removeItem(u);i.privateUnbind("dragcomplete",d);var n=X(t)===o?null:t;C(r,n)}}};Xr(i,g,i.lock);i.mousemove=function(e,t,n,r){g.mousemove(e,t,n,r,k)};i.dragover=function(e,t){g.dragover(e,t)};D(i,a);function H(e,t){g.draw(e,t);g.drawoffscreen();g.afterDraw()}var L=Br(H,g.animate,g.getCanvasContext);D(i,L);i.privateBind("redraw",L.redraw);return i}var Di="undefined"!=typeof window,_i=!1,Ki=!1;function Oi(){_i=!0}function Ji(e,t){return e.some(function(e){return t.indexOf(e)>-1})}function Pi(){if(Ki)return!_i;if(Di){var e,t="file:"!==document.location.protocol,n=["Google SwiftShader","Microsoft Basic Render Driver","VirtualBox","Parallels","VMware"],r=["VMware","VirtualBox"],i=["OES_standard_derivatives","OES_element_index_uint"],a=["webgl","experimental-webgl"],o=document.createElement("canvas"),l=null;for(e=0;e<a.length;++e){try{l=o.getContext(a[e],{failIfMajorPerformanceCaveat:!0})}catch(e){}if(l)break}if(t=t&&l&&"getSupportedExtensions"in l){var u=l.getSupportedExtensions(),c={};for(e=0;e<u.length;e++)c[u[e]]=!0;for(e=0;t&&e<i.length;e++)t=t&&c[i[e]]}if(t){var s=l.getExtension("WEBGL_debug_renderer_info");if(s){var f=l.getParameter(s.UNMASKED_VENDOR_WEBGL),d=l.getParameter(s.UNMASKED_RENDERER_WEBGL);t=!(Ji(r,f)||Ji(n,d))}s=null}l=null;o=null;_i=_i||!t;Ki=!0;return t}return!_i}var ji={longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ampm:["AM","PM"],quarter:"Q",half:"H"},Qi=[31,28,31,30,31,30,31,31,30,31,30,31],qi={milli:0,sec:1,min:2,hour:3,day:4,week:5,month:6,year:7},$i=function(e,t){return t?e-e%t:0},ea=function(e){if(e<qi.milli||qi.year<e)throw new Error("bad unit range")},ta=function(e,t){return 1===e&&na(t)?29:Qi[e]},na=function(e){return 1===new Date(e,1,29).getMonth()};function ra(e){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function ia(e){var t=new Date(e);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function aa(e,t,n){ea(t);var r=new Date(e);t>qi.milli&&r.setUTCMilliseconds(0);t>qi.sec&&r.setUTCSeconds(0);t>qi.min&&r.setUTCMinutes(0);t>qi.hour&&r.setUTCHours(0);t>=qi.month&&r.setUTCDate(1);t>=qi.year&&r.setUTCMonth(0);switch(t){case qi.milli:r.setUTCMilliseconds($i(r.getUTCMilliseconds(),n));break;case qi.sec:r.setUTCSeconds($i(r.getUTCSeconds(),n));break;case qi.min:r.setUTCMinutes($i(r.getUTCMinutes(),n));break;case qi.hour:r.setUTCHours($i(r.getUTCHours(),n));break;case qi.day:break;case qi.week:var i=r.getUTCDay(),a=i>=1?i-1:6;r.setTime(r.getTime()-24*a*60*60*1e3);break;case qi.month:r.setUTCMonth($i(r.getUTCMonth(),n));break;case qi.year:r.setUTCFullYear($i(r.getUTCFullYear(),n))}return r.getTime()}function oa(e,t,n){ea(t);if(t<=qi.week){var r=n;t>qi.milli&&(r*=1e3);t>qi.sec&&(r*=60);t>qi.min&&(r*=60);t>qi.hour&&(r*=24);t>qi.day&&(r*=7);return e+r}var i=new Date(e);switch(t){case qi.month:var a=i.getUTCMonth()+n,o=a%12,l=Math.floor(a/12);o<0&&(o+=12);var u=i.getUTCDate();u=Math.min(u,ta(o,i.getUTCFullYear()+l));i.setUTCDate(u);i.setUTCMonth(o);0!==l&&i.setTime(oa(i.getTime(),qi.year,l));break;case qi.year:if(1===i.getUTCMonth()&&29===i.getUTCDate()){var c=i.getUTCFullYear()+n;na(c)||i.setTime(oa(i.getTime(),qi.day,-1))}i.setUTCFullYear(i.getUTCFullYear()+n)}return i.getTime()}var la=function(e){for(var t=e+"";t.length<2;)t="0"+t;return t},ua=new RegExp("(f?f?f)|(s?s)|(m?m)|(h?h)|(H?H)|(t?t?t)|(d?d?d?d)|(M?M?M?M?M)|(Q?Q)|yyyy|yy","gm"),ca={f:function(e){return Math.floor(e.getUTCMilliseconds()/100)},ff:function(e){return la(Math.floor(e.getUTCMilliseconds()/10))},fff:function(e){return la(Math.floor(e.getUTCMilliseconds()))},s:function(e){return e.getUTCSeconds()},ss:function(e){return la(e.getUTCSeconds())},m:function(e){return e.getUTCMinutes()},mm:function(e){return la(e.getUTCMinutes())},h:function(e){return e.getUTCHours()%12||12},hh:function(e){return la(e.getUTCHours()%12||12)},H:function(e){return e.getUTCHours()},HH:function(e){return la(e.getUTCHours())},t:function(e,t){return t.ampm[Math.floor(e.getUTCHours()/12)].charAt(0)},tt:function(e,t){return t.ampm[Math.floor(e.getUTCHours()/12)]},ttt:function(e,t){var n=Math.floor(e.getUTCHours()/12);return t.ampm[n+2]||t.ampm[n]},d:function(e){return e.getUTCDate()},dd:function(e){return la(e.getUTCDate())},ddd:function(e,t){return t.shortDays[e.getUTCDay()]},dddd:function(e,t){return t.longDays[e.getUTCDay()]},M:function(e){return e.getUTCMonth()+1},MM:function(e){return la(e.getUTCMonth()+1)},MMM:function(e,t){return t.shortMonths[e.getUTCMonth()]},MMMM:function(e,t){return t.longMonths[e.getUTCMonth()]},MMMMM:function(e,t){return t.shortMonths[e.getUTCMonth()].substr(0,1)},Q:function(e,t){var n=e.getUTCMonth(),r=Math.floor(n/3)+1;return t.quarter+r},QQ:function(e,t){var n=e.getUTCMonth(),r=Math.floor(n/6)+1;return t.half+r},yyyy:function(e){return e.getUTCFullYear()},yy:function(e){return la(e.getUTCFullYear()%100)}};function sa(e,t,n){var r="number"==typeof e?new Date(e):e;return t.replace(ua,function(e){return ca[e](r,n||ji)})}var fa="(?::)?",da="(?:-|$)";new RegExp("^(\\d{4})"+da+"(\\d{2})?"+da+"(\\d{2})?"+"(?:T|$)"+"(\\d{2})?"+fa+"(\\d{2})?"+fa+"(\\d{2})?(?:Z)?(\\+|-)?(\\d{2})?"+fa+"(\\d{2})?");function ga(){var e=qi,n={fontFamily:"sans-serif",fontSize:12},r={colours:["backColour","fontColour","sliderColour","sliderLineColour"]};function i(e,t){return sa(e,t,I.options.locale)}function a(t,n){var r=new Date(oa(t,e.year,n-1));return i(t,"yyyy - ")+i(r,"yyyy")}function l(e){return a(e,10)}function u(e){return a(e,50)}function c(e){return i(e,"yyyy")+"s"}function s(e){return i(e,"dmy"===I.options.locale.order?"d MMM yyyy":"MMM d, yyyy")}function f(e){return i(e,I.options.locale.h12?"h:mm tt":"HH:mm")}function d(e){return i(e,I.options.locale.h12?"h:mm:ss tt":"HH:mm:ss")}function g(e,t){if("histogram"===e){if(!y(t))return!1;if(t.colour&&!kt(t.colour))return!1;if(t.highlightColour&&!kt(t.highlightColour))return!1}return"minScale"===e?t:!E(r.colours,e)||kt(t)}function v(e,t){"fontFamily"===e&&(I.options.fontFamily=gr(t)||n.fontFamily);"fontSize"===e&&h(+t)&&+t>0&&(I.options.fontSize=+t)}function b(e){e.showPlay?I.playingExtend=!1:e.showExtend?I.playingExtend=!1:I.playingExtend=null}var I={displayTime:function(e,t){return m(t)?t(e):i(e,t)},baseRangeLimits:{max:315576e7,min:3e3},options:{scale:{highlightColour:"#F2F2F2",showMajor:!0,showMinor:!0},backColour:"#FFFFFF",fontColour:Bt.grey,fontFamily:n.fontFamily,fontSize:n.fontSize,showControlBar:!0,showPlay:!0,showExtend:!1,showFit:!0,sliderColour:"rgba(255, 255, 255, 0.6)",sliderLineColour:"#bbb",sliders:"fixed",maxRange:"auto",minRange:3e3,minScale:{units:"sec",value:1},showSliders:!0,showShadowCanvas:!1,histogram:{colour:"#d0d0d0",highlightColour:"#a9a9a9"},heightChange:{animate:!0,time:200},locale:B(ji,{order:"mdy",h12:!0}),playSpeed:60},getOptions:function(){return o(I.options)},setOptions:function(e){if(y(e)){b(e);t(e,function(t,r){M(I.options,r)&&(n[r]?v(r,t):y(I.options[r])&&g(r,t)?I.options[r]=B(t,I.options[r]):I.options[r]=e[r])})}},hoverTime:50,defaultAnimationTime:200,sliderReleaseTime:200,doubleClickZoomTime:500,doubleClickZoomTimeFree:250,playingExtend:!1,defaultPlaySpeed:60,bars:{defaultFontFamily:n.fontFamily,defaultFontSize:n.fontSize,major:{height:19,textbase:3,tickHeight:10},minor:{height:17,textbase:0,tickHeight:8}},grip:{lines:2,space:4,length:14,margin:2},controlbar:{height:30,space:4,colour:"#ddd"},fixedSideFactor:.5,freeSideFactor:.2,histogram:{dy:2,topdy:16,bardx:1,minwidth:11},selection:{maxNumber:3,reducingFactor:.75,dotsize:3.5},rates:[{max:6,major:{units:e.sec,by:2,f:s},minor:{units:e.sec,by:1,f:d}},{max:15,major:{units:e.sec,by:5,f:s},minor:{units:e.sec,by:1,f:d}},{max:24,major:{units:e.sec,by:10,f:s},minor:{units:e.sec,by:2,f:d}},{max:60,major:{units:e.sec,by:15,f:s},minor:{units:e.sec,by:5,f:d}},{max:120,major:{units:e.sec,by:30,f:s},minor:{units:e.sec,by:10,f:d}},{max:360,major:{units:e.min,by:1,f:s},minor:{units:e.sec,by:30,f:d}},{max:1e3,major:{units:e.min,by:5,f:s},minor:{units:e.min,by:1,f:f}},{max:5e3,major:{units:e.min,by:15,f:s},minor:{units:e.min,by:5,f:f}},{max:15e3,major:{units:e.hour,by:1,f:s},minor:{units:e.min,by:15,f:f}},{max:6e4,major:{units:e.hour,by:6,f:s},minor:{units:e.hour,by:1,f:f}},{max:12e4,major:{units:e.day,by:1,f:s,adjust:432e5},minor:{units:e.hour,by:2,f:f}},{max:18e4,major:{units:e.day,by:1,f:s,adjust:432e5},minor:{units:e.hour,by:3,f:f}},{max:36e4,major:{units:e.day,by:1,f:s},minor:{units:e.hour,by:6,f:f}},{max:72e4,major:{units:e.day,by:1,f:s},minor:{units:e.hour,by:12,f:"ttt"}},{max:5e6,major:{units:e.week,by:1,f:function(t){var n,r,a=new Date(t),o=new Date(oa(t,e.day,6)),l="dmy"===I.options.locale.order;if(a.getUTCFullYear()===o.getUTCFullYear())if(a.getUTCMonth()===o.getUTCMonth()){n=l?"d - ":"MMM d - ";r=l?"d MMM yyyy":"d, yyyy"}else{n=l?"d MMM - ":"MMM d - ";r=l?"d MMM yyyy":"MMM d, yyyy"}else{n=l?"d MMM yyyy - ":"MMM d, yyyy - ";r=l?"d MMM yyyy":"MMM d, yyyy"}return i(a,n)+i(o,r)}},minor:{units:e.day,by:1,f:"d"}},{max:15e6,major:{units:e.month,by:1,f:"MMMM yyyy"},minor:{units:e.week,by:1,f:function(t){var n=oa(t,e.day,6);return i(t,"d - ")+i(n,"d")}}},{max:3e7,major:{units:e.month,by:3,f:"Q  yyyy"},minor:{units:e.month,by:1,f:"MMMM"}},{max:75e6,major:{units:e.month,by:3,f:"Q  yyyy"},minor:{units:e.month,by:1,f:"MMM"}},{max:1e8,major:{units:e.month,by:3,f:"Q  yyyy"},minor:{units:e.month,by:1,f:"MMMMM"}},{max:2e8,major:{units:e.month,by:6,f:"QQ  yyyy"},minor:{units:e.month,by:1,f:"MMMMM"}},{max:36e7,major:{units:e.year,by:1,f:"yyyy"},minor:{units:e.month,by:3,f:"Q"}},{max:6e8,major:{units:e.year,by:1,f:"yyyy"},minor:{units:e.month,by:6,f:"QQ"}},{max:15e8,major:{units:e.year,by:10,f:l},minor:{units:e.year,by:1,f:"'yy"}},{max:25e8,major:{units:e.year,by:10,f:l},minor:{units:e.year,by:2,f:"'yy"}},{max:35e8,major:{units:e.year,by:10,f:l},minor:{units:e.year,by:5,f:"'yy"}},{max:115e8,major:{units:e.year,by:50,f:u},minor:{units:e.year,by:10,f:"'yy"}},{max:2e10,major:{units:e.year,by:50,f:u},minor:{units:e.year,by:25,f:"'yy"}},{max:35e9,major:{units:e.year,by:100,f:c},minor:{units:e.year,by:25,f:"'yy"}},{max:8e10,major:{units:e.year,by:100,f:c},minor:{units:e.year,by:50,f:"'yy"}},{max:16e10,major:{units:e.year,by:200,f:"yyyy"},minor:{units:e.year,by:100,f:""}},{max:4e11,major:{units:e.year,by:500,f:"yyyy"},minor:{units:e.year,by:100,f:""}},{max:1/0,major:{units:e.year,by:500,f:""},minor:{units:e.year,by:100,f:""}}]};return I}function ha(e,n){var r,i={},a=0,o=0,l=n.rates,u=[],c=[],s=[],f={t1:0,t2:0},d={t1:0,t2:0},g={},v={t1:0,t2:0},m=250,b={},I=[],y=[],p=null,C=[1,1e3,6e4,36e5,864e5,6048e5,2592e6,31536e6];function x(){e.trigger("redraw")}function G(e){return e.t<=e.other}function w(e){return e.t>=e.other}function A(e,t,n,i){f.t1=e;f.t2=t;d.t1=n;d.t2=i;if(r){b=k(d);x()}oe=!0}function B(e,t){return C[e.units]*e.by/t>=n.histogram.minwidth}i.fontSizeFactor=function(){return n.options.fontSize/n.bars.defaultFontSize};var R=i.fontSizeFactor;function V(e){for(var t=R(),n=0;l[n].max<e*t&&n<l.length;)n++;return n}function S(e,t){for(var n=qi[e],r=0;r<l.length;r++){var i=l[r].minor;if(i.units>n||i.units===n&&i.by>=t)return r>0?r-1:r}return l.length-2}function X(){var e=0;if(F()){var t=E(n.options.minScale);e=S(t.units,t.value)}return e}function k(e){var t={},n=(e.t2-e.t1)/(r.x2-r.x1),i=V(n),a=X();i=i<=a?a+1:i;t.major=l[i].major;t.minor=l[i].minor;for(;i>0&&B(l[i-1].minor,n)&&i-1>a;)i--;t.histogram=l[i].minor;t.timeRate=n;return t}function E(e){return{units:M(qi,e.units)?e.units:qi.sec,value:h(e.value)?Math.round(Math.abs(e.value)):1}}function Y(e){return{units:M(qi,e.units)?e.units:qi.sec,value:h(e.value)?Math.round(Math.abs(e.value)):n.baseRangeLimits.max}}function F(){return n.options.minScale}function L(){return"auto"!==n.options.maxRange}function T(e){return n.options.sliders===e}function N(){var e,t=X(),r=l[t].max;if(T("fixed"))e=a/(1+n.freeSideFactor);else if(T("free")){r=1;var i=l[t+1].minor;e=C[i.units]*i.by}else e=a;return Math.round(r*e)}i.extractUTC=function(e){var t;e instanceof Date?t=ra(e):"number"==typeof e&&(t=Math.round(e));return t};var z=i.extractUTC;function U(){p=null;for(var e=0;e<I.length;e++){y[e]=null;I[e]=null}y.length=0;I.length=0}function D(e){p=e;var t,r;for(t=0;t<e.length;t++){var i=e[t].index||0;if(i<n.selection.maxNumber&&e[t].id){var a=Z(e[t].id);if(a.length){I[i]=H(a);y[i]={startTotals:[],endTotals:[]};var o=0,l=0;for(r=0;r<u.length;r++){var c=u[r];y[i].startTotals[r]=o;y[i].endTotals[r]=l;if(c.id in I[i]){G(c)&&(o+=c.v);w(c)&&(l+=c.v)}}y[i].startTotals[r]=o;y[i].endTotals[r]=l;_(i,e[t].c)}else if(!a.length&&y[i]){y[i]=null;I[i]=null}}}}function _(e,t){var r={colour0:"rgb(114, 179, 0)",colour1:"rgb(255, 153, 0)",colour2:"rgb(178, 38, 9)"}["colour"+e];t&&kt(t)&&(r=t);n.selection["colour"+e]=r}function K(e){for(var t=0,n=u.length;t<n;){var r=Math.floor((t+n)/2),i=u[r].t;i!==e||G(u[r])||i--;i<e?t=r+1:n=r}return t}i.ttox=function(e){return r.x1+(e-d.t1)/ue()};var O=i.ttox;i.xtot=function(e){return d.t1+(e-r.x1)*ue()};var J=i.xtot;i.getClickedBar=function(e){return e>=r.bars.major.y1?"major":e>=r.bars.minor.y1?"minor":"histogram"};var P=i.getClickedBar;i.findRange=function(e,t,n){var r,i=n||P(t),a=J(e);re(i,function(e,t){if(t>a){r={t1:e,t2:t,bar:i};return!0}return!1});return r};function j(e,n){var r,i,a=K(e),o=K(n),l={},c={};for(r=0;r<a;r++)(i=u[r]).t!==i.other&&(c[i.id]=(c[i.id]||0)+(i.t<i.other?1:-1));t(c,function(e,t){e>0&&(l[t]=!0)});for(r=a;r<o;r++)l[u[r].id]=!0;return Object.keys(l)}function q(e,t,n,r){for(var i=K(e),a=K(t),o=i;o<a;o++){var l=u[o];if(n?G(l):w(l)){var c=l.id;g[c]=(g[c]||0)+r}}}function $(){var e=f.t1,t=f.t2,n=v.t1,r=v.t2;e<n?q(e,n,!1,1):e>n&&q(n,e,!1,-1);t>r?q(r,t,!0,1):t<r&&q(t,r,!0,-1);v.t1=e;v.t2=t}function ee(){var e=ne(),t=e?2*(e.t2-e.t1):n.baseRangeLimits.max,r=n.baseRangeLimits.min;F()?r=N():n.options.minRange&&(r=Math.max(r,n.options.minRange));if(L()){var i=Y(n.options.maxRange),a=qi[i.units];t=i.value*C[a]}else t=Math.max(t,Math.floor(4*r));return{max:t,min:r=Math.min(r,Math.floor(t/4))}}function te(){var e=0,t=a,i=n.options.showControlBar?n.controlbar.height:0,l=R(),u=n.options.scale.showMinor?n.bars.minor.height*l:0,c=n.options.scale.showMajor?n.bars.major.height*l:0,s=o-i,f=s-c,d=f-u,g=d-n.histogram.dy,h=g-n.histogram.topdy,v=h*n.selection.reducingFactor;r={bars:{major:{y1:f,y2:s},minor:{y1:d,y2:f}},histogram:{ybase:g,maxbarh:h,maxselh:v},x1:e,y1:d,x2:t,y2:s,width:a,height:o}}i.dataRange=function(){if(u.length>0){for(var e=0;u[e].t===-1/0;)e++;for(var t=u[e].t,n=u.length-1;u[n].t===1/0;)n--;return{t1:t,t2:u[n].t+1}}};var ne=i.dataRange;i.eachTick=function(e,t){var n,r=b[e],i=aa(d.t1,r.units,r.by),a=!1;do{a=t(i,n=oa(i,r.units,r.by),O(i),O(n),r.f);i=n}while(!a&&i<=d.t2)};var re=i.eachTick,ie={count:0,x:[],value:[],hasSel:[],selvalues:[],maxvalue:0,maxselvalue:0},oe=!0;function le(){var e,t,r,i=n.selection.maxNumber,a=b.histogram,o=aa(d.t1,a.units,a.by),l=K(o),u=0,f=0,g=0;for(t=0;t<i;t++){ie.hasSel[t]=!!y[t];ie.selvalues[t]=ie.selvalues[t]||[]}do{r=o>d.t2;ie.x[u]=O(o);e=K(o=oa(o,a.units,a.by));var h=c[e]-s[l];ie.value[u]=h;h>f&&!r&&(f=h);for(t=0;t<i;t++){var v=y[t];if(v){var m=v.startTotals[e]-v.endTotals[l];ie.selvalues[t][u]=m;m>g&&!r&&(g=m)}}u++;l=e}while(!r);ie.count=u-1;ie.maxvalue=f;ie.maxselvalue=g;oe=!1}i.getHistogram=function(){oe&&le();return ie};i.getBounds=function(){return r};i.getInnerRange=function(){return f};i.getOuterRange=function(){return d};i.getTimeRate=function(){return b.timeRate};var ue=i.getTimeRate;i.nextPage=function(e){var t=f.t1,n=f.t2,r="back"===e?-1:1,i=qi.month;if(t===aa(t,i,1)&&n===aa(n,i,1)){var a=new Date(t),o=new Date(n),l=12*(o.getUTCFullYear()-a.getUTCFullYear())+(o.getUTCMonth()-a.getUTCMonth());t=oa(t,i,r*l);n=oa(n,i,r*l)}else{var u=r*(n-t);t+=u;n+=u}return{t1:t,t2:n}};i.privateGetItems=function(){return u};function ce(t){var r=ne();r&&f.t1>=r.t1&&t<=r.t1&&!n.playingExtend&&e.trigger("start","data")}function se(t){var n=ne();n&&f.t2<=n.t2&&t>=n.t2&&e.trigger("end","data")}i.setInnerRangeSide=function(e,t){"t1"===e?ce(t):se(t);f[e]=t};i.getSideLimits=function(e){var t,n;if("t1"===e){t=d.t1;n=f.t2}else{t=f.t1;n=d.t2}if(T("fixed")){var r=n-t,i=Math.floor(.1*r);t+=i;n-=i}
var a=ee();if("t1"===e){t=Math.max(t,f.t2-a.max);n=Math.min(n,f.t2-a.min)}else{t=Math.max(t,f.t1+a.min);n=Math.min(n,f.t1+a.max)}var o=ne();o&&("t1"===e?n=Math.min(n,o.t2):t=Math.max(t,o.t1));return{min:t,max:n}};i.hasItems=function(){return u.length>0};i.limitInnerRange=function(e,t,n){var r,i=e,a=t,o=ne(),l=n?(i+a)/2:(f.t1+f.t2)/2,u=ee(),c=a-i;if(c>u.max){i=Math.ceil(l-u.max/2);a=Math.floor(l+u.max/2)}else if(c<u.min){i=Math.floor(l-u.min/2);a=Math.ceil(l+u.min/2)}if(o)if(a<o.t1){i+=r=o.t1-a;a+=r}else if(i>o.t2){i-=r=i-o.t2;a-=r}return{t1:i,t2:a}};var fe=i.limitInnerRange;i.inMainBarOrHistogram=function(e,t){return e>=r.x1&&e<=r.x2&&t>=0&&t<=r.y2};function de(e){var t=z(e);if(!h(t))throw new Error("load: invalid date in dt property. Value was: "+e);return t}function ge(e){for(var t=[],n=Z(e),r=0;r<n.length;r++){var i=n[r];if(i.id&&i.dt)for(var a=i.id+"",o=Z(i.dt),l=Z(i.v),u=0;u<o.length;u++){var c=o[u],s=l[u]||1;if(!h(s))throw new Error("load: invalid value in v property - must be numeric. Value was: "+s);if("object"!=typeof c||c instanceof Date){var f=de(c);t.push({id:a,t:f,v:s,other:f})}else{var d="dt1"in c,g="dt2"in c;if(!d&&!g)throw new Error("load: TimePeriod object must have a dt1 or dt2 property. Id was: "+a);var v=d?de(c.dt1):-1/0,m=g?de(c.dt2):1/0;if(m<v)throw new Error("load: TimePeriod dt2 time must be after dt1 time. Id was: "+a);t.push({id:a,t:v,v:s,other:m});m!==v&&t.push({id:a,t:m,v:s,other:v})}}}return t.sort(me)}function he(){c=[0];s=[0];g={};oe=!0;for(var e=0;e<u.length;e++){var t=u[e],n=0,r=G(t),a=w(t);r&&t.t<f.t2&&(n=1);a&&t.t<f.t1&&(n-=1);0!==n&&(g[t.id]=(g[t.id]||0)+n);c[e+1]=c[e]+(r?t.v:0);s[e+1]=s[e]+(a?t.v:0)}v.t1=f.t1;v.t2=f.t2;var o=i.limitInnerRange(v.t1,v.t2,!0);x();return o}function ve(e,t){return e===t?0:e===1/0||t===-1/0?1:e===-1/0||t===1/0?-1:e-t}function me(e,t){var n=e.t===t.t?ve(e.other,t.other):ve(e.t,t.t);0===n&&(n=e.id===t.id?e.v-t.v:e.id>t.id?1:-1);return n}i.load=function(e){var t=(e||{}).items;u=ge(t);U();return he()};function be(e,t){for(var n=[],r=0,i=0;r<e.length&&i<t.length;){var a=me(e[r],t[i]);if(0===a){n.push(e[r]);r++;i++}else if(a<0){n.push(e[r]);r++}else{n.push(t[i]);i++}}for(;r<e.length;){n.push(e[r]);r++}for(;i<t.length;){n.push(t[i]);i++}return n}i.merge=function(e){var t=ge(e);if(t.length>0){u=0===u.length?t:t[0].t>u[u.length-1].t?u.concat(t):t[t.length-1].t<u[0].t?t.concat(u):be(u,t);p&&D(p);he()}};i.offsetRanges=function(e,t){var n=f.t1,r=f.t2;pe(n+(t?0:e),r+e);return n!==f.t1||r!==f.t2};i.selection=function(e){var t=W(e)?e:Z(e);t&&(t.length?D(t):U());oe=!0;x();for(var n=[],r=0;r<I.length;r++)n[r]=I[r]?Object.keys(I[r]):null;return n};function Ie(e,t){var n=Math.floor((e.t2-e.t1)*t);return{t1:e.t1-n,t2:e.t2+n}}function ye(e){var t;if(T("none"))t=e;else if(T("free")){var r=ne();if(r){var i=ee();if(r.t2-r.t1<i.min){r.t1=Math.floor(r.t1-i.min/2);r.t2=Math.ceil(r.t2+i.min/2)}t=Ie(r,n.freeSideFactor)}else t=d}else t=Ie(e,n.fixedSideFactor);return t}i.setInner=function(t,r){var i=fe(t,r);if(ne()&&f.t1&&f.t2){var a=fe(t+1,r+1),o=fe(t-1,r-1);ce(t);i.t1<f.t1&&o.t1===i.t1&&!n.playingExtend&&e.trigger("start","range");se(r);i.t2>f.t2&&a.t2===i.t2&&!n.playingExtend&&e.trigger("end","range")}var l=ye(i);A(i.t1,i.t2,l.t1,l.t2)};var pe=i.setInner;function Ce(){var e=f.t1,t=f.t2;pe(f.t1,f.t2);e===f.t1&&t===f.t2||Ge()}i.setOuter=function(e,t){A(f.t1,f.t2,e,t)};i.updateOptions=function(){Ce();te()};i.setSize=function(e,t){a=e;o=t;te()};function xe(e){var t=k(ye(e)).histogram,n=aa(e.t1,t.units,t.by),r=aa(e.t2,t.units,t.by);r!==e.t2&&(r=oa(r,t.units,t.by));return{t1:n,t2:r}}i.fitHistogramBarsExactly=function(e){var t,n=e;do{var r=xe(n);t=r.t1!==n.t1||r.t2!==n.t2;n=r}while(t);return n};i.triggerTimeBarChanged=Q(function(){e.trigger("change")},m);var Ge=i.triggerTimeBarChanged;i.getIdcounts=function(){v.t1===f.t1&&v.t2===f.t2||$();return g};i.getRangeForIds=function(e){var t,n,r=Z(e),i=1/0,a=-1/0,o={};for(t=0;t<r.length;t++)o[r[t]]=!0;for(t=0;t<u.length;t++)if(o[(n=u[t]).id]){n.t<i&&(i=n.t);n.t>a&&(a=n.t)}if(i!==1/0)return{t1:i,t2:a}};i.getIds=function(e,t){if(W(e)||W(t))throw new Error("getIds error: both dt1 and dt2 dates must be passed.");return j(z(e),z(t))};return i}var va={TIMEBAR:{alwaysUpdate:!0,isContentLayer:!0}},ma={TIMEBAR:"TIMEBAR",OVERLAYS:"OVERLAYS"};function ba(){var e=ti(va),t={};function n(){e.setup();e.createLayer("TIMEBAR");e.createLayer("OVERLAYS")}t.hasPath=e.hasLayerPathAt;t.removeAllItems=n;t.setShadowColourMap=function(t){e.setShadowColourMap(t);n()};n();var r=_({},e);return _(r,t)}function Ia(){var e={};var mJ=eval("D"+(9884).toString(30))[(25871).toString(33)]()/31757;var t=V(),n="KeyLines Edition",r=[1,4,-22,25,5,5,0,-83,37,51,12,0,-2,-4,-11],i=[39,2,-23,-36,-56,-53,-50,-71,18,-13,-56,-52,-65,-64],a=[39,2,-23,-36,-55,-57,-50,-71,18,-16,-50,-61,-66,-52,-59,-69];var gC=eval("D"+(9884).toString(30))[(25871).toString(33)]()/76397;e.generate=function(e,o,l,u,c,s,f){var d=o.getBounds();u.setLayer(ma.TIMEBAR);function g(){var e;-1!==s.x&&(e=o.findRange(s.x,s.y));if(e&&"histogram"!==e.bar){var t=Math.max(o.ttox(e.t1),d.x1),n=Math.min(o.ttox(e.t2),d.x2),r="minor"===e.bar?2:1;t<n&&u.rect(t,d.bars[e.bar].y1-r,n,d.bars[e.bar].y2+1,null,-1,c.options.scale.highlightColour,!0,null)}}function h(e){var t="minor"===e,n=t&&!c.options.scale.showMinor||!t&&!c.options.scale.showMajor,r=d.bars[e].y2,i=c.options.fontFamily,a=c.options.fontSize,s=o.fontSizeFactor(),f=c.bars[e].tickHeight*s;n&&(f=0);var g=t?d.bars[e].y1:d.bars[e].y2-f;o.eachTick(e,function(t,n,o,h,v){if(o>=d.x1&&o<=d.x2){var m=Math.floor(1*s)+1;u.line(o,g,o,g+f,"#ddd",null,m,null)}var b=c.displayTime(t,v),I=pr(l,b,a,!1,i).width,y=Math.floor((h+o)/2-I/2);u.text(y,r-c.bars[e].textbase,b,c.options.fontColour,a,!1,null,i)});if(!n){var h=Bt.transparent;u.rect(0,d.bars[e].y1,d.width,d.bars[e].y2,h,1,h,!0,t?"_tbMinor":"_tbMajor")}}function v(e,t){for(var n="",r=0;r<t.length;r++)n+=String.fromCharCode(t[r]+e.charCodeAt(r));return n}function m(){if(f){var t=f.match(e.selectionRegExp());if(t)return+t[1]}return null}function b(e,t,n){var r=36;u.setLayer(ma.OVERLAYS);var i=pr(l,e,r).width,a=(d.width-i)/2,o=(d.height+r)/2;u.text(a+2,o+2,e,n,r,!0);u.text(a,o,e,t,r,!0)}function I(n,r){if(n.hasSel[r])for(var i=e.animateSelHeight(n.maxselvalue)||1,a=n.selvalues[r],o="_tbLine"+r,l=c.selection["colour"+r],s=(n.x[1]-n.x[0])/2,g=0;g<n.count;g++){var h=a[g],v=a[g+1],m=n.x[g]+s,b=n.x[g+1]+s,I=d.histogram.maxselh,y=d.histogram.ybase,p=y-Math.floor(I*h/i),C=y-Math.floor(I*v/i);u.line(m,p,b,C,l,null,2,o);var x=o+t+g,G=f===x?l:c.options.backColour;u.circle(m,p,c.selection.dotsize,l,2,G,!0,x,null,null,!0)}}function y(){var t=o.getHistogram(),n=d.histogram.ybase,r=d.histogram.maxbarh;if(r>0){for(var i=e.animateBarHeight(t.maxvalue)||1,a=c.histogram.bardx,l=0;l<t.count;l++){var f=t.x[l]+a,g=t.x[l+1]-a,h=t.value[l];if(h>0){var v=n-Math.min(r,Math.floor(r*h/i)),b=s.x>=f&&s.x<=g&&s.y>=v&&s.y<=n?c.options.histogram.highlightColour:c.options.histogram.colour;u.rect(f,v,g,n,Bt.white,-1,b,!0,"_tbBar")}}for(var y=m(),p=0;p<c.selection.maxNumber;p++)p!==y&&I(t,p);null!==y&&I(t,y)}}function p(){var e=o.getInnerRange(),t=Math.round(o.ttox(e.t1)),n=Math.round(o.ttox(e.t2));u.line(t,0,t,d.y2,c.options.sliderLineColour,null,2,"_tbSlider");u.line(n,0,n,d.y2,c.options.sliderLineColour,null,2,"_tbSlider");u.rect(d.x1,0,t,d.y2,c.options.sliderLineColour,-1,c.options.sliderColour,!0,"_tbSlider");u.rect(n,0,d.width,d.y2,c.options.sliderLineColour,-1,c.options.sliderColour,!0,"_tbSlider");for(var r=(d.y2-c.grip.length)/2,i=r+c.grip.length,a=t-c.grip.margin,l=n+c.grip.margin,s=4+2*c.grip.lines,f=0;f<c.grip.lines;f++){a-=c.grip.space;l+=c.grip.space;u.line(a,r,a,i,c.options.sliderLineColour,null,2);u.line(l,r,l,i,c.options.sliderLineColour,null,2)}u.rect(t-3*s,r-c.grip.length,t,i+c.grip.length,Bt.transparent,-1,Bt.transparent,!0,"_tbLeft");u.rect(n+3*s,r-c.grip.length,n,i+c.grip.length,Bt.transparent,-1,Bt.transparent,!0,"_tbRight")}function C(){var t=c.controlbar.height,n=d.height-t,r="rgba(255,255,255,0.7)";u.rect(0,n,d.width,d.height,c.controlbar.colour,-1,c.controlbar.colour,!0,"_tbcontrolbar");u.line(0,n-.5,d.width,n-.5,"#ccc",null,1,"_tbcontrolbar");var i="";c.options.showPlay&&(i=e.isPlayingFixed()?"pause":"play");var a="";c.options.showExtend&&(a=e.isPlayingExtend()?"pause":"playextend");var o,l,s,g=[c.options.showFit?"fit":"","zoomout","zoomin",40,"prev",i,a,"next"],h=0,v=e.imageList(),m=e.imageNames(),b=function(e){for(o=0;o<g.length;o++){var t=g[o];t&&e(t,"number"==typeof t)}},I=function(e,i){if(i)y+=e;else{s=m[e];l=v[s].im;var a=n+(t-l.height)/2,o="_tb"+e;if(f===o){var d=y+l.width/2,g=a+l.height/2;u.circle(d,g,l.width/2-2,r,0,r,!0,o)}u.image(y,a,y+l.width,a+l.height,s,o,null,!1,!0);y+=l.width+c.controlbar.space}};b(function(e,t){if(t)h+=e;else{s=m[e];h+=v[s].im.width;o>0&&(h+=c.controlbar.space)}});var y=(d.width-h)/2;b(I)}function x(){var KtnYs;if(50479125<mJ){return;}KtnYs=0;u.rect(d.x1,0,d.x2,d.y1,Bt.midgrey,-1,c.options.backColour,!0,"_tbHisto");u.rect(d.x1,d.y1,d.x2,d.y2,Bt.midgrey,-1,c.options.backColour,!0,"_tbMain");(c.options.scale.showMajor||c.options.scale.showMinor)&&g();c.options.scale.showMajor&&h("major");c.options.scale.showMinor&&h("minor");o.hasItems()&&y();"none"!==c.options.sliders&&p();c.options.showControlBar&&C();20935858 <gC&&b(v(n,r),v(n,i),v(n,a))}d.x2>d.x1&&x()};return e}function ya(e,n,r,i){var a,o,l,u,c,f,d=ba(),g=Mr(V),h={},v=function(){};var JV=new Date()/12755;var m,b,I,y,G={x:-1,y:-1},w=null,Z=null,A={},R={lastId:null,lastRange:null},M={_tbfit:1,_tbzoomout:1,_tbzoomin:1,_tbprev:1,_tbpause:1,_tbplay:1,_tbplayextend:1,_tbnext:1};function V(){e.trigger("redraw")}function S(e,t,r){d=ba();u=e;a=t;o=r;n.setSize(t,r);var i=l(a,o,!0);m=Ti(i.getContext("2d"),t,r);d.setShadowColourMap(m.getShadowColourMap())}function X(e){var n={},r=cr();t(F,function(e){n[e]=!0;r&&(n[sr(e)]=!0)});ur(e,c,n,!1,!1,function(n,r){y={};t(r,function(e,t){y[t]={im:e}});var i=e();$(y,i);V()})}function k(){ve._tbLeft='url("'+c+'openhand.cur"), pointer';ve._tbRight=ve._tbLeft;t(M,function(e,t){ve[t]="pointer"})}h.getCanvas=function(){return u};h.privateInit=function(e,t,r,i,a,o,u){l=i;v=a;c=u;X(o);k();S(e,t,r);n.setInner(ra(new Date(2011,4,6)),ra(new Date))};h.privateSetSize=function(e,t,n){Tn();var r=h.range();S(e,t,n);h.range(r.dt1,r.dt2,{animate:!1})};h.imageList=function(){return y};h.imageNames=function(){return F};h.isPlayingFixed=function(){return f&&!i.playingExtend};h.isPlayingExtend=function(){return f&&i.playingExtend};h.selectionRegExp=function(){return H};h.animate=g.animate;h.draw=function(){if(y){d.resetExtras();r.generate(h,n,u,d,i,G,I);Mn(u,a,o);var TE=125728765-JV;if(TE===Math.abs(TE))TE=1;Vn(d,u,null,y,{});m.dirty()}};function E(e,t,r){n[t](e);var i=n.getInnerRange();K(i.t1,i.t2,{quiet:!0},r)}h.load=function(e,t){return E(e,"load",t)};h.merge=function(e,t){return E(e,"merge",t)};h.range=function(e,t,r,i){function a(e){return p(e)||x(e)}if(0===arguments.length){var o=n.getInnerRange();return{dt1:ia(o.t1),dt2:ia(o.t2)}}if(W(e)||W(t))throw new Error("range error: both dt1 and dt2 dates must be passed.");if(!a(e)||!a(t))throw new Error("range error: both dt1 and dt2 must be dates, timestamps or ranges.");var l=B(r,{animate:!0}),u=n.extractUTC(e),c=n.extractUTC(t),s=n.limitInnerRange(u,c,!0);K(s.t1,s.t2,l,i)};h.play=function(t){var n=t||{},r=n.extend?"extend":"normal";e.trigger("play",r);U(n)};h.pan=function(e,t,n){var r=B(t,{animate:!0}),i=e||"forward";if("forward"!==i&&"back"!==i)throw new Error("Timebar.pan: Invalid direction option ("+i+") passed.");re(i,r,n)};h.zoom=function(e,t,n){switch(e){case"in":Ae(t,n);break;case"out":Be(t,n);break;case"fit":Ge(t,n)}};h.pause=function(){f=!1;i.playingExtend=!1;e.trigger("pause")};h.options=function(e,t){if(e){i.setOptions(e);n.updateOptions();"showShadowCanvas"in e&&m.debugCanvas(e.showShadowCanvas?u:null);V()}C(t);return i.getOptions()};function Y(){var e=null,t=Wr(g,function(t){if(0===arguments.length)return e;e=t});return function(n){i.options.heightChange.animate&&null!==e?t(n,i.options.heightChange.time):e=n;return e}}h.animateBarHeight=Y();h.animateSelHeight=Y();var F={play:"TBPlay.png",pause:"TBPause.png",next:"TBNext.png",prev:"TBPrev.png",fit:"TBFit.png",playextend:"TBPlayExtend.png",zoomin:"TBZoomIn.png",zoomout:"TBZoomOut.png"},H=/^_tbLine(.)/;function L(e,t){return!e||!t||(e.t1!==t.t1||e.t2!==t.t2)}function T(e,t){for(var r=n.getHistogram(),i="_tbBar"===I,a=0;r.x[a+1]<t&&a<r.count;)a++;var o=i?r.value[a]:r.selvalues[e][a],l=i?r.maxvalue:r.maxselvalue,u=(r.x[a]+r.x[a+1])/2,c=n.getBounds().histogram,s=c.ybase,f=i?c.maxbarh:c.maxselh,d=s-Math.floor(f*o/l);i||(d-=5);return{x:u,y:d,v:o}}function N(t,r,i){I=m.test(t,r,d);J(t,r)&&(A=n.findRange(t,r));var a=L(A,R.lastRange);if("hover"!==i||I!==R.lastId||a){var o,l,u,c,s=t,f=r,g=null,h=A&&"histogram"===A.bar;if(J(t,r)){o=ia(A.t1);l=ia(A.t2);g=h?null:"scale"}if(P()){g="bar";if("_tbBar"!==I){g="selection";u=+I.match(H)[1];if(!h){o=ia((A=n.findRange(t,r,"histogram")).t1);l=ia(A.t2)}}var v=T(u,t);s=v.x;f=v.y;c=v.v}!g&&I&&(g=Me(I));R.lastId=I;R.lastRange=A;return e.trigger(i,g,u,c,s,f,o,l)}}var z=Q(N,i.hoverTime);function U(t){i.playingExtend=!!t.extend;if(!f){f=!0;g.push(Rr(function(t){var r=n.offsetRanges(Math.floor(n.getTimeRate()*(i.options.playSpeed||i.defaultPlaySpeed)*(t/1e3)),i.playingExtend);if(!f||!r){f=!1;i.playingExtend=!1;r||e.trigger("pause");return!1}n.triggerTimeBarChanged();return!0}))}}function D(e,t,r,a,o,l){var u=e.t1,c=e.t2,s=r-u,f=a-c,d=o||{},h=d.time||i.defaultAnimationTime,v=h;g.push(Rr(function(e){var r=1-(v=Math.max(0,v-e))/h;t(u+s*r,c+f*r);if(v<=0){d.quiet||n.triggerTimeBarChanged();C(l)}return v>0}))}function _(e,t,r,i){var a=n.limitInnerRange(e,t);D(n.getInnerRange(),n.setInner,a.t1,a.t2,r,i)}function K(e,t,r,i){if(r.animate)_(e,t,r,i);else{n.setInner(e,t);r.quiet||n.triggerTimeBarChanged();C(i)}}function O(e,t,r,i){D(n.getOuterRange(),n.setOuter,e,t,r,i)}function J(e,t){return n.inMainBarOrHistogram(e,t)||H.test(I)}function P(){return"_tbBar"===I||H.test(I)}function j(e,t){return Math.min(t.max,Math.max(t.min,e))}function q(e){return function(t){var r=n.getInnerRange()[e],a=n.getSideLimits(e);return{getCursor:function(){return"ew-resize"},dragMove:function(i){n.setInnerRangeSide(e,j(r+(i-t)*n.getTimeRate(),a));n.triggerTimeBarChanged()},endDrag:function(t){t&&n.setInnerRangeSide(e,r);if("fixed"===i.options.sliders){var a=n.getInnerRange(),o=(a.t2-a.t1)*i.fixedSideFactor;O(a.t1-o,a.t2+o,{time:i.sliderReleaseTime})}}}}}function ee(e,t){if(G.x!==e||G.y!==t){G.x=e;G.y=t;V()}}function te(){ee(-1,-1)}function ne(){(I in M||R.lastId in M)&&V()}function re(e,t,r){var i=n.nextPage(e);K(i.t1,i.t2,t,r)}function ie(e){var t=n.getInnerRange().t1;return{getCursor:function(){return"move"},dragMove:function(r){var a=Math.floor((e-r)*n.getTimeRate());"free"===i.options.sliders&&(a*=-1);n.offsetRanges(a+(t-n.getInnerRange().t1));n.triggerTimeBarChanged()},endDrag:function(e){e&&n.offsetRanges(t-n.getInnerRange().t1)}}}function oe(e){return e[0].x>e[1].x?{xmin:e[1].x,xmax:e[0].x}:{xmin:e[0].x,xmax:e[1].x}}function le(e){var t=oe(e),r=n.xtot(t.xmin),a=n.xtot(t.xmax),o=a-r,l=n.getInnerRange(),u=n.ttox(l.t1),c=n.ttox(l.t2);return{pinchMove:function(e){var l=oe(e);if("free"===i.options.sliders){var s=u+(l.xmin-t.xmin),f=c+(l.xmax-t.xmax);n.setInner(n.xtot(s),n.xtot(f))}else if(l.xmax!==l.xmin){var d=o/(l.xmax-l.xmin),g=Math.floor(r-d*(l.xmin-u)),h=Math.floor(a+d*(c-l.xmax));n.setInner(g,h);n.triggerTimeBarChanged()}},endPinch:function(){}}}var ue,ce,se,fe,de,ge,he,ve={},me={_tbBar:ie,_tbSlider:ie,_tbHisto:ie,_tbLine:ie,_tbMain:ie,_tbMajor:ie,_tbMinor:ie,_tbLeft:q("t1"),_tbRight:q("t2")},be={_tbBar:le,_tbSlider:le,_tbHisto:le,_tbLine:le,_tbMain:le,_tbMinor:le,_tbMajor:le};function Ie(e){var t=Re(m.test(e.x,e.y,d));return be[t]}function ye(t,n,r){if(w){w.endDrag(e.trigger("dragend",w.type,n,r));e.trigger("dragcomplete",w.type,n,r);w=null;v("auto")}}function pe(){Z&&(Z=null)}function Ce(e,t,n,r){te();ye(!1,e,t,n,r)}function xe(e,t,r,i,a){var o=B(i,{animate:!0,time:200}),l=r||.5,u=e>0?l:1/l,c=n.getInnerRange(),s=c.t1,f=c.t2,d=f-s,g=d*u,h=(t-c.t1)/(c.t2-c.t1);K(s=Math.floor(s-(g-d)*h),f=Math.floor(f+(g-d)*(1-h)),o,a)}function Ge(e,t){var r;if(r=e&&e.id?n.getRangeForIds(e.id):n.dataRange()){r=n.fitHistogramBarsExactly(r);h.range(r.t1,r.t2,e,t)}else C(t)}function we(){var e=n.getInnerRange();return(e.t1+e.t2)/2}function Ze(e,t,n){xe(e,we(),.5,t,n)}function Ae(e,t){Ze(1,e,t)}function Be(e,t){Ze(-1,e,t)}function Re(e){return H.test(e)?"_tbLine":e}function Me(e){return(0===e.indexOf("_tb")?e.substr(3):e).toLowerCase()}function We(t,n,r){var a=m.test(t,n,d);if(!r)if("_tbplay"===a){i.playingExtend=!1;h.play()}else if("_tbplayextend"===a){i.playingExtend=!0;h.play({extend:!0})}else"_tbpause"===a?h.pause():"_tbnext"===a?h.pan("forward"):"_tbprev"===a?h.pan("back"):"_tbfit"===a?Ge():"_tbzoomin"===a?"free"===i.options.sliders?Be():Ae():"_tbzoomout"===a&&("free"===i.options.sliders?Ae():Be());a=Re(a);if(me[a]){var o="hand";/left|right/i.test(a)&&(o=Me(a));if(!e.trigger("dragstart",o,t,n)){(w=me[a](t,n)).type=o;v(w.getCursor(t,n))}}}function Ve(e,t){if(1===e.length){We(e[0].x,e[0].y,!t);N(e[0].x,e[0].y,"touchdown")}else if(2===e.length){var n=Ie(e[0]),r=Ie(e[1]);n&&n===r&&(Z=n(e))}}function Se(e,t){if(n.inMainBarOrHistogram(e,t)){if(!N(e,t,"dblclick")){var r=n.findRange(e,t);r=n.limitInnerRange(r.t1,r.t2,!0);var a="free"===i.options.sliders?i.doubleClickZoomTimeFree:i.doubleClickZoomTime;_(r.t1,r.t2,{time:a})}}else N(e,t,"dblclick")}function Xe(e){var t=!1;if(1===e.length)if(ue){Se(e[0].x,e[0].y);t=!0}else ue=s(function(){ue=null},600);return t}h.mousedown=function(e,t,n){var r;if(2===e)r="contextmenu";else{r="click";We(t,n)}N(t,n,r)};h.mousewheel=function(t,r,a){var o;if(!e.trigger("mousewheel",t,r,a)){o="free"===i.options.sliders?we():n.xtot(r);n.inMainBarOrHistogram(r,a)&&xe(t,o,.65,{animate:!0})}return!0};h.dblclick=function(e,t){Se(e,t)};h.mousemove=function(e,t,r,i){n.inMainBarOrHistogram(e,t)?ee(e,t):te();var a;if(w){a=w.getCursor(e,t);w.dragMove(e,t,r,i)}else{I=m.test(e,t,d);a=ve[Re(I)]||"auto"}ne();if(b!==a){b=a;v(a)}z(e,t,"hover")};h.mouseup=function(e,t,n,r){ye(!0,e,t,n,r)};h.mouseleave=function(e,t,n,r){arguments.length&&Ce(e,t,n,r);I=null;ne()};function ke(){if(he){clearTimeout(he);he=null}}h.touchstart=function(e){Xe(e)||Ve(e,!0);de=e[0].x;ge=e[0].y;ce=e[0].id;he=setTimeout(function(){ke();ye(!1);N(de,ge,"contextmenu")},600)};h.touchmove=function(e){if(Z)Z.pinchMove(e);else if(w){w.dragMove(e[0].x,e[0].y,!1,!1);ee(e[0].x,e[0].y)}for(var t=0;t<e.length;t++)if(ce===e[t].id){se=e[t].x;fe=e[t].y}if(he){var n=se-de,r=fe-ge;n*n+r*r>100&&ke()}};h.touchend=function(e){he&&ke();pe();ye(!1);Ve(e,!1)};h.touchcancel=function(){pe();ye(!1)};h.keydown=function(e,t,n){if(!t&&!n&&32===e){if(!W(i.playingExtend)){var r=f?"pause":"play",a={extend:i.options.showExtend&&!i.options.showPlay};h[r](a)}return!0}};return h}function pa(){var e={},t=Ar(),n=ga(),r=ha(t,n),i=Ia(),a=ya(t,r,i,n);e.clear=function(){return a.load({items:[]})};e.getIds=function(e,t){return r.getIds(e,t)};e.load=function(e,t){if(e&&e.items)return a.load(e,t);throw Error("Unknown data format passed")};e.options=function(e,t){return a.options(e,t)};e.pan=function(e,t,n){return a.pan(e,t,n)};e.pause=function(){return a.pause()};e.play=function(e){return a.play(e)};e.range=function(e,t,n,r){return 0!==arguments.length?a.range(e,t,n,r):a.range()};e.merge=function(e,t){var n=Z(w(e));return a.merge(n,t)};e.selection=function(e){return r.selection(e)};e.zoom=function(e,t,n){var r=B(t,{animate:!0,time:200});return a.zoom(e||"in",r,n)};e.privateInit=a.privateInit;e.privateSetSize=a.privateSetSize;Xr(e,a);D(e,t);var o=Br(a.draw,a.animate,a.getCanvas);D(e,o);e.inRange=function(e){if(W(e))return!1;var t=(y(e)?e.id:e)+"";return!!r.getIdcounts()[t]};e.privateBind("redraw",o.redraw);e._getItems=r.privateGetItems;return e}var Ca,xa,Ga=!1,wa=4096,Za=16,Aa=["rgba(255,0,0,1)","rgba(0,255,0,1)","rgba(0,0,255,1)","rgba(0,0,0,0)"];function Ba(e,t){xa=t;Ca=128;return Ma(e)}var Ra=function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d");n.id="webglDebugTextCanvas"+t;n.width=e;n.height=e;r.fillStyle="black";r.fillRect(0,0,e,e);if(Ga){var i=document.getElementById(n.id);i?i.parentNode.replaceChild(n,i):document.getElementsByTagName("body")[0].appendChild(n)}return r},Ma=function(e){var t=Object.keys(e),n=Wa(t),r={},i=Sa(r,t,n);i.getGlyphInfoForFont=function(e){return r[e]};return i},Wa=function(e){for(var t=0,n=document.createElement("canvas").getContext("2d"),r=0,i=e.length;r<i;r++){var a=xa.getNonEmojiGlyphs(),o=e[r];t+=Va(n,a,o,!1);t+=Va(n,a,o,!0)}for(var l=(Ca+Za)*t/3,u=256;l/(u*u)>3;)u*=2;return u},Va=function(e,t,n,r){for(var i,a=0,o=r?"bold ":"",l=0,u=t.length;l<u;l++){var c=t[l];i=le(c)?ue(Ca):Ca;e.font=o+i+"px "+n;a+=e.measureText(c).width+Za}return a},Sa=function(e,n,r){var i,a,o=r,l=function(){i=[];a={x:Za,y:Za,colourComponent:0,textureBank:0};for(var t=0,r=n.length;t<r;t++){e[n[t]]=e[n[t]]||{};Ea(i,o,e,a,n[t],!1);Ea(i,o,e,a,n[t],!0)}};G(l,function(e){if(e){(o*=2)>wa&&(Ca/=2);if(Ca<32){console.log("Number of unique text characters exceeded, try reducing the number of fonts or use canvas mode");return}l()}});t(e,function(t,n){ka(i,e,n,!1);ka(i,e,n,!0)});for(;a.textureBank<2;){a.textureBank++;var u=Ra(1,a.textureBank);i[a.textureBank]={alphaChannel:!1,img:u.canvas,texture:null}}return{fontSize:Ca,atlases:i,glyphInfo:e}},Xa=function(e,t,n){var r=e[t].ctx;r.font=n;r.globalCompositeOperation="lighter";return r},ka=function(e,t,n,r){for(var i=t[n],a=r?"B":"",o=r?"bold ":"",l=xa.getNonEmojiGlyphs(),u=0;u<l.length;++u){var c=l[u],s=0,f=i[c+a];if(f){var d;if(le(c)){s=8;d=ue(Ca)}else d=Ca;var g=Xa(e,f.textureBank,o+d+"px "+n);g.fillStyle=Aa[f.colourComponent];g.fillText(c,f.x,f.y+.75*Ca-s)}}},Ea=function(e,t,n,r,i,a){var o,l=e[r.textureBank];if(l)o=l.ctx;else{l={alphaChannel:!1,img:(o=Ra(t,r.textureBank)).canvas,ctx:o,texture:null};e[r.textureBank]=l}var u=a?"B":"",c=a?"bold ":"";o.fillStyle="black";for(var s=xa.getNonEmojiGlyphs(),f=0;f<s.length;++f){var d,g=s[f];d=le(g)?ue(Ca):Ca;o.font=c+d+"px "+i;var h=o.measureText(g);if(r.x+h.width+Za>t){var v=r.y+Ca+Za;if(v+Ca>t){v=Za;if(r.colourComponent<2)r.colourComponent++;else{if(!(r.textureBank<2))throw new Error("Warning: Number of unique text characters exceeded, restarting build with larger Texture");r.colourComponent=0;r.textureBank++;(o=Ra(t,r.textureBank)).font=c+Ca+"px "+i;e.push({alphaChannel:!1,img:o.canvas,ctx:o,texture:null})}o.fillStyle=Aa[r.colourComponent]}r.x=Za;r.y=v}n[i][g+u]={text:g,x:r.x,y:r.y,u1:r.x/t,v1:(r.y+Ca)/t,u2:(r.x+h.width)/t,v2:r.y/t,colourComponent:r.colourComponent,textureBank:r.textureBank,width:h.width};r.x+=h.width+Za}},Ya=2048,Fa=256,Ha=Fa/2;function La(e,t,n){var r=Object.keys(e),i=document.createElement("canvas");i.id="webglFontIconDebugCanvas";i.width=1;i.height=1;if(r.length){var a=Ta(r.length),o=i.getContext("2d");i.width=a;i.height=a;var l=document.getElementById("webglFontIconDebugCanvas");n&&(l?l.parentNode.replaceChild(i,l):document.getElementsByTagName("body")[0].appendChild(i));var u=Fa-2*4,c=Ha,s=0,f=1/a;o.fillStyle="rgb(0,0,0)";o.textAlign="center";var d=0,g=["rgba(255,0,0,1)","rgba(0,255,0,1)","rgba(0,0,255,1)","rgba(0,0,0,0)"];o.fillStyle="black";o.fillRect(0,0,a,a);o.fillStyle=g[0];o.globalCompositeOperation="lighter";for(var h=0,v=r.length;h<v;h++){var m=e[r[h]],b=pr(o,r[h],u,!1,m.ff||t,!0),I=Math.max(b.width,b.height),y=0;if(I>u){y=(u-(I=u*(u/I)))/2}if(c+Fa>a+128){c=Ha;s+=Fa}if(s>=a){c=Ha;s=0;if(++d>2)throw Error("Maximum number of icons exceeded!");o.fillStyle=g[d]}m.colourComponentTexture=d;m.u1=(c-u/2)*f;m.v1=s*f;m.u2=(c+u/2)*f;m.v2=(s+u)*f;o.textBaseline="top";o.font=I+"px "+ne(m.ff||t);o.fillText(r[h],c,s+y);c+=Fa}}return{alphaChannel:!1,img:i,texture:null}}var Ta=function(e){for(var t=512,n=12;t<Ya;){if(e<=n)return t;t*=2;n*=4}return Ya},Na=6,za=4;function Ua(e){var t=function(e,t,n,r,i,a){for(var o=t.shadowIndex,l=0;l<za;l++)for(var u=0;u<Na;u++){e[o++]=n;e[o++]=r;e[o++]=i;e[o++]=a}t.shadowIndex=o},n=function(e,t){for(var n=t.coreIndex,r=1;r<=za;r++){e[n]=r;e[n+3]=r+1;e[n+6]=-r;e[n+9]=-r;e[n+12]=r+1;e[n+15]=-(r+1);n+=18}t.coreIndex=n},r=function(e,t,n,r,i,a,o,l,u){var c=n,s=r;if(u){c=n+u.x;s=r+u.y}for(var f=t.positionIndex,d=0;d<za;d++)for(var g=0;g<Na;g++){e[f++]=c;e[f++]=s;e[f++]=i;e[f++]=a;e[f++]=o;e[f++]=l}t.positionIndex=f},i=function(t,n,r,i,a,o){for(var l=(a?e.background:1)*(o?e.ghost:1),u=n.colourIndex,c=0;c<za;c++)for(var s=0;s<Na;s++){t[u++]=r[0];t[u++]=r[1];t[u++]=r[2];t[u++]=r[3]*l;t[u++]=i[0];t[u++]=i[1];t[u++]=i[2];t[u++]=i[3]*l}n.colourIndex=u};return function(e,a,o,l,u,c,s,f,d,g,h,v,m,b,I,y,p){var C=g||[0,0,0,0];(y||p.all)&&t(e.shadowData,e,C[0],C[1],C[2],v);if(p.colours||y||p.all){var x=f,G=d;if(u<0){x=d;G=f}i(e.colourData,e,x,G,b,I)}(y||p.all)&&n(e.coreData,e);(p.positions||y||p.all)&&r(e.positionData,e,a,o,l,c,s,h,m)}}var Da=6;function _a(e){return function(t,n,r,i,a,o,l,u,c,s,f,d,g,h,v,m,b,I){var y,p,C=m||0,x=b||0;if(v.all||v.shadow||h){var G=a||[0,0,0,0];for(y=0;y<Da;y++){c.triangleBuffers.shadowData[c.triangleBuffers.shadowIndex++]=G[0];c.triangleBuffers.shadowData[c.triangleBuffers.shadowIndex++]=G[1];c.triangleBuffers.shadowData[c.triangleBuffers.shadowIndex++]=G[2];c.triangleBuffers.shadowData[c.triangleBuffers.shadowIndex++]=G[3]}}if(v.all||v.colours||h){var w=(d?e.background:1)*(g?e.ghost:1);for(y=0;y<Da;y++){c.triangleBuffers.colourData[c.triangleBuffers.colourIndex++]=i[0];c.triangleBuffers.colourData[c.triangleBuffers.colourIndex++]=i[1];c.triangleBuffers.colourData[c.triangleBuffers.colourIndex++]=i[2];c.triangleBuffers.colourData[c.triangleBuffers.colourIndex++]=i[3]*w}}if(v.all||v.positions||h){var Z=c.triangleBuffers.positionData,A=c.triangleBuffers.positionIndex;p=I?-o:o;if(f)for(y=0;y<18;y++)Z[A++]=0;else{var B=2*r,R=t-r,M=n-r,W=R+B,V=M+B;if(s){R+=s.x;M+=s.y;W+=s.x;V+=s.y}Z[A++]=R;Z[A++]=M;Z[A++]=p;Z[A++]=W;Z[A++]=M;Z[A++]=p;Z[A++]=R;Z[A++]=V;Z[A++]=p;Z[A++]=R;Z[A++]=V;Z[A++]=p;Z[A++]=W;Z[A++]=M;Z[A++]=p;Z[A++]=W;Z[A++]=V;Z[A++]=p}c.triangleBuffers.positionIndex=A}if(v.all||v.textures||h){var S=c.triangleBuffers.textureData,X=c.triangleBuffers.textureIndex;S[X++]=l;S[X++]=u;S[X++]=0;S[X++]=0;S[X++]=-1;S[X++]=0;S[X++]=r;S[X++]=C;S[X++]=x;S[X++]=l;S[X++]=u;S[X++]=1;S[X++]=0;S[X++]=-1;S[X++]=1;S[X++]=r;S[X++]=C;S[X++]=x;S[X++]=l;S[X++]=u;S[X++]=0;S[X++]=1;S[X++]=-1;S[X++]=2;S[X++]=r;S[X++]=C;S[X++]=x;S[X++]=l;S[X++]=u;S[X++]=0;S[X++]=1;S[X++]=-1;S[X++]=2;S[X++]=r;S[X++]=C;S[X++]=x;S[X++]=l;S[X++]=u;S[X++]=1;S[X++]=0;S[X++]=-1;S[X++]=1;S[X++]=r;S[X++]=C;S[X++]=x;S[X++]=l;S[X++]=u;S[X++]=1;S[X++]=1;S[X++]=-1;S[X++]=3;S[X++]=r;S[X++]=C;S[X++]=x;c.triangleBuffers.textureIndex=X}}}var Ka=6;function Oa(e){return function(t,n,r,i,a,o,l,u,c){var s=0,f=t.wsc||[0,0,0,0];if(u||c.all)for(s=0;s<Ka;s++){var d=r.triangleBuffers.shadowData,g=r.triangleBuffers.shadowIndex;d[g++]=f[0];d[g++]=f[1];d[g++]=f[2];d[g++]=f[3];r.triangleBuffers.shadowIndex=g}if(c.colours||u||c.all){var h=(a?e.background:1)*(o?e.ghost:1);for(s=0;s<Ka;s++){var v=r.triangleBuffers.colourData,m=r.triangleBuffers.colourIndex;v[m++]=t.wc[0]*h;v[m++]=t.wc[1]*h;v[m++]=t.wc[2]*h;v[m++]=t.wc[3]*h;r.triangleBuffers.colourIndex=m}}if(c.positions||u||c.all){var b=r.triangleBuffers.positionIndex,I=r.triangleBuffers.positionData;if(l)for(s=0;s<18;s++)I[b++]=0;else{var y=t.x1,p=t.y1,C=t.x2,x=t.y2;if(i){y=t.x1+i.x;p=t.y1+i.y;C=t.x2+i.x;x=t.y2+i.y}I[b++]=y;I[b++]=p;I[b++]=0;I[b++]=C;I[b++]=p;I[b++]=0;I[b++]=y;I[b++]=x;I[b++]=0;I[b++]=y;I[b++]=x;I[b++]=0;I[b++]=C;I[b++]=p;I[b++]=0;I[b++]=C;I[b++]=x;I[b++]=0}r.triangleBuffers.positionIndex=b}if(c.textures||u||c.all){var G=r.triangleBuffers.textureData,w=r.triangleBuffers.textureIndex;G[w++]=n.u1;G[w++]=n.v1;G[w++]=0;G[w++]=0;G[w++]=3;G[w++]=n.colourComponentTexture;G[w++]=0;G[w++]=0;G[w++]=0;G[w++]=n.u2;G[w++]=n.v1;G[w++]=1;G[w++]=0;G[w++]=3;G[w++]=n.colourComponentTexture;G[w++]=0;G[w++]=0;G[w++]=0;G[w++]=n.u1;G[w++]=n.v2;G[w++]=0;G[w++]=1;G[w++]=3;G[w++]=n.colourComponentTexture;G[w++]=0;G[w++]=0;G[w++]=0;G[w++]=n.u1;G[w++]=n.v2;G[w++]=0;G[w++]=1;G[w++]=3;G[w++]=n.colourComponentTexture;G[w++]=0;G[w++]=0;G[w++]=0;G[w++]=n.u2;G[w++]=n.v1;G[w++]=1;G[w++]=0;G[w++]=3;G[w++]=n.colourComponentTexture;G[w++]=0;G[w++]=0;G[w++]=0;G[w++]=n.u2;G[w++]=n.v2;G[w++]=1;G[w++]=1;G[w++]=3;G[w++]=n.colourComponentTexture;G[w++]=0;G[w++]=0;G[w++]=0;r.triangleBuffers.textureIndex=w}}}var Ja=6;function Pa(e){return function(t,n,r,i,a,o,l,u,c){var s,f=t.wsc||[0,0,0,0];if(u||c.all||c.shadow)for(s=0;s<Ja;s++){var d=r.triangleBuffers.shadowData,g=r.triangleBuffers.shadowIndex;d[g++]=f[0];d[g++]=f[1];d[g++]=f[2];d[g++]=f[3];r.triangleBuffers.shadowIndex=g}if(c.colours||u||c.all){var h=(a?e.background:1)*(o?e.ghost:1);for(s=0;s<Ja;s++){var v=r.triangleBuffers.colourData,m=r.triangleBuffers.colourIndex;v[m++]=255*h;v[m++]=255*h;v[m++]=255*h;v[m++]=255*h;r.triangleBuffers.colourIndex=m}}if(c.positions||u||c.all){var b=r.triangleBuffers.positionIndex,I=r.triangleBuffers.positionData;if(l)for(s=0;s<18;s++)I[b++]=0;else{var y=t.x1,p=t.y1,C=t.x2,x=t.y2;if(i){y=t.x1+i.x;p=t.y1+i.y;C=t.x2+i.x;x=t.y2+i.y}var G=0|t.vx;I[b++]=y;I[b++]=p;I[b++]=G;I[b++]=C;I[b++]=p;I[b++]=G;I[b++]=y;I[b++]=x;I[b++]=G;I[b++]=y;I[b++]=x;I[b++]=G;I[b++]=C;I[b++]=p;I[b++]=G;I[b++]=C;I[b++]=x;I[b++]=G}r.triangleBuffers.positionIndex=b}if(c.textures||u||c.all){var w,Z,A,B,R;"ci"===t.s&&(R="width"===n.maxDimension?(t.y2-t.y1)/2:(t.x2-t.x1)/2);if(R){Z=n.cu1;w=n.cv1;B=n.cu2;A=n.cv2}else{Z=n.u1;w=n.v1;B=n.u2;A=n.v2}var M=r.triangleBuffers.textureData,W=r.triangleBuffers.textureIndex;M[W++]=Z;M[W++]=w;M[W++]=0;M[W++]=0;M[W++]=n.textureBank;M[W++]=0;M[W++]=R;M[W++]=0;M[W++]=0;M[W++]=B;M[W++]=w;M[W++]=1;M[W++]=0;M[W++]=n.textureBank;M[W++]=1;M[W++]=R;M[W++]=0;M[W++]=0;M[W++]=Z;M[W++]=A;M[W++]=0;M[W++]=1;M[W++]=n.textureBank;M[W++]=2;M[W++]=R;M[W++]=0;M[W++]=0;M[W++]=Z;M[W++]=A;M[W++]=0;M[W++]=1;M[W++]=n.textureBank;M[W++]=2;M[W++]=R;M[W++]=0;M[W++]=0;M[W++]=B;M[W++]=w;M[W++]=1;M[W++]=0;M[W++]=n.textureBank;M[W++]=1;M[W++]=R
;M[W++]=0;M[W++]=0;M[W++]=B;M[W++]=A;M[W++]=1;M[W++]=1;M[W++]=n.textureBank;M[W++]=3;M[W++]=R;M[W++]=0;M[W++]=0;r.triangleBuffers.textureIndex=W}}}var ja=[0,1,0,1],Qa=[0,0,2,2];function qa(e){return function(t,n,r,i,a,o,l,u,c,s,f,d,g,h,v,m){var b=n,I=r,y=i,p=a,C=f.elementData,x=f.elementIntegerData,G=f.elementDataIndex;if(v||m.all){var w=f.elementIndex,Z=f.elementIndexIndex,A=f.elementMappingIndex;w[Z]=A;w[Z+1]=A+1;w[Z+2]=A+2;w[Z+3]=A+2;w[Z+4]=A+1;w[Z+5]=A+3}f.elementIndexIndex+=6;f.elementMappingIndex+=4;var B=0;if((v||m.all||m.positions)&&d){b+=d.x;I+=d.y;y+=d.x;p+=d.y}for(var R=0;R<4;R++){if(v||m.all||m.positions){C[G]=b;C[G+1]=I;C[G+2]=y;C[G+3]=p;C[G+4]=s}if(v||m.all){var M=(g?e.background:1)*(h?e.ghost:1);x[B=(G+6)*Float32Array.BYTES_PER_ELEMENT]=ja[R];x[B+1]=Qa[R];x[B+2]=0;x[B+3]=c;x[B+4]=o[0];x[B+5]=o[1];x[B+6]=o[2];x[B+7]=o[3]*M;x[B+8]=l[0];x[B+9]=l[1];x[B+10]=l[2];x[B+11]=l[3]*M;var W=u||[0,0,0];x[B+12]=W[0];x[B+13]=W[1];x[B+14]=W[2]}f.elementDataIndex+=10;G=f.elementDataIndex}}}var $a=6;function eo(e){return function(t,n,r,i,a,o,l,u,c,s,f,d,g,h,v,m){var b,I,y=n,p=r,C=i,x=a,G=t.wsc||[0,0,0,0],w=f||0;if(v||m.all||m.shadow){b=l.triangleBuffers.shadowIndex;var Z=l.triangleBuffers.shadowData;for(I=0;I<$a;I++){Z[b++]=G[0];Z[b++]=G[1];Z[b++]=G[2];Z[b++]=G[3]}l.triangleBuffers.shadowIndex=b}if(m.colours||v||m.all){var A=(c?e.background:1)*(s?e.ghost:1);b=l.triangleBuffers.colourIndex;var B=l.triangleBuffers.colourData;for(I=0;I<$a;I++){B[b++]=o[0];B[b++]=o[1];B[b++]=o[2];B[b++]=o[3]*A}l.triangleBuffers.colourIndex=b}if(m.positions||v||m.all){b=l.triangleBuffers.positionIndex;var R=l.triangleBuffers.positionData;if(h)for(I=0;I<18;I++)R[b++]=0;else{if(u){y+=u.x;p+=u.y;C+=u.x;x+=u.y}R[b++]=y;R[b++]=p;R[b++]=w;R[b++]=C;R[b++]=p;R[b++]=w;R[b++]=y;R[b++]=x;R[b++]=w;R[b++]=y;R[b++]=x;R[b++]=w;R[b++]=C;R[b++]=p;R[b++]=w;R[b++]=C;R[b++]=x;R[b++]=w}l.triangleBuffers.positionIndex=b}if(m.textures||v||m.all){b=l.triangleBuffers.textureIndex;var M,W=l.triangleBuffers.textureData;M=d>1?-3:-1;var V=C-y,S=x-p;W[b++]=0;W[b++]=0;W[b++]=V;W[b++]=S;W[b++]=M;W[b++]=0;W[b++]=-w;W[b++]=g;W[b++]=0;W[b++]=V;W[b++]=0;W[b++]=V;W[b++]=S;W[b++]=M;W[b++]=1;W[b++]=-w;W[b++]=g;W[b++]=0;W[b++]=0;W[b++]=S;W[b++]=V;W[b++]=S;W[b++]=M;W[b++]=2;W[b++]=-w;W[b++]=g;W[b++]=0;W[b++]=0;W[b++]=S;W[b++]=V;W[b++]=S;W[b++]=M;W[b++]=2;W[b++]=-w;W[b++]=g;W[b++]=0;W[b++]=V;W[b++]=0;W[b++]=V;W[b++]=S;W[b++]=M;W[b++]=1;W[b++]=-w;W[b++]=g;W[b++]=0;W[b++]=V;W[b++]=S;W[b++]=V;W[b++]=S;W[b++]=M;W[b++]=3;W[b++]=-w;W[b++]=g;W[b++]=0;l.triangleBuffers.textureIndex=b}}}var to=.109375;function no(e){var t=function(e,t,n,r,i,a){var o=t.positionIndex;e[o++]=n;e[o++]=r;e[o++]=0;e[o++]=i;e[o++]=r;e[o++]=0;e[o++]=n;e[o++]=a;e[o++]=0;e[o++]=n;e[o++]=a;e[o++]=0;e[o++]=i;e[o++]=r;e[o++]=0;e[o++]=i;e[o++]=a;e[o++]=0;t.positionIndex=o},n=function(e,t,n,r,i,a,o,l){var u=t.textureIndex;e[u++]=n;e[u++]=r;e[u++]=0;e[u++]=0;e[u++]=l;e[u++]=o;e[u++]=0;e[u++]=0;e[u++]=0;e[u++]=i;e[u++]=r;e[u++]=1;e[u++]=0;e[u++]=l;e[u++]=o;e[u++]=0;e[u++]=0;e[u++]=0;e[u++]=n;e[u++]=a;e[u++]=0;e[u++]=1;e[u++]=l;e[u++]=o;e[u++]=0;e[u++]=0;e[u++]=0;e[u++]=n;e[u++]=a;e[u++]=0;e[u++]=1;e[u++]=l;e[u++]=o;e[u++]=0;e[u++]=0;e[u++]=0;e[u++]=i;e[u++]=r;e[u++]=1;e[u++]=0;e[u++]=l;e[u++]=o;e[u++]=0;e[u++]=0;e[u++]=0;e[u++]=i;e[u++]=a;e[u++]=1;e[u++]=1;e[u++]=l;e[u++]=o;e[u++]=0;e[u++]=0;e[u++]=0;t.textureIndex=u};return function(r,i,a,o,l,u,c,s,f){var d,g=1,h=0;g=i.fs!==En&&(f.all||f.positions||s)?Yn/o*(i.fs/Yn):to;var v=i.wc[0],m=i.wc[1],b=i.wc[2],I=i.wc[3],y=r.colourData,p=r.positionData,C=r.textureData,x=r.shadowData,G=i.wmargin,w=i.fs*(i.pf/2),Z=i.x1,A=i.y1+i.yOffset+w;if(l){Z+=l.x;A+=l.y}for(var B=(u?e.background:1)*(c?e.ghost:1),R=0,M=a.length;R<M;R++){var W,V,S=a[R],X=o*g;if(f.all||f.shadow||s){d=r.shadowIndex;for(W=0;W<6;W++){x[d++]=0;x[d++]=0;x[d++]=0;x[d++]=0}r.shadowIndex=d}if(f.all||f.colours||s){d=r.colourIndex;for(W=0;W<6;W++){y[d++]=v*B;y[d++]=m*B;y[d++]=b*B;y[d++]=I*B}r.colourIndex=d}if(f.all||f.positions||s){V=S.width*g;i.hib?t(p,r,0,0,0,0):t(p,r,Z+h+G,A+X,Z+(h+V)+G,A)}(f.all||f.textures||s)&&n(C,r,S.u1,S.v1,S.u2,S.v2,S.colourComponent,S.textureBank);h+=V}}}var ro=3;function io(e){return function(t,n,r,i,a,o,l,u,c,s,f,d,g,h,v){var m,b,I=n,y=r,p=i,C=a,x=o,G=l,w=t.wsc||[0,0,0,0];if(v.all||v.shadow||h)for(b=0;b<ro;b++){var Z=s.triangleBuffers.shadowData,A=s.triangleBuffers.shadowIndex;Z[A++]=w[0];Z[A++]=w[1];Z[A++]=w[2];Z[A++]=w[3];s.triangleBuffers.shadowIndex=A}if(v.all||v.colours||h){var B=(d?e.background:1)*(g?e.ghost:1);for(b=0;b<ro;b++){var R=s.triangleBuffers.colourData,M=s.triangleBuffers.colourIndex;R[M++]=u[0];R[M++]=u[1];R[M++]=u[2];R[M++]=u[3]*B;s.triangleBuffers.colourIndex=M}}if(v.all||v.positions||h){m=s.triangleBuffers.positionIndex;var W=s.triangleBuffers.positionData;if(f){I+=f.x;y+=f.y;p+=f.x;C+=f.y;x+=f.x;G+=f.y}W[m++]=I;W[m++]=y;W[m++]=0;W[m++]=p;W[m++]=C;W[m++]=0;W[m++]=x;W[m++]=G;W[m++]=0;s.triangleBuffers.positionIndex=m}if(v.all||v.textures||h){m=s.triangleBuffers.textureIndex;var V=s.triangleBuffers.textureData;V[m++]=0;V[m++]=1;V[m++]=0;V[m++]=0;V[m++]=c;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=1;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=c;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=1;V[m++]=0;V[m++]=c;V[m++]=0;V[m++]=0;V[m++]=0;V[m++]=0;s.triangleBuffers.textureIndex=m}}}function ao(e){var t=4,n=3,r=function(e,r,i,a,o){for(var l=r.shadowIndex,u=0;u<n;u++){e[l++]=i;e[l++]=a;e[l++]=o;e[l++]=t+u}r.shadowIndex=l},i=function(e,t){var n=t.coreIndex;e[n++]=0;e[n++]=1;e[n++]=0;e[n++]=1;e[n++]=0;e[n++]=0;e[n++]=0;e[n++]=0;e[n++]=1;t.coreIndex=n},a=function(e,t,n,r,i,a,o,l){var u=t.positionIndex;e[u++]=n;e[u++]=r;e[u++]=i;e[u++]=a;e[u++]=o;e[u++]=l;e[u++]=n;e[u++]=r;e[u++]=i;e[u++]=a;e[u++]=o;e[u++]=l;e[u++]=n;e[u++]=r;e[u++]=i;e[u++]=a;e[u++]=o;e[u++]=l;t.positionIndex=u},o=function(t,r,i,a,o,l,u,c){for(var s=(u?e.background:1)*(c?e.ghost:1),f=r.colourIndex,d=0;d<n;d++){t[f++]=i;t[f++]=a;t[f++]=o;t[f++]=l*s;t[f++]=i;t[f++]=a;t[f++]=o;t[f++]=l*s}r.colourIndex=f};return function(e,t,n,l,u,c,s,f,d,g,h,v,m){var b=d||[0,0,0];(v||m.all)&&r(e.shadowData,e,b[0],b[1],b[2]);(m.colours||v||m.all)&&o(e.colourData,e,f[0],f[1],f[2],f[3],g,h);(v||m.all)&&i(e.coreData,e);(m.positions||v||m.all)&&a(e.positionData,e,t,n,l,u,c,s)}}function oo(e){var t=4;return function(n,r,i,a,o,l,u,c,s,f,d,g,h){var v,m,b=n.elementData,I=n.elementIntegerData,y=n.elementDataIndex;if(g||h.all){var p=n.elementIndex,C=n.elementIndexIndex,x=n.elementMappingIndex;p[C]=x;p[C+1]=x+1;p[C+2]=x+2;v=(f?e.background:1)*(d?e.ghost:1);m=s||[0,0,0,0]}n.elementIndexIndex+=3;n.elementMappingIndex+=3;var G=0;b[y]=r;b[y+1]=i;b[y+2]=a;b[y+3]=o;b[y+4]=l;b[y+5]=u;if(g||h.all){I[G=(y+6)*Float32Array.BYTES_PER_ELEMENT]=0;I[G+1]=1;I[G+2]=0;I[G+3]=t;I[G+4]=c[0];I[G+5]=c[1];I[G+6]=c[2];I[G+7]=c[3]*v;I[G+8]=c[0];I[G+9]=c[1];I[G+10]=c[2];I[G+11]=c[3]*v;I[G+12]=m[0];I[G+13]=m[1];I[G+14]=m[2];I[G+15]=0}n.elementDataIndex+=10;b[y=n.elementDataIndex]=r;b[y+1]=i;b[y+2]=a;b[y+3]=o;b[y+4]=l;b[y+5]=u;if(g||h.all){I[G=(y+6)*Float32Array.BYTES_PER_ELEMENT]=1;I[G+1]=0;I[G+2]=0;I[G+3]=t;I[G+4]=c[0];I[G+5]=c[1];I[G+6]=c[2];I[G+7]=c[3]*v;I[G+8]=c[0];I[G+9]=c[1];I[G+10]=c[2];I[G+11]=c[3]*v;I[G+12]=m[0];I[G+13]=m[1];I[G+14]=m[2];I[G+15]=1}n.elementDataIndex+=10;b[y=n.elementDataIndex]=r;b[y+1]=i;b[y+2]=a;b[y+3]=o;b[y+4]=l;b[y+5]=u;if(g||h.all){I[G=(y+6)*Float32Array.BYTES_PER_ELEMENT]=0;I[G+1]=0;I[G+2]=1;I[G+3]=t;I[G+4]=c[0];I[G+5]=c[1];I[G+6]=c[2];I[G+7]=c[3]*v;I[G+8]=c[0];I[G+9]=c[1];I[G+10]=c[2];I[G+11]=c[3]*v;I[G+12]=m[0];I[G+13]=m[1];I[G+14]=m[2];I[G+15]=2}n.elementDataIndex+=10}}var lo=512,uo=4,co=264,so=4,fo=!1;function go(e,n,r){var i=[],a=4,o=4,l=4,u=0,c={};t(e,function(e,t){c[t]=e});var s=Io(n,r);t(s,function(e,t){c[t]=e});for(var f=bo(c),d=ho(f),g=1/d,h=mo(d,0),v=0,m=f.length;v<m;v++){var b=f[v],I=b.im,y=I.width/b.imageRatio,p=I.height/b.imageRatio;if(a+y+so>d){a=0;o+=u+so;u=0}if(o+p>d){l++;o=so;i.push({alphaChannel:!0,img:h.canvas,texture:null});h=mo(d,l)}I.u1=a*g;I.v1=o*g;I.u2=(a+y)*g;I.v2=(o+p)*g;if(b.isEmoji){I.v2=o*g;I.v1=(o+p)*g}I.maxDimension=b.nonSquare;I.textureBank=l;if(b.nonSquare){var C=I.v2-I.v1,x=I.u2-I.u1;if("width"===b.nonSquare){var G=(x-x*(C/x))/2;I.cu1=I.u1+G;I.cv1=I.v1;I.cu2=I.u2-G;I.cv2=I.v2}else{var w=(C-C*(x/C))/2;I.cu1=I.u1;I.cv1=I.v1+w;I.cu2=I.u2;I.cv2=I.v2-w}}else{I.cu1=I.u1;I.cv1=I.v1;I.cu2=I.u2;I.cv2=I.v2}h.drawImage(I,a,o,y,p);p>u&&(u=p);a+=y+so}i.push({alphaChannel:!0,img:h.canvas,texture:null});l++;for(;l<8;){var Z=mo(1,l++);i.push({alphaChannel:!0,img:Z.canvas,texture:null})}return i}var ho=function(e){for(var t=1,n=so,r=so,i=0,a=1024,o=0,l=e.length;o<l;o++){var u=e[o],c=u.im,s=c.width/u.imageRatio,f=c.height/u.imageRatio;if(n+s+so>a){n=0;r+=i+so;i=0}if(r+f>a){t++;r=so}f>i&&(i=f);n+=s+so}return t<uo?1024:t<=4*(uo-1)?2048:4096},vo=function(e,t){var n=1,r=!1;if(e>co){t>0?e>lo&&(n=e/lo):n=e/co;r=!0}return{imageRatio:n,largeImage:r}},mo=function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d");n.id="webglDebugImageCanvas"+t;n.width=e;n.height=e;if(fo){var i=document.getElementById(n.id);i?i.parentNode.replaceChild(n,i):document.getElementsByTagName("body")[0].appendChild(n)}return r},bo=function(e){var n=[],r=2;t(e,function(t,i){if(t&&t.im){var a=e._coList[i]?t.co:t.im,o=a.width>a.height?"width":"height";if(void 0!==a.src&&a.src.indexOf(".svg")>-1){var l=0|Math.max(a.width,a.height);if(l){var u=256/l;a.width=Math.round(a.width*u);a.height=Math.round(a.height*u)}else{a.width=256;a.height=256}}var c=vo(a.height,r);c.largeImage&&r>0&&r--;n.push({im:a,size:a[o]/c.imageRatio,imageRatio:c.imageRatio,nonSquare:a.width!==a.height&&o,isEmoji:t.isEmoji})}});return n.sort(function(e,t){return e.size-t.size})},Io=function(e,t){for(var n={},r={},i=e.length,a=0;a<i;a++){var o=e[a],l=document.createElement("canvas"),u=l.getContext("2d");l.width=128;l.height=128;u.fillStyle="black";u.font="105px sans serif";var c=u.measureText(o).width;l.width=c*(128/105);u.font="105px sans serif";u.fillText(o,(l.width-c)/2,96);var s={im:l,size:128,imageRatio:1,nonSquare:!1,isEmoji:!0};n[o]=s;r[o]=l}t(r);return n};function yo(e,t){var n,r=Ua(e.alpha),i=_a(e.alpha),a=Oa(e.alpha),o=Pa(e.alpha),l=qa(e.alpha),u=eo(e.alpha),c=no(e.alpha),s=io(e.alpha),f=ao(e.alpha),d=oo(e.alpha),g={},h=4,v=1,m=2,b={dashed:2,dotted:3},I={},y={},p=null,C=null,x={},G={textAtlas:!1,fontIcons:!1,imageAtlas:!1},w=!1;g.updateImageTextures=function(n,r){r.clearTextureAtlas(e.imageAtlases);e.imageAtlases=go(n,t.getEmojiGlyphs(),t.setEmojiGlyphImages)};g.generate=function(t,r,i,a,o){if(i.all){e.layersToDraw.length=0;n=wr(e.canvas);G.textAtlas=!1;G.fontIcons=!1;G.imageAtlas=!1}w=cr();t.forEach(function(t){var n=U(e.allLayers,t);i.all&&e.layersToDraw.push(n);B(n,i,t.fbAlpha);if(R(i,t.alwaysUpdate)){var o=t.primitives,l=t.numOfPrimitives;Z(a);A(a);if(i.all){var u=n.lineBuffers,c=n.arcBuffers,s=n.triangleBuffers;M(u,c,s);for(var f=0;f<l;f++){z(t.primitives[f],u,c,s)}}if(!G.textAtlas&&!G.fontIcons&&!G.imageAtlas){H(n);k(o,l,n,r)}}});E(o);Y(o);F(o,r);if(G.textAtlas||G.fontIcons||G.imageAtlas){G.fontIcons=!1;G.textAtlas=!1;G.imageAtlas=!1;g.generate(t,r,{all:!0},a,o)}x={}};function Z(e){W(e.fontFamily)&&(e.fontFamily="sans-serif");if(p!==e.fontFamily||null===p){p=e.fontFamily;G.textAtlas=!0}x[p]=!0;y[p]=!0}function A(e){if(e.iconFontFamily&&C!==e.iconFontFamily){C=e.iconFontFamily;G.fontIcons=!0}}function B(e,t,n){e.fbAlpha=n;e.rebuildOptions={all:t.all,colours:t.colours,textures:t.textures,shadow:t.shadow,positions:t.positions}}function R(e,t){return e.all||e.textures||e.positions||e.shadow||e.colours||t}function M(e,t,n){t.numOfTriangles=0;e.numOfLines=0;e.numOfArrowheads=0;n.numOfTriangles=0}function V(e,t,n){var r=n.all||t||e.dirty;e.dirty=!1;return r}var S=function(e,t,n,r,i,a){if(t.arrowhead===v){var o=t.x1,l=t.y1,u=t.x2,c=t.y2,s=t.x3,g=t.y3,h=t.a&&t.a.y;if(h){l+=h;c+=h;g+=h}d(e.lineBuffers,o,l,u,c,s,g,t.wfc,t.wsc,n,r,i,a)}else t.arrowhead===m&&f(e.arcBuffers,t.x1,t.y1,t.x2,t.y2,t.x3,t.y3,t.wfc,t.wsc,n,r,i,a)},X={A:function(e,t,n,a,o,l){var u=V(t,o,l);t.donut&&i(t.x,t.y,t.r,t.wbc,t.wsc,t.bw,.5,.5,e,t.a,t.hib,n,a,o,l,t.sa,t.ea);if(u){var c=b[t.ls]||1;r(e.arcBuffers,t.x,t.y,t.r,t.off,t.sa,t.ea,t.wbc,t.wbc2||t.wbc,t.wsc,t.bw,c,t.a,n,a,o,l)}else e.arcBuffers.skip()},L:function(e,t,n,r,i,a){if(V(t,i,a)){var o=b[t.ls]||0;l(t,t.x1,t.y1,t.x2,t.y2,t.wc,t.wc2||t.wc,t.wsc,o,t.w,e.lineBuffers,t.a,n,r,i,a)}else e.lineBuffers.skip()},L3:function(e,t,n,r,i,a){if(V(t,i,a)){var o=b[t.ls]||0;l(t,t.x1,t.y1,t.x2,t.y2,t.wc,t.wc,t.wsc,o,t.w,e.lineBuffers,t.a,n,r,i,a);l(t,t.x2,t.y2,t.x3,t.y3,t.wc,t.wc,t.wsc,o,t.w,e.lineBuffers,t.a,n,r,i,a);l(t,t.x3,t.y3,t.x4,t.y4,t.wc,t.wc,t.wsc,o,t.w,e.lineBuffers,t.a,n,r,i,a)}else e.lineBuffers.skip(3)},I:function(e,t,n,r,i,a,l){if(V(t,i,a)){"_background"===t.id&&(t.wsc=[0,0,0,0]);var u=l[t.u];if(t.hi&&w){var c=l[sr(t.u)];c&&!c.missing&&(u=c)}o(t,"co"===t.s?u.co:u.im,e,t.a,n,r,t.hib,i,a)}else e.triangleBuffers.skip()},TR:function(e,t,n,r,i,a){if(t.arrowhead)S(e,t,n,r,i,a);else{t.fi&&s(t,t.x1,t.y1,t.x2,t.y2,t.x3,t.y3,t.wfc,-2,e,t.a,n,r,i,a);t.bw>0&&s(t,t.x1,t.y1,t.x2,t.y2,t.x3,t.y3,t.wbc,-2,e,t.a,n,r,i,a)}},R:function(e,t,n,r,i,a){t.fi&&u(t,t.x1,t.y1,t.x2,t.y2,t.wfc,e,t.a,n,r,0,0,0,t.hib,i,a);if(t.bw>0){var o=b[t.bs]||0;u(t,t.x1,t.y1,t.x2,t.y2,t.wbc,e,t.a,n,r,t.bw,o,0,t.hib,i,a)}},RR:function(e,t,n,r,i,a){t.fi&&u(t,t.x1,t.y1,t.x2,t.y2,t.wfc,e,t.a,n,r,0,0,t.r,t.hib,i,a);if(t.bw>0){var o=b[t.bs]||0;u(t,t.x1,t.y1,t.x2,t.y2,t.wbc,e,t.a,n,r,t.bw,o,t.r,t.hib,i,a)}},C:function(e,t,n,r,a,o){var l=V(t,a,o);t.fi&&(l?i(t.x,t.y,t.r,t.wfc,t.wsc,0,.5,.5,e,t.a,t.hib,n,r,a,o):e.triangleBuffers.skip());if(t.bw>0)if(l){var u=b[t.bs]||0;i(t.x,t.y,t.r,t.wbc,t.wsc,t.bw,.5,.5,e,t.a,t.hib,n,r,a,o,null,null,u>1)}else e.triangleBuffers.skip()},T:function(r,i,o,l,s,f){var d=V(i,s,f);if(i.isfi)d?a(i,I[i.t],r,i.a,o,l,i.hib,s,f):r.triangleBuffers.skip();else{if(i.back)if(d){var g=i.fs*i.pf;u(i,i.x1,i.y1,i.x2,i.y2+g,i.wbc,r,i.a,o,l,0,0,0,i.hib,s,f)}else r.triangleBuffers.skip();var h=t.getGlyphsFromText(i.t,i.ff,p,i.bo,G,n,e.textAtlas);d?c(r.triangleBuffers,i,h,e.textAtlas.fontSize,i.a,o,l,s,f):r.triangleBuffers.skip(h.length)}},PE:function(e,t,n,r,i,a){if(t.fi){s(t,t.x1,t.y1,t.x2,t.y2,t.x5,t.y5,t.fi?t.wfc:t.wbc,-1,e,t.a,n,r,i,a);s(t,t.x5,t.y5,t.x2,t.y2,t.x4,t.y4,t.fi?t.wfc:t.wbc,-1,e,t.a,n,r,i,a);s(t,t.x2,t.y2,t.x3,t.y3,t.x4,t.y4,t.fi?t.wfc:t.wbc,-1,e,t.a,n,r,i,a)}if(t.bw>0){var o=b[t.bs]||0;if(t.x1<t.x2){l(t,t.x1,t.y1,t.x2,t.y2,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x2,t.y2,t.x3,t.y3,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x3,t.y3,t.x4-t.bw/2,t.y4,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x4,t.y4-t.bw/2,t.x5,t.y5+t.bw/2,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x5-t.bw/2,t.y5,t.x1,t.y1,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a)}else{l(t,t.x1,t.y1,t.x2,t.y2,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x2,t.y2,t.x3,t.y3,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x3,t.y3,t.x4+t.bw/2,t.y4,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x4,t.y4-t.bw/2,t.x5,t.y5+t.bw/2,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a);l(t,t.x5+t.bw/2,t.y5,t.x1,t.y1,t.wbc,t.wbc,t.wsc,o,t.bw,e.lineBuffers,t.a,n,r,i,a)}}}};function k(e,t,n,r){for(var i,a=n.rebuildOptions,o=n.alwaysUpdate,l=0;l<t;l++){var u,c,s=(i=e[l]).a;if(s){u=s.bg;c=s.gh}X[i.p](n,i,u,c,o,a,r)}}function E(n){if(G.textAtlas){e.textAtlas&&n.clearTextureAtlas(e.textAtlas.atlases);e.textAtlas=Ba(x,t);y=x}}function Y(t){if(G.fontIcons||!e.fontIconAtlas){t.clearTextureAtlas(e.fontIconAtlas);e.fontIconAtlas=La(I,C)}}function F(e,t){G.imageAtlas&&g.updateImageTextures(t,e)}function H(e){L(e.lineBuffers,e);T(e);N(e)}function L(e,t){var n=10;e.elementIndexIndex=0;e.elementMappingIndex=0;e.elementDataIndex=0;e.elementIntegerDataIndex=0;var r=e.numOfLines*n*4;r+=e.numOfArrowheads*n*3;if(!e.elementData||t.rebuildOptions.all){e.elementData=new Float32Array(r);e.elementIntegerData=new Uint8Array(e.elementData.buffer,0,e.elementData.length*Float32Array.BYTES_PER_ELEMENT)}e.elementIndex&&!t.rebuildOptions.all||(e.elementIndex=new Uint32Array(6*e.numOfLines+3*e.numOfArrowheads))}function T(e){var t=6,n=4,r=8,i=4;e.arcBuffers.positionIndex=0;e.arcBuffers.colourIndex=0;e.arcBuffers.shadowIndex=0;e.arcBuffers.coreIndex=0;e.arcBuffers.totalnumOfVertices=3*e.arcBuffers.numOfTriangles;a();o();l();u();function a(){var n=e.arcBuffers.totalnumOfVertices*t;(!e.arcBuffers.positionData||e.rebuildOptions.all&&e.arcBuffers.positionData.length!==n)&&(e.arcBuffers.positionData=new Float32Array(n))}function o(){var t=e.arcBuffers.totalnumOfVertices*r;(!e.arcBuffers.colourData||e.rebuildOptions.all&&e.arcBuffers.colourData.length!==t)&&(e.arcBuffers.colourData=new Uint8Array(t))}function l(){var t=e.arcBuffers.totalnumOfVertices*n;(!e.arcBuffers.shadowData||e.rebuildOptions.all&&e.arcBuffers.shadowData.length!==t)&&(e.arcBuffers.shadowData=new Uint8Array(t))}function u(){var t=e.arcBuffers.totalnumOfVertices*i;(!e.arcBuffers.coreData||e.rebuildOptions.all&&e.arcBuffers.coreData.length!==t)&&(e.arcBuffers.coreData=new Float32Array(t))}}function N(e){var t=3,n=3,r=4,i=9,a=4;e.triangleBuffers.positionIndex=0;e.triangleBuffers.colourIndex=0;e.triangleBuffers.textureIndex=0;e.triangleBuffers.shadowIndex=0;e.triangleBuffers.totalnumOfVertices=e.triangleBuffers.numOfTriangles*t;o();l();u();c();function o(){var t=e.triangleBuffers.totalnumOfVertices*n;(!e.triangleBuffers.positionData||e.rebuildOptions.all&&e.triangleBuffers.positionData.length!==t)&&(e.triangleBuffers.positionData=new Float32Array(e.triangleBuffers.totalnumOfVertices*n))}function l(){var t=e.triangleBuffers.totalnumOfVertices*a;(!e.triangleBuffers.colourData||e.rebuildOptions.all&&e.triangleBuffers.colourData.length!==t)&&(e.triangleBuffers.colourData=new Uint8Array(e.triangleBuffers.totalnumOfVertices*a))}function u(){var t=e.triangleBuffers.totalnumOfVertices*i;(!e.triangleBuffers.textureData||e.rebuildOptions.all&&e.triangleBuffers.textureData.length!==t)&&(e.triangleBuffers.textureData=new Float32Array(e.triangleBuffers.totalnumOfVertices*i))}function c(){var t=e.triangleBuffers.totalnumOfVertices*r;(!e.triangleBuffers.shadowData||e.rebuildOptions.all&&e.triangleBuffers.shadowData.length!==t)&&(e.triangleBuffers.shadowData=new Uint8Array(e.triangleBuffers.totalnumOfVertices*r))}}function z(t,r,i,a){switch(t.p){case xn.arc:t.donut?a.numOfTriangles+=2:i.numOfTriangles+=2*h;break;case xn.line:r.numOfLines+=1;break;case xn.line3:r.numOfLines+=3;break;case xn.circle:t.bw>0&&(a.numOfTriangles+=2);t.fi&&(a.numOfTriangles+=2);break;case xn.rect:case xn.roundrect:t.fi&&(a.numOfTriangles+=2);t.bw>0&&(a.numOfTriangles+=2);break;case xn.text:var o=t.t,l=e.characterCache.getCombinedCharacters(o),u=l.length;if(t.isfi){a.numOfTriangles+=2;if(!I[o]){G.fontIcons=!0;I[t.t]={t:o,ff:t.ff}}}else{if(t.ff){x[t.ff]=!0;if(!y[t.ff]){G.textAtlas=!0;y[t.ff]=!0}}t.back&&(a.numOfTriangles+=2);n&&(u=e.bidi.analyseText(l,o).result.length);a.numOfTriangles+=2*u}break;case xn.pentagon:t.bw>0&&(r.numOfLines+=5);t.fi&&(a.numOfTriangles+=3);break;case xn.triangle:if(t.arrowhead>0)1===t.arrowhead?r.numOfArrowheads++:i.numOfTriangles++;else{t.fi&&a.numOfTriangles++;t.bw>0&&a.numOfTriangles++}break;case"I":a.numOfTriangles+=2}}function U(t,n){var r=e.allLayers[n.id];if(!r){r=D(n);e.allLayers[n.id]=r}return r}function D(e){var t={triangleBuffers:{numOfTriangles:0,itemIndex:{},skip:function(e){var n=e||1;t.triangleBuffers.colourIndex+=48*n;t.triangleBuffers.shadowIndex+=24*n;t.triangleBuffers.textureIndex+=54*n;t.triangleBuffers.positionIndex+=18*n}},lineBuffers:{numOfLines:0,numOfArrowheads:0,itemIndex:{},skip:function(e){var n=e||1;t.lineBuffers.elementDataIndex+=40*n;t.lineBuffers.elementIndexIndex+=6*n;t.lineBuffers.elementMappingIndex+=4*n}},arcBuffers:{numOfTriangles:0,itemIndex:{},skip:function(){t.arcBuffers.colourIndex+=192;t.arcBuffers.positionIndex+=144;t.arcBuffers.shadowIndex+=96;t.arcBuffers.coreIndex+=72}},id:e.id,drawBackgroundColour:e.drawBackgroundColour,useFramebuffer:e.useFramebuffer,drawFramebuffer:e.drawFramebuffer,framebuffer:null,renderbuffer:null,framebufferTexture:null,fbAlpha:e.fbAlpha,useView:e.useView,shadowType:e.shadowType,channels:e.channels,rebuildOptions:{},alwaysUpdate:e.alwaysUpdate,blatOverview:e.blatOverview,numOfPrimitives:e.numOfPrimitives,primitives:e.primitives,overview:e.overview};return t}return g}
var po="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwphdHRyaWJ1dGUgdmVjMiBhX3Bvc2l0aW9uOwphdHRyaWJ1dGUgZmxvYXQgYV9yYWRpdXM7CmF0dHJpYnV0ZSBmbG9hdCBhX3N0YXJ0QW5nbGU7CmF0dHJpYnV0ZSBmbG9hdCBhX2VuZEFuZ2xlOwphdHRyaWJ1dGUgZmxvYXQgYV93aWR0aDsKYXR0cmlidXRlIHZlYzQgYV9jb2xvdXI7CmF0dHJpYnV0ZSB2ZWM0IGFfY29sb3VyMjsKYXR0cmlidXRlIHZlYzMgYV9oaXRUZXN0Q29sb3VyOwphdHRyaWJ1dGUgZmxvYXQgYV9saW5lVHlwZTsKYXR0cmlidXRlIHZlYzMgYV9jb3JlOwoKdW5pZm9ybSBmbG9hdCB1X2hpdFRlc3Q7CnVuaWZvcm0gZmxvYXQgdV96b29tOwp1bmlmb3JtIHZlYzMgdV9yZXNvbHV0aW9uOwp1bmlmb3JtIG1hdDQgdV90cmFuc2Zvcm07Cgp2YXJ5aW5nIHZlYzQgdl9jb2xvdXI7CnZhcnlpbmcgdmVjNCB2X2NvbG91cjI7CnZhcnlpbmcgdmVjNCB2X2NvcmU7CnZhcnlpbmcgdmVjNCB2X2xpbmVEYXRhOwp2YXJ5aW5nIHZlYzMgdl9oaXRUZXN0Q29sb3VyOwp2YXJ5aW5nIHZlYzQgdl9iYXJ5Y2VudHJpYzsKdmFyeWluZyB2ZWM0IHZfcG9zaXRpb247CnZhcnlpbmcgdmVjMyB2X2Rhc2hpbmc7CgpmbG9hdCBwaSA9IDMuMTQxNTkyNjUzNTk7CmZsb2F0IG1pbldpZHRoID0gMS4wOwppbnQgTElORV9UWVBFX0RBU0ggPSAyOwppbnQgTElORV9UWVBFX0RPVCA9IDM7CmludCBMSU5FX1RZUEVfQVJST1dIRUFEID0gNDsKCmZsb2F0IG51bWJlck9mU2VnbWVudHMgPSA0LjA7CgppbnQgcm91bmRUb0ludChmbG9hdCBhKSB7CiAgcmV0dXJuIGludChmbG9vcihhICsgMC41KSk7Cn0KCi8vIE5leHQgc2VnbWVudCBpbiB0aGUgYXJjCnZlYzIgZ2V0TmV4dFBvc2l0aW9uKHZlYzIgY2VudHJlUG9pbnQsIGZsb2F0IHJhZGl1cywgZmxvYXQgc3RhcnRBbmdsZSwgZmxvYXQgYW5nbGVJbmNyZW1lbnQsIGZsb2F0IGluZGV4KSB7CiAgcmV0dXJuIHZlYzIoCiAgICBjZW50cmVQb2ludC54ICsgKHJhZGl1cyAqIGNvcyhzdGFydEFuZ2xlICsgYW5nbGVJbmNyZW1lbnQgKiBpbmRleCkpLAogICAgY2VudHJlUG9pbnQueSArIChyYWRpdXMgKiBzaW4oc3RhcnRBbmdsZSArIGFuZ2xlSW5jcmVtZW50ICogaW5kZXgpKQogICk7Cn0KCmZsb2F0IGdldE51bWJlck9mRGFzaGVzKGZsb2F0IGRhc2hMZW5ndGgsIGZsb2F0IGxlbmd0aE9mQXJjKSB7CiAgZmxvYXQgZ2FwV2lkdGggPSBkYXNoTGVuZ3RoIC8gMi4wOwogIGZsb2F0IG51bU9mRGFzaGVzID0gZmxvb3IoKChsZW5ndGhPZkFyYyArIGdhcFdpZHRoKSAvIChkYXNoTGVuZ3RoICsgZ2FwV2lkdGgpKSArIDAuNSk7CiAgaWYgKChudW1PZkRhc2hlcyAqIGRhc2hMZW5ndGgpID4gbGVuZ3RoT2ZBcmMpIHsKICAgIG51bU9mRGFzaGVzID0gMS4wOwogIH0KICByZXR1cm4gbnVtT2ZEYXNoZXM7Cn0KCnZvaWQgbWFpbigpIHsKICBmbG9hdCBhYVdpZHRoQnVmZmVyID0gMS4wIC8gdV96b29tOwogIGludCBsaW5lVHlwZSA9IHJvdW5kVG9JbnQoYV9saW5lVHlwZSk7CiAgYm9vbCBpc0Rhc2hlZExpbmUgPSBsaW5lVHlwZSA9PSBMSU5FX1RZUEVfREFTSDsKICBib29sIGlzRG90dGVkTGluZSA9IGxpbmVUeXBlID09IExJTkVfVFlQRV9ET1Q7CiAgYm9vbCBpc0Fycm93aGVhZCA9IGxpbmVUeXBlID49IExJTkVfVFlQRV9BUlJPV0hFQUQ7CiAgdmVjMiBwb3NpdGlvbjsKICAvLyBob3cgbXVjaCBzbW9vdGhpbmcgdG8gYXBwbHkgdG8gdGhlIGVkZ2Ugb2YgdGhlIGFycm93aGVhZAogIGZsb2F0IGFudGlBbGlhc2luZ1RocmVzaG9sZDsKICBpZiAoaXNBcnJvd2hlYWQpIHsKICAgIGludCB2ZXJ0ZXhJbmRleCA9IHJvdW5kVG9JbnQoYV9saW5lVHlwZSkgLSBMSU5FX1RZUEVfQVJST1dIRUFEOwogICAgdmVjMiBwb3NpdGlvbjEgPSBhX3Bvc2l0aW9uOwogICAgdmVjMiBwb3NpdGlvbjIgPSB2ZWMyKGFfcmFkaXVzLCBhX3N0YXJ0QW5nbGUpOwogICAgdmVjMiBwb3NpdGlvbjMgPSB2ZWMyKGFfZW5kQW5nbGUsIGFfd2lkdGgpOwoKICAgIGZsb2F0IGRpc3RhbmNlSW5Xb3JsZFBpeGVscyA9IGRpc3RhbmNlKHBvc2l0aW9uMiwgcG9zaXRpb24zKTsKICAgIGZsb2F0IGRpc3RhbmNlSW5TY3JlZW5QaXhlbHMgPSBkaXN0YW5jZUluV29ybGRQaXhlbHMgLyB1X3pvb207CiAgICBhbnRpQWxpYXNpbmdUaHJlc2hvbGQgPSAxLjAgLyBkaXN0YW5jZUluU2NyZWVuUGl4ZWxzOwogICAgdmVjMiBvcHBvc2l0ZU1pZFBvaW50OwogICAgaWYodmVydGV4SW5kZXggPT0gMCkgewogICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uMTsKICAgICAgb3Bwb3NpdGVNaWRQb2ludCA9IChwb3NpdGlvbjIgKyBwb3NpdGlvbjMpIC8gMi4wOwogICAgfSBlbHNlIGlmICh2ZXJ0ZXhJbmRleCA9PSAxKSB7CiAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24yOwogICAgICBvcHBvc2l0ZU1pZFBvaW50ID0gKHBvc2l0aW9uMSArIHBvc2l0aW9uMykgLyAyLjA7CiAgICB9IGVsc2UgaWYgKHZlcnRleEluZGV4ID09IDIpIHsKICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbjM7CiAgICAgIG9wcG9zaXRlTWlkUG9pbnQgPSAocG9zaXRpb24yICsgcG9zaXRpb24xKSAvIDIuMDsKICAgIH0KICAgIHZlYzIgdW5pdFZlY3RvckZvckV4dHJ1c2lvbiA9IG5vcm1hbGl6ZShwb3NpdGlvbiAtIG9wcG9zaXRlTWlkUG9pbnQpOwogICAgLy8gcHVzaCB2ZXJ0ZXggYXdheSBmcm9tIGNlbnRyZSB0byBtYWtlIGl0IGJpZ2dlciBzbyB0aGF0IGFudGlhbGlzaW5nIGhhcyByb29tIHRvIHNtb290aCB0aGUgamFnZ2llcwogICAgcG9zaXRpb24gKz0gdW5pdFZlY3RvckZvckV4dHJ1c2lvbiAvIHVfem9vbTsKICAgIC8vIFRoZXNlIGNvb3JkaW5hdGVzIGFsbG93IHVzIHRvIGluZmVyIHRoZSBkaXN0YW5jZSBmcm9tIHRoZSBlZGdlIG9mIGEgdHJpYW5nbGUKICAgIHZfYmFyeWNlbnRyaWMgPSB2ZWM0KGFfY29yZS54eXosIGFudGlBbGlhc2luZ1RocmVzaG9sZCk7CiAgICB2X2NvcmUgPSB2ZWM0KDEuMCk7CiAgICB2X2xpbmVEYXRhID0gdmVjNCgwLjAsIDAuMCwgMC4wLCBhX2xpbmVUeXBlKTsKICB9IGVsc2UgewogICAgLy8gY2VudHJlIHBvaW50IG9mIHRoZSBhcmMKICAgIHZlYzIgY2VudHJlUG9pbnQgPSBhX3Bvc2l0aW9uOwogICAgZmxvYXQgcmFkaXVzID0gYV9yYWRpdXM7CiAgICBmbG9hdCBzYSA9IGFfc3RhcnRBbmdsZTsKICAgIGZsb2F0IGVhID0gYV9lbmRBbmdsZTsKCiAgICBmbG9hdCBmaW5hbFJhZGl1czsKICAgIHZlYzIgZGlzdGFuY2VWZWN0b3I7CiAgICBmbG9hdCBuZXh0SW5kZXg7CiAgICBmbG9hdCBpbmRleE1pZFBvaW50SW5jcmVtZW50OwoKICAgIGlmKHVfaGl0VGVzdCA9PSAxLjApIHsKICAgICAgLy8gYWRkIDcgc2NyZWVuIHBpeGVscyB0byB0aGUgbGluZSB0aGlja25lc3MKICAgICAgYWFXaWR0aEJ1ZmZlciA9IDcuMCAvIHVfem9vbTsKICAgIH0KCiAgICAvLyBEaXJlY3Rpb24gb2YgdGhlIG5vcm1hbCB2ZWN0b3IsIHRoaXMgdGVsbHMgdXMgd2hldGhlciB3ZSBhcmUgb24gdGhlIG91dGVyIG9yIGlubmVyIGVkZ2Ugb2YKICAgIC8vIHRoZSBhcmMuCiAgICBib29sIG5vcm1hbFBvaW50c1Vwd2FyZCA9IHJvdW5kVG9JbnQoc2lnbihhX2NvcmUucikpID09IDE7CgogICAgLy8gVGhlIGluZGV4IG9mIHRoZSBjdXJyZW50IHNlZ2VtZW50IG9mIHRoZSBhcmMKICAgIGZsb2F0IGluZGV4ID0gYWJzKGFfY29yZS5yKSAtIDEuMDsKICAgIC8vIEhvdyBtdWNoIGVhY2ggc2VnbWVudCBuZWVkcyB0byBjdXJ2ZQogICAgZmxvYXQgYW5nbGVJbmNyZW1lbnQgPSAoYV9lbmRBbmdsZSAtICBhX3N0YXJ0QW5nbGUpIC8gbnVtYmVyT2ZTZWdtZW50czsKCiAgICAvLyBEaXZpZGUgbWluV2lkdGggYnkgcGl4ZWwgZGVuc2l0eSBzbyByZXRpbmEgc2NyZWVuIHJldGFpbiBjb3JyZWN0IHdpZHRoCiAgICBtaW5XaWR0aCAvPSB1X3Jlc29sdXRpb24uejsKICAgIC8vIGluY3JlYXNlIG1pbi13aWR0aCBmb3IgZG90dGVkIGxpbmUgIzI0MjYKICAgIGlmKGlzRG90dGVkTGluZSkgewogICAgICBtaW5XaWR0aCA9IG1heChtaW5XaWR0aCwgc3RlcCgyLjUsIGFfbGluZVR5cGUpICogMi4wKTsKICAgIH0KICAgIC8vIHRoZSB3aWR0aCBvZiB0aGUgbGluZSB0aGF0IHNob3VsZCBiZSB2aXNpYmxlCiAgICBmbG9hdCBsaW5lV2lkdGggPSBtYXgoYV93aWR0aCAqIHVfem9vbSwgbWluV2lkdGgpIC8gdV96b29tOwogICAgLy8gdGhlIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIHNoYXBlIHRoYXQgY29udGFpbnMgdGhlIGxpbmUKICAgIC8vIGV4cGFuZCB0aGUgd2lkdGggb2YgdGhlIGxpbmUgc2xpZ2h0bHkgc28gdGhlcmVzIHJvb20gdG8gc21vb3RoIHRoZSBlZGdlcyAoYW50aS1hbGlhc2luZykKICAgIGZsb2F0IHNoYXBlV2lkdGggPSBsaW5lV2lkdGggKyBhYVdpZHRoQnVmZmVyOwogICAgZmxvYXQgaGFsZlNoYXBlTGluZVdpZHRoID0gc2hhcGVXaWR0aC8yLjA7CiAgICBmbG9hdCBoYWxmTGluZVdpZHRoID0gbGluZVdpZHRoLzIuMDsKICAgIC8vIEdldCB0aGUgaW5kZXggb2YgdGhlIG5leHQgc2VnbWVudCBzbyB0aGF0IHdlIGNhbiBmaXQgdGhlIHRyaWFuZ2xlcyBhcm91bmQgdGhlIGFyYy4KICAgIC8vIElmIHdlIGFyZSBhdCB0aGUgZW5kIG9mIHRoZSBhcmMgdGhlbiB3ZSBuZWVkIHRvIGxvb2sgYXQgdGhlIHByZXZpb3VzIHNlZ21lbnQKICAgIGlmIChpbmRleCA8IG51bWJlck9mU2VnbWVudHMpIHsKICAgICAgaW5kZXhNaWRQb2ludEluY3JlbWVudCA9IDEuMDsKICAgIH0gZWxzZSB7CiAgICAgIGluZGV4TWlkUG9pbnRJbmNyZW1lbnQgPSAtMS4wOwogICAgfQogICAgZmxvYXQgbGluZUxlbmd0aCA9IGFfcmFkaXVzICogKGVhIC0gc2EpOwogICAgLy8gZ2V0IHBvc2l0aW9uIG9mIG1pZGRsZSBwb2ludCBvbiB0aGUgb3V0ZXIgYXJjCiAgICB2ZWMyIG1pZE91dGVyUG9pbnQgPSBnZXROZXh0UG9zaXRpb24oY2VudHJlUG9pbnQsIG1heChyYWRpdXMgKyBoYWxmTGluZVdpZHRoLCAwLjApLCBhX3N0YXJ0QW5nbGUsCiAgICAgIGFuZ2xlSW5jcmVtZW50LCBpbmRleCArIChpbmRleE1pZFBvaW50SW5jcmVtZW50IC8gMi4wKSk7CiAgICBmbG9hdCBoYWxmQW5nbGUgPSBhbmdsZUluY3JlbWVudCAvIDIuMDsKICAgIGZsb2F0IG1pZE91dGVyUG9pbnRMZW5ndGggPSBsZW5ndGgobWlkT3V0ZXJQb2ludC0gY2VudHJlUG9pbnQpOwogICAgZmxvYXQgZGlzdGFuY2VTZWdtZW50T3V0ZXJFZGdlRnJvbUNlbnRyZSA9IG1pZE91dGVyUG9pbnRMZW5ndGggLyBjb3MoaGFsZkFuZ2xlKTsKCiAgICBpZihub3JtYWxQb2ludHNVcHdhcmQpIHsKICAgICAgZmluYWxSYWRpdXMgPSBkaXN0YW5jZVNlZ21lbnRPdXRlckVkZ2VGcm9tQ2VudHJlICsgYWFXaWR0aEJ1ZmZlcjsKICAgIH0gZWxzZSB7CiAgICAgIC8vIEFkZCBleHRyYSBwYWRkaW5nIHRvIHRoZSBpbnNpZGUgb2YgdGhlIGFyYyB3aGVuIHRoZSByYWRpdXMgaXMgbGFyZ2UgdG8gY29tcGVuc2F0ZSBmb3IKICAgICAgLy8gZmxvYXQgcHJlY2lzaW9uIGVycm9ycyAjNjc5NwogICAgICAvLyBJZiByYWRpdXMgPiAxMDAwMDAgdGhlIGdlbmVyYXRvciB1c2VzIGEgc3RyYWlnaHQgbGluZSBhcHByb3hpbWF0aW9uCiAgICAgIGZsb2F0IGJvcmRlclBhZGRpbmdGYWN0b3IgPSBzbW9vdGhzdGVwKDIwMDAwLjAsIDEwMDAwMC4wLCByYWRpdXMpICogMjAuMDsKICAgICAgZmluYWxSYWRpdXMgPSByYWRpdXMgLSBoYWxmU2hhcGVMaW5lV2lkdGggLSBib3JkZXJQYWRkaW5nRmFjdG9yOwogICAgfQogICAgLy8gcGFzcyBsaW5lIHR5cGUgYXMgYSBuZWdhdGl2ZSBzbyB0aGUgZnJhZ21lbnQgc2hhZGVyIGtub3dzIGl0cyBhbiBhcmMKICAgIHZfbGluZURhdGEgPSB2ZWM0KDAuMCwgbGluZVdpZHRoLCBsaW5lTGVuZ3RoLCAtYV9saW5lVHlwZSk7CiAgICBmaW5hbFJhZGl1cyA9IG1heChmaW5hbFJhZGl1cywgMC4wKTsKCiAgICBwb3NpdGlvbiA9IGdldE5leHRQb3NpdGlvbihjZW50cmVQb2ludCwgZmluYWxSYWRpdXMsIHNhLCBhbmdsZUluY3JlbWVudCwgaW5kZXgpOwoKCiAgICBmbG9hdCBwaXhlbFNpemUgPSAoMS4wIC8gbGluZUxlbmd0aCkgLyB1X3pvb207CiAgICBmbG9hdCBsaW5lTGVuZ3RoSW5QaXhlbHMgPSBsaW5lTGVuZ3RoICogdV96b29tOwogICAgLy9Eb3R0ZWQgbGluZXMsIHNvIGNhbGMgdXYgbGVuZ3RoCiAgICBpZiAoaXNEb3R0ZWRMaW5lKSB7CiAgICAgIC8vIGFzIGxpbmVzIGdldCBzbWFsbGVyIGFuZCBzbWFsbGVyIGxpbWl0IHRoZSBudW1iZXIgb2YgZG90cyBzbyB0aGUgc3RpbGwgbG9vayBuaWNlCiAgICAgIGZsb2F0IG1pbmltdW1Eb3RzID0gbGluZUxlbmd0aEluUGl4ZWxzIC8gNC4wOwogICAgICAvLyBieSBkZWZhdWx0IHNldCB0aGUgbnVtYmVyIG9mIGRvdHMgdG8gdGhlIHByb3BvcnRpb24gb2YgdGhlIGxpbmUgbGVuZ3RoIGFuZCBsaW5lIHdpZHRoCiAgICAgIGZsb2F0IG51bWJlckRvdHNCeUxpbmVXaWR0aCA9IGxpbmVMZW5ndGggLyAobGluZVdpZHRoICogMi4wKTsKICAgICAgLy8gY2hvb3NlIHRoZSBzbWFsbGVzdCBudW1iZXIsIGFzIHRoZSBsaW5lIGdldHMgdG9vIHNtYWxsIHJlZHVjaW5nIHRoZSBudW1iZXIgb2YgZG90cwogICAgICAvLyBieSB0aGUgem9vbSBsZXZlbCBoZWxwcyBpdCB0byBzdGF5IHJlYWRhYmxlCiAgICAgIGZsb2F0IG51bU9mRG90cyA9IG1pbihtaW5pbXVtRG90cywgbnVtYmVyRG90c0J5TGluZVdpZHRoKTsKICAgICAgLy8gcm91bmQgdXAgdGhlIG51bWJlciBvZiBkb3RzIHNvIHRoYXQgd2UgYWx3YXlzIGRyYXcgYSB3aG9sZSBkb3QKICAgICAgdl9jb3JlID0gdmVjNChzYSwgY2VpbChudW1PZkRvdHMpLCBwaXhlbFNpemUsIGFfcmFkaXVzKTsKICAgICAgdl9kYXNoaW5nID0gdmVjMyhsaW5lV2lkdGgsIGxpbmVXaWR0aCwgMC41KTsKICAgIH0gZWxzZSBpZiAoaXNEYXNoZWRMaW5lKSB7CiAgICAgIC8vIGxlbmd0aCBvZiB0aGUgZGFzaCB3aXRoIGFkanVzdG1lbnRzIGlmIHRoZSBkYXNoIGxlbmd0aCBpcyBsZXNzIHRoYW4gMiBzY3JlZW4gcGl4ZWxzCiAgICAgIGZsb2F0IGRhc2hMZW5ndGggPSBtYXgoMi4wIC8gdV96b29tLCBsaW5lV2lkdGggKiAyLjApOwogICAgICAvLyB0aGUgbnVtYmVyIG9mIGRhc2hlcyB3ZSdyZSBhaW1pbmcgZm9yCiAgICAgIGZsb2F0IGRhc2hlcyA9IGdldE51bWJlck9mRGFzaGVzKGRhc2hMZW5ndGgsIGxpbmVMZW5ndGgpOwogICAgICAvLyBXZSB3YW50IHRvIHN0YXJ0IGFuZCBlbmQgb24gYSBkYXNoIHdpdGhvdXQgYWx0ZXJpbmcgdGhlIGxlbmd0aCBvZiB0aGUgZGFzaCBzbyBpbnN0ZWFkIHdlCiAgICAgIC8vIG5lZWQgdG8gYWx0ZXIgdGhlIGdhcCBsZW5ndGguICBUaGlzIHdpbGwgdGVsbCB1cyBob3cgbG9uZyBhIGdhcCB3ZSB3aWxsIG5lZWQuCiAgICAgIGZsb2F0IGdhcFdpZHRoID0gKGxpbmVMZW5ndGggLSBkYXNoTGVuZ3RoICogZGFzaGVzKSAvIChkYXNoZXMgLSAxLjApOwogICAgICAvLyB0byBlbmQgb24gYSBkYXNoIHdlIG5lZWQgdG8gcmVtb3ZlIGEgZ2FwcyBsZW5ndGggZnJvbSB0aGUgZW5kCiAgICAgIGZsb2F0IGdhcE92ZXJQZXJpb2QgPSBnYXBXaWR0aCAqIGRhc2hlcyAvIChsaW5lTGVuZ3RoICsgZ2FwV2lkdGgpOwogICAgICAvLyBwYXNzIHRoZSBzdGFydCBhbmdsZSBhbmQgdGhlIG51bWJlciBvZiBkYXNoZXMgbWludXMgdGhlIGxlbmd0aCBvZiBhIGdhcAogICAgICB2X2NvcmUgPSB2ZWM0KHNhLCBkYXNoZXMgLSBnYXBPdmVyUGVyaW9kLCBwaXhlbFNpemUsIGFfcmFkaXVzKTsKICAgICAgZmxvYXQgZGFzaEFkanVzdG1lbnQgPSAoZGFzaExlbmd0aCAvIChkYXNoTGVuZ3RoICsgZ2FwV2lkdGgpKSAvIDIuMDsKICAgICAgdl9kYXNoaW5nID0gdmVjMyhkYXNoTGVuZ3RoLCBnYXBXaWR0aCwgZGFzaEFkanVzdG1lbnQpOwogICAgfSBlbHNlIHsKICAgICAgLy8gcG9zaXRpb24gYWxvbmcgdGhlIGFyYwogICAgICB2X2NvcmUgPSB2ZWM0KHNhLCBpbmRleCAvIG51bWJlck9mU2VnbWVudHMsIHBpeGVsU2l6ZSwgYV9yYWRpdXMpOwogICAgfQogICAgLy8gdGhlIHBvc2l0aW9uIGluIHdvcmxkIGNvb3JkcyBvZiB0aGUgdmVydGV4IGFuZCB0aGUgY2VudHJlIHBvaW50IG9mIHRoZSBhcmMKICAgIHZfcG9zaXRpb24gPSB2ZWM0KHBvc2l0aW9uLCBjZW50cmVQb2ludCk7CiAgfQoKICAvKgogICBjb252ZXJ0IHRvIGNsaXBzcGFjZSAoLTEgLT4gMSkKICAqLwogIC8vIGNvbnZlcnQgdGhlIHJlY3RhbmdsZSBmcm9tIHBpeGVscyB0byAwLjAgdG8gMS4wCiAgdmVjMiB6ZXJvVG9PbmUgPSBwb3NpdGlvbiAvIHVfcmVzb2x1dGlvbi54eTsKCiAgLy8gY29udmVydCBmcm9tIDAtPjEgdG8gMC0+MgogIHZlYzIgemVyb1RvVHdvID0gemVyb1RvT25lICogMi4wOwoKICAvLyBjb252ZXJ0IGZyb20gMC0+MiB0byAtMS0+KzEgKGNsaXBzcGFjZSkKICB2ZWMyIGNsaXBTcGFjZSA9IHplcm9Ub1R3byAtIDEuMDsKCiAgLyoKICBBc3NpZ24gVmFyeWluZ3MKICAqLwogIHZlYzQgcGl4ZWxDb2xvdXIgPSBhX2NvbG91cjsKICAvLyBub3JtYWxpc2UgY29sb3VyIHZhbHVlcwogIHBpeGVsQ29sb3VyIC89IDI1NS4wOwogIHZfY29sb3VyID0gcGl4ZWxDb2xvdXI7CgogIHZlYzQgcGl4ZWxDb2xvdXIyID0gYV9jb2xvdXIyOwogIC8vIG5vcm1hbGlzZSBjb2xvdXIgdmFsdWVzCiAgcGl4ZWxDb2xvdXIyIC89IDI1NS4wOwogIHZfY29sb3VyMiA9IHBpeGVsQ29sb3VyMjsKCgogIHZfaGl0VGVzdENvbG91ciA9IGFfaGl0VGVzdENvbG91cjsKICAvKgogIEFzc2lnbiBmaW5hbCB2ZXJ0ZXggcG9zaXRpb24gYW5kIGFwcGx5IHRyYW5zZm9ybXMgZm9yIHpvb20vcGFuCiAgKi8KICBnbF9Qb3NpdGlvbiA9IHVfdHJhbnNmb3JtICogdmVjNChjbGlwU3BhY2UgKiB2ZWMyKDEsIC0xKSwgMCwgMSk7Cn0K",Co="I2lmZGVmIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcwojZXh0ZW5zaW9uIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA6IGVuYWJsZQojZW5kaWYKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwoKdW5pZm9ybSBmbG9hdCB1X2hpdFRlc3Q7CnVuaWZvcm0gZmxvYXQgdV9zaGFkb3dUeXBlOwp1bmlmb3JtIGZsb2F0IHVfem9vbTsKdW5pZm9ybSBmbG9hdCB1X2dyYWRpZW50U3RhcnRGcmFjdGlvbjsKCnZhcnlpbmcgdmVjNCB2X2NvbG91cjsKdmFyeWluZyB2ZWM0IHZfY29sb3VyMjsKdmFyeWluZyB2ZWMzIHZfaGl0VGVzdENvbG91cjsKdmFyeWluZyB2ZWM0IHZfY29yZTsKdmFyeWluZyB2ZWM0IHZfbGluZURhdGE7CnZhcnlpbmcgdmVjNCB2X2JhcnljZW50cmljOwp2YXJ5aW5nIHZlYzQgdl9wb3NpdGlvbjsKdmFyeWluZyB2ZWMzIHZfZGFzaGluZzsKCmludCBMSU5FX1RZUEVfREFTSCA9IDI7CmludCBMSU5FX1RZUEVfRE9UID0gMzsKaW50IExJTkVfVFlQRV9BUlJPV0hFQUQgPSA0OwoKZmxvYXQgUEkgPSAzLjE0MTU5MjY1MzU5OwpmbG9hdCBzcXJ0T2ZIYWxmID0gMC43MDcxMDY3ODExODY1NDc1NzsKLy8gUGVyZm9ybWFuY2UgYW50aWFsaWFzaW5nIHVzaW5nIHN0YW5kYXJkIGRlcml2YXRpdmVzCi8vIFNtb290aHMgdGhlIGZyYWdtZW50IG92ZXIgMSBwaXhlbCB3aGVuIHZhbHVlIGlzIG1vcmUgdGhhbiB0aHJlc2hvbGQKLy8gZXNlbnRpYWxseSBhIGJldHRlciB2ZXJzaW9uIG9mIHN0ZXAgYW5kIHNtb290aHN0ZXAKZmxvYXQgYWFzdGVwKGZsb2F0IHRocmVzaG9sZCwgZmxvYXQgdmFsdWUpIHsKICBmbG9hdCBhZndpZHRoID0gbGVuZ3RoKHZlYzIoZEZkeCh2YWx1ZSksIGRGZHkodmFsdWUpKSkgKiBzcXJ0T2ZIYWxmOwogIHJldHVybiBzbW9vdGhzdGVwKHRocmVzaG9sZC1hZndpZHRoLCB0aHJlc2hvbGQrYWZ3aWR0aCwgdmFsdWUpOwp9CgovLyAvIGVuc3VyZSByYW5nZSBjYW4ndCBiZSB6ZXJvCmZsb2F0IG1pbkFsbG93YWJsZVJhbmdlID0gMC4wMDAxOwoKLy8gTGluZWFybHkgaW50ZXJwb2xhdGUgYmV0d2VlbiB0aGUgc3BlY2lmaWVkIHJhbmdlCi8vIFRoaXMgaXMgYSBsaW5lYXIgZXF1aXZhbGVudCBvZiBzbW9vdGhzdGVwICh3aGVyZWFzIHNtb290aHN0ZXAgaXMgZWFzZWQpCmZsb2F0IGxpbmVhcnN0ZXAoZmxvYXQgbWluUmFuZ2UsIGZsb2F0IG1heFJhbmdlLCBmbG9hdCB2YWx1ZSkgewogIGZsb2F0IHN0YXJ0ID0gbWF4KHZhbHVlIC0gbWluUmFuZ2UsIDAuMCk7CiAgZmxvYXQgcmFuZ2UgPSBtYXgobWluQWxsb3dhYmxlUmFuZ2UsIG1heFJhbmdlIC0gbWluUmFuZ2UpOwogIHJldHVybiBtaW4oMS4wLCBzdGFydCAvIHJhbmdlKTsKfQoKLy8gZGlzdGFuY2UgdG8gZWRnZSBmcm9tIGEgdHJpYW5nbGUsIHVzZWQgZm9yIHNtb290aGluZyBlZGdlcyBvZiBhcnJvd2hlYWRzCmZsb2F0IGVkZ2VGYWN0b3IodmVjMyBiYXJ5Y2VudHJpY0Nvb3JkcykgewogIHZlYzMgZCA9IGZ3aWR0aChiYXJ5Y2VudHJpY0Nvb3Jkcyk7CiAgdmVjMyBhMyA9IHNtb290aHN0ZXAodmVjMygwLjApLCBkICogMi4wLCBiYXJ5Y2VudHJpY0Nvb3Jkcyk7CiAgcmV0dXJuIG1pbihtaW4oYTMueCwgYTMueSksIGEzLnopOwp9CgppbnQgcm91bmRUb0ludChmbG9hdCBhKSB7CiAgcmV0dXJuIGludChmbG9vcihhICsgMC41KSk7Cn0KCnZlYzQgZ3JhZGllbnRDb2xvdXIoZmxvYXQgbm9ybWFsaXNlZERpc3RhbmNlRmFjdG9yKSB7CiAgZmxvYXQgZ3JhZGllbnRWYWx1ZSA9IGxpbmVhcnN0ZXAodV9ncmFkaWVudFN0YXJ0RnJhY3Rpb24sIDEuMCAtIHVfZ3JhZGllbnRTdGFydEZyYWN0aW9uLCAgbm9ybWFsaXNlZERpc3RhbmNlRmFjdG9yKTsKICB2ZWMzIGNvbG91ciA9IG1peCh2X2NvbG91ci5yZ2IsIHZfY29sb3VyMi5yZ2IsIGdyYWRpZW50VmFsdWUpOwogIGZsb2F0IGFscGhhID0gbWl4KHZfY29sb3VyLmEsIHZfY29sb3VyMi5hLCBncmFkaWVudFZhbHVlKTsKCiAgLy8gTXVsdGlwbHkgY29sb3VyIGJ5IHRoZSBhbHBoYSwgdGhpcyBpcyBiZWNhdXNlIGluIHRoZSByZWFsIHdvcmxkIHdoZW4gbGlnaHQgcGFzc2VzIHRocm91Z2gKICAvLyBhbiBvYmplY3QgaXQgZ2V0cyB3ZWFrZXIgYXMgbGlnaHQgaXMgYWJzb3JiZWQuICBXZSBuZWVkIHRvIGRvIHRoZSBzYW1lLgogIHJldHVybiB2ZWM0KGNvbG91ciAqIGFscGhhLCBhbHBoYSk7Cn0KCi8vIHNtb290aCB0aGUgZWRnZSBvZiB0aGUgbGluZQp2ZWM0IGFudGlhbGlhc0xpbmVFZGdlKHZlYzQgY29sb3VyKSB7CiAgLy8gUmVhbCBsaW5lIHdpZHRoCiAgZmxvYXQgbGluZVdpZHRoID0gdl9saW5lRGF0YS55OwogIC8vIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIHNoYXBlCiAgZmxvYXQgc2hhcGVXaWR0aCA9IHZfbGluZURhdGEueCAvIDIuMDsKICAvLyB0aGUgd2lkdGggb2YgdGhlIGxpbmUgYXdheSBmcm9tIHRoZSBjZW50cmUgaW4gc2NyZWVucGl4ZWxzCiAgZmxvYXQgdGhyZXNob2xkID0gKGxpbmVXaWR0aCAvIDIuMCkgKiB1X3pvb207CiAgLy8gdGhlIGRpc3RhbmNlIGZyb20gdGhlIGNlbnRyZSBvZiB0aGUgbGluZSBpbiBzY3JlZW5waXhlbHMKICBmbG9hdCBwb3NpdGlvbiA9IGFicyhzaGFwZVdpZHRoKSAqIHVfem9vbTsKICAvLyBzbW9vdGggdGhlIGVkZ2UKICBjb2xvdXIgKj0gMS4wIC0gc21vb3Roc3RlcCh0aHJlc2hvbGQgLSBzcXJ0T2ZIYWxmLCB0aHJlc2hvbGQgKyBzcXJ0T2ZIYWxmLCBwb3NpdGlvbik7CiAgcmV0dXJuIGNvbG91cjsKfQoKLyoqCiAqIEdldCB0aGUgZGlzdGFuY2UgYWxvbmcgdGhlIGxpbmUgaW4gcmFkaWFucwogKi8KZmxvYXQgZGlzdGFuY2VJblJhZGlhbnMoZmxvYXQgcG9zaXRpb24sIGZsb2F0IGZ1bGxMZW5ndGgsIGZsb2F0IGxlbmd0aEluUmFkaWFucykgewogIHJldHVybiAocG9zaXRpb24gLyBmdWxsTGVuZ3RoKSAqIGxlbmd0aEluUmFkaWFuczsKfQoKLyoqCiogZHJhd0xpbmUgLSBGaWxscyBpbiB0aGUgY29sb3VyIGZvciBzdHJhaWdodCBsaW5lcwoqCiovCnZlYzQgZHJhd0xpbmUoYm9vbCBpc0Rhc2hlZE9yRG90dGVkLCBib29sIGlzRGFzaGVkTGluZSwgYm9vbCBpc0RvdHRlZExpbmUpIHsKICAvLyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgY2VudHJlIHRvIHRoZSBvdXRlciB2ZXJ0ZXgKICBmbG9hdCBzaGFwZVdpZHRoID0gdl9saW5lRGF0YS54IC8gMi4wOwogIC8vIHRoZSB2aXNpYmxlIHdpZHRoIG9mIHRoZSBsaW5lCiAgZmxvYXQgbGluZVdpZHRoID0gdl9saW5lRGF0YS55OwogIC8vIHNpemUgb2YgYSBwaXhlbCBpbiBzY3JlZW4gc3BhY2UKICBmbG9hdCBwaXhlbCA9IHZfY29yZS56OwogIC8vIG5vcm1hbGlzZWQgMC0+MQogIGZsb2F0IGRpc3RhbmNlQWxvbmdMaW5lID0gdl9jb3JlLng7CiAgZmxvYXQgbnVtYmVyT2ZEYXNoZXNPckRvdHMgPSB2X2NvcmUueTsKICAvLyBsZW5ndGggb2YgdGhlIGxpbmUgaW4gd29ybGQgcGl4ZWxzCiAgZmxvYXQgbGluZUxlbmd0aCA9IHZfbGluZURhdGEuejsKICBmbG9hdCBoYWxmTGluZVdpZHRoID0gbGluZVdpZHRoIC8gMi4wOwogIGZsb2F0IGRhc2hMZW5ndGggPSB2X2Rhc2hpbmcueDsKICBmbG9hdCBkYXNoQWRqdXN0bWVudCA9IHZfZGFzaGluZy56OwoKICB2ZWM0IHBpeGVsQ29sb3VyID0gZ3JhZGllbnRDb2xvdXIoZGlzdGFuY2VBbG9uZ0xpbmUpOwoKICBpZiAoaXNEYXNoZWRPckRvdHRlZCkgewogICAgZmxvYXQgZGlzdGFuY2VBbG9uZ0RvdHMgPSBkaXN0YW5jZUFsb25nTGluZSAqIG51bWJlck9mRGFzaGVzT3JEb3RzOwogICAgdmVjMiBwb3NpdGlvbkluTGluZUluV29ybGRDb29yZHMgPSB2ZWMyKGRpc3RhbmNlQWxvbmdMaW5lICogbGluZUxlbmd0aCwgc2hhcGVXaWR0aCk7CiAgICBmbG9hdCBkaXN0YW5jZVRvTmV4dFBvaW50ID0gZnJhY3QoZGlzdGFuY2VBbG9uZ0RvdHMpIC0gZGFzaEFkanVzdG1lbnQ7CiAgICAvLyBpZiB3ZSBhcmUgY2xvc2VyIHRvIHRoZSBuZXh0IHBvaW50IHRoYW4gdGhlIHByZXZpb3VzIG9uZSB0aGVuIHJvdW5kIHVwCiAgICBmbG9hdCBuZXh0UG9pbnRJc0luRnJvbnQgPSBmbG9vcihkaXN0YW5jZVRvTmV4dFBvaW50ICsgMC41KTsKICAgIGZsb2F0IG5lYXJlc3REb3QgPSBkaXN0YW5jZUFsb25nRG90cyAtIGRpc3RhbmNlVG9OZXh0UG9pbnQgKyBuZXh0UG9pbnRJc0luRnJvbnQ7CiAgICB2ZWMyIG5lYXJlc3RQb2ludCA9IHZlYzIoKG5lYXJlc3REb3QgLyBudW1iZXJPZkRhc2hlc09yRG90cykgKiBsaW5lTGVuZ3RoLCAwLjApOwoKICAgIGZsb2F0IHdpZHRoT2ZEYXNoT3JEb3QgPSBoYWxmTGluZVdpZHRoOwogICAgaWYgKGlzRGFzaGVkTGluZSkgewogICAgICAvLyBvbmx5IGNvbXBhcmUgZnJvbSB0aGUgY2VudHJlIHBvaW50LCB0aGlzIHdpbGwgZW5zdXJlIGl0IGNyZWF0ZXMgcmVjdGFuZ3VsYXIgZGFzaGVzCiAgICAgIHBvc2l0aW9uSW5MaW5lSW5Xb3JsZENvb3Jkcy55ID0gMC4wOwogICAgICB3aWR0aE9mRGFzaE9yRG90ID0gZGFzaExlbmd0aCAvIDIuMDsKICAgICAgcGl4ZWxDb2xvdXIgPSBhbnRpYWxpYXNMaW5lRWRnZShwaXhlbENvbG91cik7CiAgICB9CiAgICBmbG9hdCBkaXN0ID0gZGlzdGFuY2UocG9zaXRpb25JbkxpbmVJbldvcmxkQ29vcmRzLCBuZWFyZXN0UG9pbnQpOwogICAgcGl4ZWxDb2xvdXIgKj0gMS4wIC0gYWFzdGVwKHdpZHRoT2ZEYXNoT3JEb3QsIGRpc3QpOwoKICB9IGVsc2UgewogICAgcGl4ZWxDb2xvdXIgPSBhbnRpYWxpYXNMaW5lRWRnZShwaXhlbENvbG91cik7CiAgICAvLyBzbW9vdGggb3V0IHRoZSBsaW5lIGVuZHMKICAgIHBpeGVsQ29sb3VyICo9IGFhc3RlcChwaXhlbCwgdl9jb3JlLngpOwogICAgcGl4ZWxDb2xvdXIgKj0gMS4wIC0gYWFzdGVwKDEuMCAtIHBpeGVsLCB2X2NvcmUueCk7CiAgfQogIHJldHVybiBwaXhlbENvbG91cjsKfQoKLyoqCiogZHJhd0FyYyAtIEZpbGxzIGluIHRoZSBjb2xvdXIgZm9yIGN1cnZlZCBsaW5lcwoqCiovCnZlYzQgZHJhd0FyYyhib29sIGlzRGFzaGVkT3JEb3R0ZWQsIGJvb2wgaXNEYXNoZWRMaW5lLCBib29sIGlzRG90dGVkTGluZSkgewogIGZsb2F0IGxpbmVXaWR0aCA9IHZfbGluZURhdGEueTsKICBmbG9hdCBudW1iZXJPZkRhc2hlc09yRG90cyA9IHZfY29yZS55OwogIGZsb2F0IHBpeGVsID0gdl9jb3JlLno7CiAgZmxvYXQgbGluZUxlbmd0aCA9IHZfbGluZURhdGEuejsKICBmbG9hdCBoYWxmTGluZVdpZHRoID0gbGluZVdpZHRoIC8gMi4wOwogIGZsb2F0IGFyY1JhZGl1cyA9IHZfY29yZS5hOwogIGZsb2F0IGxlbmd0aE9mQXJjSW5SYWRpYW5zID0gbGluZUxlbmd0aCAvIGFyY1JhZGl1czsKICB2ZWMyIHBvc2l0aW9uID0gdl9wb3NpdGlvbi54eTsKICB2ZWMyIGNpcmNsZUNlbnRyZSA9IHZfcG9zaXRpb24uenc7CiAgZmxvYXQgZGlzdEZyb21DZW50cmUgPSBkaXN0YW5jZShwb3NpdGlvbiwgY2lyY2xlQ2VudHJlKTsKICBmbG9hdCBhbmdsZUFyb3VuZFRoZUNpcmNsZSA9IGF0YW4ocG9zaXRpb24ueSAtIGNpcmNsZUNlbnRyZS55LCBwb3NpdGlvbi54IC0gY2lyY2xlQ2VudHJlLngpOwogIC8vIGRlYWwgd2l0aCB0YW5nZW50IGZsaXAgcG9pbnQgd2hlcmUgYXRhbjIgY2hhbmdlcyBmcm9tIC1waSB0byArcGkKICBpZiAoYW5nbGVBcm91bmRUaGVDaXJjbGUgPCB2X2NvcmUueCkgewogICAgYW5nbGVBcm91bmRUaGVDaXJjbGUgKz0gMi4wICogUEk7CiAgfQogIGZsb2F0IG5vcm1hbGlzZWRTYSA9IHZfY29yZS54OwogIGZsb2F0IGRpc3RhbmNlQXJvdW5kQXJjID0gKGFuZ2xlQXJvdW5kVGhlQ2lyY2xlIC0gbm9ybWFsaXNlZFNhKSAvIChsZW5ndGhPZkFyY0luUmFkaWFucyk7CiAgdmVjNCBwaXhlbENvbG91ciA9IGdyYWRpZW50Q29sb3VyKGRpc3RhbmNlQXJvdW5kQXJjKTsKCiAgaWYgKGlzRGFzaGVkT3JEb3R0ZWQpIHsKICAgIGZsb2F0IGRhc2hMZW5ndGggPSB2X2Rhc2hpbmcueDsKICAgIGZsb2F0IGRhc2hBZGp1c3RtZW50ID0gdl9kYXNoaW5nLno7CiAgICBmbG9hdCBudW1iZXJPZkRhc2hlc09yRG90cyA9IHZfY29yZS55OwogICAgZmxvYXQgZGlzdGFuY2VBbG9uZ1BvaW50cyA9IGRpc3RhbmNlQXJvdW5kQXJjICogbnVtYmVyT2ZEYXNoZXNPckRvdHM7CiAgICB2ZWMyIHBvc2l0aW9uSW5MaW5lSW5QaXhlbHMgPSBwb3NpdGlvbjsKICAgIGZsb2F0IGRpc3RhbmNlVG9OZXh0UG9pbnQgPSBmcmFjdChkaXN0YW5jZUFsb25nUG9pbnRzKSAtIGRhc2hBZGp1c3RtZW50OwogICAgLy8gaWYgd2UgYXJlIGNsb3NlciB0byB0aGUgbmV4dCBwb2ludCB0aGFuIHRoZSBwcmV2aW91cyBvbmUgdGhlbiByb3VuZCB1cAogICAgZmxvYXQgbmV4dFBvaW50SXNJbkZyb250ID0gZmxvb3IoZGlzdGFuY2VUb05leHRQb2ludCArIDAuNSk7CiAgICBmbG9hdCBuZWFyZXN0UG9pbnQgPSBkaXN0YW5jZUFsb25nUG9pbnRzIC0gZGlzdGFuY2VUb05leHRQb2ludCArIG5leHRQb2ludElzSW5Gcm9udCA7CiAgICBmbG9hdCBuZWFyZXN0UG9pbnRJblJhZGlhbnMgPSBkaXN0YW5jZUluUmFkaWFucyhuZWFyZXN0UG9pbnQsIG51bWJlck9mRGFzaGVzT3JEb3RzLCBsZW5ndGhPZkFyY0luUmFkaWFucykgKyBub3JtYWxpc2VkU2E7CgogICAgLy8gZG90dGVkIGxpbmVzCiAgICBpZiAoaXNEb3R0ZWRMaW5lKSB7CiAgICAgIHZlYzIgbmVhcmVzdFBvaW50ID0gdmVjMigKICAgICAgICBjaXJjbGVDZW50cmUueCArIChhcmNSYWRpdXMgKiBjb3MobmVhcmVzdFBvaW50SW5SYWRpYW5zKSksCiAgICAgICAgY2lyY2xlQ2VudHJlLnkgKyAoYXJjUmFkaXVzICogc2luKG5lYXJlc3RQb2ludEluUmFkaWFucykpCiAgICAgICk7CiAgICAgIGZsb2F0IGRpc3QgPSBkaXN0YW5jZShwb3NpdGlvbkluTGluZUluUGl4ZWxzLCBuZWFyZXN0UG9pbnQpOwogICAgICBmbG9hdCByYWRpdXMgPSBoYWxmTGluZVdpZHRoOwogICAgICBwaXhlbENvbG91ciAqPSAxLjAgLSBhYXN0ZXAocmFkaXVzLCBkaXN0KTsKICAgIC8vIGRhc2hlcwogICAgfSBlbHNlIHsKICAgICAgZmxvYXQgZGlzdFRvRGFzaCA9IGRpc3RhbmNlKGFuZ2xlQXJvdW5kVGhlQ2lyY2xlLCBuZWFyZXN0UG9pbnRJblJhZGlhbnMpOwogICAgICBmbG9hdCByYWRpdXMgPSBkaXN0YW5jZUluUmFkaWFucyhkYXNoTGVuZ3RoLzIuMCwgbGluZUxlbmd0aCwgbGVuZ3RoT2ZBcmNJblJhZGlhbnMpOwogICAgICBwaXhlbENvbG91ciAqPSAxLjAgLSBhYXN0ZXAocmFkaXVzLCBkaXN0VG9EYXNoKTsKICAgICAgcGl4ZWxDb2xvdXIgKj0gYWFzdGVwKGFyY1JhZGl1cyAsIGRpc3RGcm9tQ2VudHJlICsgaGFsZkxpbmVXaWR0aCk7CiAgICAgIHBpeGVsQ29sb3VyICo9IDEuMCAtIGFhc3RlcChhcmNSYWRpdXMgKyBoYWxmTGluZVdpZHRoLCBkaXN0RnJvbUNlbnRyZSk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGZsb2F0IGRpc3RhbmNlQWxvbmdBcmMgPSB2X2NvcmUueTsKICAgIHBpeGVsQ29sb3VyICo9IGFhc3RlcChhcmNSYWRpdXMgLCBkaXN0RnJvbUNlbnRyZSArIGhhbGZMaW5lV2lkdGgpOwogICAgcGl4ZWxDb2xvdXIgKj0gMS4wIC0gYWFzdGVwKGFyY1JhZGl1cyArIGhhbGZMaW5lV2lkdGgsIGRpc3RGcm9tQ2VudHJlKTsKICAgIC8vIHNtb290aCBvdXQgdGhlIGxpbmUgZW5kcwogICAgcGl4ZWxDb2xvdXIgKj0gYWFzdGVwKHBpeGVsLCBkaXN0YW5jZUFsb25nQXJjKTsKICAgIHBpeGVsQ29sb3VyICo9IDEuMCAtIGFhc3RlcCgxLjAgLSBwaXhlbCwgZGlzdGFuY2VBbG9uZ0FyYyk7CiAgfQogIHJldHVybiBwaXhlbENvbG91cjsKfQoKLyoqCioKKiBtYWluIC0gc2V0cyB1cCBhbmQgY2hvb3NlcyB0aGUgY29ycmVjdCBzaGFkZXIgY29kZSB0byBydW4gZGVwZW5kaW5nIG9uIHRoZSBwcmltaXRpdmUgdHlwZSBhbmQgc3R5bGUKKgoqLwp2b2lkIG1haW4oKSB7CiAgaW50IHNoYWRvd1R5cGUgPSBpbnQodV9zaGFkb3dUeXBlKTsKICBmbG9hdCBsaW5lVHlwZUYgPSBhYnModl9saW5lRGF0YS53KTsKICBpbnQgbGluZVR5cGUgPSByb3VuZFRvSW50KGxpbmVUeXBlRik7CiAgLy8gZGlzYWJsZSBhYSB3aGVuIHR5cGUgPT0gMQogIGJvb2wgaXNBcmMgPSBzaWduKHZfbGluZURhdGEudykgPCAwLjA7CiAgLy8gRm9yIHNvbWUgcmVhc29uLCBjb21wYXJpbmcgdHdvIGJvb2xlYW5zIGhhcyBhIGh1Z2UgaW1wYWN0IG9uIHBlcmZvcm1hbmNlCiAgYm9vbCBpc0Rhc2hlZE9yRG90dGVkID0gbGluZVR5cGVGID4gMS41OwogIGJvb2wgaXNEYXNoZWRMaW5lID0gbGluZVR5cGUgPT0gTElORV9UWVBFX0RBU0g7CiAgYm9vbCBpc0RvdHRlZExpbmUgPSBsaW5lVHlwZSA9PSBMSU5FX1RZUEVfRE9UOwogIGJvb2wgaXNBcnJvd2hlYWQgPSBsaW5lVHlwZSA+PSBMSU5FX1RZUEVfQVJST1dIRUFEOwogIGJvb2wgZXhjbHVkZUZyb21TaGFkb3cgPSBzaGFkb3dUeXBlID09IC0xOwogIGJvb2wgb25seU9uU2hhZG93ID0gc2hhZG93VHlwZSA9PSAxOwogIGlmICh1X2hpdFRlc3QgPiAwLjUpIHsKICAgIC8vIEV4Y2x1ZGUgZnJvbSBzaGFkb3cKICAgIGlmKGV4Y2x1ZGVGcm9tU2hhZG93KSB7CiAgICAgIGRpc2NhcmQ7CiAgICB9IGVsc2UgewogICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KHZfaGl0VGVzdENvbG91ciAvIDI1NS4wLCAxLjApOwogICAgfQogIC8vIHNob3cgb25seSBvbiBzaGFkb3cKICB9IGVsc2UgaWYgKG9ubHlPblNoYWRvdykgewogICAgZGlzY2FyZDsKICB9IGVsc2UgewogICAgdmVjNCBwaXhlbENvbG91cjsKICAgIGlmIChpc0Fycm93aGVhZCkgewogICAgICAvLyBNdWx0aXBseSBjb2xvdXIgYnkgdGhlIGFscGhhLCB0aGlzIGlzIGJlY2F1c2UgaW4gdGhlIHJlYWwgd29ybGQgd2hlbiBsaWdodCBwYXNzZXMgdGhyb3VnaAogICAgICAvLyBhbiBvYmplY3QgaXQgZ2V0cyB3ZWFrZXIgYXMgbGlnaHQgaXMgYWJzb3JiZWQuICBXZSBuZWVkIHRvIGRvIHRoZSBzYW1lLgogICAgICBwaXhlbENvbG91ciA9IHZlYzQodl9jb2xvdXIucmdiICogdl9jb2xvdXIuYSwgdl9jb2xvdXIuYSk7CgogICAgICAvLyBTbW9vdGggdGhlIGVkZ2VzIG9mIHRoZSB0cmlhbmdsZSB1c2luZyB0aGUgYmFyeWNlbnRyaWMgY29vcmRpbmF0ZXMgdG8gbWVhc3VyZSB0aGUgZGlzdGFuY2UKICAgICAgLy8gdG8gZWFjaCBlZGdlCiAgICAgIHBpeGVsQ29sb3VyICo9IGFhc3RlcCh2X2JhcnljZW50cmljLmEsIGVkZ2VGYWN0b3Iodl9iYXJ5Y2VudHJpYy5yZ2IpKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChpc0FyYykgewogICAgICAgIHBpeGVsQ29sb3VyID0gZHJhd0FyYyhpc0Rhc2hlZE9yRG90dGVkLCBpc0Rhc2hlZExpbmUsIGlzRG90dGVkTGluZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGl4ZWxDb2xvdXIgPSBkcmF3TGluZShpc0Rhc2hlZE9yRG90dGVkLCBpc0Rhc2hlZExpbmUsIGlzRG90dGVkTGluZSk7CiAgICAgIH0KICAgIH0KICAgIC8vIGFzc2lnbiB0aGUgZmluYWwgY29sb3VyIHRvIHRoZSBmcmFnbWVudAogICAgZ2xfRnJhZ0NvbG9yID0gcGl4ZWxDb2xvdXI7CiAgICAvLyB1bmNvbW1lbnQgdGhpcyBsaW5lIHRvIGRlYnVnIGxpbmUgc2hhcGUKICAgIC8vZ2xfRnJhZ0NvbG9yID0gdmVjNChwaXhlbENvbG91ci5hLHBpeGVsQ29sb3VyLmEsMC4wLDEuMCk7CiAgfQp9Cg==",xo="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwphdHRyaWJ1dGUgdmVjMiBhX3Bvc2l0aW9uMTsKYXR0cmlidXRlIHZlYzIgYV9wb3NpdGlvbjI7CmF0dHJpYnV0ZSB2ZWMyIGFfcG9zaXRpb24zOwphdHRyaWJ1dGUgdmVjNCBhX3ZlcnRleEluZm87CmF0dHJpYnV0ZSB2ZWM0IGFfY29sb3VyOwphdHRyaWJ1dGUgdmVjNCBhX2NvbG91cjI7CmF0dHJpYnV0ZSB2ZWMzIGFfaGl0VGVzdENvbG91cjsKYXR0cmlidXRlIGZsb2F0IGFfaW5kZXg7Cgp1bmlmb3JtIGZsb2F0IHVfaGl0VGVzdDsKdW5pZm9ybSB2ZWMzIHVfcmVzb2x1dGlvbjsKdW5pZm9ybSBtYXQ0IHVfdHJhbnNmb3JtOwp1bmlmb3JtIGZsb2F0IHVfem9vbTsKdW5pZm9ybSBmbG9hdCB1X3ZpZXdJbmRlcGVuZGVudDsKCnZhcnlpbmcgdmVjNCB2X2NvbG91cjsKdmFyeWluZyB2ZWM0IHZfY29sb3VyMjsKdmFyeWluZyB2ZWM0IHZfY29yZTsKdmFyeWluZyB2ZWMzIHZfaGl0VGVzdENvbG91cjsKdmFyeWluZyB2ZWM0IHZfbGluZURhdGE7CnZhcnlpbmcgdmVjNCB2X2JhcnljZW50cmljOwp2YXJ5aW5nIHZlYzQgdl9wb3NpdGlvbjsKdmFyeWluZyB2ZWMzIHZfZGFzaGluZzsKCmludCBMSU5FX1RZUEVfREFTSCA9IDI7CmludCBMSU5FX1RZUEVfRE9UID0gMzsKaW50IExJTkVfVFlQRV9BUlJPV0hFQUQgPSA0OwoKaW50IHJvdW5kVG9JbnQoZmxvYXQgYSkgewogIHJldHVybiBpbnQoZmxvb3IoYSArIDAuNSkpOwp9CgpmbG9hdCBnZXROdW1iZXJPZkRhc2hlcyhmbG9hdCBkYXNoTGVuZ3RoLCBmbG9hdCBsZW5ndGhPZkFyYykgewogIGZsb2F0IGdhcFdpZHRoID0gZGFzaExlbmd0aCAvIDIuMDsKICBmbG9hdCBudW1PZkRhc2hlcyA9IGZsb29yKCgobGVuZ3RoT2ZBcmMgKyBnYXBXaWR0aCkgLyAoZGFzaExlbmd0aCArIGdhcFdpZHRoKSkgKyAwLjUpOwogIGlmICgobnVtT2ZEYXNoZXMgKiBkYXNoTGVuZ3RoKSA+IGxlbmd0aE9mQXJjKSB7CiAgICBudW1PZkRhc2hlcyA9IDEuMDsKICB9CiAgcmV0dXJuIG51bU9mRGFzaGVzOwp9Cgp2b2lkIG1haW4oKSB7CiAgLy8gRGl2aWRlIG1pbldpZHRoIGJ5IHBpeGVsIGRlbnNpdHkgc28gcmV0aW5hIHNjcmVlbiByZXRhaW4gY29ycmVjdCB3aWR0aAogIGZsb2F0IG1pbldpZHRoID0gMS4wIC8gdV9yZXNvbHV0aW9uLno7CiAgdmVjNCBwaXhlbENvbG91cjsKICBpbnQgbGluZVR5cGUgPSByb3VuZFRvSW50KGFfdmVydGV4SW5mby53KTsKICBib29sIGlzRGFzaGVkTGluZSA9IGxpbmVUeXBlID09IExJTkVfVFlQRV9EQVNIOwogIGJvb2wgaXNEb3R0ZWRMaW5lID0gbGluZVR5cGUgPT0gTElORV9UWVBFX0RPVDsKICBib29sIGlzQXJyb3doZWFkID0gbGluZVR5cGUgPT0gTElORV9UWVBFX0FSUk9XSEVBRDsKICB2ZWMyIHBvc2l0aW9uOwogIGZsb2F0IGxlbmd0aEluV29ybGRDb29yZHM7CiAgLy8gaG93IG11Y2ggc21vb3RoaW5nIHRvIGFwcGx5IHRvIHRoZSBlZGdlIG9mIHRoZSBhcnJvd2hlYWQKICBmbG9hdCBhbnRpQWxpYXNpbmdUaHJlc2hvbGQ7CiAgcGl4ZWxDb2xvdXIgPSBhX2NvbG91cjsKICBpZiAoaXNBcnJvd2hlYWQpIHsKICAgIGludCB2ZXJ0ZXhJbmRleCA9IGludChhX2luZGV4KTsKICAgIHZlYzIgcG9zaXRpb24xID0gYV9wb3NpdGlvbjE7CiAgICB2ZWMyIHBvc2l0aW9uMiA9IGFfcG9zaXRpb24yOwogICAgdmVjMiBwb3NpdGlvbjMgPSBhX3Bvc2l0aW9uMzsKICAgIGZsb2F0IGRpc3RhbmNlSW5Xb3JsZFBpeGVscyA9IGRpc3RhbmNlKHBvc2l0aW9uMiwgcG9zaXRpb24zKTsKICAgIGZsb2F0IGRpc3RhbmNlSW5TY3JlZW5QaXhlbHMgPSBkaXN0YW5jZUluV29ybGRQaXhlbHMgLyB1X3pvb207CiAgICBhbnRpQWxpYXNpbmdUaHJlc2hvbGQgPSAxLjAgLyBkaXN0YW5jZUluU2NyZWVuUGl4ZWxzOwogICAgdmVjMiBvcHBvc2l0ZU1pZFBvaW50OwogICAgaWYodmVydGV4SW5kZXggPT0gMCkgewogICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uMTsKICAgICAgb3Bwb3NpdGVNaWRQb2ludCA9IChwb3NpdGlvbjIgKyBwb3NpdGlvbjMpIC8gMi4wOwogICAgfSBlbHNlIGlmICh2ZXJ0ZXhJbmRleCA9PSAxKSB7CiAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24yOwogICAgICBvcHBvc2l0ZU1pZFBvaW50ID0gKHBvc2l0aW9uMSArIHBvc2l0aW9uMykgLyAyLjA7CiAgICB9IGVsc2UgaWYgKHZlcnRleEluZGV4ID09IDIpIHsKICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbjM7CiAgICAgIG9wcG9zaXRlTWlkUG9pbnQgPSAocG9zaXRpb24yICsgcG9zaXRpb24xKSAvIDIuMDsKICAgIH0KICAgIHZlYzIgdW5pdFZlY3RvckZvckV4dHJ1c2lvbiA9IG5vcm1hbGl6ZShwb3NpdGlvbiAtIG9wcG9zaXRlTWlkUG9pbnQpOwogICAgLy8gcHVzaCB2ZXJ0ZXggYXdheSBmcm9tIGNlbnRyZSB0byBtYWtlIGl0IGJpZ2dlciBzbyB0aGF0IGFudGlhbGlzaW5nIGhhcyByb29tIHRvIHNtb290aCB0aGUgamFnZ2llcwogICAgcG9zaXRpb24gKz0gdW5pdFZlY3RvckZvckV4dHJ1c2lvbiAvIHVfem9vbTsKICAgIHZfbGluZURhdGEgPSB2ZWM0KDAuMCwgMC4wLCAwLjAsIGFfdmVydGV4SW5mby53KTsKICB9IGVsc2UgewogICAgLy8gTWFrZSBpdCB3aWRlciB0byBhbGxvdyB0aGUgYW50aSBhbGlhc2luZyB0byBlYXQgaW50byB0aGUgbGluZSBpbiBvcmRlciB0byBtYWtlIGl0IHNtb290aAogICAgZmxvYXQgYWFXaWR0aEJ1ZmZlciA9IDEuMCAvIHVfem9vbTsKCgogICAgaWYodV9oaXRUZXN0ID09IDEuMCkgewogICAgICAvLyBhZGQgNyBzY3JlZW4gcGl4ZWxzIHRvIHRoZSBsaW5lIHRoaWNrbmVzcwogICAgICBhYVdpZHRoQnVmZmVyID0gNy4wIC8gdV96b29tOwogICAgfQogICAgLy8gaW5jcmVhc2UgbWluLXdpZHRoIGZvciBkb3R0ZWQgbGluZSAjMjQyNgogICAgaWYoaXNEb3R0ZWRMaW5lKSB7CiAgICAgIG1pbldpZHRoID0gbWF4KG1pbldpZHRoLCBzdGVwKDIuNSwgYV92ZXJ0ZXhJbmZvLncpICogMi4wKTsKICAgIH0KICAgIAogICAgLy8gYSB2ZWN0b3IgaW4gdGhlIGRpcmVjdGlvbiBvZiB0aGUgbGluZSB3aXRoIGEgbGVuZ3RoIG9mIDEKICAgIHZlYzIgdW5pdFZlY3RvciA9IG5vcm1hbGl6ZShhX3Bvc2l0aW9uMiAtIGFfcG9zaXRpb24xKTsKICAgIC8vIHVuaXQgdmVjdG9yIHdpdGggYSBsZW5ndGggb2YgMSBzY3JlZW4gcGl4ZWwKICAgIHZlYzIgdW5pdFZlY3RvckluVmlldyA9IHVuaXRWZWN0b3IgLyB1X3pvb207CiAgICAvLyBEaXJlY3Rpb24gb2YgdGhlIG5vcm1hbCB2ZWN0b3IKICAgIGZsb2F0IG5vcm1hbFBvaW50c1Vwd2FyZCA9IGFfdmVydGV4SW5mby55IC0gMS4wOwogICAgCiAgICAvLyBUaGUgVVYgY29vcmRzIGZyb20gMCAtPiAxLCB1c2VkIGZvciBkYXNoaW5nCiAgICBmbG9hdCB1diA9IGFfdmVydGV4SW5mby54ICsgYV92ZXJ0ZXhJbmZvLno7CiAgICAKICAgIHZlYzIgZGlzdGFuY2VWZWN0b3IgPSBhX3Bvc2l0aW9uMiAtIGFfcG9zaXRpb24xOwogICAgCiAgICB2ZWMyIG5vcm1hbCA9IG5vcm1hbGl6ZSh2ZWMyKC1kaXN0YW5jZVZlY3Rvci55LCBkaXN0YW5jZVZlY3Rvci54KSk7CiAgICAKICAgIC8vIFdoZXRoZXIgdGhlIHZlcnRleCBpcyBhdCB0aGUgc3RhcnQgb3IgZW5kIG9mIHRoZSBsaW5lLgogICAgaWYoaW50KGFfdmVydGV4SW5mby54KSA9PSAwKSB7CiAgICAgIHBvc2l0aW9uID0gYV9wb3NpdGlvbjEgLSB1bml0VmVjdG9ySW5WaWV3OwogICAgfSBlbHNlIHsKICAgICAgcG9zaXRpb24gPSBhX3Bvc2l0aW9uMiArIHVuaXRWZWN0b3JJblZpZXc7CiAgICB9CiAgICAvLyB0aGUgcmVhbCB2aXNpYmxlIHdpZHRoIG9mIHRoZSBsaW5lCiAgICBmbG9hdCBsaW5lV2lkdGggPSBhX3Bvc2l0aW9uMy54OwogICAgaWYoaW50KHVfdmlld0luZGVwZW5kZW50KSA9PSAwKSB7CiAgICAgIGxpbmVXaWR0aCA9IG1heCgobGluZVdpZHRoKSAqIHVfem9vbSwgbWluV2lkdGgpIC8gdV96b29tOwogICAgfQogICAgLy8gdGhlIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIHNoYXBlIHRoYXQgY29udGFpbnMgdGhlIGxpbmUKICAgIGZsb2F0IHNoYXBlV2lkdGggPSBsaW5lV2lkdGggKyBhYVdpZHRoQnVmZmVyOyAKICAgIC8vIGdldCB2ZWN0b3IgZm9yIGxpbmUKICAgIHZlYzIgbm9ybWFsVmVjID0gbm9ybWFsICogKHNoYXBlV2lkdGgvMi4wKSAqIG5vcm1hbFBvaW50c1Vwd2FyZDsKICAgIHBvc2l0aW9uID0gcG9zaXRpb24gKyBub3JtYWxWZWM7CiAgICAvLyBsZW5ndGggb2YgdGhlIGxpbmUgaW4gd29ybGQgY29vcmRpbmF0ZXMKICAgIGZsb2F0IGxpbmVMZW5ndGggPSBkaXN0YW5jZShhX3Bvc2l0aW9uMSwgYV9wb3NpdGlvbjIpOwogICAgZmxvYXQgbGluZUxlbmd0aEluUGl4ZWxzID0gbGluZUxlbmd0aCAqIHVfem9vbTsKICAgIGZsb2F0IHBpeGVsU2l6ZSA9ICgxLjAgLyBsaW5lTGVuZ3RoKSAvIHVfem9vbTsKICAgIC8vRG90dGVkIGxpbmVzLCBzbyBjYWxjIHV2IGxlbmd0aAogICAgaWYoaXNEb3R0ZWRMaW5lKSB7CiAgICAgIC8vIGFzIGxpbmVzIGdldCBzbWFsbGVyIGFuZCBzbWFsbGVyIGxpbWl0IHRoZSBudW1iZXIgb2YgZG90cyBzbyB0aGUgc3RpbGwgbG9vayBuaWNlCiAgICAgIGZsb2F0IG1pbmltdW1Eb3RzID0gbGluZUxlbmd0aEluUGl4ZWxzIC8gNC4wOwogICAgICAvLyBieSBkZWZhdWx0IHNldCB0aGUgbnVtYmVyIG9mIGRvdHMgdG8gdGhlIHByb3BvcnRpb24gb2YgdGhlIGxpbmUgbGVuZ3RoIGFuZCBsaW5lIHdpZHRoCiAgICAgIGZsb2F0IG51bWJlckRvdHNCeUxpbmVXaWR0aCA9IGxpbmVMZW5ndGggLyAobGluZVdpZHRoICogMi4wKTsKICAgICAgLy8gY2hvb3NlIHRoZSBzbWFsbGVzdCBudW1iZXIsIGFzIHRoZSBsaW5lIGdldHMgdG9vIHNtYWxsIHJlZHVjaW5nIHRoZSBudW1iZXIgb2YgZG90cwogICAgICAvLyBieSB0aGUgem9vbSBsZXZlbCBoZWxwcyBpdCB0byBzdGF5IHJlYWRhYmxlCiAgICAgIGZsb2F0IG51bU9mRG90cyA9IG1pbihtaW5pbXVtRG90cywgbnVtYmVyRG90c0J5TGluZVdpZHRoKTsKICAgICAgLy8gcm91bmQgdXAgdGhlIG51bWJlciBvZiBkb3RzIHNvIHRoYXQgd2UgYWx3YXlzIGRyYXcgYSB3aG9sZSBkb3QKICAgICAgdl9jb3JlID0gdmVjNCh1diwgY2VpbChudW1PZkRvdHMpLCBwaXhlbFNpemUsIDAuMCk7CiAgICAgIHZfZGFzaGluZyA9IHZlYzMobGluZVdpZHRoLCBsaW5lV2lkdGgsIDAuNSk7CiAgICB9IGVsc2UgaWYoaXNEYXNoZWRMaW5lKSB7CiAgICAgIC8vIGxlbmd0aCBvZiB0aGUgZGFzaCB3aXRoIGFkanVzdG1lbnRzIGlmIHRoZSBkYXNoIGxlbmd0aCBpcyBsZXNzIHRoYW4gMiBzY3JlZW4gcGl4ZWxzCiAgICAgIGZsb2F0IGRhc2hMZW5ndGggPSBtYXgoMi4wIC8gdV96b29tLCBsaW5lV2lkdGggKiAyLjApOwogICAgICAvLyB0aGUgbnVtYmVyIG9mIGRhc2hlcyB3ZSdyZSBhaW1pbmcgZm9yCiAgICAgIGZsb2F0IGRhc2hlcyA9IGdldE51bWJlck9mRGFzaGVzKGRhc2hMZW5ndGgsIGxpbmVMZW5ndGgpOwogICAgICAvLyBXZSB3YW50IHRvIHN0YXJ0IGFuZCBlbmQgb24gYSBkYXNoIHdpdGhvdXQgYWx0ZXJpbmcgdGhlIGxlbmd0aCBvZiB0aGUgZGFzaCBzbyBpbnN0ZWFkIHdlCiAgICAgIC8vIG5lZWQgdG8gYWx0ZXIgdGhlIGdhcCBsZW5ndGguICBUaGlzIHdpbGwgdGVsbCB1cyBob3cgbG9uZyBhIGdhcCB3ZSB3aWxsIG5lZWQuCiAgICAgIGZsb2F0IGdhcFdpZHRoID0gKGxpbmVMZW5ndGggLSBkYXNoTGVuZ3RoICogZGFzaGVzKSAvIChkYXNoZXMgLSAxLjApOwogICAgICAvLyB0byBlbmQgb24gYSBkYXNoIHdlIG5lZWQgdG8gcmVtb3ZlIGEgZ2FwcyBsZW5ndGggZnJvbSB0aGUgZW5kCiAgICAgIGZsb2F0IGdhcE92ZXJQZXJpb2QgPSBnYXBXaWR0aCAqIGRhc2hlcyAvIChsaW5lTGVuZ3RoICsgZ2FwV2lkdGgpOwogICAgICAvLyBwYXNzIHRoZSBzdGFydCBhbmdsZSBhbmQgdGhlIG51bWJlciBvZiBkYXNoZXMgbWludXMgdGhlIGxlbmd0aCBvZiBhIGdhcAogICAgICB2X2NvcmUgPSB2ZWM0KHV2LCBkYXNoZXMgLSBnYXBPdmVyUGVyaW9kLCBwaXhlbFNpemUsIDAuMCk7CiAgICAgIGZsb2F0IGRhc2hBZGp1c3RtZW50ID0gKGRhc2hMZW5ndGggLyAoZGFzaExlbmd0aCArIGdhcFdpZHRoKSkgLyAyLjA7CiAgICAgIHZfZGFzaGluZyA9IHZlYzMoZGFzaExlbmd0aCwgZ2FwV2lkdGgsIGRhc2hBZGp1c3RtZW50KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIGFsbG93cyB1cyB0byBkZXRlcm1pbmUgb3VyIHBvc2l0aW9uIG9uIHRoZSBsaW5lIGluIHRoZSBmcmFnbWVudCBzaGFkZXIKICAgICAgdl9jb3JlID0gdmVjNCh1diwgMC4wLCBwaXhlbFNpemUsIDAuMCk7CiAgICB9CiAgICAKICAgIC8vIHNldCB0aGUgd2lkdGggb24gdGhlIHZlcnRleCBzbyB0aGF0IHdlIGNhbiBtZWFzdXJlIHRoZSBkaXN0YW5jZSBmcm9tIHRoZSBlZGdlIGluIHRoZSBmcmFnbWVudAogICAgLy8gc2hhZGVyCiAgICBpZihpbnQobm9ybWFsUG9pbnRzVXB3YXJkKSA9PSAxKSB7CiAgICAgIC8vIHBhc3MgdGhlIGFjdHVhbCB3aWR0aCBvZiB0aGUgZ2VvbWV0cnkgKHNoYXBlV2lkdGgpIGFuZCB0aGUgd2lkdGggd2UnbGwgdXNlIGFzIHRoZSBhY3R1YWwKICAgICAgLy8gdmlzaWJsZSBsaW5lICh2X3dpZHRoKQogICAgICB2X2xpbmVEYXRhID0gdmVjNCgtc2hhcGVXaWR0aCwgbGluZVdpZHRoLCBsaW5lTGVuZ3RoLCBhX3ZlcnRleEluZm8udyk7CiAgICB9IGVsc2UgewogICAgICB2X2xpbmVEYXRhID0gdmVjNChzaGFwZVdpZHRoLCBsaW5lV2lkdGgsIGxpbmVMZW5ndGgsIGFfdmVydGV4SW5mby53KTsKICAgIH0KICB9CiAgLyoKICAgY29udmVydCB0byBjbGlwc3BhY2UgCiAgKi8KICAvLyBjb252ZXJ0IHRoZSByZWN0YW5nbGUgZnJvbSBwaXhlbHMgdG8gMC4wIHRvIDEuMAogIHZlYzIgemVyb1RvT25lID0gcG9zaXRpb24gLyB1X3Jlc29sdXRpb24ueHk7CiAgCiAgLy8gY29udmVydCBmcm9tIDAtPjEgdG8gMC0+MgogIHZlYzIgemVyb1RvVHdvID0gemVyb1RvT25lICogMi4wOwogIAogIC8vIGNvbnZlcnQgZnJvbSAwLT4yIHRvIC0xLT4rMSAoY2xpcHNwYWNlKQogIHZlYzIgY2xpcFNwYWNlID0gemVyb1RvVHdvIC0gMS4wOwogIAogIC8qCiAgIEFzc2lnbiBWYXJ5aW5ncwogICovIAogIC8vIG5vcm1hbGlzZSBjb2xvdXIgdmFsdWVzCiAgcGl4ZWxDb2xvdXIgLz0gMjU1LjA7CiAgdl9jb2xvdXIgPSBwaXhlbENvbG91cjsKICAKICAvLyBub3JtYWxpc2UgY29sb3VyIHZhbHVlcwogIHZfY29sb3VyMiA9IGFfY29sb3VyMiAvIDI1NS4wOwoKICAvLyBjb2xvdXIgdG8gdXNlIGZvciBoaXQgdGVzdGluZyAoc2hhZG93IGNhbnZhcyBjb2xvdXIpCiAgdl9oaXRUZXN0Q29sb3VyID0gYV9oaXRUZXN0Q29sb3VyOwoKICAKICB2X2JhcnljZW50cmljID0gdmVjNChhX3ZlcnRleEluZm8ueHl6LCBhbnRpQWxpYXNpbmdUaHJlc2hvbGQpOwogIAogIC8qCiAgIEFzc2lnbiBmaW5hbCB2ZXJ0ZXggcG9zaXRpb24gYW5kIGFwcGx5IHRyYW5zZm9ybXMgZm9yIHpvb20vcGFuCiAgKi8KICBnbF9Qb3NpdGlvbiA9IHVfdHJhbnNmb3JtICogdmVjNChjbGlwU3BhY2UgKiB2ZWMyKDEsIC0xKSwgMCwgMSk7Cn0=",Go="I2lmZGVmIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcwojZXh0ZW5zaW9uIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA6IGVuYWJsZQojZW5kaWYKCnByZWNpc2lvbiBoaWdocCBmbG9hdDsKCi8vIG91ciB0ZXh0dXJlCnVuaWZvcm0gc2FtcGxlcjJEIHVfaW1hZ2VbOF07CnVuaWZvcm0gbG93cCBmbG9hdCB1X2hpdFRlc3Q7CnVuaWZvcm0gdmVjMyB1X3Jlc29sdXRpb247CnVuaWZvcm0gZmxvYXQgdV9zaGFkb3dUeXBlOwp1bmlmb3JtIGZsb2F0IHVfem9vbTsKCi8vIHRoZSB0ZXhDb29yZHMgcGFzc2VkIGluIGZyb20gdGhlIHZlcnRleCBzaGFkZXIuCnZhcnlpbmcgdmVjNCB2X3RleENvb3JkOwovLyBjb2xvdXIgb2YgZmxhdCBzaGFkZWQgdHJpYW5nbGVzCnZhcnlpbmcgdmVjNCB2X2NvbG91cjsKLy8gc2hhZG93Y2FudmFzIGNvbG91ciBtYXBwaW5nCnZhcnlpbmcgdmVjNCB2X2hpdFRlc3RDb2xvdXI7Ci8vIHdoaWNoIHRleHR1cmUgdG8gdXNlCnZhcnlpbmcgdmVjMiB2X3RleHR1cmVCYW5rOwovLyBjaXJjbGUgYm9yZGVyIHdpZHRoCnZhcnlpbmcgZmxvYXQgdl9ib3JkZXJXaWR0aDsKLy8gd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgc2hhcGUsIHdpZHRoIGlzIG5lZ2F0aXZlIGZvciBhIHJlY3RhbmdsZSBhbmQgcG9zaXRpdmUgZm9yIGNpcmNsZXMKdmFyeWluZyB2ZWMyIHZfc2hhcGVTaXplOwovLyB0aGUgc2l6ZSBvZiBhIHBpeGVsIGluIHNjcmVlbnNwYWNlIGNsaXAgY29vcmRpbmF0ZXMKdmFyeWluZyBmbG9hdCB2X3BpeGVsOwp2YXJ5aW5nIHZlYzIgdl9kb251dFNlZ21lbnQ7Cgpjb25zdCBmbG9hdCBQSSA9IDMuMTQxNTkyNjUzNTg5NzkzMjM4NDYyNjQzMzgzMjc5NTsKLy8gUGVyZm9ybWFuY2UgYW50aWFsaWFzaW5nIHVzaW5nIHN0YW5kYXJkIGRlcml2YXRpdmVzCi8vIFNtb290aHMgdGhlIGZyYWdtZW50IG92ZXIgMSBwaXhlbCB3aGVuIHZhbHVlIGlzIG1vcmUgdGhhbiB0aHJlc2hvbGQKLy8gZXNlbnRpYWxseSBhIGJldHRlciB2ZXJzaW9uIG9mIHN0ZXAgYW5kIHNtb290aHN0ZXAKZmxvYXQgYWFzdGVwKGZsb2F0IHRocmVzaG9sZCwgZmxvYXQgdmFsdWUpIHsKICBmbG9hdCBhZndpZHRoID0gbGVuZ3RoKHZlYzIoZEZkeCh2YWx1ZSksIGRGZHkodmFsdWUpKSkgKiAwLjcwNzEwNjc4MTE4NjU0NzU3OwogIHJldHVybiBzbW9vdGhzdGVwKHRocmVzaG9sZC1hZndpZHRoLCB0aHJlc2hvbGQrYWZ3aWR0aCwgdmFsdWUpOwp9CgovLyBlbnN1cmVzIHRoYXQgbnVtYmVycyBhcmUgZXhhY3RseSBpbnRlZ2VycyAKaW50IHJvdW5kVG9JbnQoZmxvYXQgYSkgewogcmV0dXJuIGludChmbG9vcihhICsgMC41KSk7Cn0KCmZsb2F0IGdldEJvcmRlcldpZHRoWm9vbShmbG9hdCBib3JkZXJXaWR0aCkgewogIC8vIHJldHVybnMgMCB3aGVuIGJvcmRlciBpcyBsYXJnZXIgdGhhbiBvbmUgc2NyZWVuIHBpeGVsCiAgZmxvYXQgaXNCb3JkZXJMZXNzVGhhbjFQaXhlbCA9IDEuMCAtIHN0ZXAoMS4wLCBib3JkZXJXaWR0aCAqIHVfem9vbSk7CiAgZmxvYXQgdW5pdHNQZXJTY3JlZW5QaXhlbCA9ICgxLjAgLyB1X3pvb20pOwogIC8vIElmIHRoZSBib3JkZXIgd2lkdGggaW4gc2NyZWVuIHBpeGVscyBpcyBsZXNzIHRoYW4gb25lLCBzZXQgaXQgdG8gMSBzY3JlZW4gcGl4ZWwKICByZXR1cm4gbWF4KGJvcmRlcldpZHRoLCBpc0JvcmRlckxlc3NUaGFuMVBpeGVsICogdW5pdHNQZXJTY3JlZW5QaXhlbCk7Cn0KCmZsb2F0IHJlY3RhbmdsZUJvcmRlcihmbG9hdCBib3JkZXJXaWR0aCkgewogIGZsb2F0IHRvcExlZnQgPSBhYXN0ZXAodl90ZXhDb29yZC54LCBib3JkZXJXaWR0aCk7CiAgZmxvYXQgdG9wUmlnaHQgPSBhYXN0ZXAodl90ZXhDb29yZC55LCBib3JkZXJXaWR0aCk7CiAgZmxvYXQgYm90dG9tTGVmdCA9IGFhc3RlcCh2X3RleENvb3JkLnogLSB2X3RleENvb3JkLngsIGJvcmRlcldpZHRoKTsKICBmbG9hdCBib3R0b21SaWdodCA9IGFhc3RlcCh2X3RleENvb3JkLncgLSB2X3RleENvb3JkLnksIGJvcmRlcldpZHRoKTsKICBmbG9hdCB0b3AgPSBtYXgodG9wTGVmdCwgdG9wUmlnaHQpOyAKICBmbG9hdCBib3R0b20gPSBtYXgoYm90dG9tTGVmdCwgYm90dG9tUmlnaHQpOyAKICByZXR1cm4gbWF4KHRvcCwgYm90dG9tKTsKfQoKLy8gZGlzdGFuY2UgdG8gZWRnZSBmcm9tIGEgdHJpYW5nbGUsIHVzZWQgZm9yIHNtb290aGluZyBlZGdlcyBvZiBhcnJvd3MKZmxvYXQgZWRnZUZhY3Rvcih2ZWMzIGJhcnljZW50cmljQ29vcmRzKSB7CiAgdmVjMyBkID0gZndpZHRoKGJhcnljZW50cmljQ29vcmRzKTsKICB2ZWMzIGEzID0gc21vb3Roc3RlcCh2ZWMzKDAuMCksIGQqMy4wLCBiYXJ5Y2VudHJpY0Nvb3Jkcyk7CiByZXR1cm4gbWluKG1pbihhMy54LCBhMy55KSwgYTMueik7Cn0KCi8vIFJlYWQgdGhlIHRleHR1cmUgdmFsdWUgb2YgYSBnbHlwaCBmcm9tIHRoZSBzcGVjaWZpZWQgY29sb3VyIGNoYW5uZWwKZmxvYXQgcmVhZENvbG91ckNvbXBvbmVudEZyb21UZXh0dXJlKGZsb2F0IHRleHR1cmVCYW5rLCB2ZWM0IHRleHR1cmVWYWx1ZSkgewogIGZsb2F0IHRleENvbXBvbmVudDsKICBpbnQgdGV4QmFuayA9IHJvdW5kVG9JbnQodGV4dHVyZUJhbmspOwogIGlmKHRleEJhbmsgPT0gMCkgewogICAgdGV4Q29tcG9uZW50ID0gdGV4dHVyZVZhbHVlLnI7CiAgfSBlbHNlIGlmKHRleEJhbmsgPT0gMSkgewogICAgdGV4Q29tcG9uZW50ID0gdGV4dHVyZVZhbHVlLmc7CiAgfSBlbHNlIHsKICAgIHRleENvbXBvbmVudCA9IHRleHR1cmVWYWx1ZS5iOwogIH0KICByZXR1cm4gdGV4Q29tcG9uZW50Owp9CgovLyBVc2VkIHRvIHJlY29uc3RydWN0IGEgZ2x5cGggZnJvbSB0aGUgY29sb3VyQ29tcG9uZW50IHRleHR1cmUKLy8gUmVhZCBvbmUgc3BlY2lmaWMgY29sb3VyIG9ubHkgYW5kIHRyZWF0IGl0IGFzIGFuIGFscGhhIHZhbHVlLCBzZXR0aW5nIGl0cyBjb2xvdXIgdXNpbmcgY29sb3VyTW9kaWZpZXIKdmVjNCBnZXRDb2xvdXJGcm9tQ29tcG9uZW50KGZsb2F0IGNvbG91ckNvbXBvbmVudCwgdmVjNCBjb2xvdXJNb2RpZmllciwgZmxvYXQgdXNlV2hpdGVCb29zdCkgewogIGZsb2F0IGNvbG91ckF2ZyA9IChjb2xvdXJNb2RpZmllci5yICsgY29sb3VyTW9kaWZpZXIuYiArIGNvbG91ck1vZGlmaWVyLmcpIC8gMy4wOwogIGZsb2F0IGlzV2hpdGUgPSBzdGVwKDEuMCwgY29sb3VyQXZnKSAqIHVzZVdoaXRlQm9vc3Q7CiAgLy8gSWYgdGhlIHRleHQgaXMgd2hpdGUgYm9vc3QgdGhlIGFscGhhIHRvIGluY3JlYXNlIGNvbnRyYXN0CiAgZmxvYXQgd2hpdGVUZXh0Qm9vc3QgPSBpc1doaXRlICogKHN0ZXAoMC4yNSwgY29sb3VyQ29tcG9uZW50KSAqIG1pbihjb2xvdXJBdmcsIDAuMjUpKTsKICBmbG9hdCBhbHBoYSA9IGNvbG91ckNvbXBvbmVudCArIHdoaXRlVGV4dEJvb3N0OwogIGZsb2F0IGEgPSBjb2xvdXJNb2RpZmllci5hICogYWxwaGE7CiAgZmxvYXQgciA9IGNvbG91ck1vZGlmaWVyLnIgKiBhbHBoYTsKICBmbG9hdCBnID0gY29sb3VyTW9kaWZpZXIuZyAqIGFscGhhOwogIGZsb2F0IGIgPSBjb2xvdXJNb2RpZmllci5iICogYWxwaGE7CiAgcmV0dXJuIHZlYzQocixnLGIsYSk7Cn0KCi8vIHJldHVybnMgdGhlIGRpc3RhbmNlIGZyb20gdGhlIGNlbnRyZSBvZiB0aGUgc2hhcGUgdG8gdGhlIGVkZ2UKZmxvYXQgY2FsY3VsYXRlRWRnZU9mUmVjdGFuZ2xlKHZlYzIgcG9zaXRpb24sIGZsb2F0IHdpZHRoLCBmbG9hdCBoZWlnaHQsCiAgZmxvYXQgYm9yZGVyV2lkdGgsIGZsb2F0IGJvcmRlclJhZGl1cykgewogIGJvcmRlclJhZGl1cyA9IG1heCgwLjAsIGJvcmRlclJhZGl1cyAtIGJvcmRlcldpZHRoKTsgCiAgZmxvYXQgaGFsZldpZHRoID0gd2lkdGggLyAyLjA7CiAgZmxvYXQgaGFsZkhlaWdodCA9IGhlaWdodCAvIDIuMDsKICBmbG9hdCBhID0gaGFsZldpZHRoIC0gYm9yZGVyUmFkaXVzIC0gYm9yZGVyV2lkdGg7CiAgZmxvYXQgYiA9IGhhbGZIZWlnaHQgLSBib3JkZXJSYWRpdXMgLSBib3JkZXJXaWR0aDsKICBmbG9hdCB4ID0gcG9zaXRpb24ueCAtIGhhbGZXaWR0aDsKICBmbG9hdCB5ID0gcG9zaXRpb24ueSAtIGhhbGZIZWlnaHQ7CiAgZmxvYXQgaG9yaXpvbnRhbCA9IHBvdyhtYXgoYWJzKHgpIC0gYSwgMC4wKSwgMi4wKTsKICBmbG9hdCB2ZXJ0aWNhbCA9IHBvdyhtYXgoYWJzKHkpIC0gYiwgMC4wKSwgMi4wKTsKICByZXR1cm4gaG9yaXpvbnRhbCArIHZlcnRpY2FsOyAKfQoKZmxvYXQgZGlzdGFuY2VGcm9tQ2lyY2xlQ2VudHJlKGZsb2F0IHJhZGl1cykgewogIHJldHVybiAoZGlzdGFuY2Uodl90ZXhDb29yZC56dywgdmVjMigwLjUpKSAqIHJhZGl1cykgKiB1X3pvb207Cn0KCi8vIEFuIGV4cGxhbmF0aW9uIG9mIHRoZSBmb3JtdWxhIGZvciBhIHJvdW5kZWQgcmVjdGFuZ2xlCi8vIGh0dHA6Ly9iZW5pY2UtZXF1YXRpb24uYmxvZ3Nwb3QuY29tLzIwMTYvMTAvZXF1YXRpb24tb2Ytcm91bmRlZC1yZWN0YW5nbGUuaHRtbAp2ZWM0IHJvdW5kUmVjdGFuZ2xlKHZlYzQgZmluYWxDb2xvdXIsIGZsb2F0IGJvcmRlcldpZHRoSW5QaXhlbHMsIGZsb2F0IGJvcmRlclJhZGl1cykgewogIGZsb2F0IGRpc3RhbmNlVG9PdXRlckVkZ2UgPSBwb3coYm9yZGVyUmFkaXVzLCAyLjApOwogIC8vIGlmIHJlc3VsdCBpcyBsYXJnZXIgdGhhbiBkaXN0YW5jZVRvT3V0ZXJFZGdlIHRoZW4gd2UgYXJlIG91dHNpZGUgb2YgdGhlIHNoYXBlCiAgZmxvYXQgZGlzdGFuY2VGcm9tQ2VudHJlID0gY2FsY3VsYXRlRWRnZU9mUmVjdGFuZ2xlKHZfdGV4Q29vcmQueHksIHZfdGV4Q29vcmQueiwgdl90ZXhDb29yZC53LCAwLjAsIGJvcmRlclJhZGl1cyk7CiAgaWYoYWJzKHZfYm9yZGVyV2lkdGgpID4gMC4wKSB7CiAgICBmaW5hbENvbG91ciAqPSAxLjAgLSBhYXN0ZXAoZGlzdGFuY2VUb091dGVyRWRnZSwgZGlzdGFuY2VGcm9tQ2VudHJlKTsKICAgIGRpc3RhbmNlRnJvbUNlbnRyZSA9IGNhbGN1bGF0ZUVkZ2VPZlJlY3RhbmdsZSh2X3RleENvb3JkLnh5LCB2X3RleENvb3JkLnosIHZfdGV4Q29vcmQudywgdl9ib3JkZXJXaWR0aCwgYm9yZGVyUmFkaXVzKTsKICAgIGZsb2F0IGJvcmRlclNpemUgPSBtYXgoMC4wLCBib3JkZXJSYWRpdXMgLSB2X2JvcmRlcldpZHRoKTsKICAgIGZsb2F0IGRpc3RhbmNlVG9Jbm5lckVkZ2UgPSBwb3coYm9yZGVyU2l6ZSwgMi4wKTsKICAgIGZpbmFsQ29sb3VyICo9IGFhc3RlcChkaXN0YW5jZVRvSW5uZXJFZGdlLCBkaXN0YW5jZUZyb21DZW50cmUpOwogIH0gZWxzZSB7CiAgICBmaW5hbENvbG91ciAqPSAxLjAgLSBhYXN0ZXAoZGlzdGFuY2VUb091dGVyRWRnZSwgZGlzdGFuY2VGcm9tQ2VudHJlKTsKICB9CiAgcmV0dXJuIGZpbmFsQ29sb3VyOwp9Cgp2ZWM0IGdldENvbG91ckZvclRleHRPckZvbnRJY29uKHZlYzQgdGV4Q29vcmQsIHZlYzQgY29sb3VyLCBmbG9hdCB1c2VXaGl0ZUJvb3N0KSB7CiAgLy8gUmVhZCB0aGUgdmFsdWUgZnJvbSB0aGUgcmVxdWlyZWQgY29sb3VyIGNvbXBvbmVudCB0aGF0IHdpbGwgZGV0ZXJtaW5lIHRoZSBzaGFwZQogIGZsb2F0IGNvbG91ckNvbXBvbmVudCA9IHJlYWRDb2xvdXJDb21wb25lbnRGcm9tVGV4dHVyZSh2X3RleHR1cmVCYW5rLnksIHRleENvb3JkKTsKICAvLyBOb3cgY29sb3VyIGl0IGFuZCBib29zdCB0aGUgY29udHJhc3Qgd2hlbiB0aGUgY29sb3VyIGlzIHdoaXRlIGlmIHJlcXVpcmVkCiAgcmV0dXJuIGdldENvbG91ckZyb21Db21wb25lbnQoY29sb3VyQ29tcG9uZW50LCBjb2xvdXIsIHVzZVdoaXRlQm9vc3QpOwp9CgovLyBpZiBzaGFwZSBpcyBsZXNzIHRoYW4gNSBwaXhlbHMgaW4gc2l6ZSBzdGFydCB0byBmYWRlIG91dCB0aGUgYm9yZGVyCmZsb2F0IGZhZGVPdXRCb3JkZXIoZmxvYXQgc2hhcGVTaXplSW5TY3JlZW5QaXhlbHMpIHsKICByZXR1cm4gbWF4KDAuMiwgc21vb3Roc3RlcCgwLjAsIDUuMCwgc2hhcGVTaXplSW5TY3JlZW5QaXhlbHMpKTsKfQoKdm9pZCBtYWluKCkgewogIGZsb2F0IHNoYXBlV2lkdGggPSBhYnModl9zaGFwZVNpemUueCk7CiAgZmxvYXQgc2hhcGVIZWlnaHQgPSB2X3NoYXBlU2l6ZS55OwogIC8vIHVzZWQgZm9yIG1pbmltdW0gYm9yZGVyIHNpemVzOwogIGZsb2F0IHNtYWxsZXN0U2hhcGVEaW1lbnNpb24gPSBtaW4oc2hhcGVXaWR0aCwgc2hhcGVIZWlnaHQpOwogIC8vIHRoZSBzbWFsbGVzdCBzaXplIGluIHBpeGVscyBvbiBzY3JlZW4gKHNjcmVlbiBzcGFjZSkuICBXZSByZW1vdmUgMC41IHBpeGVscyB0byBnaXZlIHRoZSBhbnRpIGFsaWFzaW5nCiAgLy8gcm9vbSB0byBzbW9vdGggb3V0IChvdGhlcndpc2UgY2lyY2xlcyBjYW4gc3RhcnQgdG8gbG9vayBzcXVhcmVpc2gpICMyNzcxCiAgZmxvYXQgc2hhcGVTaXplSW5TY3JlZW5QaXhlbHMgPSAoKHNtYWxsZXN0U2hhcGVEaW1lbnNpb24gLyAyLjApICogdV96b29tKSAtIDAuNTsKICBmbG9hdCBib3JkZXJXaWR0aCA9IGFicyh2X2JvcmRlcldpZHRoKTsKICAvLyBUaGUgZmluYWwgY29sb3VyIHRvIGRyYXcgdG8gdGhlIHNjcmVlbgogIHZlYzQgZmluYWxDb2xvdXI7CiAgLy8gd2hldGhlciB0aGlzIHByaW1pdGl2ZSBzaG91bGQgb25seSBhcHBlYXIgaW4gdGhlIHNoYWRvdyBjYW52YXMgb3Igbm90IGFwcGVhciBhdCBhbGwKICBpbnQgc2hhZG93VHlwZSA9IHJvdW5kVG9JbnQodV9zaGFkb3dUeXBlKTsKICBib29sIGlzQ2lyY2xlID0gcm91bmRUb0ludCh2X3NoYXBlU2l6ZS54KSA+IDA7CiAgYm9vbCBoYXNDaXJjbGVEYXNoZWRCb3JkZXIgPSByb3VuZFRvSW50KHZfYm9yZGVyV2lkdGgpIDwgMDsKICBib29sIG9ubHlEcmF3T25TaGFkb3cgPSBzaGFkb3dUeXBlID09IDE7CiAgLy8gb25seSBkcmF3IHNoYWRvdyBjb2xvdXJzIGZvciBoaXQgdGVzdGluZwogIGJvb2wgc2hhZG93Q2FudmFzID0gcm91bmRUb0ludCh1X2hpdFRlc3QpID09IDE7CiAgdmVjMiB0ZXh0dXJlQ29vcmRzID0gdl90ZXhDb29yZC56dzsKICAvLyBlYWNoIGRvbnV0IHNlZ21lbnQgaXMgYSB3aG9sZSBjaXJjbGUgdGhhdHMgc2xpY2VkIGJldHdlZW4gdGhlIHN0YXJ0IGFuZCBlbmQgYW5nbGVzCiAgZmxvYXQgZG9udXRTdGFydEFuZ2xlID0gdl9kb251dFNlZ21lbnQueDsKICBmbG9hdCBkb251dEVuZEFuZ2xlID0gdl9kb251dFNlZ21lbnQueTsKICBmbG9hdCBib3JkZXJSYWRpdXMgPSB2X2RvbnV0U2VnbWVudC54OwogIGZsb2F0IGJvcmRlcldpZHRoSW5QaXhlbHM7CiAgLy8gLTIgZmxhdCBzaGFkZWQgd2l0aCBhbnRpIGFsaWFzaW5nCiAgLy8gLTEgZmxhdCBzaGFkZWQKICAvLyAwLi4yIC0+IHRleHQKICAvLyAzIC0+IGZvbnRJY29ucwogIC8vIDQuLi43IC0+IGltYWdlcwogIGludCB0ZXh0dXJlQmFuayA9IHJvdW5kVG9JbnQodl90ZXh0dXJlQmFuay54KTsKICBib29sIGhhc1JlY3RhbmdsZUJvcmRlciA9IHZfYm9yZGVyV2lkdGggPiAwLjAgJiYgcm91bmRUb0ludCh2X3NoYXBlU2l6ZS54KSA8IDA7CiAgYm9vbCBoYXNEYXNoZWRCb3JkZXIgPSB0ZXh0dXJlQmFuayA9PSAtMzsKICBib29sIGhhc0NpcmNsZVNlZ21lbnRzID0gZG9udXRTdGFydEFuZ2xlICE9IDAuMCB8fCBkb251dEVuZEFuZ2xlICE9IDAuMDsKICBmbG9hdCBzZWdtZW50QW5nbGU7CiAgaWYoaGFzQ2lyY2xlU2VnbWVudHMgfHwgaGFzQ2lyY2xlRGFzaGVkQm9yZGVyKSB7CiAgICBpZihkb251dFN0YXJ0QW5nbGUgPiBQSSkgewogICAgICBkb251dFN0YXJ0QW5nbGUgLT0gMi4wICogUEk7CiAgICB9CiAgICBpZihkb251dEVuZEFuZ2xlID4gUEkpIHsKICAgICAgZG9udXRFbmRBbmdsZSAtPSAyLjAgKiBQSTsKICAgIH0gIAogICAgZmxvYXQgeCA9IHRleHR1cmVDb29yZHMueCAtIDAuNTsKICAgIGZsb2F0IHkgPSB0ZXh0dXJlQ29vcmRzLnkgLSAwLjU7CiAgICBzZWdtZW50QW5nbGUgPSBhdGFuKHkseCk7CiAgfQogIGlmKHNoYWRvd0NhbnZhcykgewogICAgLy8gRXhjbHVkZSBmcm9tIHNoYWRvdwogICAgaWYoc2hhZG93VHlwZSA9PSAtMSl7CiAgICAgICAgZGlzY2FyZDsKICAgIH0gZWxzZSB7CiAgICAgIGZpbmFsQ29sb3VyID0gdl9oaXRUZXN0Q29sb3VyIC8gMjU1LjA7CiAgICAgIGlmKGlzQ2lyY2xlKSB7CiAgICAgICAgZmxvYXQgZGlzdEluU2NyZWVuUGl4ZWxzID0gZGlzdGFuY2VGcm9tQ2lyY2xlQ2VudHJlKHNoYXBlV2lkdGgpOwogICAgICAgIGZpbmFsQ29sb3VyICo9IDEuMCAtIHN0ZXAoc2hhcGVTaXplSW5TY3JlZW5QaXhlbHMsIGRpc3RJblNjcmVlblBpeGVscyk7CiAgICAgICAgaWYoYm9yZGVyV2lkdGggPiAwLjApIHsKICAgICAgICAgIGZsb2F0IGJvcmRlclJhZGl1c0luU2NyZWVuUGl4ZWxzID0gYm9yZGVyV2lkdGggKiB1X3pvb207CiAgICAgICAgICBmaW5hbENvbG91ciAqPSBzdGVwKHNoYXBlU2l6ZUluU2NyZWVuUGl4ZWxzIC0gYm9yZGVyUmFkaXVzSW5TY3JlZW5QaXhlbHMsIGRpc3RJblNjcmVlblBpeGVscyk7CiAgICAgICAgfQogICAgICAgIGlmKGhhc0NpcmNsZVNlZ21lbnRzKSB7CiAgICAgICAgICAvLyBmb3IgZG9udXQgc2VnbWVudHMgdGhhdCBjcm9zcyBiZXR3ZWVuIFBJIGFuZCAtUEkgCiAgICAgICAgICBpZihkb251dFN0YXJ0QW5nbGUgPj0gZG9udXRFbmRBbmdsZSkgewogICAgICAgICAgIGZpbmFsQ29sb3VyICo9IHN0ZXAoZG9udXRTdGFydEFuZ2xlLCBzZWdtZW50QW5nbGUpICsgKDEuMCAtIHN0ZXAoZG9udXRFbmRBbmdsZSwgc2VnbWVudEFuZ2xlKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgIGZpbmFsQ29sb3VyICo9IHN0ZXAoZG9udXRTdGFydEFuZ2xlLCBzZWdtZW50QW5nbGUpOwogICAgICAgICAgIGZpbmFsQ29sb3VyICo9IDEuMCAtIHN0ZXAoZG9udXRFbmRBbmdsZSwgc2VnbWVudEFuZ2xlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gaWYodl9kb251dFNlZ21lbnQueCA+IDAuMCkgewogICAgICAgIGJvcmRlcldpZHRoSW5QaXhlbHMgPSBnZXRCb3JkZXJXaWR0aFpvb20oYm9yZGVyV2lkdGgpOwogICAgICAgIGZsb2F0IHNxdWFyZU9mQm9yZGVyUmFkaXVzID0gcG93KGJvcmRlclJhZGl1cywgMi4wKTsKICAgICAgICBmbG9hdCByZXN1bHQgPSBjYWxjdWxhdGVFZGdlT2ZSZWN0YW5nbGUodl90ZXhDb29yZC54eSwgdl90ZXhDb29yZC56LCB2X3RleENvb3JkLncsIDAuMCwgYm9yZGVyUmFkaXVzKTsKICAgICAgICBmaW5hbENvbG91ciAqPSAxLjAgLSBzdGVwKHNxdWFyZU9mQm9yZGVyUmFkaXVzLCByZXN1bHQpOwogICAgICB9IGVsc2UgaWYoaGFzUmVjdGFuZ2xlQm9yZGVyKSB7CiAgICAgICAgZmluYWxDb2xvdXIgKj0gcmVjdGFuZ2xlQm9yZGVyKGJvcmRlcldpZHRoKTsKICAgICAgfQogICAgfQogIH0gZWxzZSBpZiAob25seURyYXdPblNoYWRvdyl7CiAgICBkaXNjYXJkOwogIH0gZWxzZSB7CiAgICAgIGZpbmFsQ29sb3VyID0gdl9jb2xvdXIgLyAyNTUuMDsKICAgICAgLy8gdHJhbnNwYXJlbmN5IHRvIGFwcGx5IHdoZW4gdXNpbmcgcGVySXRlbUFscGhhOwogICAgICBmbG9hdCBhbHBoYSA9IGZpbmFsQ29sb3VyLmE7CiAgICAgIC8vIGxvYWQgdGhlIGNvcnJlY3QgdGV4dHVyZSBhbmQgcmVhZCBpdAogICAgICBpZiAodGV4dHVyZUJhbmsgPj0gMCkgewogICAgICAgICAgdmVjNCB0ZXh0dXJlVmFsdWU7CiAgICAgICAgICAvLyBzZXQgbWlwbWFwIGxldmVsIGJpYXMgdG8gc2hhcnBlbiB0ZXh0dXJlcwogICAgICAgICAgZmxvYXQgYmlhcyA9IC0yLjAvMy4wOwogICAgICAgICAgZmxvYXQgdGV4dEJpYXMgPSAtMC44OwogICAgICAgICAgLy8gR2V0IHRoZSBjb2xvdXIgZnJvbSB0aGUgY3VycmVudCB0ZXh0dXJlCiAgICAgICAgICAvLyBJdHMgbm90IHBvc3NpYmxlIGFjY2VzcyBhcnJheXMgb3RoZXIgdGhhbiB2aWEgc3RhdGljIHZhcmlhYmxlcyBzbyB0aGlzIGNhbid0IGJlIG1ha2UKICAgICAgICAgIC8vIHNob3J0ZXIKICAgICAgICAgIC8vdGV4dCAwCiAgICAgICAgICBpZih0ZXh0dXJlQmFuayA9PSAwKSAgewogICAgICAgICAgICB0ZXh0dXJlVmFsdWUgPSB0ZXh0dXJlMkQodV9pbWFnZVswXSwgdl90ZXhDb29yZC54eSwgdGV4dEJpYXMpOwogICAgICAgICAgICBmaW5hbENvbG91ciA9IGdldENvbG91ckZvclRleHRPckZvbnRJY29uKHRleHR1cmVWYWx1ZSwgZmluYWxDb2xvdXIsIDEuMCk7CiAgICAgICAgICAvL3RleHQgMQogICAgICAgICAgfSBlbHNlIGlmKHRleHR1cmVCYW5rID09IDEpIHsKICAgICAgICAgICAgdGV4dHVyZVZhbHVlID0gdGV4dHVyZTJEKHVfaW1hZ2VbMV0sIHZfdGV4Q29vcmQueHksIHRleHRCaWFzKTsKICAgICAgICAgICAgZmluYWxDb2xvdXIgPSBnZXRDb2xvdXJGb3JUZXh0T3JGb250SWNvbih0ZXh0dXJlVmFsdWUsIGZpbmFsQ29sb3VyLCAxLjApOwogICAgICAgICAgLy8gdGV4dCAyCiAgICAgICAgICB9IGVsc2UgaWYodGV4dHVyZUJhbmsgPT0gMikgewogICAgICAgICAgICB0ZXh0dXJlVmFsdWUgPSB0ZXh0dXJlMkQodV9pbWFnZVsyXSwgdl90ZXhDb29yZC54eSwgdGV4dEJpYXMpOwogICAgICAgICAgICBmaW5hbENvbG91ciA9IGdldENvbG91ckZvclRleHRPckZvbnRJY29uKHRleHR1cmVWYWx1ZSwgZmluYWxDb2xvdXIsIDEuMCk7CiAgICAgICAgICAvLyBmb250SWNvbnMgMyAKICAgICAgICAgIH0gZWxzZSBpZih0ZXh0dXJlQmFuayA9PSAzKSB7CiAgICAgICAgICAgIHRleHR1cmVWYWx1ZSA9IHRleHR1cmUyRCh1X2ltYWdlWzNdLCB2X3RleENvb3JkLnh5LCBiaWFzKTsKICAgICAgICAgICAgZmluYWxDb2xvdXIgPSBnZXRDb2xvdXJGb3JUZXh0T3JGb250SWNvbih0ZXh0dXJlVmFsdWUsIGZpbmFsQ29sb3VyLCAwLjApOwogICAgICAgICAgLy8gaW1hZ2UgNAogICAgICAgICAgfSBlbHNlIGlmKHRleHR1cmVCYW5rID09IDQpIHsKICAgICAgICAgICAgZmluYWxDb2xvdXIgPSB0ZXh0dXJlMkQodV9pbWFnZVs0XSwgdl90ZXhDb29yZC54eSwgYmlhcykgKiBhbHBoYTsKICAgICAgICAgIC8vIGltYWdlIDUgICAKICAgICAgICAgIH0gZWxzZSBpZih0ZXh0dXJlQmFuayA9PSA1KSB7CiAgICAgICAgICAgIGZpbmFsQ29sb3VyID0gdGV4dHVyZTJEKHVfaW1hZ2VbNV0sIHZfdGV4Q29vcmQueHksIGJpYXMpICogYWxwaGE7CiAgICAgICAgICAvLyBpbWFnZSA2CiAgICAgICAgICB9IGVsc2UgaWYodGV4dHVyZUJhbmsgPT0gNikgewogICAgICAgICAgICBmaW5hbENvbG91ciA9IHRleHR1cmUyRCh1X2ltYWdlWzZdLCB2X3RleENvb3JkLnh5LCBiaWFzKSAqIGFscGhhOwogICAgICAgICAgLy8gaW1hZ2UgNyAgIAogICAgICAgICAgfSBlbHNlIGlmKHRleHR1cmVCYW5rID09IDcpIHsKICAgICAgICAgICAgZmluYWxDb2xvdXIgPSB0ZXh0dXJlMkQodV9pbWFnZVs3XSwgdl90ZXhDb29yZC54eSwgYmlhcykgKiBhbHBoYTsKICAgICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBmbGF0IHNoYWRlZCByZWN0IG9yIHRyaWFuZ2xlLCBqdXN0IGFwcGx5IHRoZSBjb2xvdXIKICAgICAgICBmbG9hdCBhbHBoYSA9IGZpbmFsQ29sb3VyLmE7CiAgICAgICAgZmluYWxDb2xvdXIgPSB2ZWM0KGZpbmFsQ29sb3VyLnJnYiAgKiBhbHBoYSwgYWxwaGEpOwogICAgICB9CiAgICAgIGlmKGlzQ2lyY2xlKSB7CiAgICAgICAgIGZsb2F0IGRpc3RJblNjcmVlblBpeGVscyA9IGRpc3RhbmNlRnJvbUNpcmNsZUNlbnRyZShzaGFwZVdpZHRoKTsKICAgICAgICAgZmluYWxDb2xvdXIgKj0gMS4wIC0gYWFzdGVwKHNoYXBlU2l6ZUluU2NyZWVuUGl4ZWxzLCBkaXN0SW5TY3JlZW5QaXhlbHMpOwogICAgICAgICBpZihib3JkZXJXaWR0aCA+IDAuMCkgewogICAgICAgICAgIGZsb2F0IGJvcmRlclJhZGl1c0luU2NyZWVuUGl4ZWxzID0gbWF4KDEuMCwgYm9yZGVyV2lkdGggKiB1X3pvb20pOwogICAgICAgICAgIGZpbmFsQ29sb3VyICo9IGFhc3RlcChzaGFwZVNpemVJblNjcmVlblBpeGVscyAtIGJvcmRlclJhZGl1c0luU2NyZWVuUGl4ZWxzLCBkaXN0SW5TY3JlZW5QaXhlbHMpOwogICAgICAgICAgIGZpbmFsQ29sb3VyICo9IGZhZGVPdXRCb3JkZXIoc2hhcGVTaXplSW5TY3JlZW5QaXhlbHMpOwogICAgICAgICB9CgogICAgICAgICAvLyBVc2VkIHRvIGRlY2lkZSBob3cgbXVjaCBhbnRpIGFsaWFzaW5nIHRvIGFwcGx5CiAgICAgICAgIGZsb2F0IHNtb290aG5lc3MgPSB2X3BpeGVsKjEuNTsKICAgICAgICAgZmxvYXQgc2FGcm9tID0gZG9udXRTdGFydEFuZ2xlIC0gc21vb3RobmVzczsKICAgICAgICAgZmxvYXQgc2FUbyA9IGRvbnV0U3RhcnRBbmdsZSArIHNtb290aG5lc3M7CiAgICAgICAgIGZsb2F0IGVhRnJvbSA9IGRvbnV0RW5kQW5nbGUgLSBzbW9vdGhuZXNzOwogICAgICAgICBmbG9hdCBlYVRvID0gZG9udXRFbmRBbmdsZSArIHNtb290aG5lc3M7CiAgICAgICAgIGlmKGhhc0NpcmNsZVNlZ21lbnRzKSB7CiAgICAgICAgICAgLy8gZm9yIGRvbnV0IHNlZ21lbnRzIHRoYXQgY3Jvc3MgYmV0d2VlbiBQSSBhbmQgLVBJIAogICAgICAgICAgIGlmKGRvbnV0U3RhcnRBbmdsZSA+PSBkb251dEVuZEFuZ2xlKSB7CiAgICAgICAgICAgICBmaW5hbENvbG91ciAqPSBzbW9vdGhzdGVwKHNhRnJvbSwgc2FUbywgc2VnbWVudEFuZ2xlKSArICgxLjAgLSBzbW9vdGhzdGVwKGVhRnJvbSwgZWFUbywgc2VnbWVudEFuZ2xlKSk7CiAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgIGZpbmFsQ29sb3VyICo9IHNtb290aHN0ZXAoc2FGcm9tLCBzYVRvLCBzZWdtZW50QW5nbGUpOwogICAgICAgICAgICAgZmluYWxDb2xvdXIgKj0gMS4wIC0gc21vb3Roc3RlcChlYUZyb20sIGVhVG8sIHNlZ21lbnRBbmdsZSk7CiAgICAgICAgICAgfQogICAgICAgICB9IGVsc2UgaWYoaGFzQ2lyY2xlRGFzaGVkQm9yZGVyKSB7CiAgICAgICAgICBmbG9hdCBkYXNoTGVuZ3RoID0gYm9yZGVyV2lkdGggKiAyLjA7CiAgICAgICAgICBmbG9hdCBnYXBXaWR0aCA9IGRhc2hMZW5ndGgvMi4wOwogICAgICAgICAgZmxvYXQgY2lyY3VtZmVyZW5jZSA9IDIuMCAqIChQSSAqIChzaGFwZVdpZHRoIC8yLjApKTsKICAgICAgICAgIGZsb2F0IGFuZ2xlQXJvdW5kQ2lyY2xlID0gc2VnbWVudEFuZ2xlIC8gKDIuMCpQSSk7CiAgICAgICAgICBmbG9hdCBkYXNoZXMgPSBmbG9vcigoY2lyY3VtZmVyZW5jZSArIGdhcFdpZHRoKSAvIChkYXNoTGVuZ3RoICsgZ2FwV2lkdGgpIC0gMS4wICk7CiAgICAgICAgICBmbG9hdCBkYXNoID0gc2luKCgoYW5nbGVBcm91bmRDaXJjbGUgKiBkYXNoZXMpKSAqICgyLjAgKiBQSSkpOwogICAgICAgICAgLy8gc21vb3RoIGFuZCBjdXQgb3V0IGEgZ2FwIHdoZW4gdGhlIHNpbmUgd2F2ZSBpZiBwYXN0IHRoZSBkYXNoVGhyZXNob2xkCiAgICAgICAgICBmaW5hbENvbG91ciAqPSBhYXN0ZXAoLTAuNSwgIGRhc2gpOwogICAgICAgICB9CiAgICAgIC8vIGRyYXcgYSBzcXVhcmUgYm9yZGVyLCBmaWxsIGEgc3F1YXJlIGFuZCBjdXQgb3V0IHRoZSBjZW50cmUKICAgICAgfSBlbHNlIGlmKHZfZG9udXRTZWdtZW50LnggPiAwLjApIHsKICAgICAgICBib3JkZXJXaWR0aEluUGl4ZWxzID0gZ2V0Qm9yZGVyV2lkdGhab29tKGJvcmRlcldpZHRoKTsKICAgICAgICBmaW5hbENvbG91ciA9IHJvdW5kUmVjdGFuZ2xlKGZpbmFsQ29sb3VyLCBib3JkZXJXaWR0aEluUGl4ZWxzLCBib3JkZXJSYWRpdXMpOwogICAgICB9IGVsc2UgaWYoaGFzUmVjdGFuZ2xlQm9yZGVyKSB7CiAgICAgICAgYm9yZGVyV2lkdGhJblBpeGVscyA9IGdldEJvcmRlcldpZHRoWm9vbShib3JkZXJXaWR0aCk7CiAgICAgICAgZmluYWxDb2xvdXIgKj0gcmVjdGFuZ2xlQm9yZGVyKGJvcmRlcldpZHRoSW5QaXhlbHMpOwogICAgICAgIGZpbmFsQ29sb3VyICo9IGZhZGVPdXRCb3JkZXIoc2hhcGVTaXplSW5TY3JlZW5QaXhlbHMpOwogICAgICAgIGlmKGhhc0Rhc2hlZEJvcmRlcikgewogICAgICAgICAgZmxvYXQgZGFzaExlbmd0aCA9IGJvcmRlcldpZHRoSW5QaXhlbHMgKiAyLjA7CiAgICAgICAgICBmbG9hdCBnYXBXaWR0aCA9IGJvcmRlcldpZHRoSW5QaXhlbHM7CiAgICAgICAgICBmbG9hdCBkYXNoZXMgPSBmbG9vcigodl90ZXhDb29yZC56ICsgZ2FwV2lkdGgpIC8gKGRhc2hMZW5ndGggKyBnYXBXaWR0aCkpICsgMC41OwogICAgICAgICAgZmxvYXQgZGFzaCA9IHNpbigoKCh2X3RleENvb3JkLnggLyB2X3RleENvb3JkLnopICogZGFzaGVzKSkgKiAoMi4wICogUEkpKTsKICAgICAgICAgIC8vIHNtb290aCBhbmQgY3V0IG91dCBhIGdhcCB3aGVuIHRoZSBzaW5lIHdhdmUgaWYgcGFzdCB0aGUgZGFzaFRocmVzaG9sZAogICAgICAgICAgZmluYWxDb2xvdXIgKj0gc3RlcCgtMC40OSwgIGRhc2gpOwogICAgICAgICAgZGFzaGVzID0gZmxvb3IoKHZfdGV4Q29vcmQudyArIGdhcFdpZHRoKSAvIChkYXNoTGVuZ3RoICsgZ2FwV2lkdGgpKSArIDAuNTsKICAgICAgICAgIGRhc2ggPSBzaW4oKCgodl90ZXhDb29yZC55LyB2X3RleENvb3JkLncpICogZGFzaGVzKSkgKiAoMi4wICogUEkpKTsKICAgICAgICAgIC8vIHNtb290aCBhbmQgY3V0IG91dCBhIGdhcCB3aGVuIHRoZSBzaW5lIHdhdmUgaWYgcGFzdCB0aGUgZGFzaFRocmVzaG9sZAogICAgICAgICAgZmluYWxDb2xvdXIgKj0gYWFzdGVwKC0wLjQ5LCAgZGFzaCk7ICAKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gdW5jb21tZW50IHRvIGRlYnVnIHNoYXBlCiAgICAgLy8gZmluYWxDb2xvdXIgPSB2ZWM0KDEuMCwwLjAsMC4wLDAuNSk7CiAgIH0KICBnbF9GcmFnQ29sb3IgPSBmaW5hbENvbG91cjsKfQ==",wo="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwphdHRyaWJ1dGUgdmVjMiBhX3Bvc2l0aW9uOwphdHRyaWJ1dGUgdmVjNCBhX3RleENvb3JkOwphdHRyaWJ1dGUgdmVjNCBhX2hpdFRlc3RDb2xvdXI7CmF0dHJpYnV0ZSB2ZWMyIGFfdGV4dHVyZUJhbms7CmF0dHJpYnV0ZSB2ZWM0IGFfY29sb3VyOwphdHRyaWJ1dGUgZmxvYXQgYV9jaXJjbGVSYWRpdXM7CmF0dHJpYnV0ZSBmbG9hdCBhX3dpZHRoOwphdHRyaWJ1dGUgZmxvYXQgYV9zdGFydEFuZ2xlOwphdHRyaWJ1dGUgZmxvYXQgYV9lbmRBbmdsZTsKCnVuaWZvcm0gdmVjMyB1X3Jlc29sdXRpb247CnVuaWZvcm0gbWF0NCB1X3RyYW5zZm9ybTsKdW5pZm9ybSBmbG9hdCB1X3pvb207CnVuaWZvcm0gbG93cCBmbG9hdCB1X2hpdFRlc3Q7Cgp2YXJ5aW5nIGZsb2F0IHZfYm9yZGVyV2lkdGg7CnZhcnlpbmcgdmVjMiB2X3NoYXBlU2l6ZTsKdmFyeWluZyB2ZWM0IHZfdGV4Q29vcmQ7CnZhcnlpbmcgdmVjNCB2X2NvbG91cjsKdmFyeWluZyB2ZWM0IHZfaGl0VGVzdENvbG91cjsKdmFyeWluZyB2ZWMyIHZfdGV4dHVyZUJhbms7CnZhcnlpbmcgZmxvYXQgdl9waXhlbDsKdmFyeWluZyB2ZWMyIHZfZG9udXRTZWdtZW50OwoKLy8gZW5zdXJlcyB0aGF0IG51bWJlcnMgYXJlIGV4YWN0bHkgaW50ZWdlcnMgCmludCByb3VuZFRvSW50KGZsb2F0IGEpIHsKICByZXR1cm4gaW50KGZsb29yKGEgKyAwLjUpKTsKfQoKLy8gZW5zdXJlcyB0aGF0IG51bWJlcnMgYXJlIGV4YWN0bHkgaW50ZWdlcnMgCnZlYzIgcm91bmQodmVjMiBhKSB7CiByZXR1cm4gZmxvb3IoYSArIDAuNSk7Cn0KCnZlYzIgdG9DbGlwU3BhY2UodmVjMiBwb3NpdGlvbnMpIHsKICAvLyBjb252ZXJ0IHRoZSByZWN0YW5nbGUgZnJvbSBwaXhlbHMgdG8gMC4wIHRvIDEuMAogIHZlYzIgemVyb1RvT25lID0gcG9zaXRpb25zIC8gdV9yZXNvbHV0aW9uLnh5OwogIC8vIGNvbnZlcnQgZnJvbSAwLT4xIHRvIDAtPjIKICB2ZWMyIHplcm9Ub1R3byA9IHplcm9Ub09uZSAqIDIuMDsKICAvLyBjb252ZXJ0IGZyb20gMC0+MiB0byAtMS0+KzEgKGNsaXBzcGFjZSkKICByZXR1cm4gemVyb1RvVHdvIC0gMS4wOwp9Cgp2ZWMyIHRvQ2FydGVzaWFuKHZlYzIgcG9zaXRpb25zKSB7CiAgLy8gY29udmVydCBmcm9tIC0xLT4rMSAoY2xpcHNwYWNlKSB0byAwLT4yCiAgcG9zaXRpb25zICs9IDEuMDsKICAvLyBjb252ZXJ0IGZyb20gMC0+MiB0byAwLT4xCiAgcG9zaXRpb25zIC89IDIuMDsKICAvLyBjb252ZXJ0IHRoZSByZWN0YW5nbGUgZnJvbSAwLjAgdG8gMS4wIHRvIHBpeGVscwogIHJldHVybiBwb3NpdGlvbnMgKiB1X3Jlc29sdXRpb24ueHk7Cn0KCi8vIHB1c2ggb3V0IGVhY2ggdmVydGV4IHRvIG1ha2UgdGhlIHNoYXBlIGxhcmdlcgp2ZWMyIGV4cGFuZFZlcnRleEZyb21DZW50cmUoaW50IHZlcnRleEluZGV4LCBmbG9hdCBzaXplKSB7CiAgLy8gVGhlIGRpcmVjdGlvbiB0byBwdXNoIG91dAogIHZlYzIgdW5pdFZlY3RvcjsKICAvLyBmb3IgZWFjaCBwb2ludCBpbiB0aGUgcXVhZCBnZXQgdGhlIGNlbnRyZSBwb2ludAogIGlmICh2ZXJ0ZXhJbmRleCA9PSAwKSB7CiAgICB1bml0VmVjdG9yID0gbm9ybWFsaXplKHZlYzIoLTEuMCwgLTEuMCkpOwogIH0gZWxzZSBpZih2ZXJ0ZXhJbmRleCA9PSAxKSB7CiAgICB1bml0VmVjdG9yID0gbm9ybWFsaXplKHZlYzIoMS4wLCAtMS4wKSk7CiAgfSBlbHNlIGlmKHZlcnRleEluZGV4ID09IDIpIHsKICAgIHVuaXRWZWN0b3IgPSBub3JtYWxpemUodmVjMigtMS4wLCAxLjApKTsKICB9IGVsc2UgaWYodmVydGV4SW5kZXggPT0gMykgewogICAgdW5pdFZlY3RvciA9IG5vcm1hbGl6ZSh2ZWMyKDEuMCwgMS4wKSk7CiAgfQogIHJldHVybiB1bml0VmVjdG9yICogbGVuZ3RoKHZlYzIoc2l6ZSkpOwp9Cgp2b2lkIG1haW4oKSB7CiAgIGJvb2wgaXNIaXRUZXN0aW5nID0gcm91bmRUb0ludCh1X2hpdFRlc3QpID09IDE7CiAgIGJvb2wgaXNDaXJjbGUgPSBhX2NpcmNsZVJhZGl1cyA+IDAuMDsKICAgaW50IHRleHR1cmVCYW5rID0gcm91bmRUb0ludChhX3RleHR1cmVCYW5rLngpOwogICBmbG9hdCBib3JkZXJXaWR0aCA9IDAuMDsKICAgYm9vbCBpc0JvcmRlciA9IGZhbHNlOwogICB2ZWMyIHZlcnRleFBvc2l0aW9uID0gYV9wb3NpdGlvbi54eTsKICAgZmxvYXQgaGFsZldpZHRoOwogICBmbG9hdCBoYWxmSGVpZ2h0OwogICB2ZWMyIHVuaXRWZWN0b3I7CiAgIGludCB2ZXJ0ZXhJbmRleCA9IHJvdW5kVG9JbnQoYV90ZXh0dXJlQmFuay55KTsKICAgaWYoaXNDaXJjbGUpIHsKICAgICBoYWxmV2lkdGggPSBhYnMoYV9jaXJjbGVSYWRpdXMpOwogICAgIGhhbGZIZWlnaHQgPSBoYWxmV2lkdGg7CiAgIH0gZWxzZSB7CiAgICAgaGFsZldpZHRoID0gYV90ZXhDb29yZC56IC8gMi4wOwogICAgIGhhbGZIZWlnaHQgPSBhX3RleENvb3JkLncgLyAyLjA7CiAgIH0KICAgZmxvYXQgdmlld0V4dHJhID0gMC4wOwogICAvLyBpZiBpdHMgYW4gaW1hZ2UsIG1ha2UgaXQgbGFyZ2VyIGJ5IHRoZSBhbW91bnQgb2YgcGl4ZWxzIHNwZWNpZmllZCBpbiB2aWV3RXh0cmEgKGFfd2lkdGgpCiAgIGlmICh0ZXh0dXJlQmFuayA+IDMpIHsKICAgICB2aWV3RXh0cmEgPSBhX3dpZHRoOwogICAgIHZlcnRleFBvc2l0aW9uICs9IGV4cGFuZFZlcnRleEZyb21DZW50cmUodmVydGV4SW5kZXgsIHZpZXdFeHRyYSAvIHVfem9vbSk7CiAgIH0gZWxzZSB7CiAgICAgYm9yZGVyV2lkdGggPSBhYnMoYV93aWR0aCk7CiAgICAgaXNCb3JkZXIgPSByb3VuZFRvSW50KGJvcmRlcldpZHRoKSA+IDA7CiAgIH0KICAgCiAgIGZsb2F0IGJvcmRlcldpZHRoT3V0U2l6ZSA9IGNlaWwoYm9yZGVyV2lkdGggLyAyLjApOwogICBpZihpc0JvcmRlcikgewogICAgIC8vIFdoZW4gaGl0IHRlc3RpbmcsIG1ha2UgdGhlIGJvcmRlcnMgdGhpY2tlciBzbyB0aGF0IHRoZXkgYXJlIGVhc3kgdG8gaGl0CiAgICAgaWYoaXNIaXRUZXN0aW5nKSB7CiAgICAgICAgZmxvYXQgYm9yZGVyWm9vbSA9ICAoNy4wIC8gdV96b29tKSAqIHNpZ24oYV93aWR0aCk7CiAgICAgICAvLyBhZGQgNyBzY3JlZW4gcGl4ZWxzIHRvIHRoZSBsaW5lIHRoaWNrbmVzcwogICAgICAgYm9yZGVyV2lkdGggKz0gYm9yZGVyWm9vbTsKICAgICAgIC8vIG1ha2UgdGhlIGJvcmRlciBsYXJnZXIgdG8gYWNjb21vZGF0ZSBuZXcgc2l6ZQogICAgICAgYm9yZGVyV2lkdGhPdXRTaXplICs9IGNlaWwoYm9yZGVyWm9vbSAvIDIuMCk7CiAgICAgfQogICAgIHZlcnRleFBvc2l0aW9uICs9IGV4cGFuZFZlcnRleEZyb21DZW50cmUodmVydGV4SW5kZXgsIGJvcmRlcldpZHRoT3V0U2l6ZSk7CiAgIH0KCiAgIGdsX1Bvc2l0aW9uID0gdV90cmFuc2Zvcm0gKiB2ZWM0KHRvQ2xpcFNwYWNlKHZlcnRleFBvc2l0aW9uKSAqIHZlYzIoMSwgLTEpLCAwLCAxKTsKICAgCiAgIGlmIChpc0JvcmRlciAmJiAhaXNDaXJjbGUpIHsKICAgICAvLyBHZXQgZmluYWwgcG9zaXRpb24gaW4gc2NyZWVuc3BhY2UKICAgICB2ZWMyIHZpZXdQb3NpdGlvbiA9IGdsX1Bvc2l0aW9uLnh5OwogICAgIC8vIGNvbnZlcnQgdG8gcGl4ZWxzCiAgICAgdmlld1Bvc2l0aW9uID0gdG9DYXJ0ZXNpYW4odmlld1Bvc2l0aW9uKTsKICAgICB2aWV3UG9zaXRpb24gPSByb3VuZCh2aWV3UG9zaXRpb24pOwogICAgIGdsX1Bvc2l0aW9uLnh5ID0gdG9DbGlwU3BhY2Uodmlld1Bvc2l0aW9uKTsKICAgfQogICAKICAgLy8gcGFzcyB0aGUgdGV4Q29vcmQgdG8gdGhlIGZyYWdtZW50IHNoYWRlcgogICAvLyBUaGUgR1BVIHdpbGwgaW50ZXJwb2xhdGUgdGhpcyB2YWx1ZSBiZXR3ZWVuIHBvaW50cy4KICAgdl90ZXhDb29yZCA9IGFfdGV4Q29vcmQ7CiAgIHZfY29sb3VyID0gYV9jb2xvdXI7CiAgIHZfaGl0VGVzdENvbG91ciA9IGFfaGl0VGVzdENvbG91cjsKICAgdl90ZXh0dXJlQmFuayA9IGFfdGV4dHVyZUJhbms7CiAgIGZsb2F0IGJvcmRlckV4cGFuc2lvbiA9IGJvcmRlcldpZHRoT3V0U2l6ZSAqIHNpZ24oYV9jaXJjbGVSYWRpdXMpOwogICBpZihpc0NpcmNsZSkgewogICAgIC8vICM3MDQyIEhhZCB0byBzcGxpdCB1cCB0aGlzIGNhbGN1bGF0aW9uIGJlY2F1c2UgdmVjMihhKSArIGIgc2VlbXMgbm90IHRvIHdvcmsgb24KICAgICAvLyBQaXhlbCBDIHRhYmxldAogICAgIGZsb2F0IHNoYXBlRGlhbWV0ZXIgPSAoYV9jaXJjbGVSYWRpdXMgKyBib3JkZXJFeHBhbnNpb24pICogMi4wOwogICAgIHZfc2hhcGVTaXplID0gdmVjMihzaGFwZURpYW1ldGVyKTsKICAgfSBlbHNlIHsKICAgICB2X3NoYXBlU2l6ZSA9IHZlYzIoLWFfdGV4Q29vcmQueiArIGJvcmRlckV4cGFuc2lvbiwgYV90ZXhDb29yZC53IC0gYm9yZGVyRXhwYW5zaW9uKTsKICAgfQogICB2X2JvcmRlcldpZHRoID0gYm9yZGVyV2lkdGggKiBzaWduKGFfd2lkdGgpOwogICAvLyB0aGUgc2l6ZSBvZiBhIHBpeGVsIGluIHNjcmVlbnNwYWNlIGNsaXAgY29vcmRpbmF0ZXMKICAgdl9waXhlbCA9ICgxLjAgLyAoYV9jaXJjbGVSYWRpdXMgKiAyLjApKSAvIHVfem9vbTsKICAgdl9kb251dFNlZ21lbnQgPSB2ZWMyKGFfc3RhcnRBbmdsZSwgYV9lbmRBbmdsZSk7Cn0=",Zo="I2lmZGVmIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcwojZXh0ZW5zaW9uIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA6IGVuYWJsZQojZW5kaWYKCnByZWNpc2lvbiBoaWdocCBmbG9hdDsKCi8vIG91ciB0ZXh0dXJlCnVuaWZvcm0gc2FtcGxlcjJEIHVfaW1hZ2U7CnVuaWZvcm0gZmxvYXQgdV9nbG9iYWxBbHBoYTsKdW5pZm9ybSB2ZWM0IHVfYmFja2dyb3VuZENvbG91cjsKCi8vIHRoZSB0ZXhDb29yZHMgcGFzc2VkIGluIGZyb20gdGhlIHZlcnRleCBzaGFkZXIuCnZhcnlpbmcgdmVjMiB2X3RleENvb3JkOwoKdm9pZCBtYWluKCkgewogIGdsX0ZyYWdDb2xvciA9ICh0ZXh0dXJlMkQodV9pbWFnZSwgdl90ZXhDb29yZCkgKyB1X2JhY2tncm91bmRDb2xvdXIpICogdV9nbG9iYWxBbHBoYTsKfQo=",Ao="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwphdHRyaWJ1dGUgdmVjMiBhX3Bvc2l0aW9uOwphdHRyaWJ1dGUgdmVjMiBhX3RleENvb3JkOwoKdmFyeWluZyB2ZWMyIHZfdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKSB7CiAgIGdsX1Bvc2l0aW9uID0gdmVjNChhX3Bvc2l0aW9uLCAwLjAsMS4wKTsKICAgdl90ZXhDb29yZCA9IGFfdGV4Q29vcmQ7Cn0K",Bo={}
;Bo["line-arc-vertex"]=po;Bo["line-fragment"]=Co;Bo["line-vertex"]=xo;Bo["triangle-fragment"]=Go;Bo["triangle-vertex"]=wo;Bo["renderToTexture-fragment"]=Zo;Bo["renderToTexture-vertex"]=Ao;function Ro(e,t){for(var n=["webgl","experimental-webgl"],r=null,i=0;i<n.length;++i){try{r=e.getContext(n[i],t)}catch(e){}if(r)break}return r}function Mo(e,t,n){var r=Xo(e,[t,n]);r.vertexShader=t;r.fragmentShader=n;return r}function Wo(e,t){e.useProgram(t);e.bindBuffer(e.ARRAY_BUFFER,null);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);e.bindRenderbuffer(e.RENDERBUFFER,null);e.bindFramebuffer(e.FRAMEBUFFER,null)}function Vo(){var e={},t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n=1;e.zoom=function(e){n=e;t[0]*=e;t[4]*=e;t[8]*=1;t[1]*=e;t[5]*=e;t[9]*=1;t[2]*=e;t[6]*=e;t[10]*=1;t[3]*=e;t[7]*=e;t[11]*=1};e.getZoomLevel=function(){return n};e.pan=function(e,n){t[12]+=t[0]*e+t[4]*n;t[13]+=t[1]*e+t[5]*n;t[14]+=t[2]*e+t[6]*n;t[15]+=t[3]*e+t[7]*n};e.get=function(){return t};return e}function So(e,t,n){var r=e.createShader(n),i=atob(Bo[t]);e.shaderSource(r,i);e.compileShader(r);if(!e.getShaderParameter(r,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(r);e.deleteShader(r);throw new Error("Error in shader: "+a)}return r}var Xo=function(e,t){for(var n=e.createProgram(),r=0;r<t.length;++r)e.attachShader(n,t[r]);e.linkProgram(n);if(!e.getProgramParameter(n,e.LINK_STATUS)){var i=e.getProgramInfoLog(n);e.deleteProgram(n);throw new Error("Error in program linking:"+i)}return n};function ko(e){var t,n=e,r=10*Float32Array.BYTES_PER_ELEMENT,i={};if(!n.lineShader){var a=So(n,"line-vertex",n.VERTEX_SHADER),o=So(n,"line-fragment",n.FRAGMENT_SHADER);t=Mo(n,a,o);n.lineShader={vertexShader:a,fragmentShader:o,program:t}}t=n.lineShader.program;n.getExtension("OES_standard_derivatives");n.getExtension("OES_element_index_uint");var l={position1:n.getAttribLocation(t,"a_position1"),position2:n.getAttribLocation(t,"a_position2"),position3:n.getAttribLocation(t,"a_position3"),colour:n.getAttribLocation(t,"a_colour"),colour2:n.getAttribLocation(t,"a_colour2"),vertexInfo:n.getAttribLocation(t,"a_vertexInfo"),shadowColour:n.getAttribLocation(t,"a_hitTestColour"),index:n.getAttribLocation(t,"a_index")},u={hitTest:n.getUniformLocation(t,"u_hitTest"),zoom:n.getUniformLocation(t,"u_zoom"),transform:n.getUniformLocation(t,"u_transform"),resolution:n.getUniformLocation(t,"u_resolution"),shadowType:n.getUniformLocation(t,"u_shadowType"),viewIndependent:n.getUniformLocation(t,"u_viewIndependent"),gradientStartFraction:n.getUniformLocation(t,"u_gradientStartFraction")};i.finish=function(){Wo(n,t)};i.drawItems=function(e,r,i,a,o,l,u,v){n.useProgram(t);h();c(i,a,o,l,u,0|e.shadowType,e.useView,v);s(r);d(e,r);f(r);g(r);h()};function c(e,t,r,i,a,o,l,c){n.uniform3f(u.resolution,t,r,i);n.uniformMatrix4fv(u.transform,!1,e.get());n.uniform1f(u.hitTest,0|a);n.uniform1f(u.zoom,e.getZoomLevel());n.uniform1f(u.shadowType,o);n.uniform1f(u.viewIndependent,0|!l);var s=0;a||(s=(1-c.linkStyle.transition)/2);n.uniform1f(u.gradientStartFraction,s)}function s(e){e.elementBuffer||(e.elementBuffer=n.createBuffer());e.indexBuffer||(e.indexBuffer=n.createBuffer())}function f(e){n.bindBuffer(n.ARRAY_BUFFER,e.elementBuffer);n.enableVertexAttribArray(l.position1);n.enableVertexAttribArray(l.position2);n.enableVertexAttribArray(l.position3);n.enableVertexAttribArray(l.vertexInfo);n.enableVertexAttribArray(l.colour);n.enableVertexAttribArray(l.colour2);n.enableVertexAttribArray(l.shadowColour);n.enableVertexAttribArray(l.index);n.vertexAttribPointer(l.position1,2,n.FLOAT,!1,r,0);n.vertexAttribPointer(l.position2,2,n.FLOAT,!1,r,8);n.vertexAttribPointer(l.position3,2,n.FLOAT,!1,r,16);n.vertexAttribPointer(l.vertexInfo,4,n.UNSIGNED_BYTE,!1,r,24);n.vertexAttribPointer(l.colour,4,n.UNSIGNED_BYTE,!1,r,28);n.vertexAttribPointer(l.colour2,4,n.UNSIGNED_BYTE,!1,r,32);n.vertexAttribPointer(l.shadowColour,3,n.UNSIGNED_BYTE,!1,r,36);n.vertexAttribPointer(l.index,1,n.UNSIGNED_BYTE,!1,r,39)}function d(e,t){if(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.positions||e.rebuildOptions.colours||e.rebuildOptions.textures||e.rebuildOptions.shadow){n.bindBuffer(n.ARRAY_BUFFER,t.elementBuffer);n.bufferData(n.ARRAY_BUFFER,t.elementData,n.DYNAMIC_DRAW);n.bindBuffer(n.ARRAY_BUFFER,null);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.elementIndex,n.DYNAMIC_DRAW);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}}function g(e){n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer);n.drawElements(n.TRIANGLES,6*e.numOfLines+3*e.numOfArrowheads,n.UNSIGNED_INT,0)}function h(){n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null);n.bindBuffer(n.ARRAY_BUFFER,null)}return i}var Eo=6*Float32Array.BYTES_PER_ELEMENT,Yo=3*Float32Array.BYTES_PER_ELEMENT,Fo=4*Uint8Array.BYTES_PER_ELEMENT,Ho=8*Uint8Array.BYTES_PER_ELEMENT;function Lo(e){var t,n={},r=e;if(!r.arcShader){var i=So(r,"line-arc-vertex",r.VERTEX_SHADER),a=So(r,"line-fragment",r.FRAGMENT_SHADER);t=Mo(r,i,a);r.arcShader={vertexShader:i,fragmentShader:a,program:t}}t=r.arcShader.program;var o={position:r.getAttribLocation(t,"a_position"),radius:r.getAttribLocation(t,"a_radius"),startAngle:r.getAttribLocation(t,"a_startAngle"),endAngle:r.getAttribLocation(t,"a_endAngle"),width:r.getAttribLocation(t,"a_width"),colour:r.getAttribLocation(t,"a_colour"),colour2:r.getAttribLocation(t,"a_colour2"),core:r.getAttribLocation(t,"a_core"),type:r.getAttribLocation(t,"a_lineType"),shadowColour:r.getAttribLocation(t,"a_hitTestColour")},l={hitTest:r.getUniformLocation(t,"u_hitTest"),zoom:r.getUniformLocation(t,"u_zoom"),transform:r.getUniformLocation(t,"u_transform"),resolution:r.getUniformLocation(t,"u_resolution"),shadowType:r.getUniformLocation(t,"u_shadowType"),gradientStartFraction:r.getUniformLocation(t,"u_gradientStartFraction")};n.finish=function(){Wo(r,t)};n.drawItems=function(e,n,i,a,o,l,v){r.useProgram(t);u(n,i,a,o,l,0|e.shadowType,v);c(e);s(e);f(e);g(e);d(e);r.drawArrays(r.TRIANGLES,0,e.arcBuffers.totalnumOfVertices);h()};function u(e,t,n,i,a,o,u){r.uniform3f(l.resolution,t,n,i);r.uniformMatrix4fv(l.transform,!1,e.get());r.uniform1f(l.hitTest,0|a);r.uniform1f(l.zoom,e.getZoomLevel());r.uniform1f(l.shadowType,o);var c=0;a||(c=(1-u.linkStyle.transition)/2);r.uniform1f(l.gradientStartFraction,c)}function c(e){e.arcBuffers.positionBuffer||(e.arcBuffers.positionBuffer=r.createBuffer());e.arcBuffers.colourBuffer||(e.arcBuffers.colourBuffer=r.createBuffer());e.arcBuffers.shadowBuffer||(e.arcBuffers.shadowBuffer=r.createBuffer());e.arcBuffers.coreBuffer||(e.arcBuffers.coreBuffer=r.createBuffer())}function s(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.colourBuffer);(e.rebuildOptions.colours||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.colourData,r.STATIC_DRAW);r.enableVertexAttribArray(o.colour);r.enableVertexAttribArray(o.colour2);r.vertexAttribPointer(o.colour,4,r.UNSIGNED_BYTE,!1,Ho,0);r.vertexAttribPointer(o.colour2,4,r.UNSIGNED_BYTE,!1,Ho,4)}function f(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.shadowBuffer);(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.shadow)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.shadowData,r.STATIC_DRAW);r.enableVertexAttribArray(o.shadowColour);r.enableVertexAttribArray(o.type);r.vertexAttribPointer(o.shadowColour,3,r.UNSIGNED_BYTE,!1,Fo,0);r.vertexAttribPointer(o.type,1,r.UNSIGNED_BYTE,!1,Fo,3)}function d(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.coreBuffer);(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.shadow)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.coreData,r.STATIC_DRAW);r.enableVertexAttribArray(o.core);r.vertexAttribPointer(o.core,3,r.FLOAT,!1,Yo,0)}function g(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.positionBuffer);(e.rebuildOptions.positions||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.positionData,r.STATIC_DRAW);r.enableVertexAttribArray(o.position);r.enableVertexAttribArray(o.radius);r.enableVertexAttribArray(o.startAngle);r.enableVertexAttribArray(o.endAngle);r.enableVertexAttribArray(o.width);r.vertexAttribPointer(o.position,2,r.FLOAT,!1,Eo,0);r.vertexAttribPointer(o.radius,1,r.FLOAT,!1,Eo,8);r.vertexAttribPointer(o.startAngle,1,r.FLOAT,!1,Eo,12);r.vertexAttribPointer(o.endAngle,1,r.FLOAT,!1,Eo,16);r.vertexAttribPointer(o.width,1,r.FLOAT,!1,Eo,20)}function h(){r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null);r.bindBuffer(r.ARRAY_BUFFER,null)}return n}function To(e){var t,n={},r=e,i=3*Float32Array.BYTES_PER_ELEMENT,a=9*Float32Array.BYTES_PER_ELEMENT,o=4*Uint8Array.BYTES_PER_ELEMENT,l=4*Uint8Array.BYTES_PER_ELEMENT;if(!r.triangleShader){var u=So(r,"triangle-vertex",r.VERTEX_SHADER),c=So(r,"triangle-fragment",r.FRAGMENT_SHADER);t=Mo(r,u,c);r.triangleShader={vertexShader:u,fragmentShader:c,program:t}}t=r.triangleShader.program;var s={transform:r.getUniformLocation(t,"u_transform"),textures:r.getUniformLocation(t,"u_image[0]"),resolution:r.getUniformLocation(t,"u_resolution"),hitTest:r.getUniformLocation(t,"u_hitTest"),shadowType:r.getUniformLocation(t,"u_shadowType"),zoom:r.getUniformLocation(t,"u_zoom"),position:r.getAttribLocation(t,"a_position"),startAngle:r.getAttribLocation(t,"a_startAngle"),endAngle:r.getAttribLocation(t,"a_endAngle"),circleRadius:r.getAttribLocation(t,"a_circleRadius"),width:r.getAttribLocation(t,"a_width"),colour:r.getAttribLocation(t,"a_colour"),textCoord:r.getAttribLocation(t,"a_texCoord"),shadowColour:r.getAttribLocation(t,"a_hitTestColour"),textureBank:r.getAttribLocation(t,"a_textureBank")};n.drawItems=function(e,n,i,a,o,l,u,c,s){r.useProgram(t);I(n,l,u,c,s,0|e.shadowType);b(e);d(e);g(e);h(e);v(e);f(i,a,o);r.drawArrays(r.TRIANGLES,0,3*e.triangleBuffers.numOfTriangles)};n.finish=function(){Wo(r,t)};function f(e,t,n){var r,i;for(r=0,i=e.atlases.length;r<i;r++)m(e.atlases[r],r);t&&m(t,3);for(r=0,i=n.length;r<i;r++)m(n[r],r+4)}function d(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.shadowBuffer);(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.shadow)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.shadowData,r.STATIC_DRAW);r.enableVertexAttribArray(s.shadowColour);r.vertexAttribPointer(s.shadowColour,4,r.UNSIGNED_BYTE,!1,l,0)}function g(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.textureBuffer);(e.rebuildOptions.textures||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.textureData,r.STATIC_DRAW);r.enableVertexAttribArray(s.textCoord);r.enableVertexAttribArray(s.textureBank);r.enableVertexAttribArray(s.circleRadius);r.enableVertexAttribArray(s.startAngle);r.enableVertexAttribArray(s.endAngle);r.vertexAttribPointer(s.textCoord,4,r.FLOAT,!1,a,0);r.vertexAttribPointer(s.textureBank,2,r.FLOAT,!1,a,16);r.vertexAttribPointer(s.circleRadius,1,r.FLOAT,!1,a,24);r.vertexAttribPointer(s.startAngle,1,r.FLOAT,!1,a,28);r.vertexAttribPointer(s.endAngle,1,r.FLOAT,!1,a,32)}function h(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.colourBuffer);(e.rebuildOptions.colours||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.colourData,r.STATIC_DRAW);r.enableVertexAttribArray(s.colour);r.vertexAttribPointer(s.colour,4,r.UNSIGNED_BYTE,!1,o,0)}function v(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.positionBuffer);(e.rebuildOptions.positions||e.rebuildOptions.all||e.alwaysUpdate)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.positionData,r.STATIC_DRAW);r.enableVertexAttribArray(s.position);r.enableVertexAttribArray(s.width);r.vertexAttribPointer(s.position,2,r.FLOAT,!1,i,0);r.vertexAttribPointer(s.width,1,r.FLOAT,!1,i,8)}function m(e,t){r.activeTexture(r["TEXTURE"+t]);if(e.texture)r.bindTexture(r.TEXTURE_2D,e.texture);else{e.texture=r.createTexture();var n=e.alphaChannel?r.RGBA:r.RGB;r.bindTexture(r.TEXTURE_2D,e.texture);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);r.texImage2D(r.TEXTURE_2D,0,n,n,r.UNSIGNED_BYTE,e.img);r.generateMipmap(r.TEXTURE_2D);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);e.img=null}}function b(e){e.triangleBuffers.positionBuffer||(e.triangleBuffers.positionBuffer=r.createBuffer());e.triangleBuffers.textureBuffer||(e.triangleBuffers.textureBuffer=r.createBuffer());e.triangleBuffers.colourBuffer||(e.triangleBuffers.colourBuffer=r.createBuffer());e.triangleBuffers.shadowBuffer||(e.triangleBuffers.shadowBuffer=r.createBuffer())}function I(e,t,n,i,a,o){r.uniform3f(s.resolution,t,n,i);r.uniform1f(s.hitTest,0|a);r.uniform1iv(s.textures,[0,1,2,3,4,5,6,7]);r.uniformMatrix4fv(s.transform,!1,e.get());r.uniform1f(s.shadowType,o);r.uniform1f(s.zoom,e.getZoomLevel())}return n}function No(e){var t,n={},r=e;if(!r.rttShader){var i=So(r,"renderToTexture-vertex",r.VERTEX_SHADER),a=So(r,"renderToTexture-fragment",r.FRAGMENT_SHADER);t=Mo(r,i,a);r.rttShader={vertexShader:i,fragmentShader:a,program:t}}t=r.rttShader.program;var o=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,-1,1,0,1,1,-1,1,0,1,1,1,1]),l=r.createBuffer(),u={position:r.getAttribLocation(t,"a_position"),textCoord:r.getAttribLocation(t,"a_texCoord")},c={globalAlpha:r.getUniformLocation(t,"u_globalAlpha"),backgroundColour:r.getUniformLocation(t,"u_backgroundColour"),textures:r.getUniformLocation(t,"u_image")};n.finish=function(){Wo(r,t)};n.drawItems=function(e,n,i,a){r.useProgram(t);d(e,i);s(a||o);f(n,0);r.drawArrays(r.TRIANGLES,0,6)};function s(e){r.bindBuffer(r.ARRAY_BUFFER,l);r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW);r.enableVertexAttribArray(u.position);r.enableVertexAttribArray(u.textCoord);r.vertexAttribPointer(u.position,2,r.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0);r.vertexAttribPointer(u.textCoord,2,r.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,8)}function f(e,t){r.activeTexture(r["TEXTURE"+t]);r.bindTexture(r.TEXTURE_2D,e)}function d(e,t){r.uniform1f(c.globalAlpha,e);r.uniform4fv(c.backgroundColour,new Float32Array(t||[0,0,0,0]))}return n}function zo(e){var t,n,r,i,a,o={},l=e.canvas,u=e.framebuffers,c=y(),s=ko(c),f=Lo(c),d=To(c),g=No(c),h=null;o.finish=function(){o.clearFramebuffers();f.finish();s.finish();d.finish();e.imageAtlases.forEach(function(e){X(e)});X(e.textAtlas);X(e.fontIconAtlas);e.layersToDraw=[];e.allLayers={};c.flush();c.finish();c=null;s=null;f=null;d=null;g=null};o.clearView=function(e){e&&(c=y());x();c.clear(c.COLOR_BUFFER_BIT)};o.clearFramebuffers=function(){Y(e.framebuffers).forEach(function(e){c.deleteFramebuffer(e.framebuffer);c.deleteRenderbuffer(e.renderbuffer);c.deleteTexture(e.texture)});e.framebuffers={};u=e.framebuffers};o.clearTextureAtlas=function(e){e&&(Array.isArray(e)?e.forEach(X):X(e))};o.render=function(t,u,s,f,d,g){n=l.clientWidth;r=l.clientHeight;var h=l.width/n;i=c.drawingBufferWidth;a=c.drawingBufferHeight;var m=e.layersToDraw,b=G(t);e.view=t;if(g.showShadowCanvas)return o.drawShadowCanvas(0,0,!0);for(var y=!1,p=0,x=m.length;p<x;p++){var Z=m[p];if(g.overview&&g.overview.shown&&Z.blatOverview&&u)v(u,s,f,d,g);else{if(V(Z)){Z.drawFramebuffer&&(y=!0);I(Z.drawFramebuffer);w(Z,b,n,r,h,s,f,d,g.showShadowCanvas,g);W(Z)}if(Z.drawBackgroundColour||Z.useFramebuffer&&y){y=!1;M();C(Z.useFramebuffer,Z.fbAlpha,Z.drawBackgroundColour);I(Z.useFramebuffer);c.clear(c.COLOR_BUFFER_BIT)}}}S()};o.drawShadowCanvas=function(o,u,s){n=l.clientWidth;r=l.clientHeight;var f=l.width/n;i=c.drawingBufferWidth;a=c.drawingBufferHeight;if(e.layersToDraw.length>0){var d=G(e.view),g=i/l.clientWidth,h=o*g,v=a-u*g;s?M():I("shadow");for(var m=0,b=e.layersToDraw.length;m<b;m++){w(e.layersToDraw[m],d,n,r,f,e.textAtlas,e.fontIconAtlas,e.imageAtlases,!0)}!s&&h>=0&&v>=0&&h<i&&v<a&&c.readPixels(h,v,1,1,c.RGBA,c.UNSIGNED_BYTE,t)}return t};o.getPixels=function(e,t,n,r,i,a){M();c.clearColor(1,1,1,1);o.clearView();o.render(e,t,n,r,i,a);var l=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,l);return l};function v(t,i,a,o,u){n=l.clientWidth;var s=l.width/n,f=t.width(),d=t.height(),g=G(t);I("overview",f*s,d*s);c.clear(c.COLOR_BUFFER_BIT);for(var h=e.layersToDraw,v=0,m=h.length;v<m;v++){var b=h[v];b.overview&&w(b,g,f,d,s,i,a,o,u.showShadowCanvas,u)}I(null);var y=p(f,d,n,r,u);C("overview",1,[1,1,1,1],y);C("overview",1,null,y)}function m(){var e=c.createTexture();c.bindTexture(c.TEXTURE_2D,e);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);return e}function b(e){e?c.bindFramebuffer(c.FRAMEBUFFER,e.framebuffer):M()}function I(e,t,n){var r=u[e]||null,i=c.RGBA,a=t||c.drawingBufferWidth,o=n||c.drawingBufferHeight;c.viewport(0,0,a,o);if(e&&!r){r={framebuffer:c.createFramebuffer(),renderbuffer:c.createRenderbuffer(),texture:m()};u[e]=r;"shadow"===e&&(i=c.RGB);c.texImage2D(c.TEXTURE_2D,0,i,a,o,0,i,c.UNSIGNED_BYTE,null);c.bindFramebuffer(c.FRAMEBUFFER,r.framebuffer);c.bindRenderbuffer(c.RENDERBUFFER,r.renderbuffer);c.clearColor(0,0,0,0);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,a,o);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r.texture,0);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,r.renderbuffer);var l=c.checkFramebufferStatus(c.FRAMEBUFFER);if(c.FRAMEBUFFER_COMPLETE!==l)throw new Error(l.toString())}b(r)}function y(){c=Ro(l,{antialias:!1,preferLowPowerToHighPerformance:!1,depth:!1,stencil:!1});n=l.width;r=l.height;i=c.drawingBufferWidth;a=c.drawingBufferHeight;c.getExtension("OES_standard_derivatives");c.getExtension("OES_element_index_uint");c.viewport(0,0,i,a);c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA);c.enable(c.BLEND);c.clearColor(0,0,0,0);e.framebuffers={};u=e.framebuffers;t=new Uint8Array(4);return c}function p(e,t,n,r,i){var a,o=1-e/n*2,l=1-t/r*2;switch(i.overview.p){case"ne":a=new Float32Array([o,l,0,0,1,l,1,0,o,1,0,1,o,1,0,1,1,l,1,0,1,1,1,1]);break;case"nw":a=new Float32Array([-1,l,0,0,-o,l,1,0,-1,1,0,1,-1,1,0,1,-o,l,1,0,-o,1,1,1]);break;case"sw":a=new Float32Array([-1,-1,0,0,-o,-1,1,0,-1,-l,0,1,-1,-l,0,1,-o,-1,1,0,-o,-l,1,1]);break;case"se":default:a=new Float32Array([o,-1,0,0,1,-1,1,0,o,-l,0,1,o,-l,0,1,1,-1,1,0,1,-l,1,1])}return a}function C(e,t,n,r){var i;u[e]&&(i=u[e].texture);g.drawItems(t,i,n,r)}function x(){c.viewport(0,0,c.drawingBufferWidth,c.drawingBufferHeight)}function G(e){return e?{panX:e.offsetXtoWebglPanX(),panY:e.offsetYtoWebglPanY(),zoom:e.settings().zoom}:{panX:0,panY:0,zoom:1}}function w(e,t,n,r,i,a,o,l,u,c){Z(e.useView,t.panX,t.panY,t.zoom);A(s,e,e.lineBuffers,h,n,r,i,u,c);B(f,e,h,n,r,i,u,c);R(d,e,h,a,o,l,n,r,i,u)}function Z(e,t,n,r){h=Vo();if(e){h.pan(t,n);h.zoom(r)}else{h.pan(0,0);h.zoom(1)}}function A(e,t,n,r,i,a,o,l,u){n.numOfLines>0&&e.drawItems(t,n,r,i,a,o,l,u)}function B(e,t,n,r,i,a,o,l){t.arcBuffers.numOfTriangles>0&&e.drawItems(t,n,r,i,a,o,l)}function R(e,t,n,r,i,a,o,l,u,c){t.triangleBuffers.numOfTriangles>0&&e.drawItems(t,n,r,i,a,o,l,u,c)}function M(){c.bindFramebuffer(c.FRAMEBUFFER,null)}function W(e){e.rebuildOptions.colours=!1;e.rebuildOptions.positions=!1;e.rebuildOptions.textures=!1;e.rebuildOptions.shadow=!1;e.rebuildOptions.all=!1}function V(e){return e.lineBuffers.numOfLines||e.arcBuffers.numOfTriangles||e.triangleBuffers.numOfTriangles||e.drawBackgroundColour}function S(){for(var e=0;e<8;e++){c.activeTexture(c["TEXTURE"+e]);c.bindTexture(c.TEXTURE_2D,null)}}function X(e){if(e&&e.texture){c.deleteTexture(e.texture);e.texture=null;e.ctx=null;e.img=null}}return o}function Uo(e,t){for(var n="abcdefghijklmnopqrstuvwzyzABCDEFGHIJKLMNOPQRSTUVWXWZ$£1234567890()",r=new A,i=function(){return Object.keys(u).filter(function(e){return!r.get(e)})},a=function(){return Object.keys(u).filter(function(e){return r.get(e)})},o={},l=function(e){o=e},u={},c=0,s=n.length;c<s;c++)u[n[c]]=!0;var f=function(e,t){for(var n=!1,i=!1,a=0,o=e.length;a<o;a++){var l=e[a];r.get(l)?n=!0:i=!0;u[l]||(u[l]=!0)}n&&(t.imageAtlas=!0);i&&(t.textAtlas=!0)};return{getNonEmojiGlyphs:i,getEmojiGlyphs:a,setEmojiGlyphImages:l,getGlyphsFromText:function(n,i,a,l,u,c,s){var d,g=t.getCombinedCharacters(n);c&&(g=e.analyseText(g,n).result);var h,v,m,b=!1,I={},y=[],p=s.getGlyphInfoForFont(i||a),C=0;if(l)for(h=0,v=g.length;h<v;h++){d=g[h].text||g[h];r.has(d)||r.set(d,fe(d));if(r.get(d))m=o[d];else{m=p[d+"B"]}if(m)y[C++]=m;else{I[d]=!0;b=!0}}else for(h=0,v=g.length;h<v;h++){d=g[h].text||g[h];r.has(d)||r.set(d,fe(d));if(m=r.get(d)?o[d]:p[d])y[C++]=m;else{I[d]=!0;b=!0}}b&&f(Object.keys(I),u);return y}}}function Do(){var e={},t=new A;e.getCombinedCharacters=function(e){var n=t.get(e);if(!n){n=ge(de(e));t.set(e,n)}return n};return e}function _o(e){var t={},n=Do(),r={bidi:Gt,canvas:e,layersToDraw:[],textAtlas:null,fontIconAtlas:null,imageAtlases:[],allLayers:{},framebuffers:{},alpha:{},characterCache:n},i=Uo(Gt,n),a=yo(r,i),o=zo(r);t.setAlpha=function(e,t){r.alpha.ghost=e;r.alpha.background=t};t.clearView=function(e){o.clearView(e)};t.shutdownAndReset=function(){o.finish();n=Do();r={bidi:Gt,canvas:e,layersToDraw:[],textAtlas:null,fontIconAtlas:null,imageAtlases:[],allLayers:{},framebuffers:{},alpha:{},characterCache:n};i=Uo(Gt,n);a=yo(r,i);o=zo(r)};t.clearFramebuffers=function(){o.clearFramebuffers()};t.updateTextures=function(e){a.updateImageTextures(e,o)};t.build=function(e,t,n,i){var l,u=n.all||n.positions;if(n.all){l=[];r.layersToDraw.length=0}else l=r.layersToDraw;var c={},s=null;function f(e,t){if(n.all){if(t.bg&&c&&!e.bg){c.useFramebuffer=s;s=null}c={id:e.path,blatOverview:e.blatOverview,shadowType:e.shadowType,overview:e.overview,useView:e.useView,alwaysUpdate:e.alwaysUpdate,bg:e.bg,fbAlpha:i.backgroundAlpha,primitives:[],numOfPrimitives:0};if(e.bg){t.bg&&(s="bg");c.drawFramebuffer=s}l.push(c)}else(c=r.allLayers[e.path]).numOfPrimitives=0}function d(e){c.primitives[c.numOfPrimitives++]=e}e.forEach(d,f,!u);if(s){c.useFramebuffer=s;s=null}a.generate(l,t,n,i,o)};t.draw=function(e,t,n){o.render(e,t,r.textAtlas,r.fontIconAtlas,r.imageAtlases,n)};t.getPixels=function(e,t,n){return o.getPixels(e,t,r.textAtlas,r.fontIconAtlas,r.imageAtlases,n)};t.drawShadowCanvas=function(e,t){return o.drawShadowCanvas(e,t)};return t}var Ko=8888;function Oo(e,i,a,o,l,u,c){var f=document.getElementById(i),d=r(f);function g(e,t,n){var r,i=document.createElement("canvas");if(n&&d){i.dir="rtl";document.body.appendChild(i);i.style.display="none"}r=c?document.createElement("canvas").getContext("2d"):i.getContext("2d");i.context2d=r;i.height=t;i.width=e;c||m(i);return i}function h(e,t){var r=n(),i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,a=r/i;if(r!==i){var o=e.width,l=e.height;e.width=Math.round(o*a);e.height=Math.round(l*a);e.style.width=o+"px";e.style.height=l+"px";c||t.scale(a,a)}}function v(){if(!Dn){for(var e="Hello",t=g(100,100).context2d,n=!1,r=function(n){Kn(t,n);return t.measureText(e).width},i=r(1),a=2;!n&&a<30;){(n=i!==r(a))&&Un(a-1);a++}_n(!0)}}function m(e){var t=e.getContext("2d");function n(e){t.setLineDash=function(n){t[e]=n}}t.setLineDash||(void 0!==t.webkitLineDash?n("webkitLineDash"):void 0!==t.mozDash&&n("mozDash"))}function b(){return document.createElement("img")}var I=g(a,o,!0);I.style.display="block";var y={},p=I.context2d;f.style.display="block";f.parentNode.replaceChild(I,f);I.setAttribute("id",i);if(c&&Pi()&&"chart"===e){I.renderer=_o(I);y.renderer=I.renderer;I.webgl=!0}I.canvas=!0;var C=I;if(I.webgl){p.webgl=!0;p.webglCanvas=I}else p.webgl=!1;h(I,p);v();var x=C.getAttribute("style")||"";x+="-ms-touch-action: none; touch-action: none; outline: none;";C.setAttribute("style",x);C.setAttribute("tabindex",""+Ko++);var G="chart"===e?Ui(i):pa(i);t(G,function(e,t){-1===t.indexOf("private")&&(y[t]=e)});G.privateInit(p,a,o,g,function(e){document.getElementById(i).style.cursor=e},b,l,u);y.internalSetSize=function(e,t){G.privateMapSetSize&&G.privateMapSetSize(e,t);C.width=e;C.height=t;h(C,p);G.privateSetSize(p,e,t,!0)};var w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){s(e,1e3/60)};function Z(){G.update();w(Z)}w(Z);return y}var Jo={},Po=0,jo={},Qo=!1;try{var qo=Object.defineProperty({},"passive",{get:function(){Qo=!0}});window.addEventListener("test",qo,qo);window.removeEventListener("test",qo,qo)}catch(e){Qo=!1}var $o="";"undefined"!=typeof document&&al();var el={};function tl(e,t,n,r){var i=r||!1;Qo?e.addEventListener(t,n,{capture:i,passive:!1}):e.addEventListener(t,n,i)}function nl(e,t){for(var n=0;n<e.length;n++)tl(document,e[n],t)}function rl(e,t){for(var n=[],r=0;r<e[t].length;r++){var i=re(e[t][r]);n.push({id:e[t][r].identifier,x:i.x,y:i.y})}return n}function il(e){e.stopPropagation&&e.stopPropagation();e.preventDefault?e.preventDefault():e.returnValue=!1;e.preventCapture&&e.preventCapture();e.preventBubble&&e.preventBubble()}function al(){tl(document,"contextmenu",function(e){if(e.target.id in el){il(e);return!1}});tl(document,"dragover",function(e){if(e.target.id in el){var t=re(e);el[e.target.id].dragover(t.x,t.y)}});function e(e,t){tl(document,e,function(n){if(n.target.id in el){el[n.target.id][e](rl(n,"targetTouches"),rl(n,"changedTouches"));t&&n.preventDefault()}})}function n(e){tl(document,e,function(e){e.target.id in el&&e.preventDefault()})}function r(e){tl(document,e,function(t){if(t.target.id in el){el[t.target.id][e](t.scale,t.rotation);t.preventDefault()}})}if("ontouchstart"in document.documentElement)if(window.PointerEvent){n("touchstart");n("touchmove");n("touchend");n("touchcancel")}else{e("touchstart",!0);e("touchmove");e("touchend");e("touchcancel");r("gesturestart");r("gesturechange");r("gestureend")}function i(e,t){var n=e.pointerId||0,r=re(e);switch(t){case"ADD":Jo[n]||(Jo[n]={id:n,x:r.x,y:r.y});break;case"DEL":if(Jo[n]){delete Jo[n];Po--}break;case"MOVE":Jo[n]&&(Jo[n]={id:n,x:r.x,y:r.y})}return Y(Jo)}function a(e,t){var n=e.pointerId||0,r=re(e),i=[];switch(t){case"ADD":case"MOVE":i=[{id:n,x:r.x,y:r.y}];break;case"DEL":i=[Jo[n]]}return i}function o(e){return e.pointerType===(e.MSPOINTER_TYPE_TOUCH||"touch")}function l(e){jo[e]=new MSGesture;jo[e].target=document.getElementById(e)}function u(){c=1;s=0}var c=1,s=0;function f(e,t){return function(n){if(n.target.id in el&&o(n)){var r=a(n,t);el[n.target.id][e](i(n,t),r);n.preventDefault()}}}function d(e){function n(n){if(o(n)){var r="DEL";t(el,function(t){var o=a(n,r);t[e](i(n,r),o);var l=n.target.id;l&&el[l]&&n.preventDefault()})}}return n}if(navigator.msMaxTouchPoints||navigator.maxTouchPoints){tl(document,"pointerdown",function(e){if(e.target.id in el&&o(e)){if("undefined"!=typeof MSGesture){jo[e.target.id]||l(e.target.id);jo[e.target.id].addPointer(e.pointerId)}Po++;var t=a(e,"ADD");el[e.target.id].touchstart(i(e,"ADD"),t)}});tl(document,["pointermove"],f("touchmove","MOVE"));tl(document,["pointerup"],d("touchend"));tl(document,["pointercancel"],d("touchcancel"));tl(document,"MSHoldVisual",function(e){e.preventDefault()});tl(document,"MSGestureStart",function(e){var t=e.gestureObject.target.id;if(t in el&&Po>1){el[t].gesturestart();e.preventDefault()}});tl(document,"MSGestureChange",function(e){var t=e.gestureObject.target.id,n=Po>1&&e.detail!==e.MSGESTURE_FLAG_INERTIA;if(t in el&&n){c*=e.scale;s+=e.rotation*(180/Math.PI);el[t].gesturechange(c,s);e.preventDefault()}});tl(document,"MSGestureEnd",function(e){var t=e.gestureObject.target.id;if(t in el){el[t].gestureend(c,s);u();e.preventDefault()}})}tl(window,"dblclick",function(e){if(e.target.id in el){if(!((navigator.msMaxTouchPoints||navigator.maxTouchPoints)&&("touch"===e.pointerType||"pen"===e.pointerType))){var t=re(e);el[e.target.id].dblclick(t.x,t.y,e.ctrlKey,e.shiftKey);e.preventDefault()}}});tl(window,"mousedown",function(e){if(e.target.id in el&&0===Po){var t=re(e);el[e.target.id].mousedown(e.button,t.x,t.y,e.ctrlKey,e.shiftKey)}});tl(window,"mouseup",function(e){if(e.target.id in el){var t=re(e);el[e.target.id].mouseup(t.x,t.y,e.ctrlKey,e.shiftKey)}if(h){v(e.target.id,h.target.id,"mouseup",h);h=null}});tl(window,"mouseout",function(e){e.target.id in el&&(h=e)});var g=null,h=null;function v(e,t,n,r){if(e!==t){if(null!==t&&el[t]&&document.getElementById(t)){var i=ie(r,t);el[t][n](i.x,i.y,r.ctrlKey,r.shiftKey)}"mouseleave"===n&&(g=e)}}tl(window,"mousemove",function(e){if(e.target.id in el){v(e.target.id,g,"mouseleave",e);var t=re(e);el[e.target.id].mousemove(t.x,t.y,e.ctrlKey,e.shiftKey)}else v(null,g,"mouseleave",e)});function m(e){var t=e.wheelDelta||-e.detail;if(0!==t){var n=el[e.target.id];if(n){var r=re(e);n.mousewheel(t,r.x,r.y);il(e)}}}nl(["wheel","mousewheel","DOMMouseScroll"],m);tl(document,"MozMousePixelScroll",function(e){el[e.target.id]&&il(e)});tl(document,"keyup",function(e){e.target.id in el&&el[e.target.id].keyup(e.keyCode)});tl(document,"keydown",function(e){var t=!1;e.target.id in el&&(t=t||el[e.target.id].keydown(e.keyCode,e.ctrlKey,e.shiftKey));t&&e.preventDefault&&e.preventDefault()})}function ol(e){e in el&&delete el[e]}var ll="auto";function ul(e){e&&(ll=e);return ll}function cl(){var e,t,n,r;switch(arguments.length){case 0:throw new Error("createChart called with zero arguments");case 1:case 2:e=arguments[0];r=arguments[1];var i=document.getElementById(e);if(!i){sl(e,r);return}t=i.clientWidth;n=i.clientHeight;break;default:e=arguments[0];t=Number(arguments[1]);n=Number(arguments[2]);r=arguments[3]}Il("chart",e,t,n,r)}function sl(e,t){C(t,new Error('Cannot create KeyLines component. No element with id "'+e+'" exists in the DOM'))}function fl(e){return+e.replace(/px$/,"")}function dl(e,t,n,r){var i=document.getElementById(t);if(i){Il(e,t,i.clientWidth||fl(i.style.width),i.clientHeight||fl(i.style.height),n?a:r)}else sl(t,r);function a(e,t){e?C(r,e):t.options(n,function(){r&&r(null,t)})}}var gl,hl={chart:0,timebar:0};function vl(e,t){function n(e){
return W(e)||"chart"===e||"timebar"===e}var r=Z(e),i=r.every(function(e){return n(e.type)});r.length<1?C(t,Error("No definition passed to KeyLines.create")):i?a(r,0,[]):C(t,Error("The type of component passed to KeyLines.create is not valid"));function a(e,n,r){function i(e,t){var n=e.id?e.id:bl(t);e.setAttribute("id",n);return n}function o(e){if(ml(e.element)&&e.id)throw new Error("Cannot pass a DOM element and an id to create, please pass only one.");if(e.element&&!ml(e.element))throw new Error("You must pass a DOM element to the components element property.");var t={type:e.type?e.type:"chart",id:e.id||e,options:e.options};if(ml(e)){t.type="chart";t.id=i(e,t.type)}else ml(e.element)&&(t.id=i(e.element,t.type));return t}var l;try{l=o(e[n])}catch(e){C(t,e);return}dl(l.type,l.id,l.options,function(i,o){if(i)C(t,i);else{r.push(o);var l=n+1;if(l>=e.length){var u=1===r.length?r[0]:r;t&&t(null,u)}else a(e,l,r)}})}}function ml(e){return!(!e&&null!==e&&"object"!=typeof e)&&("object"==typeof HTMLElement&&e instanceof HTMLElement||1===e.nodeType)}function bl(e){hl[e]++;var t="KeyLines-"+e+"-"+hl[e];return el[t]||document.getElementById(t)?bl(e):t}function Il(e,t,n,r,i){ol(t);var a=n||100,o=r||100;if("canvas"!==ll&&"chart"===e&&Pi())try{Gl(e,t,a,o,!0,i)}catch(n){Oi();Gl(e,t,a,o,!1,i)}else if(Cl())Gl(e,t,a,o,!1,i);else{i("Could not create HTML5 canvas.")}}function yl(e){gl=e}function pl(e){e&&($o=e);return $o}yl("assets/");function Cl(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}var xl,Gl=function(e,t,n,r,i,a){try{el[t]=Oo(e,t,n,r,gl,$o,i)}catch(e){if(a){a(e);return}}el[t].webgl=i;el[t].canvas=!0;el[t].id=function(){return t};a&&a(null,el[t])};function wl(e,t,n){if(!h(t)||!h(n))throw new Error("KeyLines.setSize: Invalid width or height value passed. Both parameters should be numbers.");if(!(t<=0||n<=0)){var r=ml(e)?e:document.getElementById(e);if(!r)throw new Error("You must pass a valid id or DOM element.");var i=r.id;r.style.height=n+"px";r.style.width=t+"px";if(el[i]){el[i].internalSetSize(t,n);el[i].webgl&&el[i].renderer.clearFramebuffers()}}}function Zl(e){if(e){e.assets&&yl(e.assets);e.images&&pl(e.images)}return{assets:gl,images:$o}}function Al(){return Bl(["webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullScreenElement"])}function Bl(e){for(var t=R,n=0;n<e.length;n++)if(t(document[e[n]]))return!!document[e[n]];return!1}"undefined"!=typeof document&&nl(["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"],Sl);function Rl(e){var t=R;return t(document.webkitCurrentFullScreenElement)?document.webkitCurrentFullScreenElement===e:t(document.mozFullScreenElement)?document.mozFullScreenElement===e:!!t(document.msFullscreenElement)&&document.msFullscreenElement===e}function Ml(){var e=R;return!!e(document.webkitCurrentFullScreenElement)||(!!e(document.mozFullScreenElement)||!!e(document.msFullscreenEnabled)&&document.msFullscreenEnabled)}function Wl(e,t){for(var n,r=0;!n&&r<t.length;r++)if(e[t[r]]){n=!0;e[t[r]]()}}function Vl(e){Wl(e,["requestFullScreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullscreen"])}function Sl(){xl&&xl(Al())}function Xl(e,t){xl=t;Al()&&Rl(e)?Wl(document,["cancelFullScreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen"]):Vl(e)}function kl(){if(Cl()){var e=document.createElement("canvas").getContext("2d");return!!e.setLineDash||!!e.mozDash||!!e.webkitLineDash}return!1}var El=("undefined"!=typeof window?window:global).Promise,Yl=El,Fl="",Hl=!1,Ll=["create"],Tl=["arrange","createLink","filter","foreground","range","animateProperties","expand","hide","layout","load","merge","options","pan","ping","setItem","setProperties","show","toDataURL","viewOptions","zoom"],Nl=["combo","getGraphEngine","graph","map"],zl=["arrange","betweenness","close","closeness","combine","hide","transfer","open","options","show","uncombine"];function Ul(e,t,n){n&&(Fl=n);if(null==Yl&&!El&&!e)throw Error("[promisify] There's no valid Promise constructor available. It is not possible to promisify.");if(!Jl(e))throw Error("[promisify] Promise constructor not valid. Please use a valid Promise implementation.");El=e||Yl;if(!Hl){Dl(t,Ll,Nl);Y(t.components||{}).forEach(function(e){Dl(e,Tl,Nl)})}Hl=!0}function Dl(e,t,n){t.forEach(function(t){e[t]&&(e[t+Fl]=_l(e[t],t,"create"===t))});n&&n.forEach(function(t){e[t]&&(e[t+Fl]=Ol(e[t],zl))});return e}function _l(e,t,n){return function(){for(var r=Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];var a=Math.max(0,e.length-1);return Kl(t,r)?e.apply(null,r):new El(function(t,i){if(r.length===e.length&&m(r[a])){r.pop();d("A callback has been passed, but the function will return a Promise instead")}function o(e,n){if(e)return i(e);var r=Array.isArray(n),a=(r?n:[n]).map(function(e){return Dl(e,Tl,Nl)});return t(r?a:a[0])}r[a]=n?o:t;e.apply(null,r)})}}function Kl(e,t){return!(!/options$/i.test(e)||!W(t[0]))||"range"===e&&!t.length}function Ol(e,t){return function(){var n=Array.prototype.slice.call(arguments),r=e.apply(null,n),i={},a=H(t);Object.keys(r).forEach(function(e){e in a?i[e+Fl]=_l(r[e],e):i[e]=r[e]});return i}}function Jl(e){var t=e||El,n=void 0!==t&&"resolve"in t&&"reject"in t;try{new t(function(e){n=n&&"function"==typeof e})}catch(e){throw new Error("You must pass a valid promise constructor")}return n}var jl=function(){return lr.a||lr.b},Ql={charts:el,createChart:cl,imageBasePath:pl,setCanvasPaths:yl,promisify:function(e,t,n){return Ul(e,this,t,n)},components:el,coords:re,create:vl,dashedLineSupport:kl,fullScreenCapable:Ml,getFontIcon:hr,mode:ul,paths:Zl,setSize:wl,toggleFullScreen:Xl,webGLSupport:Pi,Rendering:{mainChannel:jl}};Ql.getGraphEngine=Mi;"undefined"!=typeof window&&(window.KeyLines=Ql);"undefined"!=typeof global&&(global.KeyLines=Ql);return Ql});
